(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1001:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(1),o=n.n(i),l=n(228),s=n.n(l),c=n(886),u=n(111),d=n(102),p=n(16),m=n(94),f=n(737),v=n(730),b=n(1007),E=n(991),g=n(989),y=n(990),O=n(988),I=n(152),h=n(114),S=n(12),R=n(1008),T=n(1013),P=n(985),C=n(987),j=n(1002),V=function(e){var t=e.caption,n=e.classes,r=e.hasNullOption,i=e.inputId,o=e.name,l=e.onChange,s=e.optionRender,c=e.options,u=e.value;return a.a.createElement("div",{className:n.container},a.a.createElement(T.a,{component:"label",shrink:!0,htmlFor:i},t),a.a.createElement(j.a,{name:o,value:u,displayEmpty:!0,onChange:l,input:a.a.createElement(P.a,{id:i}),className:n.selectRoot},r&&a.a.createElement(C.a,{key:null,value:null},s({option:null,index:-1,options:c})),c.map(function(e,t){return a.a.createElement(C.a,{key:e,value:e},s({option:e,index:t,options:c}))})))},N=o.a.oneOfType([o.a.number,o.a.string]);V.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(N),value:N},V.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var L=Object(S.a)({container:{display:"inline-block",flexGrow:"1",flexBasis:"0"},selectRoot:{display:"block"}})(V),w=n(706),D=n(970),A=n(696),_=n(695),q=function(e){var t=e.inputValue,n=e.sourceProps,r=(n=void 0===n?{}:n).suggestions,i=void 0===r?[]:r,o=e.children,l=t.toLowerCase();return a.a.createElement(a.a.Fragment,null,o(i.filter(function(e){return e.label.toLowerCase().includes(l)})))};q.propTypes={inputValue:o.a.string.isRequired,sourceProps:o.a.shape({suggestions:o.a.array}).isRequired,children:o.a.func.isRequired};var Y=q;function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){x(e,t,n[t])})}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var F=function(e){var t=e.inputProps,n=e.classes,r=e.ref,i=k(e,["inputProps","classes","ref"]);return a.a.createElement(R.a,U({InputProps:H({inputRef:r,classes:{root:n.inputRoot,input:n.inputInput}},t)},i))},M=n(699);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var G=function(e){var t=e.itemProps,n=e.isHighlighted,r=e.isSelected,i=e.children,o=i.label,l=i.details;return a.a.createElement(C.a,B({},t,{selected:n,component:"div",style:{fontWeight:r?500:400}}),a.a.createElement(M.a,{primary:o,secondary:l}))};G.propTypes={itemProps:o.a.object,isHighlighted:o.a.bool,isSelected:o.a.bool,children:o.a.func.isRequired},G.defaultProps={itemProps:void 0,isHighlighted:!1,isSelected:!1};var W=G;function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var J=Object(A.a)(function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}}),X=function(e){return(e||{}).label},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.SuggestionsResolver,n=void 0===t?Y:t,r=e.SuggestionItemComponent,i=void 0===r?W:r,o=e.InputComponent,l=void 0===o?F:o;return function(e){var t=e.classes,r=e.sourceProps,o=e.inputProps,s=e.inputFieldProps,c=$(e,["classes","sourceProps","inputProps","inputFieldProps"]),u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){K(e,t,n[t])})}return e}({},J(),t);return a.a.createElement("div",{className:u.root},a.a.createElement(D.a,z({itemToString:X},c),function(e){var t=e.getInputProps,c=e.getItemProps,d=e.getMenuProps,p=e.highlightedIndex,m=e.inputValue,f=e.isOpen,v=e.selectedItem;return a.a.createElement("div",{className:u.container},a.a.createElement(l,z({fullWidth:!0,classes:u,inputProps:t(o)},s)),a.a.createElement("div",d(),f&&a.a.createElement(_.a,{className:u.paper,square:!0},a.a.createElement(n,{inputValue:m,sourceProps:r},function(e){return e.map(function(e,t){return a.a.createElement(i,{key:e.label,itemProps:c({item:e}),isHighlighted:p===t,isSelected:Boolean(v)&&v.label===e.label},e)})}))))}))}};Q();function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee,te="FILTER",ne="SEARCH",re=function(e){var t=e.queryFormat,n=e.filterField,r=e.inputValue,a={pageSize:e.numberOfItemsToRequest};switch(t){case ne:return{navigation:a,search:r};case te:default:return{navigation:a,filter:Z({},n,{comparator:"~",value:"%".concat(r,"%")})}}},ae=Q({SuggestionsResolver:Object(w.a)(function(e,t){var n=t.inputValue,r=t.sourceProps,a=r.modelName,i=r.domain,o=r.filterField,l=r.numberOfItemsToRequest,s=r.queryFormat;return{domain:i,identity:n,request:{entities:{modelName:a,observe:n,query:re({queryFormat:s,filterField:o,inputValue:n,numberOfItemsToRequest:l})}},debounceRequest:500}})(function(e){var t=e.sourceProps,n=(t=void 0===t?{}:t).filterField,r=t.resolveDetails,a=t.convertEntityToSuggestion,i=void 0===a?function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Z(e,t,n[t])})}return e}({},e,{label:e[n],details:r?r(e):void 0})}:a,o=e.entities,l=(o=void 0===o?{}:o).data,s=void 0===l?[]:l;return(0,e.children)((s||[]).map(i))})}),ie=n(162);function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var le=(oe(ee={},ie.TRIP_TYPES.LEISURE,"Отдых"),oe(ee,ie.TRIP_TYPES.BUSINESS,"Работа"),oe(ee,ie.TRIP_TYPES.MIXED,"Смешанный"),oe(ee,ie.TRIP_TYPES.RELOCATION,"Переезд"),oe(ee,ie.TRIP_TYPES.OTHER,"Другой"),ee);function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.option;return t?le[t]:"Не указан"},de=function(e){var t=e.tripName,n=e.tripType,a=e.originLocationId,i=e.originGeonameId,o=ce(Object(r.useState)({tripName:t,tripType:n,originLocationId:a,originGeonameId:i}),2),l=o[0],s=o[1];return{tripState:l,setTripState:function(e){return s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){se(e,t,n[t])})}return e}({},l,e))}}},pe=function(e){var t=e.classes,n=e.locationsDict,i=e.tripState,o=i.tripType,l=i.tripName,s=i.originLocationId,c=e.setTripState,u=Object(r.useCallback)(function(e){var t=e.target.value;return c({tripName:t})},[c]),d=Object(r.useCallback)(function(e){var t=e.target.value;return c({tripType:t})},[c]),p=Object(r.useCallback)(function(e){var t=e.geonameId;return c({originGeonameId:t})},[c]),m=(n[s]||{}).locationName;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:t.optionGroup},a.a.createElement(R.a,{fullWidth:!0,label:"Название поездки",value:l,onChange:u})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(ae,{classes:{root:t.suggest},textFieldProps:{label:"Старт из"},initialInputValue:m,inputProps:{placeholder:"Пункт отправления..."},onChange:p,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"tripEditCard.geoname",queryFormat:ne,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(L,{caption:"Тип поездки",inputId:"TripEditCard-TripTypeOptions",onChange:d,optionRender:ue,options:Object.values(ie.TRIP_TYPES),hasNullOption:!0,value:o})))};pe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},pe.defaultProps={className:void 0};var me=s()(Object(h.connect)(function(e){return{locationsDict:Object(d.d)(e,"locations")}}),Object(S.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}}))(pe);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ve=function(e){var t=e.initialState,n=e.children,r=e.onSubmit,i=de(t),o=i.tripState,l=i.setTripState,s=fe(a.a.useState(!1),2),u=s[0],d=s[1],p=function(){return d(!1)};return a.a.createElement(a.a.Fragment,null,a.a.cloneElement(n,{onClick:function(){return d(!0)}}),u&&a.a.createElement(b.a,{transitionDuration:500,open:u,onClose:p,"aria-labelledby":"form-dialog-title"},a.a.createElement(O.a,{id:"form-dialog-title"},"Поездка"),a.a.createElement(g.a,null,a.a.createElement(y.a,null,"Редактирование поездки"),a.a.createElement(me,{tripState:o,setTripState:l})),a.a.createElement(E.a,null,a.a.createElement(c.a,{onClick:p,color:"secondary"},"Отмена"),a.a.createElement(c.a,{onClick:function(){r(o),p()},color:"primary"},"Сохранить"))))};ve.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},ve.defaultProps={};var be=ve,Ee=n(153),ge=n(748),ye=n(163),Oe=n(151),Ie=n(58),he=n(906),Se=n(992),Re=n(238),Te=n.n(Re),Pe=n(786),Ce=n.n(Pe),je=function(e){for(var t=e.target;t;){if(t.dataset&&"enabled"===t.dataset.sortHandler)return!1;t=t.parentNode}return!0};function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ne=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},Le=n(280),we=function(e){var t=e.location,n=t.locationId,r=t.locationName,i=void 0===r?"unknown":r,o=e.locationPath,l=e.Icon,s=e.classes,c=o?a.a.createElement(Ie.b,{to:o.toUrl({strLocationId:String(n)})},i):i;return a.a.createElement("div",{className:s.container},l&&a.a.createElement(l,{className:s.icon}),c)};we.propTypes={classes:o.a.objectOf(o.a.string).isRequired,location:o.a.shape(Ee.default),Icon:Le.a,locationPath:p.d},we.defaultProps={location:{},Icon:void 0,locationPath:void 0};var De,Ae=Object(S.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"}})(we),_e=n(743),qe=n.n(_e),Ye=n(909),Ue=n.n(Ye),He=n(907),xe=n.n(He),ke=n(785),Fe=n.n(ke),Me=n(908),Be=n.n(Me),Ge=n(158);function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ze=(We(De={},Ge.VISIT_TYPES.TRANSIT,"Транзит"),We(De,Ge.VISIT_TYPES.REGULAR,"Посещение"),We(De,Ge.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),We(De,Ge.VISIT_TYPES.RELOCATION,"Переезд"),De);function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Je=function(e){var t=e.option;return t?ze[t]:"Не указан"},Xe=function(e){var t=e.visitType,n=e.visitComment,a=e.locationId,i=e.locationName,o=e.geonameId,l=$e(Object(r.useState)({visitComment:n,visitType:t,locationId:a,locationName:i,geonameId:o}),2),s=l[0],c=l[1];return{visitState:s,setVisitState:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ke(e,t,n[t])})}return e}({},s,e))}}},Qe=function(e){var t=e.classes,n=e.visitState,i=n.visitType,o=n.visitComment,l=n.locationName,s=e.setVisitState,c=Object(r.useCallback)(function(e){var t=e.target.value;return s({visitType:t})},[s]),u=Object(r.useCallback)(function(e){var t=e.geonameId;return s({geonameId:t})},[s]),d=Object(r.useCallback)(function(e){var t=e.target.value;return s({visitComment:t})},[s]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:t.optionGroup},a.a.createElement(ae,{classes:{root:t.suggest},textFieldProps:{label:"Место посещения"},initialInputValue:l,inputProps:{placeholder:"Населенный пункт..."},onChange:u,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"visitEditCard.geoname",queryFormat:ne,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(L,{caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",onChange:c,optionRender:Je,options:Object.values(Ge.VISIT_TYPES),hasNullOption:!0,value:i})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(R.a,{label:"Комментарий",fullWidth:!0,value:o,onChange:d,multiline:!0,rows:1,rowsMax:12})))};Qe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Qe.defaultProps={className:void 0};var Ze=Object(S.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}})(Qe);function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tt=function(e){var t=e.initialState,n=e.children,r=e.onSubmit,i=Xe(t),o=i.visitState,l=i.setVisitState,s=et(a.a.useState(!1),2),u=s[0],d=s[1],p=function(){return d(!1)};return a.a.createElement(a.a.Fragment,null,a.a.cloneElement(n,{onClick:function(){return d(!0)}}),u&&a.a.createElement(b.a,{transitionDuration:500,open:u,onClose:p,"aria-labelledby":"form-dialog-title"},a.a.createElement(O.a,{id:"form-dialog-title"},"Посещение"),a.a.createElement(g.a,null,a.a.createElement(y.a,null,"Редактирование посещения"),a.a.createElement(Ze,{visitState:o,setVisitState:l})),a.a.createElement(E.a,null,a.a.createElement(c.a,{onClick:p,color:"secondary"},"Отмена"),a.a.createElement(c.a,{onClick:function(){r(o),p()},color:"primary"},"Сохранить"))))};tt.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},tt.defaultProps={};var nt=tt;function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var at=function(e){var t=e.visit,n=e.onVisitUpdate,r=e.classes,i=e.isEditable,o=e.locationPath;if(!t)return"Не указано";var l=t.locationName,s=t.visitType,c=t.locationId,u=function(e){switch(e){case"Transit":return xe.a;case"BaseCamp":return Be.a;case"Relocation":return Fe.a;case"Regular":default:return Ue.a}}(s);return a.a.createElement("div",{className:r.container},u&&a.a.createElement(u,{className:r.icon}),a.a.createElement(Ie.b,{to:o.toUrl({strLocationId:String(c)})},l),i&&a.a.createElement(nt,{initialState:t,onSubmit:function(e){return n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){rt(e,t,n[t])})}return e}({},t,e))}},a.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},a.a.createElement(Ce.a,{className:r.editIcon}))))};at.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isEditable:o.a.bool,onVisitUpdate:o.a.func.isRequired,visit:o.a.shape(Oe.default),locationPath:p.d.isRequired},at.defaultProps={isEditable:!1,visit:{}};var it=Object(S.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}})(at),ot=n(919),lt=n.n(ot),st=n(918),ct=n.n(st),ut=n(916),dt=n.n(ut),pt=n(913),mt=n.n(pt),ft=n(927),vt=n.n(ft),bt=n(915),Et=n.n(bt),gt=n(921),yt=n.n(gt),Ot=n(922),It=n.n(Ot),ht=n(914),St=n.n(ht),Rt=n(917),Tt=n.n(Rt),Pt=n(920),Ct=n.n(Pt),jt=n(923),Vt=n.n(jt),Nt=n(924),Lt=n.n(Nt),wt=n(925),Dt=n.n(wt),At=n(926),_t=n.n(At),qt=n(929),Yt=n.n(qt),Ut=n(928),Ht=n.n(Ut),xt=n(61),kt=n(218),Ft=n(968);function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Bt(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Gt=function(e){var t=e.children,n=e.description,r=e.onReject,i=e.onSubmit,o=e.title,l=Bt(e,["children","description","onReject","onSubmit","title"]);return a.a.createElement(Ft.a,Mt({},l,{onSubmit:i}),function(e){var i=e.handleSubmit,l=Bt(e,["handleSubmit"]);return a.a.createElement(b.a,{transitionDuration:500,open:!0,onClose:r,"aria-labelledby":"form-dialog-title"},a.a.createElement(O.a,{id:"form-dialog-title"},o),a.a.createElement(g.a,null,a.a.createElement(y.a,null,n),a.a.cloneElement(t,l)),a.a.createElement(E.a,null,a.a.createElement(c.a,{onClick:r,color:"secondary"},"Отмена"),a.a.createElement(c.a,{onClick:i,color:"primary"},"Сохранить")))})};Gt.propTypes={children:o.a.node.isRequired,description:o.a.node,onReject:o.a.func.isRequired,onSubmit:o.a.func.isRequired,title:o.a.node},Gt.defaultProps={description:void 0,title:void 0};var Wt=Gt,zt=n(994),Kt=n(1005),$t=n(993),Jt=n(1011),Xt=n(761),Qt=n(278),Zt=n(279),en=n(216),tn=n(140),nn=function(e){var t=e.dateFrom,n=e.timeFrom;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())},rn=function(e){var t=e.values,n=t.rideDeparture,r=t.rideArrival,a=e.handleChange,i=Object(Qt.a)(n,r),o=function(e,t){var i,o,l=(i=e,o=t,Object(tn.a)(i,o)),s=l?t:e,c=l?e:t;Object(Zt.a)(n,s)||function(e){a("departureDateTime")(e)}(s),Object(Zt.a)(r,c)||function(e){a("arrivalDateTime")(e)}(c)};return{isSameDateField:{value:i,onChange:function(e){Boolean(i)!==Boolean(e)&&o(n,nn({dateFrom:e?n:Object(en.a)(n,1),timeFrom:r}))}},rideDepartureField:{value:n,onChange:function(e){var t=i?nn({timeFrom:r,dateFrom:e}):r;o(e,t)}},rideArrivalField:{value:r,onChange:function(e){var t=i?nn({timeFrom:n,dateFrom:e}):n;o(t,e)}}}};function an(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var on=null,ln=function(e){var t=e.option;return t?Xt.d[t]:"Не указан"},sn=function(e){var t=e.option;return t?Xt.c[t]:"Не указан"},cn=function(e){var t=e.option;return t?Xt.a[t]:"Не указан"},un=function(e){var t=e.option;return t?Xt.b[t]:"Не указан"},dn=function(e){var t=e.classes,n=e.availableVisits,i=e.originLocation,o=e.values,l=o.departureVisitId,s=o.arrivalVisitId,c=o.vehicleType,u=o.rideType,d=o.rideComment,p=o.rideClass,m=o.rideOccupation,f=o.departureDateTime,v=o.arrivalDateTime,b=e.handleChange,E=n.map(function(e){return e.visitId}),g=Object.fromEntries(n.map(function(e){return[e.visitId,e]})),y=rn({values:{rideDeparture:f,rideArrival:v},handleChange:b}),O=y.rideArrivalField,I=y.rideDepartureField,h=y.isSameDateField,S=Object(r.useCallback)(function(e){var t=e.option;if(t===on)return i.locationName;var n=g[t];return n?n.locationName:"Не указано"},[g]);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:t.optionGroup},a.a.createElement(L,{name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:S,hasNullOption:!1,options:[on].concat(an(E)),value:l,onChange:b}),a.a.createElement(L,{name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:S,options:[].concat(an(E),[on]),onChange:b,value:s})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(L,{name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:ln,options:Object.values(xt.VEHICLE_TYPES),onChange:b,value:c}),a.a.createElement(L,{name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:sn,options:Object.values(xt.RIDE_TYPES),onChange:b,value:u})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(L,{name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:cn,options:Object.values(xt.RIDE_CLASSES),onChange:b,value:p}),a.a.createElement(L,{name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:un,options:Object.values(xt.RIDE_OCCUPATION),onChange:b,value:m})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement($t.a,{name:"departureDateTime",autoOk:!0,className:t.option,label:"Дата отправления",value:I.value,onChange:I.onChange,format:"dd/MM/yyyy"}),h.value?a.a.createElement(zt.a,{control:a.a.createElement(Kt.a,{checked:h.value,onChange:function(e){return h.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):a.a.createElement($t.a,{name:"arrivalDateTime",autoOk:!0,className:t.option,label:"Дата прибытия",value:O.value,onChange:O.onChange,format:"dd/MM/yyyy"})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(Jt.a,{name:"departureDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время отправления",value:I.value,onChange:I.onChange}),a.a.createElement(Jt.a,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время прибытия",value:O.value,onChange:O.onChange})),a.a.createElement("div",{className:t.optionGroup},a.a.createElement(R.a,{name:"rideComment",className:t.option,label:"Комментарий",multiline:!0,onChange:b,rows:1,rowsMax:12,value:d})))};dn.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},dn.defaultProps={className:void 0};var pn=Object(S.a)({optionGroup:{display:"flex"},option:{flexGrow:"1"}})(dn);function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var fn=function(e){var t=e.availableVisits,n=e.initialState,r=e.children,i=e.className,o=e.onSubmit,l=e.originLocation,s=mn(a.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return a.a.createElement("div",{className:i},a.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},r),c&&a.a.createElement(Wt,{initialValues:n,enableReinitialize:!0,onSubmit:function(e){o(e),d()},onReject:d,title:"Транспорт",description:"Как вы добрались в место назначения и как уехали из него?"},a.a.createElement(pn,{availableVisits:t,originLocation:l})))};fn.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,className:o.a.string,onSubmit:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired},fn.defaultProps={className:void 0,availableVisits:[]};var vn=fn;function bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var En=function(e){var t=e.availableVisits,n=e.originLocation,r=e.classes,i=e.className,o=e.defaultArrivalVisitId,l=e.defaultDepartureVisitId,s=e.isEditable,c=e.onRideUpdate,u=e.ride,d=e.ride,p=d.rideId,m=d.vehicleType,f=d.rideType,v=d.arrivalDateTime,b=d.departureDateTime,E=e.showDetails,g=p?u:Object(kt.a)({defaultDepartureVisitId:l,defaultArrivalVisitId:o}),y=p?function(e){switch(e){case xt.VEHICLE_TYPES.CAR:return mt.a;case xt.VEHICLE_TYPES.TRAIN:return St.a;case xt.VEHICLE_TYPES.AIRCRAFT:return Et.a;case xt.VEHICLE_TYPES.BUS:case xt.VEHICLE_TYPES.TROLLEY:case xt.VEHICLE_TYPES.CITY_BUS:return dt.a;case xt.VEHICLE_TYPES.MOTORHOME:case xt.VEHICLE_TYPES.JITNEY:return Tt.a;case xt.VEHICLE_TYPES.LOCAL_TRAIN:return St.a;case xt.VEHICLE_TYPES.FERRY:return ct.a;case xt.VEHICLE_TYPES.BIKE:return lt.a;case xt.VEHICLE_TYPES.BY_FEET:return Ct.a;case xt.VEHICLE_TYPES.MOTORBIKE:return yt.a;case xt.VEHICLE_TYPES.TRUCK:return Fe.a;case xt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return It.a;case xt.VEHICLE_TYPES.TRAM:return Vt.a;case xt.VEHICLE_TYPES.TAXI:return Lt.a;case xt.VEHICLE_TYPES.SUBWAY:return Dt.a;case xt.VEHICLE_TYPES.PUBLIC_TRANSPORT:return _t.a;case xt.VEHICLE_TYPES.ROPEWAY:case xt.VEHICLE_TYPES.FUNICULAR:default:return vt.a}}(m):Ht.a,O=a.a.createElement(y,{className:r.icon}),I=s?a.a.createElement(vn,{className:r.editDialogTrigger,initialState:g,availableVisits:t,onSubmit:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){bn(e,t,n[t])})}return e}({},u,e))},originLocation:n},O):O;return a.a.createElement("div",{className:qe()(i,r.container)},f===xt.RIDE_TYPES.HITCH_HIKING&&a.a.createElement(Yt.a,{className:r.icon}),I,Boolean(p&&E)&&a.a.createElement("span",{className:r.details},function(e,t){var n=Boolean(t)&&t.toLocaleDateString(),r=Boolean(e)&&e.toLocaleDateString();return n===r?n:"".concat(r,"—").concat(n)}(b,v)))};En.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),classes:o.a.objectOf(o.a.string).isRequired,className:o.a.string,defaultArrivalVisitId:o.a.number,defaultDepartureVisitId:o.a.number,isEditable:o.a.bool,onRideUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,ride:o.a.shape(I.default),showDetails:o.a.bool},En.defaultProps={availableVisits:[],className:void 0,defaultArrivalVisitId:void 0,defaultDepartureVisitId:void 0,isEditable:!1,ride:{},showDetails:!1};var gn=Object(S.a)({container:{display:"inline-block"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},editDialogTrigger:{display:"inline-block"}})(En),yn=n(930),On=n.n(yn),In=function(e){var t=e.className,n=e.classes;return a.a.createElement(On.a,{className:qe()(t,n.dragHandler),"data-sort-handler":"enabled"})};In.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},In.defaultProps={className:void 0};var hn=Object(S.a)({dragHandler:{cursor:"grab",marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block"}})(In);function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rn=function(e){var t,n,r=e.visit,i=e.visit,o=(i=void 0===i?{}:i).visitId,l=i.arrivalRideId,s=i.departureRideId,c=e.ridesDict,u=e.classes,d=e.prevVisitId,p=e.nextVisitId,m=e.tripVisitsList,f=e.isEditable,v=e.isSortable,b=e.isSorting,E=e.isArrivalRideMatch,g=e.isDepartureRideMatch,y=e.onRideUpdate,O=e.onVisitUpdate,I=e.originLocation,h=e.locationPath,S=f&&!E,R=f&&!g;return a.a.createElement("div",{className:u.container},a.a.createElement(gn,{availableVisits:m,defaultDepartureVisitId:d,defaultArrivalVisitId:o,visitId:o,isEditable:f,className:qe()(u.ride,(t={},Sn(t,u.alwaysVisible,b||!g),Sn(t,u.warning,S),t)),ride:c[l],showDetails:b||S,onRideUpdate:y,originLocation:I}),a.a.createElement(it,{classes:{editIcon:u.visibleOnlyOnHover},isEditable:f,onVisitUpdate:O,visit:r,locationPath:h}),(!g||b)&&a.a.createElement(gn,{className:qe()(u.ride,(n={},Sn(n,u.alwaysVisible,b||!g),Sn(n,u.warning,R),n)),ride:c[s],availableVisits:m,defaultDepartureVisitId:o,defaultArrivalVisitId:p,isEditable:f&&!g,showDetails:b||R,onRideUpdate:y,originLocation:I}),v&&!b&&a.a.createElement(hn,{className:u.visibleOnlyOnHover}))};Rn.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isArrivalRideMatch:o.a.bool,isDepartureRideMatch:o.a.bool,isEditable:o.a.bool,isSortable:o.a.bool,isSorting:o.a.bool,nextVisitId:o.a.number,onRideUpdate:o.a.func.isRequired,onVisitUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,prevVisitId:o.a.number,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default)),visit:o.a.shape(Oe.default).isRequired,locationPath:p.d.isRequired},Rn.defaultProps={isArrivalRideMatch:!0,isDepartureRideMatch:!0,isEditable:!1,isSortable:!1,isSorting:!1,nextVisitId:null,prevVisitId:null,tripVisitsList:[]};var Tn=Object(S.a)({alwaysVisible:{},container:{position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}})(Rn);var Pn=function(e){var t,n,r,i=e.classes,o=e.isSorting,l=e.onVisitUpdate;return a.a.createElement("div",{className:qe()((t={},n=i.draggableContainer,r=!o,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))},a.a.createElement(nt,{initialState:{visitType:null,visitComment:""},onSubmit:l},a.a.createElement(c.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},a.a.createElement("span",null,"Добавить посещение"))),a.a.createElement(hn,{className:i.visibleOnlyOnHover}))};Pn.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isSorting:o.a.bool,onVisitUpdate:o.a.func.isRequired},Pn.defaultProps={isSorting:!1};var Cn=Object(S.a)({visibleOnlyOnHover:{visibility:"hidden"},draggableContainer:{position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}}})(Pn);function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Nn(){return(Nn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ln(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var wn=Object(he.SortableContainer)(function(e){var t=e.children;return a.a.createElement("div",null,t)}),Dn=Object(he.SortableElement)(function(e){var t=e.replaceWithNode,n=e.onVisitUpdate,r=Ln(e,["replaceWithNode","onVisitUpdate"]);return t||a.a.createElement(Tn,Nn({onVisitUpdate:n},r))}),An=function(e){var t=e.classes,n=e.countriesDict,i=e.isEditable,o=e.locationsDict,l=e.onRideUpdate,s=e.onVisitsOrderUpdate,c=e.ridesDict,u=e.trip,d=e.trip,p=d.tripId,m=d.originLocationId,f=d.tripName,v=d.tripType,b=e.tripIndex,E=e.tripVisitsList,g=e.onTripUpdate,y=e.onVisitUpdate,O=e.storyPath,I=e.locationPath,h=i,S=Vn(Object(r.useState)(!1),2),R=S[0],T=S[1],P=Vn(Object(r.useState)(E.length),2),C=P[0],j=P[1],V=h?Dn:Tn,N=(i?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return[].concat(Ve(e.slice(0,n)),[t],Ve(e.slice(n)))}(E,{isItVisitCreatorControl:!0},C):E).map(function(e,t){var n=e.isItVisitCreatorControl,r=e.visitId;if(n)return a.a.createElement(Dn,{key:"visitCreator",index:t,replaceWithNode:a.a.createElement(Cn,{isSorting:R,onVisitUpdate:function(e){return y(e,{indexInCollection:C,collection:E,tripId:p})}})});var s=Vn(function(e,t,n){var r=t-1-(t>n?1:0),a=t+1-(t+1>n?1:0);return[r>=0?e[r]:null,a<e.length?e[a]:null]}(E,t,C),2),u=s[0],d=s[1],f=(u||{}).visitId,v=(d||{}).visitId;return a.a.createElement(V,{index:t,isArrivalRideMatch:Ne(u,e),isDepartureRideMatch:Ne(e,d),isEditable:i,isSortable:h,isSorting:R,key:r,nextVisitId:v,onRideUpdate:l,onVisitUpdate:y,originLocation:o[m],prevVisitId:f,ridesDict:c,tripVisitsList:E,visit:e,locationPath:I})}),L=h?a.a.createElement(wn,{onSortEnd:function(e,t){T(!1);var n=e.oldIndex,r=e.newIndex;n===C?j(r):s(t,{oldIndex:n>C?n-1:n,newIndex:r>C?r-1:r,collection:E})},shouldCancelStart:je,updateBeforeSortStart:function(){return T(!0)},lockAxis:"y",lockToContainerEdges:!0},N):a.a.createElement("div",null,N),w=a.a.createElement(Ae,{location:o[m],Icon:Te.a,locationPath:I}),D=a.a.createElement(be,{initialState:u,onSubmit:function(e){return g(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){jn(e,t,n[t])})}return e}({},u,e))}},a.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},a.a.createElement(Ce.a,{className:t.visibleOnlyOnHover}))),A=E[E.length-1],_=E[E.length-2],q=A||{},Y=q.departureRideId,U=q.visitId,H=v===ie.TRIP_TYPES.RELOCATION,x=H?null:a.a.createElement(gn,{availableVisits:E,defaultDepartureVisitId:U,isEditable:i,onRideUpdate:l,originLocation:o[m],ride:c[Y],showDetails:R||Ne(_,A)}),k=E.some(function(e){var t=e.visitComment,n=e.arrivalRideId,r=e.departureRideId;if(t)return!0;if((c[n]||{}).rideComment)return!0;var a=(c[r]||{}).rideComment;return Boolean(a)});return a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",{className:t.container},"".concat(b+1,". ").concat(Object(ge.b)(E,n,o[m]&&o[m].countryId,f)),i&&D),w,L,!H&&a.a.createElement(a.a.Fragment,null,x,w),k&&a.a.createElement("div",null,a.a.createElement(Ie.b,{to:O.toUrl({strTripId:String(p)})},"Заметки")))};An.propTypes={classes:o.a.objectOf(o.a.string).isRequired,tripIndex:o.a.number.isRequired,isEditable:o.a.bool,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired,onRideUpdate:o.a.func.isRequired,onTripUpdate:o.a.func.isRequired,onVisitsOrderUpdate:o.a.func.isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,trip:o.a.shape(ye.default).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default)),storyPath:p.d.isRequired,locationPath:p.d.isRequired},An.defaultProps={isSortable:!1,tripVisitsList:[]};var _n=Object(S.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}})(An);function qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Yn(e,t,n[t])})}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Un,Hn,xn=(Un={orderResolver:function(e){return e.orderInTrip}}.orderResolver,function(e){var t=e.index,n=e.collection;if(!n.length)return 100;if(t<=0)return Un(n[0])-1;if(t>=n.length-1)return Un(n[n.length-1])+1;var r=Un(n[t-1]),a=Un(n[t]);return(r+a)/2+(Math.random()-.5)*(a-r)/2});function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fn=Object(u.a)(ge.a),Mn=function(e){var t=e.match.params.userAlias,n=e.isTripsComplete,i=e.userTrips,o=(i=void 0===i?{}:i).data,l=void 0===o?[]:o,s=e.userVisits,u=(s=void 0===s?{}:s).data,d=void 0===u?[]:u,p=e.countriesDict,f=e.locationsDict,b=e.namedPaths,E=e.ridesDict,g=e.request,y=e.invalidateRequest,O=Object(m.c)(),I=O.isAuthenticated,h=O.userAlias,S=I&&h===t,R=Object(r.useCallback)(function(e,t){var n=t.oldIndex,r=t.newIndex,a=t.collection;n!==r&&g(function(e){var t=e.oldIndex,n=e.newIndex,r=e.collection;return{domain:"tripsPage.visits.sort",modelName:"visits",query:{id:r[t].visitId,body:{orderInTrip:xn({index:n,collection:r})}}}}({oldIndex:n,newIndex:r,collection:a}))},[g]),T=Object(r.useCallback)(function(e){return g(function(e){var t=e.ride;return{domain:"tripsPage.visits.rides",modelName:"rides",query:{id:e.ride.rideId,body:t}}}({ride:e}))},[g]),P=Object(r.useCallback)(function(e){return g(function(e){var t=e.trip;return{domain:"tripsPage.visits.trips",modelName:"trips",query:{id:e.trip.tripId,body:t}}}({trip:e})).then(function(){return y({domain:"tripsPage.trips"})})},[g]),C=Object(r.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.indexInCollection,r=t.collection,a=t.tripId;return g(function(e){var t=e.visit,n=e.visit.visitId,r=e.tripId,a=e.indexInCollection,i=e.collection;return{domain:"tripsPage.visits.visit",modelName:"visits",query:{id:n,body:qn({},t,{tripId:r,orderInTrip:a||0===a?xn({index:a,collection:i}):void 0})}}}({visit:e,tripId:a,indexInCollection:n,collection:r})).then(function(){return y({domain:"tripsPage.visits"})})},[g]),j=Object(r.useMemo)(function(){return a.a.createElement(be,{initialState:{tripType:null},onSubmit:P},a.a.createElement(c.a,{size:"small",variant:"outlined",color:"primary"},"Добавить поездку"))},[P]);if(n&&!l.length)return a.a.createElement(v.a,{shouldShowLinkToTrips:!1},j);var V=Fn(d);return a.a.createElement(a.a.Fragment,null,S&&j,l.map(function(e,t){var n=e.tripId;return a.a.createElement("div",{key:n},a.a.createElement(_n,{locationsDict:f,countriesDict:p,onRideUpdate:T,onTripUpdate:P,onVisitUpdate:C,onVisitsOrderUpdate:R,ridesDict:E,trip:e,tripIndex:t,tripVisitsList:V[n],isEditable:S,storyPath:b.travel.tripStory,locationPath:b.travel.locationPath}))}))};Mn.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired,namedPaths:p.e.namedPaths.isRequired,request:o.a.func.isRequired,isTripsComplete:o.a.bool.isRequired,trips:o.a.shape({data:o.a.arrayOf(o.a.shape(ye.default))}).isRequired,visits:o.a.shape({data:o.a.arrayOf(o.a.shape(Oe.default))}).isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired};t.default=s()(p.g,Object(f.b)({domain:"tripsPage",mapStateToProps:function(e){return{countriesDict:Object(d.d)(e,"countries"),locationsDict:Object(d.d)(e,"locations"),ridesDict:Object(d.d)(e,"rides"),isTripsComplete:Object(d.g)(e,"tripsPage.userTrips").isComplete}},requirementsConfig:(Hn={},kn(Hn,f.a.COMMON.COUNTRIES,!0),kn(Hn,f.a.USER.TRIPS,!0),kn(Hn,f.a.USER.LOCATIONS,!0),kn(Hn,f.a.USER.VISITS,!0),kn(Hn,f.a.USER.RIDES,!0),Hn)}))(Mn)},706:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(232),o=function(e){return function(t){var n=t.provision,r=(n=void 0===n?{}:n).isPending,o=void 0===r||r,l=n.hasFallback;return o&&!l?a.a.createElement(i.a,null):a.a.createElement(e,t)}},l=n(102);t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}(l.a.apply(void 0,t),o)(e)}}},730:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(1),o=n.n(i),l=n(31),s=n(228),c=n.n(s),u=n(112),d=n(16),p=n(94),m=function(e){var t=e.children,n=e.match.params.userAlias,i=e.namedPaths,o=(i=void 0===i?{}:i).travel,s=(o=void 0===o?{}:o).trips,c=Object(p.c)().userAlias;if(n!==c)return a.a.createElement("span",null,"Пользователь пока еще не внес информацию о своих поездках");var u=Object(r.useCallback)(function(){return a.a.createElement("div",null,a.a.createElement("span",null,"Нам пока ничего не известно о ваших путешествиях. Но очень интересно узнать. Создайте вашу первую поездку, а мы подготовим по ней отчет"),t)},[t]);return a.a.createElement(l.d,null,a.a.createElement(l.b,{path:s.toUrl({userAlias:c}),component:u}),a.a.createElement(l.a,{to:s.toUrl({userAlias:c})}))};m.propTypes={children:o.a.node,match:o.a.shape({params:o.a.shape({userAlias:o.a.string})}).isRequired,namedPaths:o.a.shape({travel:o.a.shape({trips:o.a.instanceOf(u.a)})}).isRequired},m.defaultProps={children:null},t.a=c()(l.g,d.g)(m)},737:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(31),o=n(157),l=n.n(o),s=n(228),c=n.n(s),u=n(706),d=n(709),p=n.n(d),m=n(102);n.d(t,"a",function(){return f});var f={COMMON:{COUNTRIES:"COMMON.COUNTRIES"},USER:{TRIPS:"USER.TRIPS",LOCATIONS:"USER.LOCATIONS",VISITS:"USER.VISITS",RIDES:"USER.RIDES"}};t.b=function(e){var t=e.domain,n=e.mapStateToProps,r=e.requirementsConfig;return function(e){var o=c()(i.g,Object(u.a)(function(e,n){var a=n.countriesDict,i=n.match.params.userAlias,o=function(e,t){return(Object(m.f)(e,"".concat(t,".userTrips"))||{}).data}(e,t),s=l()(r)?r(e,n):r,c={};if(s[f.COMMON.COUNTRIES]&&(c.countries={modelName:"countries",condition:!a||!Object.keys(a).length,query:{navigation:{isDisabled:!0}}}),s[f.USER.TRIPS]&&(c.userTrips={modelName:"trips",observe:i,query:{userAlias:i,navigation:{isDisabled:!0}}}),s[f.USER.LOCATIONS]){var u=function(e,t){var n=Object(m.d)(e,"trips"),r=Object(m.d)(e,"locations"),a=t?p()(t.reduce(function(e,t){var r=n[t];if(r){var a=r.originLocationId;a&&e.push(a)}return e},[])):[],i=a.filter(function(e){return!r[e]});return{requiredLocationsIds:a,missingLocationsIds:i}}(e,o),d=u.requiredLocationsIds,v=u.missingLocationsIds;c.userLocations={modelName:"locations",observe:d,condition:v.length,query:{filter:{id:{comparator:"in",value:v}},navigation:{isDisabled:!0}}}}if(s[f.USER.VISITS]){var b=s[f.USER.VISITS].year,E=parseInt(/^\d{4}$/.test(String(b))?b:void 0,10);c.userVisits={modelName:"visits",observe:{userTripsIds:o,year:b},condition:o&&o.length,query:{filter:{trip_id:{comparator:"in",value:o},departure_date_time:E?{comparator:">=",value:"".concat(E,"-01-01")}:void 0,arrival_date_time:E?{comparator:"<",value:"".concat(E+1,"-01-01")}:void 0},navigation:{isDisabled:!0}}}}return s[f.USER.RIDES]&&(c.userRides={modelName:"rides",observe:o,condition:o&&o.length,query:{filter:{trip_id:{comparator:"in",value:o}},navigation:{isDisabled:!0}}}),{domain:t,request:c}},n))(e);return function(e){return a.a.createElement(o,e)}}}},748:function(e,t,n){"use strict";var r=n(705),a=n.n(r),i=n(731),o=n.n(i),l=n(709),s=n.n(l),c=function(e,t){var n=t.maxLength,r=t.separator,a=void 0===r?", ":r,i=s()(e),o=i.slice(0,n).join(a);return i.length>n?"".concat(o,"..."):o},u=n(158),d=function(e,t,n,r){if(!e.length)return r;var i=Object.keys(a()(e.filter(function(e){return e.visitType!==u.VISIT_TYPES.TRANSIT}),"countryId"));return 1===i.length?c(e.map(function(e){return e.locationName}),{maxLength:4})||r:c(i.map(function(e){return Number(e)!==n&&t[e]&&t[e].countryName}).filter(Boolean),{maxLength:4})||r};n.d(t,"c",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return d});var p=function(e){return e.sort(function(e,t){return e.orderInTrip-t.orderInTrip})},m=function(e){return o()(a()(e,"tripId"),p)}},761:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return p});var r,a,i,o,l=n(61);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=(s(r={},l.RIDE_CLASSES.ECONOMY,"Эконом"),s(r,l.RIDE_CLASSES.COMFORT,"Комфорт"),s(r,l.RIDE_CLASSES.BUSINESS,"Бизнес"),s(r,l.RIDE_CLASSES.FIRST,"Первый"),s(r,l.RIDE_CLASSES.PRIVATE,"Частный"),r),u=(s(a={},l.RIDE_OCCUPATION.PASSENGER,"Пассажир"),s(a,l.RIDE_OCCUPATION.STUFF,"Персонал"),s(a,l.RIDE_OCCUPATION.DRIVER,"Водитель"),a),d=(s(i={},l.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),s(i,l.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),s(i,l.RIDE_TYPES.CHARTER,"Чартерный рейс"),s(i,l.RIDE_TYPES.TOUR,"Тур"),s(i,l.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),s(i,l.RIDE_TYPES.HITCH_HIKING,"Автостоп"),s(i,l.RIDE_TYPES.DROP_OFF,"Подбросили до места"),i),p=(s(o={},l.VEHICLE_TYPES.CAR,"Автомобиль"),s(o,l.VEHICLE_TYPES.TRAIN,"Поезд"),s(o,l.VEHICLE_TYPES.AIRCRAFT,"Самолет"),s(o,l.VEHICLE_TYPES.BUS,"Автобус"),s(o,l.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),s(o,l.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),s(o,l.VEHICLE_TYPES.FERRY,"Паром"),s(o,l.VEHICLE_TYPES.BIKE,"Велосипед"),s(o,l.VEHICLE_TYPES.BY_FEET,"Пешком"),s(o,l.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),s(o,l.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),s(o,l.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),s(o,l.VEHICLE_TYPES.TRUCK,"Грузовик"),s(o,l.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),s(o,l.VEHICLE_TYPES.TRAM,"Трамвай"),s(o,l.VEHICLE_TYPES.TROLLEY,"Троллейбус"),s(o,l.VEHICLE_TYPES.TAXI,"Такси"),s(o,l.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),s(o,l.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),s(o,l.VEHICLE_TYPES.SUBWAY,"Метро"),s(o,l.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),o)}}]);
//# sourceMappingURL=travel-Trips-e8bc145d9c904911be49.js.map