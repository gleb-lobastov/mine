(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1002:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(1),o=n.n(i),l=n(31),s=n(230),c=n.n(s),u=n(890),d=n(111),p=n(102),m=n(706),f=n(17),v=n(94),b=n(734),E=n(1009),g=n(993),y=n(991),h=n(992),O=n(990),I=n(152),S=n(114),R=n(12),T=n(1008),P=n(1016),C=n(987),j=n(989),V=n(1004),N=function(e){var t=e.caption,n=e.classes,a=e.hasNullOption,i=e.inputId,o=e.name,l=e.onChange,s=e.optionRender,c=e.options,u=e.value;return r.a.createElement("div",{className:n.container},r.a.createElement(P.a,{component:"label",shrink:!0,htmlFor:i},t),r.a.createElement(V.a,{name:o,value:u,displayEmpty:!0,onChange:l,input:r.a.createElement(C.a,{id:i}),className:n.selectRoot},a&&r.a.createElement(j.a,{key:null,value:null},s({option:null,index:-1,options:c})),c.map(function(e,t){return r.a.createElement(j.a,{key:e,value:e},s({option:e,index:t,options:c}))})))},w=o.a.oneOfType([o.a.number,o.a.string]);N.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(w),value:w},N.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var L=Object(R.a)({container:{display:"inline-block",flexGrow:"1",flexBasis:"0"},selectRoot:{display:"block"}})(N),D=n(972),A=n(700),_=n(699),q=function(e){var t=e.inputValue,n=e.sourceProps,a=(n=void 0===n?{}:n).suggestions,i=void 0===a?[]:a,o=e.children,l=t.toLowerCase();return r.a.createElement(r.a.Fragment,null,o(i.filter(function(e){return e.label.toLowerCase().includes(l)})))};q.propTypes={inputValue:o.a.string.isRequired,sourceProps:o.a.shape({suggestions:o.a.array}).isRequired,children:o.a.func.isRequired};var Y=q;function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){k(e,t,n[t])})}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var F=function(e){var t=e.inputProps,n=e.classes,a=e.ref,i=U(e,["inputProps","classes","ref"]);return r.a.createElement(T.a,H({InputProps:x({inputRef:a,classes:{root:n.inputRoot,input:n.inputInput}},t)},i))},M=n(703);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var G=function(e){var t=e.itemProps,n=e.isHighlighted,a=e.isSelected,i=e.children,o=i.label,l=i.details;return r.a.createElement(j.a,B({},t,{selected:n,component:"div",style:{fontWeight:a?500:400}}),r.a.createElement(M.a,{primary:o,secondary:l}))};G.propTypes={itemProps:o.a.object,isHighlighted:o.a.bool,isSelected:o.a.bool,children:o.a.func.isRequired},G.defaultProps={itemProps:void 0,isHighlighted:!1,isSelected:!1};var W=G;function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var $=Object(A.a)(function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}}),X=function(e){return(e||{}).label},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.SuggestionsResolver,n=void 0===t?Y:t,a=e.SuggestionItemComponent,i=void 0===a?W:a,o=e.InputComponent,l=void 0===o?F:o;return function(e){var t=e.classes,a=e.sourceProps,o=e.inputProps,s=e.inputFieldProps,c=J(e,["classes","sourceProps","inputProps","inputFieldProps"]),u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){K(e,t,n[t])})}return e}({},$(),t);return r.a.createElement("div",{className:u.root},r.a.createElement(D.a,z({itemToString:X},c),function(e){var t=e.getInputProps,c=e.getItemProps,d=e.getMenuProps,p=e.highlightedIndex,m=e.inputValue,f=e.isOpen,v=e.selectedItem;return r.a.createElement("div",{className:u.container},r.a.createElement(l,z({fullWidth:!0,classes:u,inputProps:t(o)},s)),r.a.createElement("div",d(),f&&r.a.createElement(_.a,{className:u.paper,square:!0},r.a.createElement(n,{inputValue:m,sourceProps:a},function(e){return e.map(function(e,t){return r.a.createElement(i,{key:e.label,itemProps:c({item:e}),isHighlighted:p===t,isSelected:Boolean(v)&&v.label===e.label},e)})}))))}))}};Q();function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee,te="FILTER",ne="SEARCH",ae=function(e){var t=e.queryFormat,n=e.filterField,a=e.inputValue,r={pageSize:e.numberOfItemsToRequest};switch(t){case ne:return{navigation:r,search:a};case te:default:return{navigation:r,filter:Z({},n,{comparator:"~",value:"%".concat(a,"%")})}}},re=Q({SuggestionsResolver:Object(m.a)(function(e,t){var n=t.inputValue,a=t.sourceProps,r=a.modelName,i=a.domain,o=a.filterField,l=a.numberOfItemsToRequest,s=a.queryFormat;return{domain:i,identity:n,request:{entities:{modelName:r,observe:n,query:ae({queryFormat:s,filterField:o,inputValue:n,numberOfItemsToRequest:l})}},debounceRequest:500}})(function(e){var t=e.sourceProps,n=(t=void 0===t?{}:t).filterField,a=t.resolveDetails,r=t.convertEntityToSuggestion,i=void 0===r?function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Z(e,t,n[t])})}return e}({},e,{label:e[n],details:a?a(e):void 0})}:r,o=e.entities,l=(o=void 0===o?{}:o).data,s=void 0===l?[]:l;return(0,e.children)((s||[]).map(i))})}),ie=n(161);function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var le=(oe(ee={},ie.TRIP_TYPES.LEISURE,"Отдых"),oe(ee,ie.TRIP_TYPES.BUSINESS,"Работа"),oe(ee,ie.TRIP_TYPES.MIXED,"Смешанный"),oe(ee,ie.TRIP_TYPES.RELOCATION,"Переезд"),oe(ee,ie.TRIP_TYPES.OTHER,"Другой"),ee);function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.option;return t?le[t]:"Не указан"},de=function(e){var t=e.tripName,n=e.tripType,r=e.originLocationId,i=e.originGeonameId,o=ce(Object(a.useState)({tripName:t,tripType:n,originLocationId:r,originGeonameId:i}),2),l=o[0],s=o[1];return{tripState:l,setTripState:function(e){return s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){se(e,t,n[t])})}return e}({},l,e))}}},pe=function(e){var t=e.classes,n=e.locationsDict,i=e.tripState,o=i.tripType,l=i.tripName,s=i.originLocationId,c=e.setTripState,u=Object(a.useCallback)(function(e){var t=e.target.value;return c({tripName:t})},[c]),d=Object(a.useCallback)(function(e){var t=e.target.value;return c({tripType:t})},[c]),p=Object(a.useCallback)(function(e){var t=e.geonameId;return c({originGeonameId:t})},[c]),m=(n[s]||{}).locationName;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{fullWidth:!0,label:"Название поездки",value:l,onChange:u})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(re,{classes:{root:t.suggest},textFieldProps:{label:"Старт из"},initialInputValue:m,inputProps:{placeholder:"Пункт отправления..."},onChange:p,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"tripEditCard.geoname",queryFormat:ne,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{caption:"Тип поездки",inputId:"TripEditCard-TripTypeOptions",onChange:d,optionRender:ue,options:Object.values(ie.TRIP_TYPES),hasNullOption:!0,value:o})))};pe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},pe.defaultProps={className:void 0};var me=c()(Object(S.connect)(function(e){return{locationsDict:Object(p.d)(e,"locations")}}),Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}}))(pe);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ve=function(e){var t=e.initialState,n=e.children,a=e.onSubmit,i=de(t),o=i.tripState,l=i.setTripState,s=fe(r.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return r.a.createElement(r.a.Fragment,null,r.a.cloneElement(n,{onClick:function(){return d(!0)}}),c&&r.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},"Поездка"),r.a.createElement(y.a,null,r.a.createElement(h.a,null,"Редактирование поездки"),r.a.createElement(me,{tripState:o,setTripState:l})),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:function(){a(o),p()},color:"primary"},"Сохранить"))))};ve.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},ve.defaultProps={};var be=ve,Ee=n(153),ge=n(751),ye=n(162),he=n(151),Oe=n(58),Ie=n(910),Se=n(994),Re=n(240),Te=n.n(Re),Pe=n(789),Ce=n.n(Pe),je=function(e){for(var t=e.target;t;){if(t.dataset&&"enabled"===t.dataset.sortHandler)return!1;t=t.parentNode}return!0};function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ne=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},we=n(282),Le=function(e){var t=e.location,n=t.locationId,a=t.locationName,i=void 0===a?"unknown":a,o=e.locationPath,l=e.Icon,s=e.classes,c=o?r.a.createElement(Oe.b,{to:o.toUrl({strLocationId:String(n)})},i):i;return r.a.createElement("div",{className:s.container},l&&r.a.createElement(l,{className:s.icon}),c)};Le.propTypes={classes:o.a.objectOf(o.a.string).isRequired,location:o.a.shape(Ee.default),Icon:we.a,locationPath:f.d},Le.defaultProps={location:{},Icon:void 0,locationPath:void 0};var De,Ae=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"}})(Le),_e=n(746),qe=n.n(_e),Ye=n(913),He=n.n(Ye),xe=n(911),ke=n.n(xe),Ue=n(788),Fe=n.n(Ue),Me=n(912),Be=n.n(Me),Ge=n(157);function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ze=(We(De={},Ge.VISIT_TYPES.TRANSIT,"Транзит"),We(De,Ge.VISIT_TYPES.REGULAR,"Посещение"),We(De,Ge.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),We(De,Ge.VISIT_TYPES.RELOCATION,"Переезд"),De);function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $e=function(e){var t=e.option;return t?ze[t]:"Не указан"},Xe=function(e){var t=e.visitType,n=e.visitComment,r=e.locationId,i=e.locationName,o=e.geonameId,l=Je(Object(a.useState)({visitComment:n,visitType:t,locationId:r,locationName:i,geonameId:o}),2),s=l[0],c=l[1];return{visitState:s,setVisitState:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Ke(e,t,n[t])})}return e}({},s,e))}}},Qe=function(e){var t=e.classes,n=e.visitState,i=n.visitType,o=n.visitComment,l=n.locationName,s=e.setVisitState,c=Object(a.useCallback)(function(e){var t=e.target.value;return s({visitType:t})},[s]),u=Object(a.useCallback)(function(e){var t=e.geonameId;return s({geonameId:t})},[s]),d=Object(a.useCallback)(function(e){var t=e.target.value;return s({visitComment:t})},[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(re,{classes:{root:t.suggest},textFieldProps:{label:"Место посещения"},initialInputValue:l,inputProps:{placeholder:"Населенный пункт..."},onChange:u,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"visitEditCard.geoname",queryFormat:ne,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",onChange:c,optionRender:$e,options:Object.values(Ge.VISIT_TYPES),hasNullOption:!0,value:i})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{label:"Комментарий",fullWidth:!0,value:o,onChange:d,multiline:!0,rows:1,rowsMax:12})))};Qe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Qe.defaultProps={className:void 0};var Ze=Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}})(Qe);function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tt=function(e){var t=e.initialState,n=e.children,a=e.onSubmit,i=Xe(t),o=i.visitState,l=i.setVisitState,s=et(r.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return r.a.createElement(r.a.Fragment,null,r.a.cloneElement(n,{onClick:function(){return d(!0)}}),c&&r.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},"Посещение"),r.a.createElement(y.a,null,r.a.createElement(h.a,null,"Редактирование посещения"),r.a.createElement(Ze,{visitState:o,setVisitState:l})),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:function(){a(o),p()},color:"primary"},"Сохранить"))))};tt.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},tt.defaultProps={};var nt=tt;function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(e){var t=e.visit,n=e.onVisitUpdate,a=e.classes,i=e.isEditable,o=e.locationPath;if(!t)return"Не указано";var l=t.locationName,s=t.visitType,c=t.locationId,u=function(e){switch(e){case"Transit":return ke.a;case"BaseCamp":return Be.a;case"Relocation":return Fe.a;case"Regular":default:return He.a}}(s);return r.a.createElement("div",{className:a.container},u&&r.a.createElement(u,{className:a.icon}),r.a.createElement(Oe.b,{to:o.toUrl({strLocationId:String(c)})},l),i&&r.a.createElement(nt,{initialState:t,onSubmit:function(e){return n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){at(e,t,n[t])})}return e}({},t,e))}},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement(Ce.a,{className:a.editIcon}))))};rt.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isEditable:o.a.bool,onVisitUpdate:o.a.func.isRequired,visit:o.a.shape(he.default),locationPath:f.d.isRequired},rt.defaultProps={isEditable:!1,visit:{}};var it=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}})(rt),ot=n(923),lt=n.n(ot),st=n(922),ct=n.n(st),ut=n(920),dt=n.n(ut),pt=n(917),mt=n.n(pt),ft=n(931),vt=n.n(ft),bt=n(919),Et=n.n(bt),gt=n(925),yt=n.n(gt),ht=n(926),Ot=n.n(ht),It=n(918),St=n.n(It),Rt=n(921),Tt=n.n(Rt),Pt=n(924),Ct=n.n(Pt),jt=n(927),Vt=n.n(jt),Nt=n(928),wt=n.n(Nt),Lt=n(929),Dt=n.n(Lt),At=n(930),_t=n.n(At),qt=n(933),Yt=n.n(qt),Ht=n(932),xt=n.n(Ht),kt=n(61),Ut=n(218),Ft=n(971);function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Bt(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Gt=function(e){var t=e.children,n=e.description,a=e.onReject,i=e.onSubmit,o=e.title,l=Bt(e,["children","description","onReject","onSubmit","title"]);return r.a.createElement(Ft.a,Mt({},l,{onSubmit:i}),function(e){var i=e.handleSubmit,l=Bt(e,["handleSubmit"]);return r.a.createElement(E.a,{transitionDuration:500,open:!0,onClose:a,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},o),r.a.createElement(y.a,null,r.a.createElement(h.a,null,n),r.a.cloneElement(t,l)),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:a,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:i,color:"primary"},"Сохранить")))})};Gt.propTypes={children:o.a.node.isRequired,description:o.a.node,onReject:o.a.func.isRequired,onSubmit:o.a.func.isRequired,title:o.a.node},Gt.defaultProps={description:void 0,title:void 0};var Wt=Gt,zt=n(996),Kt=n(1006),Jt=n(995),$t=n(1015),Xt=n(764),Qt=n(280),Zt=n(281),en=n(216),tn=n(140),nn=function(e){var t=e.dateFrom,n=e.timeFrom;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())},an=function(e){var t=e.values,n=t.rideDeparture,a=t.rideArrival,r=e.handleChange,i=Object(Qt.a)(n,a),o=function(e,t){var i,o,l=(i=e,o=t,Object(tn.a)(i,o)),s=l?t:e,c=l?e:t;Object(Zt.a)(n,s)||function(e){r("departureDateTime")(e)}(s),Object(Zt.a)(a,c)||function(e){r("arrivalDateTime")(e)}(c)};return{isSameDateField:{value:i,onChange:function(e){Boolean(i)!==Boolean(e)&&o(n,nn({dateFrom:e?n:Object(en.a)(n,1),timeFrom:a}))}},rideDepartureField:{value:n,onChange:function(e){var t=i?nn({timeFrom:a,dateFrom:e}):a;o(e,t)}},rideArrivalField:{value:a,onChange:function(e){var t=i?nn({timeFrom:n,dateFrom:e}):n;o(t,e)}}}};function rn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var on=null,ln=function(e){var t=e.option;return t?Xt.d[t]:"Не указан"},sn=function(e){var t=e.option;return t?Xt.c[t]:"Не указан"},cn=function(e){var t=e.option;return t?Xt.a[t]:"Не указан"},un=function(e){var t=e.option;return t?Xt.b[t]:"Не указан"},dn=function(e){var t=e.classes,n=e.availableVisits,i=e.originLocation,o=e.values,l=o.departureVisitId,s=o.arrivalVisitId,c=o.vehicleType,u=o.rideType,d=o.rideComment,p=o.rideClass,m=o.rideOccupation,f=o.departureDateTime,v=o.arrivalDateTime,b=e.handleChange,E=n.map(function(e){return e.visitId}),g=Object.fromEntries(n.map(function(e){return[e.visitId,e]})),y=an({values:{rideDeparture:f,rideArrival:v},handleChange:b}),h=y.rideArrivalField,O=y.rideDepartureField,I=y.isSameDateField,S=Object(a.useCallback)(function(e){var t=e.option;if(t===on)return i.locationName;var n=g[t];return n?n.locationName:"Не указано"},[g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:S,hasNullOption:!1,options:[on].concat(rn(E)),value:l,onChange:b}),r.a.createElement(L,{name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:S,options:[].concat(rn(E),[on]),onChange:b,value:s})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:ln,options:Object.values(kt.VEHICLE_TYPES),onChange:b,value:c}),r.a.createElement(L,{name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:sn,options:Object.values(kt.RIDE_TYPES),onChange:b,value:u})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:cn,options:Object.values(kt.RIDE_CLASSES),onChange:b,value:p}),r.a.createElement(L,{name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:un,options:Object.values(kt.RIDE_OCCUPATION),onChange:b,value:m})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(Jt.a,{name:"departureDateTime",autoOk:!0,className:t.option,label:"Дата отправления",value:O.value,onChange:O.onChange,format:"dd/MM/yyyy"}),I.value?r.a.createElement(zt.a,{control:r.a.createElement(Kt.a,{checked:I.value,onChange:function(e){return I.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):r.a.createElement(Jt.a,{name:"arrivalDateTime",autoOk:!0,className:t.option,label:"Дата прибытия",value:h.value,onChange:h.onChange,format:"dd/MM/yyyy"})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement($t.a,{name:"departureDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время отправления",value:O.value,onChange:O.onChange}),r.a.createElement($t.a,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время прибытия",value:h.value,onChange:h.onChange})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{name:"rideComment",className:t.option,label:"Комментарий",multiline:!0,onChange:b,rows:1,rowsMax:12,value:d})))};dn.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},dn.defaultProps={className:void 0};var pn=Object(R.a)({optionGroup:{display:"flex"},option:{flexGrow:"1"}})(dn);function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var fn=function(e){var t=e.availableVisits,n=e.initialState,a=e.children,i=e.className,o=e.onSubmit,l=e.originLocation,s=mn(r.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return r.a.createElement("div",{className:i},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},a),c&&r.a.createElement(Wt,{initialValues:n,enableReinitialize:!0,onSubmit:function(e){o(e),d()},onReject:d,title:"Транспорт",description:"Как вы добрались в место назначения и как уехали из него?"},r.a.createElement(pn,{availableVisits:t,originLocation:l})))};fn.propTypes={availableVisits:o.a.arrayOf(o.a.shape(he.default)),initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,className:o.a.string,onSubmit:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired},fn.defaultProps={className:void 0,availableVisits:[]};var vn=fn;function bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var En=function(e){var t=e.availableVisits,n=e.originLocation,a=e.classes,i=e.className,o=e.defaultArrivalVisitId,l=e.defaultDepartureVisitId,s=e.isEditable,c=e.onRideUpdate,u=e.ride,d=e.ride,p=d.rideId,m=d.vehicleType,f=d.rideType,v=d.arrivalDateTime,b=d.departureDateTime,E=e.showDetails,g=p?u:Object(Ut.a)({defaultDepartureVisitId:l,defaultArrivalVisitId:o}),y=p?function(e){switch(e){case kt.VEHICLE_TYPES.CAR:return mt.a;case kt.VEHICLE_TYPES.TRAIN:return St.a;case kt.VEHICLE_TYPES.AIRCRAFT:return Et.a;case kt.VEHICLE_TYPES.BUS:case kt.VEHICLE_TYPES.TROLLEY:case kt.VEHICLE_TYPES.CITY_BUS:return dt.a;case kt.VEHICLE_TYPES.MOTORHOME:case kt.VEHICLE_TYPES.JITNEY:return Tt.a;case kt.VEHICLE_TYPES.LOCAL_TRAIN:return St.a;case kt.VEHICLE_TYPES.FERRY:return ct.a;case kt.VEHICLE_TYPES.BIKE:return lt.a;case kt.VEHICLE_TYPES.BY_FEET:return Ct.a;case kt.VEHICLE_TYPES.MOTORBIKE:return yt.a;case kt.VEHICLE_TYPES.TRUCK:return Fe.a;case kt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return Ot.a;case kt.VEHICLE_TYPES.TRAM:return Vt.a;case kt.VEHICLE_TYPES.TAXI:return wt.a;case kt.VEHICLE_TYPES.SUBWAY:return Dt.a;case kt.VEHICLE_TYPES.PUBLIC_TRANSPORT:return _t.a;case kt.VEHICLE_TYPES.ROPEWAY:case kt.VEHICLE_TYPES.FUNICULAR:default:return vt.a}}(m):xt.a,h=r.a.createElement(y,{className:a.icon}),O=s?r.a.createElement(vn,{className:a.editDialogTrigger,initialState:g,availableVisits:t,onSubmit:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){bn(e,t,n[t])})}return e}({},u,e))},originLocation:n},h):h;return r.a.createElement("div",{className:qe()(i,a.container)},f===kt.RIDE_TYPES.HITCH_HIKING&&r.a.createElement(Yt.a,{className:a.icon}),O,Boolean(p&&E)&&r.a.createElement("span",{className:a.details},function(e,t){var n=Boolean(t)&&t.toLocaleDateString(),a=Boolean(e)&&e.toLocaleDateString();return n===a?n:"".concat(a,"—").concat(n)}(b,v)))};En.propTypes={availableVisits:o.a.arrayOf(o.a.shape(he.default)),classes:o.a.objectOf(o.a.string).isRequired,className:o.a.string,defaultArrivalVisitId:o.a.number,defaultDepartureVisitId:o.a.number,isEditable:o.a.bool,onRideUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,ride:o.a.shape(I.default),showDetails:o.a.bool},En.defaultProps={availableVisits:[],className:void 0,defaultArrivalVisitId:void 0,defaultDepartureVisitId:void 0,isEditable:!1,ride:{},showDetails:!1};var gn=Object(R.a)({container:{display:"inline-block"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},editDialogTrigger:{display:"inline-block"}})(En),yn=n(934),hn=n.n(yn),On=function(e){var t=e.className,n=e.classes;return r.a.createElement(hn.a,{className:qe()(t,n.dragHandler),"data-sort-handler":"enabled"})};On.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},On.defaultProps={className:void 0};var In=Object(R.a)({dragHandler:{cursor:"grab",marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block"}})(On);function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rn=function(e){var t,n,a=e.visit,i=e.visit,o=(i=void 0===i?{}:i).visitId,l=i.arrivalRideId,s=i.departureRideId,c=e.ridesDict,u=e.classes,d=e.prevVisitId,p=e.nextVisitId,m=e.tripVisitsList,f=e.isEditable,v=e.isSortable,b=e.isSorting,E=e.isArrivalRideMatch,g=e.isDepartureRideMatch,y=e.onRideUpdate,h=e.onVisitUpdate,O=e.originLocation,I=e.locationPath,S=f&&!E,R=f&&!g;return r.a.createElement("div",{className:u.container},r.a.createElement(gn,{availableVisits:m,defaultDepartureVisitId:d,defaultArrivalVisitId:o,visitId:o,isEditable:f,className:qe()(u.ride,(t={},Sn(t,u.alwaysVisible,b||!g),Sn(t,u.warning,S),t)),ride:c[l],showDetails:b||S,onRideUpdate:y,originLocation:O}),r.a.createElement(it,{classes:{editIcon:u.visibleOnlyOnHover},isEditable:f,onVisitUpdate:h,visit:a,locationPath:I}),(!g||b)&&r.a.createElement(gn,{className:qe()(u.ride,(n={},Sn(n,u.alwaysVisible,b||!g),Sn(n,u.warning,R),n)),ride:c[s],availableVisits:m,defaultDepartureVisitId:o,defaultArrivalVisitId:p,isEditable:f&&!g,showDetails:b||R,onRideUpdate:y,originLocation:O}),v&&!b&&r.a.createElement(In,{className:u.visibleOnlyOnHover}))};Rn.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isArrivalRideMatch:o.a.bool,isDepartureRideMatch:o.a.bool,isEditable:o.a.bool,isSortable:o.a.bool,isSorting:o.a.bool,nextVisitId:o.a.number,onRideUpdate:o.a.func.isRequired,onVisitUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,prevVisitId:o.a.number,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(he.default)),visit:o.a.shape(he.default).isRequired,locationPath:f.d.isRequired},Rn.defaultProps={isArrivalRideMatch:!0,isDepartureRideMatch:!0,isEditable:!1,isSortable:!1,isSorting:!1,nextVisitId:null,prevVisitId:null,tripVisitsList:[]};var Tn=Object(R.a)({alwaysVisible:{},container:{position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}})(Rn);var Pn=function(e){var t,n,a,i=e.classes,o=e.isSorting,l=e.onVisitUpdate;return r.a.createElement("div",{className:qe()((t={},n=i.draggableContainer,a=!o,n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t))},r.a.createElement(nt,{initialState:{visitType:null,visitComment:""},onSubmit:l},r.a.createElement(u.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement("span",null,"Добавить посещение"))),r.a.createElement(In,{className:i.visibleOnlyOnHover}))};Pn.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isSorting:o.a.bool,onVisitUpdate:o.a.func.isRequired},Pn.defaultProps={isSorting:!1};var Cn=Object(R.a)({visibleOnlyOnHover:{visibility:"hidden"},draggableContainer:{position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}}})(Pn);function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Nn(){return(Nn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function wn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Ln=Object(Ie.SortableContainer)(function(e){var t=e.children;return r.a.createElement("div",null,t)}),Dn=Object(Ie.SortableElement)(function(e){var t=e.replaceWithNode,n=e.onVisitUpdate,a=wn(e,["replaceWithNode","onVisitUpdate"]);return t||r.a.createElement(Tn,Nn({onVisitUpdate:n},a))}),An=function(e){var t=e.classes,n=e.countriesDict,i=e.isEditable,o=e.locationsDict,l=e.onRideUpdate,s=e.onVisitsOrderUpdate,c=e.ridesDict,u=e.trip,d=e.trip,p=d.tripId,m=d.originLocationId,f=d.tripName,v=d.tripType,b=e.tripIndex,E=e.tripVisitsList,g=e.onTripUpdate,y=e.onVisitUpdate,h=e.storyPath,O=e.locationPath,I=i,S=Vn(Object(a.useState)(!1),2),R=S[0],T=S[1],P=Vn(Object(a.useState)(E.length),2),C=P[0],j=P[1],V=I?Dn:Tn,N=(i?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return[].concat(Ve(e.slice(0,n)),[t],Ve(e.slice(n)))}(E,{isItVisitCreatorControl:!0},C):E).map(function(e,t){var n=e.isItVisitCreatorControl,a=e.visitId;if(n)return r.a.createElement(Dn,{key:"visitCreator",index:t,replaceWithNode:r.a.createElement(Cn,{isSorting:R,onVisitUpdate:function(e){return y(e,{indexInCollection:C,collection:E,tripId:p})}})});var s=Vn(function(e,t,n){var a=t-1-(t>n?1:0),r=t+1-(t+1>n?1:0);return[a>=0?e[a]:null,r<e.length?e[r]:null]}(E,t,C),2),u=s[0],d=s[1],f=(u||{}).visitId,v=(d||{}).visitId;return r.a.createElement(V,{index:t,isArrivalRideMatch:Ne(u,e),isDepartureRideMatch:Ne(e,d),isEditable:i,isSortable:I,isSorting:R,key:a,nextVisitId:v,onRideUpdate:l,onVisitUpdate:y,originLocation:o[m],prevVisitId:f,ridesDict:c,tripVisitsList:E,visit:e,locationPath:O})}),w=I?r.a.createElement(Ln,{onSortEnd:function(e,t){T(!1);var n=e.oldIndex,a=e.newIndex;n===C?j(a):s(t,{oldIndex:n>C?n-1:n,newIndex:a>C?a-1:a,collection:E})},shouldCancelStart:je,updateBeforeSortStart:function(){return T(!0)},lockAxis:"y",lockToContainerEdges:!0},N):r.a.createElement("div",null,N),L=r.a.createElement(Ae,{location:o[m],Icon:Te.a,locationPath:O}),D=r.a.createElement(be,{initialState:u,onSubmit:function(e){return g(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){jn(e,t,n[t])})}return e}({},u,e))}},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement(Ce.a,{className:t.visibleOnlyOnHover}))),A=E[E.length-1],_=E[E.length-2],q=A||{},Y=q.departureRideId,H=q.visitId,x=v===ie.TRIP_TYPES.RELOCATION,k=x?null:r.a.createElement(gn,{availableVisits:E,defaultDepartureVisitId:H,isEditable:i,onRideUpdate:l,originLocation:o[m],ride:c[Y],showDetails:R||Ne(_,A)}),U=E.some(function(e){var t=e.visitComment,n=e.arrivalRideId,a=e.departureRideId;if(t)return!0;if((c[n]||{}).rideComment)return!0;var r=(c[a]||{}).rideComment;return Boolean(r)});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:t.container},"".concat(b+1,". ").concat(Object(ge.b)(E,n,o[m]&&o[m].countryId,f)),i&&D),L,w,!x&&r.a.createElement(r.a.Fragment,null,k,L),U&&r.a.createElement("div",null,r.a.createElement(Oe.b,{to:h.toUrl({strTripId:String(p)})},"Заметки")))};An.propTypes={classes:o.a.objectOf(o.a.string).isRequired,tripIndex:o.a.number.isRequired,isEditable:o.a.bool,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired,onRideUpdate:o.a.func.isRequired,onTripUpdate:o.a.func.isRequired,onVisitsOrderUpdate:o.a.func.isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,trip:o.a.shape(ye.default).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(he.default)),storyPath:f.d.isRequired,locationPath:f.d.isRequired},An.defaultProps={isSortable:!1,tripVisitsList:[]};var _n=Object(R.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}})(An);function qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Yn(e,t,n[t])})}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hn,xn=(Hn={orderResolver:function(e){return e.orderInTrip}}.orderResolver,function(e){var t=e.index,n=e.collection;if(!n.length)return 100;if(t<=0)return Hn(n[0])-1;if(t>=n.length-1)return Hn(n[n.length-1])+1;var a=Hn(n[t-1]),r=Hn(n[t]);return(a+r)/2+(Math.random()-.5)*(r-a)/2}),kn=n(714),Un=n.n(kn),Fn=Object(d.a)(ge.a),Mn=function(e){var t=e.match.params.userAlias,n=e.isTripsComplete,i=e.trips,o=(i=void 0===i?{}:i).data,l=void 0===o?[]:o,s=e.visits,c=(s=void 0===s?{}:s).data,d=void 0===c?[]:c,p=e.countriesDict,m=e.locationsDict,f=e.namedPaths,E=e.ridesDict,g=e.request,y=e.invalidateRequest,h=Object(v.c)(),O=h.isAuthenticated,I=h.userAlias,S=O&&I===t,R=Object(a.useCallback)(function(e,t){var n=t.oldIndex,a=t.newIndex,r=t.collection;n!==a&&g(function(e){var t=e.oldIndex,n=e.newIndex,a=e.collection;return{domain:"tripsPage.visits.sort",modelName:"visits",query:{id:a[t].visitId,body:{orderInTrip:xn({index:n,collection:a})}}}}({oldIndex:n,newIndex:a,collection:r}))},[g]),T=Object(a.useCallback)(function(e){return g(function(e){var t=e.ride;return{domain:"tripsPage.visits.rides",modelName:"rides",query:{id:e.ride.rideId,body:t}}}({ride:e}))},[g]),P=Object(a.useCallback)(function(e){return g(function(e){var t=e.trip;return{domain:"tripsPage.visits.trips",modelName:"trips",query:{id:e.trip.tripId,body:t}}}({trip:e})).then(function(){return y({domain:"tripsPage.trips"})})},[g]),C=Object(a.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.indexInCollection,a=t.collection,r=t.tripId;return g(function(e){var t=e.visit,n=e.visit.visitId,a=e.tripId,r=e.indexInCollection,i=e.collection;return{domain:"tripsPage.visits.visit",modelName:"visits",query:{id:n,body:qn({},t,{tripId:a,orderInTrip:r||0===r?xn({index:r,collection:i}):void 0})}}}({visit:e,tripId:r,indexInCollection:n,collection:a})).then(function(){return y({domain:"tripsPage.visits"})})},[g]),j=Object(a.useMemo)(function(){return r.a.createElement(be,{initialState:{tripType:null},onSubmit:P},r.a.createElement(u.a,{size:"small",variant:"outlined",color:"primary"},"Добавить поездку"))},[P]);if(n&&!l.length)return r.a.createElement(b.a,{shouldShowLinkToTrips:!1},j);var V=Fn(d);return r.a.createElement(r.a.Fragment,null,S&&j,l.map(function(e,t){var n=e.tripId;return r.a.createElement("div",{key:n},r.a.createElement(_n,{locationsDict:m,countriesDict:p,onRideUpdate:T,onTripUpdate:P,onVisitUpdate:C,onVisitsOrderUpdate:R,ridesDict:E,trip:e,tripIndex:t,tripVisitsList:V[n],isEditable:S,storyPath:f.travel.tripStory,locationPath:f.travel.locationPath}))}))};Mn.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired,namedPaths:f.e.namedPaths.isRequired,request:o.a.func.isRequired,isTripsComplete:o.a.bool.isRequired,trips:o.a.shape({data:o.a.arrayOf(o.a.shape(ye.default))}).isRequired,visits:o.a.shape({data:o.a.arrayOf(o.a.shape(he.default))}).isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired};t.default=c()(l.g,f.g,Object(m.a)(function(e,t){var n=t.countriesDict,a=t.match.params.userAlias,r=function(e){return(Object(p.f)(e,"tripsPage.trips")||{}).data}(e),i=function(e,t){var n=Object(p.d)(e,"trips"),a=Object(p.d)(e,"locations"),r=t?Un()(t.reduce(function(e,t){var a=n[t];if(a){var r=a.originLocationId;r&&e.push(r)}return e},[])):[],i=r.filter(function(e){return!a[e]});return{requiredLocationsIds:r,missingLocationsIds:i}}(e,r),o=i.requiredLocationsIds,l=i.missingLocationsIds;return{domain:"tripsPage",request:{countries:{condition:!n||!Object.keys(n).length,modelName:"countries",query:{navigation:{isDisabled:!0}}},trips:{modelName:"trips",observe:a,query:{userAlias:a,navigation:{isDisabled:!0}}},locations:{modelName:"locations",observe:o,condition:l.length,query:{filter:{id:{comparator:"in",value:l}},navigation:{isDisabled:!0}}},rides:{modelName:"rides",observe:r,condition:r&&r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}},visits:{modelName:"visits",observe:r,condition:r&&r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}}}}},function(e){return{countriesDict:Object(p.d)(e,"countries"),locationsDict:Object(p.d)(e,"locations"),ridesDict:Object(p.d)(e,"rides"),isTripsComplete:Object(p.g)(e,"tripsPage.trips").isComplete}}))(Mn)},706:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(234),o=function(e){return function(t){var n=t.provision,a=(n=void 0===n?{}:n).isPending,o=void 0===a||a,l=n.hasFallback;return o&&!l?r.a.createElement(i.a,null):r.a.createElement(e,t)}},l=n(102);t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}(l.a.apply(void 0,t),o)(e)}}},734:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(1),o=n.n(i),l=n(31),s=n(230),c=n.n(s),u=n(112),d=n(17),p=n(94),m=function(e){var t=e.children,n=e.match.params.userAlias,i=e.namedPaths,o=(i=void 0===i?{}:i).travel,s=(o=void 0===o?{}:o).trips,c=Object(p.c)().userAlias;if(n!==c)return r.a.createElement("span",null,"Пользователь пока еще не внес информацию о своих поездках");var u=Object(a.useCallback)(function(){return r.a.createElement("div",null,r.a.createElement("span",null,"Нам пока ничего не известно о ваших путешествиях. Но очень интересно узнать. Создайте вашу первую поездку, а мы подготовим по ней отчет"),t)},[t]);return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:s.toUrl({userAlias:c}),component:u}),r.a.createElement(l.a,{to:s.toUrl({userAlias:c})}))};m.propTypes={children:o.a.node,match:o.a.shape({params:o.a.shape({userAlias:o.a.string})}).isRequired,namedPaths:o.a.shape({travel:o.a.shape({trips:o.a.instanceOf(u.a)})}).isRequired},m.defaultProps={children:null},t.a=c()(l.g,d.g)(m)},751:function(e,t,n){"use strict";var a=n(710),r=n.n(a),i=n(735),o=n.n(i),l=n(714),s=n.n(l),c=function(e,t){var n=t.maxLength,a=t.separator,r=void 0===a?", ":a,i=s()(e),o=i.slice(0,n).join(r);return i.length>n?"".concat(o,"..."):o},u=n(157),d=function(e,t,n,a){if(!e.length)return a;var i=Object.keys(r()(e.filter(function(e){return e.visitType!==u.VISIT_TYPES.TRANSIT}),"countryId"));return 1===i.length?c(e.map(function(e){return e.locationName}),{maxLength:4})||a:c(i.map(function(e){return Number(e)!==n&&t[e]&&t[e].countryName}).filter(Boolean),{maxLength:4})||a};n.d(t,"c",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return d});var p=function(e){return e.sort(function(e,t){return e.orderInTrip-t.orderInTrip})},m=function(e){return o()(r()(e,"tripId"),p)}},764:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return p});var a,r,i,o,l=n(61);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=(s(a={},l.RIDE_CLASSES.ECONOMY,"Эконом"),s(a,l.RIDE_CLASSES.COMFORT,"Комфорт"),s(a,l.RIDE_CLASSES.BUSINESS,"Бизнес"),s(a,l.RIDE_CLASSES.FIRST,"Первый"),s(a,l.RIDE_CLASSES.PRIVATE,"Частный"),a),u=(s(r={},l.RIDE_OCCUPATION.PASSENGER,"Пассажир"),s(r,l.RIDE_OCCUPATION.STUFF,"Персонал"),s(r,l.RIDE_OCCUPATION.DRIVER,"Водитель"),r),d=(s(i={},l.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),s(i,l.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),s(i,l.RIDE_TYPES.CHARTER,"Чартерный рейс"),s(i,l.RIDE_TYPES.TOUR,"Тур"),s(i,l.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),s(i,l.RIDE_TYPES.HITCH_HIKING,"Автостоп"),s(i,l.RIDE_TYPES.DROP_OFF,"Подбросили до места"),i),p=(s(o={},l.VEHICLE_TYPES.CAR,"Автомобиль"),s(o,l.VEHICLE_TYPES.TRAIN,"Поезд"),s(o,l.VEHICLE_TYPES.AIRCRAFT,"Самолет"),s(o,l.VEHICLE_TYPES.BUS,"Автобус"),s(o,l.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),s(o,l.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),s(o,l.VEHICLE_TYPES.FERRY,"Паром"),s(o,l.VEHICLE_TYPES.BIKE,"Велосипед"),s(o,l.VEHICLE_TYPES.BY_FEET,"Пешком"),s(o,l.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),s(o,l.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),s(o,l.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),s(o,l.VEHICLE_TYPES.TRUCK,"Грузовик"),s(o,l.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),s(o,l.VEHICLE_TYPES.TRAM,"Трамвай"),s(o,l.VEHICLE_TYPES.TROLLEY,"Троллейбус"),s(o,l.VEHICLE_TYPES.TAXI,"Такси"),s(o,l.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),s(o,l.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),s(o,l.VEHICLE_TYPES.SUBWAY,"Метро"),s(o,l.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),o)}}]);
//# sourceMappingURL=travel-Trips-5f93b94e485fa4f16b20.js.map