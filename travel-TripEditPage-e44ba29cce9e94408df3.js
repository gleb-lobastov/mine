(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1052:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(0),a=r.n(n),i=r(1289),o=r.n(i),c=r(1287),l=r.n(c),u=r(932),s=r.n(u),p=r(1288),d=r.n(p),f=r(249);function m(e){var t=e.visit.visitType,r=e.className,n=function(e){switch(e){case f.VISIT_TYPES.TRANSIT:return l.a;case f.VISIT_TYPES.BASE_CAMP:return d.a;case f.VISIT_TYPES.RELOCATION:return s.a;case f.VISIT_TYPES.REGULAR:default:return o.a}}(t);return a.a.createElement(n,{className:r})}},1352:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(2),o=r.n(i),c=r(26),l=r(324),u=r(37),s=r(129),p=r(894),d=r(334),f=r(845),m=r(854),v=r(848),b=r(1253),O=r(1307),E=r(1364),y=r(8),g=r(861),h=r(853),I=r(1342),j=r(1355),T=function(e){var t=e["data-locator"],r=e.caption,n=e.classes,i=e.hasNullOption,o=e.inputId,c=e.name,l=e.onChange,u=e.optionRender,s=e.options,p=e.value;return(a.a.createElement("div",{"data-locator":t,className:n.container},a.a.createElement(g.a,{component:"label",shrink:!0,htmlFor:o},r),a.a.createElement(j.a,{name:c,value:p,displayEmpty:!0,onChange:l,input:a.a.createElement(h.a,{id:o}),className:n.selectRoot,MenuProps:{"data-locator":"options-".concat(o)}},i&&a.a.createElement(I.a,{"data-locator":"option-null",key:null,value:null},u({option:null,index:-1,options:s})),s.map((function(e,t){return a.a.createElement(I.a,{"data-locator":"option-".concat(e),key:e,value:e},u({option:e,index:t,options:s}))})))))},P=o.a.oneOfType([o.a.number,o.a.string]);T.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(P),value:P},T.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var S=Object(y.a)({container:{display:"block"},selectRoot:{display:"block"}})(T),C=r(1310),D=r(847),R=r(851);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _(e){var t=e.isHighlighted,r=e.isSelected,n=e.option,i=A(e,["isHighlighted","isSelected","option"]);return(a.a.createElement(I.a,w({component:"div",selected:t,style:{fontWeight:r?500:400}},i),a.a.createElement(R.a,{primary:n.label,secondary:n.details})))}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function x(e){var t=e.isOpen,r=e.options,n=e.classes,i=e.getMenuProps,o=e.getItemProps,c=e.selectedItem,l=e.highlightedIndex;return(a.a.createElement("div",i(),t&&a.a.createElement(D.a,{className:n.paper,square:!0},r.map((function(e,t){return a.a.createElement(_,N({key:e.label},o({item:e}),{isHighlighted:l===t,isSelected:Boolean(c)&&c.label===e.label,option:e}))})))))}var V=r(1290),L=r.n(V);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e){var t=e.classes,r=e.triggerProps,n=e.triggerInputProps;return(a.a.createElement(E.a,k({InputProps:Y({classes:{root:t.inputRoot,input:t.inputInput}},n),fullWidth:!0,classes:L()(t,"inputRoot","inputInput")},r)))}function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var $=Object(f.a)((function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}})),K=function(e){return(e||{}).label};function W(e){var t=e["data-locator"],r=e.classes,n=e.options,i=e.inputProps,o=e.triggerProps,c=q(e,["data-locator","classes","options","inputProps","triggerProps"]),l=z(z({},$()),r);return a.a.createElement("div",{"data-locator":t,className:l.root},a.a.createElement(C.a,B({itemToString:K},c),(function(e){var t=e.getInputProps,r=e.getItemProps,c=e.getMenuProps,u=e.highlightedIndex,s=e.inputValue,p=e.isOpen,d=e.selectedItem;return(a.a.createElement("div",{className:l.container},a.a.createElement(M,{classes:l,inputValue:s,triggerProps:o,triggerInputProps:t(i)}),a.a.createElement(x,{isOpen:p,options:n,classes:l,getMenuProps:c,getItemProps:r,selectedItem:d,highlightedIndex:u})))})))}var X=r(81),J=r(20),Q=r(107);var Z="FILTER",ee="SEARCH";function te(e){var t,r,n,a=e.queryFormat,i=e.filterField,o=e.inputValue,c={pageSize:e.numberOfItemsToRequest};switch(a){case ee:return{navigation:c,search:o};case Z:default:return{navigation:c,filter:(t={},r=i,n={comparator:"~",value:"%".concat(o,"%")},r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t)}}}function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function le(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ue(e){var t=e.classes,r=e.inputProps,i=e.triggerProps,o=e.sourceProps,c=e.transformSuggestionToOption,l=void 0===c?function(e){return e}:c,u=le(e,["classes","inputProps","triggerProps","sourceProps","transformSuggestionToOption"]),s=oe(Object(n.useState)(""),2),p=s[0],d=s[1],f=function(e){var t=e.domain,r=e.modelName,n=e.inputValue,a=e.queryFormat,i=e.filterField,o=e.numberOfItemsToRequest,c=e.debounceRequestDelayMs,l=void 0===c?400:c,u=Object(Q.g)({debounceRequest:l,domain:t,isProvision:!0,modelName:r,observe:n,query:te({queryFormat:a,filterField:i,inputValue:n,numberOfItemsToRequest:o})}),s=(Object(J.o)(u)||{}).data,p=void 0===s?[]:s,d=Object(X.c)((function(e){return Object(Q.c)(e,r)||{}}));return{provision:u,suggestions:p.map((function(e){return d[e]})).filter(Boolean)}}(ae(ae({},o),{},{inputValue:p})).suggestions,m=Object(n.useCallback)((function(e){var t;d(null===(t=e.target)||void 0===t?void 0:t.value)})),v=Object(n.useMemo)((function(){return ae(ae({},r),{},{onChange:m})}),[r,m]),b=Object(n.useMemo)((function(){return f.map(l)}),[f]);return a.a.createElement(W,re({classes:t,inputProps:v,triggerProps:i,options:b},u))}var se,pe=r(181);function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fe=(de(se={},pe.TRIP_TYPES.LEISURE,"Отдых"),de(se,pe.TRIP_TYPES.BUSINESS,"Работа"),de(se,pe.TRIP_TYPES.MIXED,"Смешанный"),de(se,pe.TRIP_TYPES.RELOCATION,"Переезд"),de(se,pe.TRIP_TYPES.OTHER,"Другой"),se);var me=function(e){var t=e.option;return t?fe[t]:"Не указан"},ve=Object(f.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}});function be(e){var t,r,n,i,o=e.provision,c=(o=void 0===o?{}:o).locationsDict,l=void 0===c?{}:c,u=e.formikProps,s=ve(),p=u.handleChange,d=u.setFieldValue,f=u.handleBlur,m=u.errors,y=u.touched,g=u.values.trip,h=void 0===g?{}:g,I=(l[h.originLocationId]||{}).locationName;return a.a.createElement(v.a,{container:!0,spacing:3,alignItems:"center"},a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(b.a,{control:a.a.createElement(O.a,{"data-locator":"TRIP_EDIT_PAGE.AUTOGENERATED_NAME_CHECKBOX",fullWidth:!0,helperText:(null===(t=y.trip)||void 0===t?void 0:t.hasAutogeneratedTripName)&&(null===(r=m.trip)||void 0===r?void 0:r.hasAutogeneratedTripName),name:"trip.hasAutogeneratedTripName",onBlur:f,onChange:p,checked:h.hasAutogeneratedTripName}),label:"Автогенерируемое название"})),a.a.createElement(v.a,{item:!0,xs:6},!h.hasAutogeneratedTripName&&a.a.createElement(E.a,{"data-locator":"TRIP_EDIT_PAGE.TRIP_NAME_INPUT",className:s.textField,fullWidth:!0,helperText:(null===(n=y.trip)||void 0===n?void 0:n.tripName)&&(null===(i=m.trip)||void 0===i?void 0:i.tripName),label:"Название поездки",margin:"normal",name:"trip.tripName",onBlur:f,onChange:p,value:h.tripName})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(ue,{"data-locator":"TRIP_EDIT_PAGE.ORIGIN_LOCATION_SUGGEST",classes:{root:s.suggest},inputProps:{placeholder:"Пункт отправления..."},initialInputValue:I,onChange:function(e){var t=e.suggestion.geonameId;return d("trip.originGeonameId",t)},onBlur:f,sourceProps:{domain:"tripEditCard.geoname",modelName:"geonames",filterField:"locationName",queryFormat:ee,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}},transformSuggestionToOption:Oe,triggerProps:{label:"Старт из"}})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"TRIP_EDIT_PAGE.TRIP_TYPE_SELECT",caption:"Тип поездки",name:"trip.tripType",inputId:"TripEditCard-TripTypeOptions",onChange:p,onBlur:f,optionRender:me,options:Object.values(pe.TRIP_TYPES),hasNullOption:!0,value:h.tripType})))}function Oe(e){return{label:e.locationName,detail:e.countryName,suggestion:e}}be.propTypes={},be.defaultProps={};var Ee=r(108),ye=r.n(Ee),ge=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},he=r(1301),Ie=function(e){for(var t=e.target;t;){var r=t.dataset;if(r){var n=r.sortHandler;if("enabled"===n)return!1;if("disabled"===n)return!0}t=t.parentNode}return!0};function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Te(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var Pe=Object(he.SortableContainer)((function(e){var t=e.children,r=e.className;return(a.a.createElement("div",{className:r},t))})),Se=Object(he.SortableElement)((function(e){return e.node}));function Ce(e){var t=e.children,r=Te(e,["children"]);return(a.a.createElement(Pe,je({shouldCancelStart:Ie,lockAxis:"y",lockToContainerEdges:!0},r),a.a.Children.map(t,(function(e,t){return a.a.createElement(Se,{node:e,index:t})}))))}var De=r(1302),Re=r.n(De),we=Object(f.a)({dragHandler:{cursor:"grab"}});function Ae(e){var t=e.className,r=we();return a.a.createElement(Re.a,{className:ye()(t,r.dragHandler),"data-sort-handler":"enabled"})}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ne(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Ae.propTypes={className:o.a.string},Ae.defaultProps={className:void 0};var xe="RIDE_CREATE_DIALOG",Ve="RIDE_EDIT_DIALOG",Le="VISIT_CREATE_DIALOG",ke="VISIT_EDIT_DIALOG",He="VISIT_DELETE_DIALOG";var Ye=Object(f.a)({container:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}});function Fe(e){var t=e.showDialog,r=Ye();return a.a.createElement("div",{className:r.container,"data-sort-handler":"enabled"},a.a.createElement(m.a,{"data-locator":"TRIP_EDIT_PAGE.ADD_VISIT_BUTTON","data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return t(Le)}},a.a.createElement("span",null,"Добавить посещение")),a.a.createElement(Ae,{className:r.visibleOnlyOnHover}))}Fe.propTypes={showDialog:o.a.func.isRequired},Fe.defaultProps={};var Me=r(859),Be=r(1303),Ue=r.n(Be);function ze(){return(ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ge(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qe(e){var t=e.onClick,r=Ge(e,["onClick"]);return(a.a.createElement(Me.a,ze({"data-locator":"ACTIONS.CREATE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),a.a.createElement(Ue.a,null)))}qe.propTypes={},qe.defaultProps={};var $e=r(982),Ke=r.n($e);function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Xe(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Je(e){var t=e.onClick,r=Xe(e,["onClick"]);return(a.a.createElement(Me.a,We({"data-locator":"ACTIONS.EDIT_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),a.a.createElement(Ke.a,null)))}Je.propTypes={},Je.defaultProps={};var Qe=r(1304),Ze=r.n(Qe);function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function tt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rt(e){var t=e.onClick,r=tt(e,["onClick"]);return(a.a.createElement(Me.a,et({"data-locator":"ACTIONS.DELETE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),a.a.createElement(Ze.a,null)))}rt.propTypes={},rt.defaultProps={};var nt=Object(f.a)({actions:{display:"inline-block"}});function at(e){var t=e["data-locator"],r=e.className,n=e.isEntityExist,i=e.onEditClick,o=e.onDeleteClick,c=e.onCreateClick,l=nt(),u=!n&&Boolean(c),s=n&&Boolean(i),p=n&&Boolean(o);return a.a.createElement("div",{"data-locator":t,"data-sort-handler":"disabled",className:ye()(l.actions,r)},u&&a.a.createElement(qe,{onClick:c}),s&&a.a.createElement(Je,{onClick:i}),p&&a.a.createElement(rt,{onClick:o}))}var it=r(1052),ot=r(252),ct=Object(f.a)({container:{display:"inline-block",marginRight:"4px","&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},visibleOnHover:{visibility:"hidden"}}),lt=function(e){var t=e.visit,r=e.showDialog,n=ct();if(!t)return"Не указано";var i=t.locationName;return(a.a.createElement("div",{className:n.container,"data-locator":"TRIP_EDIT_PAGE.VISIT_BLOCK"},a.a.createElement(it.a,{visit:t,className:n.icon}),i,a.a.createElement(at,{className:n.visibleOnHover,isEntityExist:!0,onEditClick:function(){return r(ke,t)},onDeleteClick:function(){return r(He,t)}})))};lt.propTypes={visit:o.a.shape(ot.default)},lt.defaultProps={visit:{}};var ut=lt,st=r(873),pt=r(308),dt=r(931);var ft=Object(f.a)({container:{"&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},visibleOnHover:{visibility:"hidden"}}),mt=function(e){var t,r,n,i=e.className,o=e.ride,c=e.showDialog,l=ft(),u=o||{},s=u.rideId,p=u.arrivalDateTime,d=u.departureDateTime,f=Boolean(s);return a.a.createElement("div",{className:ye()(i,l.container),"data-locator":"TRIP_EDIT_PAGE.RIDE_BLOCK"},f&&a.a.createElement(a.a.Fragment,null,a.a.createElement(dt.a,{ride:o,className:l.icon}),a.a.createElement("span",{className:l.details},Object(st.b)({departureDateTime:d,arrivalDateTime:p}))),a.a.createElement(at,{"data-locator":"TRIP_EDIT_PAGE.RIDE_ACTIONS",className:ye()((t={},r=l.visibleOnHover,n=f,r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t)),isEntityExist:f,onCreateClick:function(){return c(xe)},onEditClick:function(){return c(Ve,o)}}))};mt.propTypes={className:o.a.string,ride:o.a.shape(pt.default)},mt.defaultProps={className:void 0,ride:{}};var vt=mt;function bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(r),!0).forEach((function(t){Et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yt=Object(f.a)({alwaysVisible:{},container:{margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}});function gt(e){var t=e.style,r=e.className,n=e.prevVisit,i=e.visit,o=e.nextVisit,c=e.showDialog,l=e.isArrivalRideMatch,u=e.isDepartureRideMatch,s=(e.tripId,e.provision),p=yt(),d=s.ridesDict,f=i||{},m=f.visitId,v=f.arrivalRideId,b=f.departureRideId,O=(n||{}).visitId,E=(o||{}).visitId;return a.a.createElement("div",{className:ye()(p.container,r),style:t,"data-sort-handler":"enabled"},a.a.createElement(vt,{showDialog:function(e,t){return c(e,Ot(Ot({},t),{},{departureVisitId:l?O:void 0,arrivalVisitId:m}))},className:ye()(p.ride,Et({},p.warning,!l)),ride:d[v],provision:s}),a.a.createElement(ut,{showDialog:c,classes:{editIcon:p.visibleOnlyOnHover},visit:i,provision:s}),a.a.createElement(vt,{showDialog:function(e,t){return c(e,Ot(Ot({},t),{},{departureVisitId:m,arrivalVisitId:u?E:void 0}))},visitId:m,className:ye()(p.ride,Et({},p.warning,!u)),ride:d[b],provision:s}))}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function It(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){jt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function jt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}gt.propTypes={},gt.defaultProps={};var St=Object(f.a)({creatorsContainer:{display:"flex",justifyContent:"space-between"},isCompact:{marginTop:"-52px"},resetFlow:{transform:"translate(0, 0)"}});function Ct(e){var t=e.showDialog,r=e.provision,i=e.formikProps,o=i.values.trip.visits,c=r.visitsDict,u=St(),s=Tt(Object(n.useState)(o.length),2),p=s[0],d=s[1],f=Tt(Object(n.useState)(!1),2),m=f[0],v=f[1],b=function(e,r){var n=Tt(Rt(o,p).map((function(e){return e&&c[e]||null})),2),a=n[0],i=n[1];t(e,It(It({},r),{},{orderInTrip:Dt(a,i)}))};return o.length?a.a.createElement(l.a,{name:"trip.visits",render:function(e){return a.a.createElement(Ce,{className:u.resetFlow,updateBeforeSortStart:function(){return v(!0)},onSortEnd:function(t){v(!1);var r=t.oldIndex,n=t.newIndex;r===p?d(n):e.move(r,n)}},o.flatMap((function(e,n){var l=Tt(Rt(o,n).map((function(e){return e&&c[e]||null})),3),s=l[0],d=l[1],f=l[2],v=function(e,t,r){var n=ge(e,t);return{isDepartureRideMatch:ge(t,r),isArrivalRideMatch:n}}(s,d,f),O=v.isArrivalRideMatch,E=v.isDepartureRideMatch,y=n>=1&&!m&&O&&p!==n,g=a.a.createElement(gt,{key:"v".concat(e),index:n,style:{zIndex:o.length-n},className:ye()(jt({},u.isCompact,y)),showDialog:t,isArrivalRideMatch:O,isDepartureRideMatch:E,prevVisit:s,visit:d,nextVisit:f,formikProps:i,provision:r}),h=p===n,I=p===o.length&&p===n+1;if(!h&&!I)return g;var j=a.a.createElement("div",{style:{zIndex:o.length+1}},a.a.createElement(Fe,{key:"visitCreator",showDialog:b}));return h?[j,g]:[g,j]})))}}):a.a.createElement(Fe,{key:"visitCreator",showDialog:b})}function Dt(e,t){var r=(e||{}).orderInTrip,n=(t||{}).orderInTrip;return e?t?(r+n)/2+(Math.random()-.5)*(n-r)/2:r+1:n-1}function Rt(e,t){return[e[t-1]||null,e[t]||null,e[t+1]||null]}Ct.propTypes={},Ct.defaultProps={};var wt=r(186),At=r(990);function _t(e){var t=e.isCreation,r=e.className,n=e.provision,i=e.formikProps.values.trip,o=n.visitsDict,c=n.countriesDict,l=n.locationsDict,u=t?"Создание поездки":"Редактирование поездки",s=Object(At.a)(i,o,c,l),p="".concat(u,': "').concat(s,'"');return a.a.createElement(wt.a,{variant:"h6",className:r},p)}var Nt=Object(f.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"},actionButton:{marginTop:"24px"},hint:{color:"gray",fontSize:12,paddingLeft:"8px"}}),xt=function(e){var t=e.isCreation,r=e.showDialog,n=e.provision,i=e.formikProps,o=Nt();return a.a.createElement(a.a.Fragment,null,a.a.createElement(_t,{className:o.container,formikProps:i,isCreation:t,provision:n}),a.a.createElement(l.b,null,a.a.createElement(be,{formikProps:i,provision:n}),!t&&a.a.createElement(Ct,{classes:o,showDialog:r,formikProps:i,provision:n}),a.a.createElement(m.a,{"data-locator":"TRIP_EDIT_PAGE.SUBMIT_TRIP_BUTTON",className:o.actionButton,type:"submit",color:"primary"},t?"Создать":"Сохранить"),t&&a.a.createElement("div",{className:o.hint},"После создания поездки в нее можно будет добавить места посещения и маршрут")))};xt.propTypes={isCreation:o.a.bool.isRequired},xt.defaultProps={};var Vt,Lt,kt,Ht,Yt=xt,Ft=r(335),Mt=r(336),Bt=r(1343),Ut=r(1347),zt=r(1345),Gt=r(1346),qt=r(1344),$t=function(e){var t=e["data-locator"],r=e.isOpen,n=e.title,i=e.description,o=e.children,c=e.primaryButtonCaption,l=e.primaryButtonHandler,u=e.secondaryButtonCaption,s=e.secondaryButtonHandler,p=e.onClose;return(a.a.createElement(Bt.a,{"data-locator":t,transitionDuration:500,open:r,onClose:p,"aria-labelledby":"form-dialog"},a.a.createElement(qt.a,{id:"form-dialog-title"},n),a.a.createElement(zt.a,null,a.a.createElement(Gt.a,null,i),o),a.a.createElement(Ut.a,null,s&&a.a.createElement(m.a,{"data-locator":"DIALOG.RESET_BUTTON",onClick:s,color:"secondary"},u),l&&a.a.createElement(m.a,{"data-locator":"DIALOG.SUBMIT_BUTTON",onClick:l,color:"primary"},c))))},Kt=function(e){var t=e["data-locator"],r=e.initialValues,n=e.isOpen,i=e.onSubmit,o=e.onReset,c=e.title,u=e.description,s=e.children;return(a.a.createElement(l.c,{initialValues:r,enableReinitialize:!0,onSubmit:i},(function(e){return a.a.createElement($t,{"data-locator":t,description:u,onClose:o,isOpen:n,primaryButtonCaption:"Сохранить",primaryButtonHandler:e.handleSubmit,secondaryButtonCaption:"Отмена",secondaryButtonHandler:o,title:c},a.a.cloneElement(s,{formikProps:e}))})))},Wt=r(1348),Xt=r(1361),Jt=r(983),Qt=r(95);function Zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var er=(Zt(Vt={},Qt.RIDE_CLASSES.ECONOMY,"Эконом"),Zt(Vt,Qt.RIDE_CLASSES.COMFORT,"Комфорт"),Zt(Vt,Qt.RIDE_CLASSES.BUSINESS,"Бизнес"),Zt(Vt,Qt.RIDE_CLASSES.FIRST,"Первый"),Zt(Vt,Qt.RIDE_CLASSES.PRIVATE,"Частный"),Vt),tr=(Zt(Lt={},Qt.RIDE_OCCUPATION.PASSENGER,"Пассажир"),Zt(Lt,Qt.RIDE_OCCUPATION.STUFF,"Персонал"),Zt(Lt,Qt.RIDE_OCCUPATION.DRIVER,"Водитель"),Lt),rr=(Zt(kt={},Qt.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),Zt(kt,Qt.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),Zt(kt,Qt.RIDE_TYPES.CHARTER,"Чартерный рейс"),Zt(kt,Qt.RIDE_TYPES.TOUR,"Тур"),Zt(kt,Qt.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),Zt(kt,Qt.RIDE_TYPES.HITCH_HIKING,"Автостоп"),Zt(kt,Qt.RIDE_TYPES.DROP_OFF,"Подбросили до места"),kt),nr=(Zt(Ht={},Qt.VEHICLE_TYPES.CAR,"Автомобиль"),Zt(Ht,Qt.VEHICLE_TYPES.TRAIN,"Поезд"),Zt(Ht,Qt.VEHICLE_TYPES.AIRCRAFT,"Самолет"),Zt(Ht,Qt.VEHICLE_TYPES.BUS,"Автобус"),Zt(Ht,Qt.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),Zt(Ht,Qt.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),Zt(Ht,Qt.VEHICLE_TYPES.FERRY,"Паром"),Zt(Ht,Qt.VEHICLE_TYPES.BIKE,"Велосипед"),Zt(Ht,Qt.VEHICLE_TYPES.BY_FEET,"Пешком"),Zt(Ht,Qt.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),Zt(Ht,Qt.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),Zt(Ht,Qt.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),Zt(Ht,Qt.VEHICLE_TYPES.TRUCK,"Грузовик"),Zt(Ht,Qt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),Zt(Ht,Qt.VEHICLE_TYPES.TRAM,"Трамвай"),Zt(Ht,Qt.VEHICLE_TYPES.TROLLEY,"Троллейбус"),Zt(Ht,Qt.VEHICLE_TYPES.TAXI,"Такси"),Zt(Ht,Qt.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),Zt(Ht,Qt.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),Zt(Ht,Qt.VEHICLE_TYPES.SUBWAY,"Метро"),Zt(Ht,Qt.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),Ht),ar=r(323),ir=r(371),or=r(250),cr=r(874),lr=function(e){var t=e.dateFrom,r=e.timeFrom,n=Object(cr.a)(r),a=Object(cr.a)(t);return n&&a?new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()):new Date(NaN)};function ur(e,t){return Object(cr.a)(e)&&!Object(ir.a)(t,e)}function sr(e){return function(e){if(Array.isArray(e))return pr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return pr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dr=null,fr=function(e){return function(t){var r=t.option;return r===dr?"Пункт отправления":a.a.createElement(Jt.a,{visit:e[r]})}},mr=function(e){var t=e.option;return t?nr[t]:"Не указан"},vr=function(e){var t=e.option;return t?rr[t]:"Не указан"},br=function(e){var t=e.option;return t?er[t]:"Не указан"},Or=function(e){var t=e.option;return t?tr[t]:"Не указан"},Er=Object(f.a)({option:{width:"100%"}}),yr=function(e){var t,r,n,i,o,c,l,u,s,p,d,f=e.tripVisitsIds,m=e.visitsDict,y=e.formikProps,g=y.values,h=g.vehicleType,I=g.rideType,j=g.rideComment,T=g.rideClass,P=g.rideOccupation,C=g.departureVisitId,D=g.departureDateTime,R=g.arrivalVisitId,w=g.arrivalDateTime,A=y.handleChange,_=y.setFieldValue,N=Er(),x=f&&f.length>0,V=(r=(t={arrivalDateTimeField:{value:w,onChange:function(e){return _("arrivalDateTime",e)}},departureDateTimeField:{value:D,onChange:function(e){return _("departureDateTime",e)}}}).arrivalDateTimeField,n=r.value,i=r.onChange,o=t.departureDateTimeField,c=o.value,l=o.onChange,u=Object(ar.a)(c,n),s=function(e,t){ur(e,c)&&l(e),ur(t,n)&&i(t)},p=function(e){var t=u?lr({timeFrom:n,dateFrom:e}):n;s(e,t)},d=function(e){var t=u?lr({timeFrom:c,dateFrom:e}):c;s(t,e)},{isSameDateField:{value:u,onChange:function(e){Boolean(u)!==Boolean(e)&&s(c,lr({dateFrom:e?c:Object(or.a)(c,1),timeFrom:n}))}},rideDepartureDateField:{value:c,onChange:function(e){p(lr({dateFrom:e,timeFrom:c}))}},rideArrivalDateField:{value:n,onChange:function(e){d(lr({dateFrom:e,timeFrom:n}))}},rideDepartureTimeField:{value:c,onChange:function(e){p(lr({dateFrom:c,timeFrom:e}))}},rideArrivalTimeField:{value:n,onChange:function(e){d(lr({dateFrom:n,timeFrom:e}))}}}),L=V.rideArrivalDateField,k=V.rideArrivalTimeField,H=V.rideDepartureDateField,Y=V.rideDepartureTimeField,F=V.isSameDateField;return a.a.createElement(v.a,{container:!0,spacing:3,alignItems:"center"},x&&a.a.createElement(a.a.Fragment,null,a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_VISIT_SELECT",name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:fr(m),hasNullOption:!1,options:[dr].concat(sr(f)),value:C,onChange:A})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_VISIT_SELECT",name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:fr(m),options:[].concat(sr(f),[dr]),onChange:A,value:R}))),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.VEHICLE_TYPE_SELECT",name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:mr,options:Object.values(Qt.VEHICLE_TYPES),onChange:A,value:h})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_TYPE_SELECT",name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:vr,options:Object.values(Qt.RIDE_TYPES),onChange:A,value:I})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_CLASS_SELECT",name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:br,options:Object.values(Qt.RIDE_CLASSES),onChange:A,value:T})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_OCCUPATION_SELECT",name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:Or,options:Object.values(Qt.RIDE_OCCUPATION),onChange:A,value:P})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(Wt.a,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_DATE_PICKER",name:"departureDateTime",autoOk:!0,className:N.option,label:"Дата отправления",value:H.value,onChange:H.onChange,format:"dd/MM/yyyy"})),a.a.createElement(v.a,{item:!0,xs:6},F.value?a.a.createElement(b.a,{control:a.a.createElement(O.a,{checked:F.value,onChange:function(e){return F.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):a.a.createElement(Wt.a,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_DATE_PICKER",name:"arrivalDateTime",autoOk:!0,className:N.option,label:"Дата прибытия",value:L.value,onChange:L.onChange,format:"dd/MM/yyyy"})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(Xt.a,{name:"departureDateTime",ampm:!1,autoOk:!0,className:N.option,label:"Время отправления",value:Y.value,onChange:Y.onChange})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(Xt.a,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:N.option,label:"Время прибытия",value:k.value,onChange:k.onChange})),a.a.createElement(v.a,{item:!0,xs:12},a.a.createElement(E.a,{name:"rideComment",className:N.option,label:"Комментарий",multiline:!0,onChange:A,rows:1,rowsMax:12,value:j})))};yr.propTypes={},yr.defaultProps={};var gr=yr;function hr(){return(hr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ir(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jr(e){var t=e.isCreation,r=e.tripVisitsIds,n=e.visitsDict,i=Ir(e,["isCreation","tripVisitsIds","visitsDict"]);return(a.a.createElement(Kt,hr({"data-locator":"TRIP_EDIT_PAGE.RIDE_DIALOG",title:t?"Создание маршрута":"Редактирование маршрута"},i),a.a.createElement(gr,{tripVisitsIds:r,visitsDict:n,formikProps:null})))}var Tr,Pr=r(930),Sr=r(249);function Cr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Dr=(Cr(Tr={},Sr.VISIT_TYPES.TRANSIT,"Транзит"),Cr(Tr,Sr.VISIT_TYPES.REGULAR,"Посещение"),Cr(Tr,Sr.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),Cr(Tr,Sr.VISIT_TYPES.RELOCATION,"Переезд"),Tr),Rr=function(e){return function(t){var r=t.option;return(a.a.createElement(Pr.a,{ride:e[r],isLong:!0}))}},wr=function(e){var t=e.option;return t?Dr[t]:"Не указан"},Ar=Object(f.a)({option:{width:"100%"}});function _r(e){var t=e.tripRidesIds,r=e.ridesDict,n=e.formikProps,i=n.values,o=i.locationName,c=i.visitType,l=i.visitComment,u=i.arrivalRideId,s=i.departureRideId,p=n.handleChange,d=n.handleBlur,f=n.setFieldValue,m=Ar(),b=t&&t.length>0;return a.a.createElement(v.a,{container:!0,spacing:3,alignItems:"center"},a.a.createElement(v.a,{item:!0,xs:12},a.a.createElement(ue,{"data-locator":"VISIT_EDIT_FORM_SECTION.LOCATION_SUGGEST",inputProps:{placeholder:"Место посещения..."},initialInputValue:o,onChange:function(e){var t=e.suggestion.geonameId;return f("geonameId",t)},onBlur:d,sourceProps:{domain:"visitEditFormSection.geoname",modelName:"geonames",filterField:"locationName",queryFormat:ee},transformSuggestionToOption:Nr,triggerProps:{label:"Место посещения"}})),b&&a.a.createElement(a.a.Fragment,null,a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{name:"arrivalRideId",caption:"Прибытие",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:Rr(r),options:t,onChange:p,value:u})),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{name:"departureRideId",caption:"Отправление",inputId:"RideEditCard-departureVisitId",optionRender:Rr(r),hasNullOption:!1,options:t,value:s,onChange:p}))),a.a.createElement(v.a,{item:!0,xs:6},a.a.createElement(S,{"data-locator":"VISIT_EDIT_FORM_SECTION.VISIT_TYPE_SELECT",name:"visitType",value:c,onChange:p,caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",optionRender:wr,options:Object.values(Sr.VISIT_TYPES),hasNullOption:!0})),a.a.createElement(v.a,{item:!0,xs:12},a.a.createElement(E.a,{className:m.option,name:"visitComment",value:l,onChange:p,label:"Комментарий",fullWidth:!0,multiline:!0,rows:1,rowsMax:12})))}function Nr(e){return{label:e.locationName,details:[e.countryName,e.regionName].filter(Boolean).join(", "),suggestion:e}}function xr(){return(xr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Vr(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Lr(e){var t=e.isCreation,r=e.tripRidesIds,n=e.ridesDict,i=Vr(e,["isCreation","tripRidesIds","ridesDict"]);return(a.a.createElement(Kt,xr({"data-locator":"TRIP_EDIT_PAGE.VISIT_DIALOG",title:t?"Создание посещения":"Редактирование посещения"},i),a.a.createElement(_r,{tripRidesIds:r,ridesDict:n,formikProps:null})))}function kr(){return(kr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Hr(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Yr(e){var t=e.visit,r=e.onSubmit,n=e.onReset,i=Hr(e,["visit","onSubmit","onReset"]);return(a.a.createElement($t,kr({title:"Удалить посещение",description:"Вы действительно хотите удалить посещение",primaryButtonCaption:"Да",primaryButtonHandler:function(e){return r(e,t)},secondaryButtonCaption:"Нет",secondaryButtonHandler:n},i),a.a.createElement(Jt.a,{visit:t})))}function Fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(r),!0).forEach((function(t){Br(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Br(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ur(e){var t=e.provision,r=e.dialogsState,i=e.hideDialog,o=e.handleSubmitRide,c=e.handleSubmitVisit,l=e.handleDeleteVisit,u=e.trip,s=t.ridesDict,p=t.visitsDict,d=u.tripId,f=u.visits,m=u.rides,v=r.dialogName,b=r.dialogParams,O=void 0===b?{}:b,E=Object(n.useMemo)((function(){var e=O.rideId;return Mr(Mr(Mr({},e?s[e]:Object(Ft.b)()),O),{},{tripId:d})}),[s,d,O]),y=Object(n.useMemo)((function(){var e=O.visitId;return Mr(Mr(Mr({},e?p[e]:Object(Mt.b)()),O),{},{tripId:d})}),[p,d,O]),g=function(e){return e===Ve||e===xe}(v),h=function(e){return e===ke||e===Le}(v),I=v===He;return a.a.createElement(a.a.Fragment,null,a.a.createElement(jr,{initialValues:E,tripVisitsIds:f,isOpen:g,onSubmit:function(e){o(e),i()},onReset:i,isCreation:v===xe,visitsDict:p}),a.a.createElement(Lr,{initialValues:y,tripRidesIds:m,isOpen:h,onSubmit:function(e){c(e),i()},onReset:i,isCreation:v===Le,ridesDict:s}),a.a.createElement(Yr,{visit:p[O.visitId],isOpen:I,onSubmit:function(e,t){var r=t.visitId;l(r),i()},onReset:i}))}_r.propTypes={},_r.defaultProps={};function zr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){var t=e.orderResolver}({orderResolver:function(e){return e.orderInTrip}});function qr(e){var t=e.match.params,r=t.userAlias,i=t.strTripId,o=t.action,f=Object(u.d)().travel.tripEdit,m=Object(c.g)(),v="create"===o,b=Object(s.c)(),O=b.isAuthenticated,E=b.userAlias,y=i&&parseInt(i,10),g=Object(p.b)({userAlias:r,tripsIds:y?[y]:[]}),h=g.tripsDict,I=g.tripsProvision,j=v?Object(d.b)():h[y],T=function(e){var t=zr(Object(Q.h)({domain:"".concat("travel.TripEditPage",".rides"),modelName:"rides"}),1)[0],r=Object(n.useCallback)((function(r){return t({query:{id:r.rideId,body:r}}).then(e)}),[]),a=zr(Object(Q.h)({domain:"".concat("travel.TripEditPage",".trips"),modelName:"trips"}),1)[0],i=Object(n.useCallback)((function(t){return a({query:{id:t.tripId,body:t}}).finally(e)}),[]),o=zr(Object(Q.h)({domain:"".concat("travel.TripEditPage",".visits"),modelName:"visits"}),1)[0],c=Object(n.useCallback)((function(t){return o({query:{id:t.visitId,body:t}}).then(e)}),[]),l=zr(Object(Q.h)({domain:"".concat("travel.TripEditPage",".visits"),modelName:"visits"}),1)[0];return{handleSubmitRide:r,handleSubmitTrip:i,handleSubmitVisit:c,handleDeleteVisit:Object(n.useCallback)((function(t){return l({method:"DELETE",query:{id:t}}).then(e)}),[])}}(I.invalidate),P=T.handleSubmitRide,S=T.handleSubmitTrip,C=T.handleSubmitVisit,D=T.handleDeleteVisit,R=function(){var e=_e(Object(n.useState)({name:null}),2),t=e[0],r=e[1];return{showDialog:function(e,t){r({dialogName:e,dialogParams:t})},hideDialog:function(){r({name:null})},dialogsState:t}}(),w=R.showDialog,A=R.hideDialog,_=R.dialogsState,N=g.isError,x=g.isReady,V=g.isPending;return y&&(!x||j)||v?O&&E===r?N?a.a.createElement("div",null,"...Error"):V?a.a.createElement("div",null,"...Loading"):j?a.a.createElement(a.a.Fragment,null,a.a.createElement(l.c,{initialValues:{trip:j},onSubmit:function(e){return S(e.trip).then((function(e){if(!y&&e){var t=f.toUrl({userAlias:r,strTripId:String(e)});m.push(t)}}))}},(function(e){return a.a.createElement(Yt,{isCreation:v,showDialog:w,formikProps:e,provision:g})})),a.a.createElement(Ur,{provision:g,dialogsState:_,hideDialog:A,handleSubmitRide:P,handleSubmitVisit:C,handleDeleteVisit:D,trip:j})):a.a.createElement("div",null,"...Error, no trip is provided"):a.a.createElement("div",null,"У вас не достаочно прав для просмотра данной страницы"):a.a.createElement("div",null,"Запрашиваемая вами страница не найдена")}qr.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired};t.default=qr},1363:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return C}));var n=r(0),a=r.n(n),i=r(2),o=r.n(i),c=r(108),l=r.n(c),u=r(1306),s=r(845),p=r(129),d=r(894),f=r(983);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16),a:t}:{r:0,g:0,b:0,a:0};return"rgba(".concat(n.r,",").concat(n.g,",").concat(n.b,",").concat(n.a,")")}var E=80*Math.cos(45/360*2*Math.PI);function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,r=O(e,t);return{background:"repeating-linear-gradient(\n      ".concat(45,"deg,\n      ").concat("#FFF",",\n      ").concat("#FFF"," ").concat(20,"px,\n      ").concat(r," ").concat(20,"px,\n      ").concat(r," ").concat(40,"px\n    )"),backgroundSize:"calc(100% + ".concat(E,"px)")}}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P=Object(s.a)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({container:{fontSize:"16px",lineHeight:"1.5"},photosContainer:{display:"flex",flexWrap:"wrap"},photoContainer:{margin:"4px 12px 12px",minWidth:"150px",maxHeight:"100px",textAlign:"center"},photo:{maxWidth:"150px",borderRadius:"4px"}},function(e){return{dropzoneContainer:{display:"flex",flexDirection:"column",justifyContent:"space-around",height:"100%",minHeight:"144px",padding:"0 12px",margin:"12px 0",cursor:"pointer"},dropzoneStandby:{"& $dropzoneContainer":v({border:"2px dashed ".concat(e.palette.primary.dark),borderRadius:"4px"},y(e.palette.primary.light,.2)),"& $dropzoneUpload":v(v({borderColor:e.palette.disabled.dark},y(e.palette.disabled.main,.2)),{},{animation:"$slide 2s infinite linear forwards"})},dropzoneActive:v(v({border:"2px dashed ".concat(e.palette.secondary.dark),animation:"$slide 2s infinite linear forwards"},y(e.palette.secondary.light)),{},{"&$dropzoneAccept":v(v({borderColor:e.palette.secondary.dark},y(e.palette.secondary.main)),{},{animation:"$slide 2s infinite linear forwards"}),"&$dropzoneReject":v(v({borderColor:e.palette.error.dark},y(e.palette.error.main)),{},{animation:"$slide 2s infinite linear forwards"})}),dropzoneAccept:{},dropzoneReject:{},dropzoneUpload:{},"@keyframes slide":{"0%":{backgroundPositionX:"-".concat(E,"px")},"100%":{backgroundPositionX:0}}}}(e))})),S="travel.VisitEditPage";function C(e){var t,r=e.match.params,i=r.userAlias,o=r.strVisitId,c=P(),s=h(Object(n.useState)(null),2),m=s[0],v=s[1],b=h(Object(n.useState)([]),2),O=b[0],E=b[1],y=null!==m,I=Object(p.c)(),j=I.isAuthenticated,C=I.userAlias,D=Object(d.c)({domain:S,userAlias:i,visitId:Number(o)}),R=D.isError,w=D.isPending,A=D.visit,_=Object(d.a)({domain:S,userAlias:i,visitId:Number(o)}).submitVisitPhoto,N=Object(n.useCallback)((function(e,t){return t&&E(t),v(1),_({id:Number(o),data:e}).finally((function(){return v(null)}))}),_),x=Object(u.a)({accept:"image/*",disabled:y,onDrop:N,maxSize:5242880,minSize:51200}),V=x.getRootProps,L=x.getInputProps,k=x.isDragActive,H=x.isDragAccept,Y=x.isDragReject;if(!(j&&C===i))return a.a.createElement("div",null,"Ошибка. Нет доступа");if(R)return a.a.createElement("div",null,"...Error");if(w)return a.a.createElement("div",null,"...Loading");if(!A)return a.a.createElement("div",null,"...Не найдено посещение");var F=A.photos;return(a.a.createElement("div",g({},V(),{className:l()((t={},T(t,c.dropzoneStandby,!k),T(t,c.dropzoneActive,k),T(t,c.dropzoneAccept,H),T(t,c.dropzoneReject,Y),t))}),a.a.createElement(f.a,{visit:A,isLong:!0}),a.a.createElement("div",{className:l()(c.dropzoneContainer,T({},c.dropzoneUpload,y))},a.a.createElement("input",L()),function(e){var t=e.isDragActive;switch(!0){case e.isUploadInProgress:return"Идет загрузка, пожалуйста не закрывайте браузер";case t:return"Загрузить фотографии";default:return"Перенесите сюда фотографии для загрузки или кликните, что-бы выбрать файлы"}}({isDragActive:k,isUploadInProgress:y}),O.length>0&&a.a.createElement("div",null,"Не удалось загрузить следующие файлы:",O.map((function(e){return a.a.createElement("div",{key:e.path},(r=(t=e).file,n=t.errors.map((function(e){return e.message})).join(", "),"".concat(r.path," - ").concat(r.size," bytes, reason: ").concat(n)));var t,r,n})))),a.a.createElement("div",{className:c.photosContainer},F.map((function(e){var t=e.thumbnailUrl;return(a.a.createElement("div",{key:t,className:c.photoContainer},a.a.createElement("img",{className:c.photo,src:t})))})))))}C.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired,strVisitId:o.a.string}).isRequired}).isRequired}},865:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(0),a=r(81),i=r(907),o=r.n(i),c=r(908),l=r.n(c),u=r(929),s=r.n(u),p=r(172),d=r.n(p),f=r(107),m=r(20),v=r(891),b=r(872),O=r(892);function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function y(e){var t=e.userAlias,r=function(e){var t=e.userAlias,r=e.tripsIds,n=Object(a.c)((function(e){return{tripsDict:Object(f.c)(e,"trips")||{}}})).tripsDict,i=!r,o=!i&&r.filter((function(e){return!n[e]}));return Object(f.g)({domain:"travel.trips-".concat(t),isProvision:!0,modelName:"trips",observe:t,query:{userAlias:t,navigation:{isDisabled:!0},filter:i?{}:{id:{comparator:"in",value:o}}}})}({userAlias:t,tripsIds:e.tripsIds}),i=Object(v.a)({domain:"travel.trips-".concat(t,".user"),userAlias:t}),c=i.user,l=(c=void 0===c?{}:c).locationsRating,u=void 0===l?{}:l,p=E(i,["user"]),y=(Object(m.o)(r)||{}).data,h=void 0===y?[]:y,I=Object(a.c)((function(e){return{tripsDict:Object(f.c)(e,"trips")||{},visitsDict:Object(f.c)(e,"visits")||{},ridesDict:Object(f.c)(e,"rides")||{},countriesDict:Object(f.c)(e,"countries")||{},locationsDict:Object(f.c)(e,"locations")||{}}})),j=I.tripsDict,T=I.visitsDict,P=I.ridesDict,S=I.countriesDict,C=I.locationsDict,D=Object(n.useMemo)((function(){return Array.from(new Set(h.flatMap((function(e){var t;return(null===(t=j[e])||void 0===t?void 0:t.visits)||[]}))))}),[h,j]),R=Object(n.useMemo)((function(){return Array.from(new Set(h.flatMap((function(e){var t;return(null===(t=j[e])||void 0===t?void 0:t.rides)||[]}))))}),[h,j]),w=Object(n.useMemo)((function(){return Array.from(new Set(D.flatMap((function(e){var t;return(null===(t=T[e])||void 0===t?void 0:t.countryId)||[]}))))}),[D,T]),A=Object(n.useMemo)((function(){return Array.from(new Set(D.flatMap((function(e){var t;return(null===(t=T[e])||void 0===t?void 0:t.locationId)||[]}))))}),[D,T]),_=Object(b.a)(),N=Object(O.a)({domain:"travel.locations-".concat(t),locationsIds:A}),x=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{updatesCounter:s()(t.map(m.p)),isReady:t.every(m.i),isPending:t.some(m.h),isValid:t.every(m.k),error:t.find(m.g),errors:t.map(m.f).filter(Boolean),invalidate:function(){return t.forEach((function(e){return(0,e.invalidate)()}))}}}(r,p,_,N),V=x.isError,L=x.isValid,k=x.isReady,H=x.isPending,Y=function(e,t,r){var n=e.reduce((function(e,n){var a=t[n];if(!a)return e;var i=r[n],o=a.countryId;return e[o]||(e[o]=[]),e[o].push(i),e}),{});return d()(n,(function(e){return function(e){if(!e.length)return 1/0;var t=e.length/e.map((function(e){return 1/e})).reduce((function(e,t){return e+t})),r=o()(e),n=Math.log(e.length);return 1/(1/t+n/r)}(e)}))}(A,C,u);return{tripsProvision:r,countriesProvision:_,locationsProvision:N,isError:V,isValid:L,isReady:k,isPending:H,tripsIds:h,tripsDict:j,visitsIds:D,visitsDict:T,ridesIds:R,ridesDict:P,ridesStats:g(R,P),locationsIds:A,locationsDict:C,locationsRating:u,countriesIds:w,countriesDict:S,countriesRating:Y}}function g(e,t){return{earliestDeparture:new Date(l()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime.getTime()})))),latestArrival:new Date(o()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime.getTime()}))))}}},872:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(107);r(20);function a(){return Object(n.g)({domain:"travel.countries",isProvision:!0,modelName:"countries",query:{navigation:{isDisabled:!0}}})}},873:function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return v})),r.d(t,"a",(function(){return b}));var n=r(323),a=r(899),i=r(900),o=r(879),c=r(882),l="d MMMM yyyy",u="LLLL yyyy",s="LLLL",p="d MMMM",d="d";function f(e,t,r){var f=r?u:l,m=Object(c.a)(t,f,{locale:o.a});if(Object(n.a)(e,t))return m;var v="";if(Object(a.a)(e,t))r||(v=Object(c.a)(e,d,{locale:o.a}));else if(Object(i.a)(e,t)){var b=r?s:p;v=Object(c.a)(e,b,{locale:o.a})}else v=Object(c.a)(e,f,{locale:o.a});return"".concat(v,"—").concat(m)}function m(e,t){return f(e.departureDateTime,e.arrivalDateTime,t)}function v(e,t){var r=e.departureDateTime;return f(e.arrivalDateTime,r,t)}function b(e){var t=e.periodStart,r=e.periodEnd,n=e.isObscure,a=e.placeholder;if(!r){var i=n?u:l,s=Object(c.a)(t,i,{locale:o.a});return"".concat(s,"—").concat(a)}return f(t,r,n)}},874:function(e,t,r){"use strict";function n(e){return e instanceof Date&&!Number.isNaN(e.getTime())}r.d(t,"a",(function(){return n}))},882:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(56),a=r(874);function i(e){if(!Object(a.a)(e))return"?";for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return n.a.apply(void 0,[e].concat(r))}},891:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(81),a=r(107);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){var t=e.domain,r=e.userAlias,i=Object(n.c)((function(e){return Object(a.e)(e,"users",r)}));return o(o({},Object(a.g)({domain:t,applicableSchemaName:"item",isProvision:!0,modelName:"users",observe:r,condition:Boolean(r),query:{id:r}})),{},{user:i})}},892:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return p}));var n=r(81),a=r(107);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e){var t=e.domain,r=e.locationsIds,i=Object(n.c)((function(e){return Object(a.c)(e,"locations")||{}})),o=r.filter((function(e){return!i[e]}));return Object(a.g)({domain:t,isProvision:!0,modelName:"locations",observe:r,condition:Boolean(o.length),query:{filter:{id:{comparator:"in",value:o}},navigation:{isDisabled:!0}}})}function p(e){var t=e.domain,r=l(Object(a.h)({domain:t,modelName:"locations",method:"POST"}),2),n=r[0];return o(o({},r[1]),{},{submitLocationRating:n})}},894:function(e,t,r){"use strict";r.d(t,"b",(function(){return n.a})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d}));var n=r(865),a=(r(872),r(81)),i=r(107);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){var t=e.userAlias,r=e.visitId,n=Object(a.c)((function(e){return{visitsDict:Object(i.c)(e,"visits")||{}}})).visitsDict[r];return u({visit:n},Object(i.g)({domain:"travel.visit".concat(r,"-").concat(t),isProvision:!0,modelName:"visits",observe:r,condition:!n,query:{userAlias:t,filter:{visit_id:{comparator:"=",value:r}},navigation:{isDisabled:!0}}}))}function d(e){var t=e.domain,r=o(Object(i.h)({domain:t,modelName:"visits",method:"POST",contentType:"multipart/form-data"}),2),n=r[0];return u(u({},r[1]),{},{submitVisitPhoto:n})}},930:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),a=r.n(n),i=r(845),o=r(971),c=r.n(o),l=r(873),u=r(95),s=r(931),p=Object(i.a)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function d(e){var t=e.ride,r=e.ride,n=(r=void 0===r?{}:r).rideType,i=e.className,o=e.isLong,d=p();return t?a.a.createElement("div",{className:i},a.a.createElement(s.a,{ride:t,className:d.icon}),n===u.RIDE_TYPES.HITCH_HIKING&&a.a.createElement(c.a,{className:d.absoluteIcon}),o&&Object(l.b)(t)):null}},931:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r(0),a=r.n(n),i=r(961),o=r.n(i),c=r(960),l=r.n(c),u=r(958),s=r.n(u),p=r(955),d=r.n(p),f=r(969),m=r.n(f),v=r(957),b=r.n(v),O=r(963),E=r.n(O),y=r(964),g=r.n(y),h=r(956),I=r.n(h),j=r(932),T=r.n(j),P=r(959),S=r.n(P),C=r(962),D=r.n(C),R=r(965),w=r.n(R),A=r(966),_=r.n(A),N=r(967),x=r.n(N),V=r(968),L=r.n(V),k=r(970),H=r.n(k),Y=r(95);function F(e){var t=e.ride.vehicleType,r=e.className,n=function(e){switch(e){case Y.VEHICLE_TYPES.CAR:return d.a;case Y.VEHICLE_TYPES.TRAIN:return I.a;case Y.VEHICLE_TYPES.AIRCRAFT:return b.a;case Y.VEHICLE_TYPES.BUS:case Y.VEHICLE_TYPES.TROLLEY:case Y.VEHICLE_TYPES.CITY_BUS:return s.a;case Y.VEHICLE_TYPES.MOTORHOME:case Y.VEHICLE_TYPES.JITNEY:return S.a;case Y.VEHICLE_TYPES.LOCAL_TRAIN:return I.a;case Y.VEHICLE_TYPES.FERRY:return l.a;case Y.VEHICLE_TYPES.BIKE:return o.a;case Y.VEHICLE_TYPES.BY_FEET:return D.a;case Y.VEHICLE_TYPES.MOTORBIKE:return E.a;case Y.VEHICLE_TYPES.TRUCK:return T.a;case Y.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return g.a;case Y.VEHICLE_TYPES.TRAM:return w.a;case Y.VEHICLE_TYPES.TAXI:return _.a;case Y.VEHICLE_TYPES.SUBWAY:return x.a;case Y.VEHICLE_TYPES.PUBLIC_TRANSPORT:return L.a;case Y.VEHICLE_TYPES.ROPEWAY:case Y.VEHICLE_TYPES.FUNICULAR:return m.a;default:return H.a}}(t);return a.a.createElement(n,{className:r})}},983:function(e,t,r){"use strict";var n=r(0),a=r.n(n),i=r(2),o=r.n(i),c=r(845),l=r(1052),u=r(252),s=r(873),p=Object(c.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},period:{display:"inline",color:"gray",fontSize:12}}),d=function(e){var t=e.visit,r=e.isLong,n=p();if(!t)return"Не указано";var i=t.locationName;return(a.a.createElement("div",{className:n.container},a.a.createElement(l.a,{visit:t,className:n.icon}),"".concat(i).concat(r?", ":""),a.a.createElement("div",{className:n.period},r&&Object(s.c)(t))))};d.propTypes={visit:o.a.shape(u.default)},d.defaultProps={visit:{}},t.a=d},990:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(980),a=r(981),i=r(972),o=r.n(i),c=r(976),l=r.n(c),u=function(e,t){var r=t.maxLength,n=t.separator,a=void 0===n?", ":n,i=l()(e),o=i.slice(0,r).join(a);return i.length>r?"".concat(o,"..."):o},s=r(249),p=r(873);function d(e,t,r,i){var c,l=e||{},d=l.visits,f=l.originLocationId,m=l.tripName,v=l.hasAutogeneratedTripName,b=null===(c=i[f])||void 0===c?void 0:c.countryId;if(!v)return m||"Без названия";if(!d.length)return"Без названия";var O=Object(p.c)({arrivalDateTime:Object(n.a)(d.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime}))),departureDateTime:Object(a.a)(d.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime})))}),E=Object.keys(o()(d.filter((function(e){var r;return(null===(r=t[e])||void 0===r?void 0:r.visitType)!==s.VISIT_TYPES.TRANSIT})),"countryId"));if(1===E.length){var y=u(d.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.locationName})),{maxLength:4});return"".concat(y||"Без названия",", ").concat(O)}var g=u(E.map((function(e){return Number(e)!==b&&r[e]&&r[e].countryName})).filter(Boolean),{maxLength:4});return"".concat(g||"Без названия",", ").concat(O)}}}]);
//# sourceMappingURL=travel-TripEditPage-e44ba29cce9e94408df3.js.map