{"version":3,"sources":["webpack:///./node_modules/@material-ui/icons/StarBorder.js","webpack:///./node_modules/@material-ui/icons/ThumbDownOutlined.js","webpack:///./node_modules/@material-ui/icons/ThumbsUpDownOutlined.js","webpack:///./src/packages/travel/pages/VisitsPage/useVisitsPageStyles.js","webpack:///./src/packages/travel/pages/VisitsPage/consts.js","webpack:///./src/packages/travel/pages/VisitsPage/useVisitsGroupingSidebar.js","webpack:///./node_modules/memoize-one/dist/memoize-one.esm.js","webpack:///./src/packages/travel/pages/VisitsPage/utils.js","webpack:///./src/packages/travel/pages/VisitsPage/calcCounters.js","webpack:///./src/packages/travel/pages/VisitsPage/switchSortingFn.js","webpack:///./src/packages/travel/components/models/countries/CountryInfo/CountryInfo.jsx","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderCountry.js","webpack:///./src/packages/travel/components/models/locations/LocationInfo/LocationInfo.jsx","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderLocation.js","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderOriginLocation.js","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderDepartureLocation.js","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderArrivalLocation.js","webpack:///./src/packages/travel/components/models/trips/TripInfo/TripInfo.jsx","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderTrip.js","webpack:///./src/packages/travel/components/common/YearInfo/YearInfo.jsx","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderYear.js","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderNodesInOrder.js","webpack:///./src/packages/travel/pages/VisitsPage/blocks/renderTitle.jsx","webpack:///./src/packages/travel/pages/VisitsPage/VisitsPage.jsx","webpack:///./src/packages/travel/dataSource/useTrips.js","webpack:///./src/packages/travel/dataSource/useCountries.js","webpack:///./src/packages/travel/dataSource/useUser.js","webpack:///./src/packages/travel/dataSource/useLocations.js","webpack:///./src/modules/utilities/dateTime/dateTimePeriodToString.js","webpack:///./src/packages/travel/components/models/rides/RideInfo/RideInfo.jsx","webpack:///./src/packages/travel/components/models/rides/RideIcon/RideIcon.jsx","webpack:///./src/packages/travel/components/common/LocationsMap/useMarkers.js","webpack:///./src/packages/travel/components/common/LocationsMap/LocationsMap.jsx","webpack:///./node_modules/@material-ui/core/esm/Link/Link.js"],"names":["_interopRequireDefault","Object","defineProperty","exports","value","default","_react","_default","createElement","d","makeStyles","theme","visibilityTrigger","visibility","visibleOnlyOnHover","group","backgroundColor","top","marginTop","spacing","subgroup","detail","color","fontSize","formControl","width","ratingBlock","display","alignItems","ratingIcon","halfDown","position","GROUP_VISITS_BY","VISITS_SECTIONS","TRIPS","LOCATIONS","VISITS_SECTION_DEFAULT","VISITS_SECTIONS_GROUPS","key","l10n","GROUP_VISITS_BY_DEFAULTS","SORT_VISITS_BY","RATING_ALPHABET","VISITS_ALPHABET","ALPHABET","SORT_VISITS_BY_DEFAULT","COMPARATORS","VISIT","ARRIVAL_YEAR","TRIP","DEPARTURE_TIME","ID","PRESERVE_ORDER","COUNTRY","VISITS","RATING","NAME_ID","LOCATION","setQueryFilter","queryFilter","section","classes","useVisitsPageStyles","groupByQuery","sortBy","sortByQuery","values","includes","resolveActualSortBy","actualSection","visitsSectionGroups","find","resolveActualGroupBy","groupBy","useSidebar","closeSidebar","List","ListItem","FormControl","className","InputLabel","shrink","id","Select","labelId","autoWidth","onChange","event","target","map","visitsSectionGroup","MenuItem","areInputsEqual","newInputs","lastInputs","length","i","resultFn","isEqual","lastThis","lastResult","lastArgs","calledOnce","newArgs","_i","arguments","this","apply","resolveTripCountryId","tripId","countryId","resolveYearCountryId","year","resolveArrivalYear","arrivalDateTime","getFullYear","checkIsGroupedByTrip","lastCacheKey","cachedResult","inc","ref","refKey","counterName","counterKey","countersRef","counterRef","currentCount","getLocationVisitsCount","counters","locationId","locations","visits","keys","getCountryVisitsCount","countries","getLocationVisitsByYearCount","years","COMPARATOR_FUNCTIONS_MAPPING","visitA","visitB","arrivalDateTimeA","arrivalDateTimeB","countriesDict","countryIdA","countryIdB","countryNameA","countryName","countryNameB","countriesRating","_","locationIdA","locationNameA","locationName","locationIdB","locationNameB","locationsRating","tripsIds","tripIdA","tripIdB","indexA","indexOf","indexB","tripsDict","departureDateTimeA","departureDateTime","departureDateTimeB","resolveComparatorBySortFn","sortFn","ENTITY_COMPARATORS","createComparator","provision","comparatorsKeys","comparatorFuncs","comparatorKey","comparatorFnCreator","warning","filter","Boolean","fnIdx","comparisonResult","memoizeOne","locationsDict","memoize","ratings","countryIdToCompare","rating","sum","CountryInfo","country","isSubgroup","isDetail","children","Typography","variant","renderCountry","visit","visitId","changes","isTripChanged","isCountryChanged","isGroupedByTrip","isGroupedByYearCountries","locationsCounter","yearsCountries","tripsCountries","useStyles","autoMargin","marginLeft","LocationInfo","shouldJustifyContent","location","childrenArray","React","Children","toArray","lastChildren","slice","restChildren","Grid","container","justify","item","GROUPS_TO_RENDER_COUNTRY","GROUPS_TO_RENDER_YEARS_OF_VISIT","renderLocation","departureRideId","isYearChanged","isLocationChanged","visitsDict","ridesDict","isGroupedByTripsOnly","countryDetailNode","visitsCount","resolveVisitsCounter","visitsDetailNode","yearsOfVisitDetailNode","getYearsOfVisits","join","childrenNodes","nodes","reduce","nodesMemo","node","index","push","joinNodes","locationRating","LOCATION_RATING","PLACE_TO_LIVE","FEW_PER_YEAR","ONCE_PER_YEAR","ONCE_PER_TWO_YEARS","ONCE_PER_FIVE_YEARS","ONCE_PER_DECADE","TWICE_PER_LIVE","ONCE_PER_LIVE","NEVER","renderRatingNode","renderAlignedRatingNode","visitDateTimePeriodToString","RideInfo","ride","renderOriginLocation","keyBase","trip","originLocationId","originLocation","renderDepartureLocation","props","arrivalRideId","renderArrivalLocation","willTripChange","TripInfo","tripName","paragraph","renderTrip","tripEditPath","travelPaths","tripEdit","hasEditRights","userAlias","tripEditButtonNode","IconButton","href","toUrl","strTripId","String","size","cls","YearInfo","renderYear","isGroupedByCountriesYear","renderNodesInOrder","prevVisit","nextVisit","forwardedProps","prevCountryId","prevLocationId","prevTripId","nextTripId","prevYear","renderProps","checkIsGroupedByYear","checkIsGroupedByCountry","renderTitle","createTripUrl","locationsUrl","locationsCount","countriesCount","linkToCreateTripNode","to","component","Link","VisitsPage","match","params","authenticatedUserAlias","useAuthContext","useQueryFilter","useVisitsGroupingSidebar","useTripsStats","isPending","isError","usePaths","travel","locationsPath","tripCreatePath","tripCreate","visitsIds","unsortedVisitsList","visitsList","cacheKey","totalVisits","trips","forEach","calcCounters","updatesCounter","titleNode","locationsIds","mapsNode","LocationsMap","height","sort","NAME","switchSortingFn","nodesAccumulator","propTypes","PropTypes","string","isRequired","number","tripsProvision","requiredTripsIds","useSelector","state","selectDict","shouldRequireAllTrips","missingTripsIds","useProvision","domain","isProvision","modelName","observe","query","navigation","isDisabled","comparator","useTrips","useUser","user","userProvision","selectResult","data","Array","from","Set","flatMap","tripsId","ridesIds","rides","countriesIds","countriesProvision","useCountries","locationsProvision","useLocations","commonProvisionState","provisions","selectUpdatesCounter","isReady","every","selectIsReady","some","selectIsPending","isValid","selectIsValid","error","selectIsError","errors","selectError","invalidate","mergeProvisionsState","ratingsGroupedByCountries","memo","mapValues","ratingsByCountry","Infinity","avg","a","b","best","max","lengthRatio","Math","log","averageRating","calcCountriesRating","ridesStats","calcRidesStats","earliestDeparture","Date","min","rideId","getTime","latestArrival","isLoading","selectItem","applicableSchemaName","condition","requiredLocationIds","missingLocationsIds","useLocationRatingRequest","useRequest","method","submitLocationRating","DATE_FORMATS","dateTimePeriodToString","periodStart","periodEnd","periodEndString","dateFormat","locale","ru","isSameDay","periodStartString","isSameMonth","isSameYear","rideDateTimePeriodToString","icon","absoluteIcon","rideType","isLong","RIDE_TYPES","HITCH_HIKING","RideIcon","vehicleType","IconComponent","VEHICLE_TYPES","CAR","CarIcon","TRAIN","TrainIcon","AIRCRAFT","FlightIcon","BUS","TROLLEY","CITY_BUS","BusIcon","MOTORHOME","JITNEY","VanIcon","LOCAL_TRAIN","FERRY","BoatIcon","BIKE","BikeIcon","BY_FEET","WalkIcon","MOTORBIKE","MotorcycleIcon","TRUCK","TruckIcon","ALL_TERRAIN_VEHICLE","TerrainIcon","TRAM","TramIcon","TAXI","LocalTaxiIcon","SUBWAY","SubwayIcon","PUBLIC_TRANSPORT","SeatIcon","ROPEWAY","FUNICULAR","CustomTransportIcon","UnknownRideIcon","resolveRideIconComponent","createControlledPromise","resolver","rejector","promise","Promise","resolve","reject","googleMapContainer","margin","maxWidth","maxHeight","handleGoogleApiLoaded","markersCoords","useMemo","apiPromise","previousCoords","useRef","changesCount","useEffect","current","markers","then","api","maps","bounds","LatLngBounds","lat","lon","marker","Marker","lng","extend","fitBounds","getZoom","setZoom","setMap","useMarkers","locationIdToShowMarker","bootstrapURLKeys","__GOOGLE_MAP_API_KEY__","center","zoom","onGoogleApiLoaded","objectOf","shape","locationPropTypes","arrayOf","defaultProps","forwardRef","_props$color","_props$component","onBlur","onFocus","TypographyClasses","_props$underline","underline","_props$variant","other","_useIsFocusVisible","isFocusVisible","onBlurVisible","focusVisibleRef","_React$useState","useState","focusVisible","setFocusVisible","handlerRef","root","concat","button","underlineNone","textDecoration","underlineHover","underlineAlways","WebkitTapHighlightColor","outline","border","borderRadius","padding","cursor","userSelect","verticalAlign","borderStyle","name"],"mappings":"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","file":"travel-VisitsPage-d5ef44b6dd499f97f22f.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\"\n}), 'StarBorder');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm0 12l-4.34 4.34L12 14H3v-2l3-7h9v10zm4-12h4v12h-4z\"\n}), 'ThumbDownOutlined');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M12 6c0-.55-.45-1-1-1H5.82l.66-3.18.02-.23c0-.31-.13-.59-.33-.8L5.38 0 .44 4.94C.17 5.21 0 5.59 0 6v6.5c0 .83.67 1.5 1.5 1.5h6.75c.62 0 1.15-.38 1.38-.91l2.26-5.29c.07-.17.11-.36.11-.55V6zm-2 1.13L7.92 12H2V6.21l1.93-1.93L3.36 7H10v.13zM22.5 10h-6.75c-.62 0-1.15.38-1.38.91l-2.26 5.29c-.07.17-.11.36-.11.55V18c0 .55.45 1 1 1h5.18l-.66 3.18-.02.24c0 .31.13.59.33.8l.79.78 4.94-4.94c.27-.27.44-.65.44-1.06v-6.5c0-.83-.67-1.5-1.5-1.5zm-.5 7.79l-1.93 1.93.57-2.72H14v-.13L16.08 12H22v5.79z\"\n}), 'ThumbsUpDownOutlined');\n\nexports.default = _default;","import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles(theme => ({\n  visibilityTrigger: {\n    '&:hover $visibleOnlyOnHover': {\n      visibility: 'visible',\n    },\n  },\n  visibleOnlyOnHover: {\n    visibility: 'hidden',\n  },\n  group: {\n    backgroundColor: 'white',\n    top: 0,\n    '&:not(:first-of-type)': {\n      marginTop: theme.spacing(5),\n    },\n\n    '& ~ $subgroup': {\n      marginTop: theme.spacing(2),\n    },\n\n    '& + $subgroup ': {\n      marginTop: 0,\n    },\n  },\n  subgroup: {\n    backgroundColor: 'white',\n    top: 38,\n  },\n  detail: {\n    color: 'gray',\n    fontSize: 12,\n  },\n  formControl: {\n    width: '100%',\n  },\n  ratingBlock: { display: 'inline-flex', alignItems: 'center' },\n  ratingIcon: { color: 'gray', fontSize: 12 },\n  halfDown: { position: 'relative', top: 12 },\n}));\n","export const KEY_GROUP_VISITS_BY = 'group';\nexport const GROUP_VISITS_BY = {\n  LOCATIONS: 'loc',\n  COUNTRIES: 'c',\n  YEARS: 'yr',\n  YEARS_COUNTRIES: 'yr_c',\n  COUNTRIES_YEARS: 'c_yr',\n  TRIPS: 't',\n  TRIPS_COUNTRIES: 't_с',\n};\n\nexport const VISITS_SECTIONS = {\n  TRIPS: 'trips',\n  LOCATIONS: 'locations',\n};\nexport const VISITS_SECTION_DEFAULT = VISITS_SECTIONS.TRIPS;\nexport const VISITS_SECTIONS_GROUPS = {\n  [VISITS_SECTIONS.LOCATIONS]: [\n    { key: GROUP_VISITS_BY.LOCATIONS, l10n: 'По городам' },\n    { key: GROUP_VISITS_BY.COUNTRIES, l10n: 'По странам' },\n    { key: GROUP_VISITS_BY.YEARS, l10n: 'По годам' },\n    { key: GROUP_VISITS_BY.YEARS_COUNTRIES, l10n: 'По годам и странам' },\n    { key: GROUP_VISITS_BY.COUNTRIES_YEARS, l10n: 'По странам и годам' },\n  ],\n  [VISITS_SECTIONS.TRIPS]: [\n    { key: GROUP_VISITS_BY.TRIPS, l10n: 'По поездкам' },\n    { key: GROUP_VISITS_BY.TRIPS_COUNTRIES, l10n: 'По поездкам и странам' },\n  ],\n};\nexport const GROUP_VISITS_BY_DEFAULTS = {\n  [VISITS_SECTIONS.LOCATIONS]: GROUP_VISITS_BY.COUNTRIES,\n  [VISITS_SECTIONS.TRIPS]: GROUP_VISITS_BY.TRIPS,\n};\n\nexport const KEY_SORT_VISITS_BY = 'sort';\nexport const SORT_VISITS_BY = {\n  RATING_ALPHABET: 'r_a',\n  VISITS_ALPHABET: 'v_a',\n  ALPHABET: 'a',\n};\nexport const SORT_VISITS_BY_DEFAULT = SORT_VISITS_BY.ALPHABET;\n\nexport const COMPARATORS = {\n  VISIT: { ARRIVAL_YEAR: 'ARRIVAL_YEAR' },\n  TRIP: {\n    DEPARTURE_TIME: 'TRIP_DEPARTURE_DATE',\n    ID: 'TRIP_ID',\n    PRESERVE_ORDER: 'PRESERVE_ORDER',\n  },\n  COUNTRY: {\n    VISITS: 'COUNTRY_VISITS',\n    RATING: 'COUNTRY_RATING',\n    NAME_ID: 'COUNTRY_NAME_ID',\n  },\n  LOCATION: {\n    VISITS: 'LOCATION_VISITS',\n    RATING: 'LOCATION_RATING',\n    NAME_ID: 'LOCATION_NAME_ID',\n  },\n};\n","import React from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { useSidebar } from 'core/context/SidebarContext';\nimport {\n  GROUP_VISITS_BY,\n  KEY_GROUP_VISITS_BY,\n  GROUP_VISITS_BY_DEFAULTS,\n  VISITS_SECTION_DEFAULT,\n  VISITS_SECTIONS,\n  VISITS_SECTIONS_GROUPS,\n  SORT_VISITS_BY,\n  KEY_SORT_VISITS_BY,\n  SORT_VISITS_BY_DEFAULT,\n} from './consts';\nimport useVisitsPageStyles from './useVisitsPageStyles';\n\nexport default function(setQueryFilter, queryFilter, section) {\n  const classes = useVisitsPageStyles();\n  const {\n    [KEY_GROUP_VISITS_BY]: groupByQuery,\n    [KEY_SORT_VISITS_BY]: sortByQuery,\n  } = queryFilter || {};\n  const sortBy = resolveActualSortBy(sortByQuery);\n  const [groupBy, visitsSectionGroups] = resolveActualGroupBy(\n    groupByQuery,\n    section,\n  );\n\n  useSidebar(\n    ({ closeSidebar }) => (\n      <List>\n        <ListItem>\n          <FormControl className={classes.formControl}>\n            <InputLabel shrink={true} id=\"select-groupBy-filter-label\">\n              Сгруппировать\n            </InputLabel>\n            <Select\n              labelId=\"select-groupBy-filter-label\"\n              autoWidth={true}\n              id=\"select-groupBy-filter\"\n              value={groupBy}\n              onChange={event => {\n                closeSidebar();\n                setQueryFilter({\n                  [KEY_GROUP_VISITS_BY]: event.target.value,\n                });\n              }}\n            >\n              {visitsSectionGroups.map(visitsSectionGroup => (\n                <MenuItem\n                  key={visitsSectionGroup.key}\n                  value={visitsSectionGroup.key}\n                >\n                  {visitsSectionGroup.l10n}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </ListItem>\n        {groupBy !== GROUP_VISITS_BY.TRIPS && (\n          <ListItem>\n            <FormControl className={classes.formControl}>\n              <InputLabel shrink={true} id=\"select-sortBy-filter-label\">\n                Сортировать\n              </InputLabel>\n              <Select\n                labelId=\"select-sortBy-filter-label\"\n                autoWidth={true}\n                id=\"select-sortBy-filter\"\n                value={sortBy}\n                onChange={event => {\n                  closeSidebar();\n                  setQueryFilter({\n                    [KEY_SORT_VISITS_BY]: event.target.value,\n                  });\n                }}\n              >\n                <MenuItem value={SORT_VISITS_BY.ALPHABET}>По алфавиту</MenuItem>\n                <MenuItem value={SORT_VISITS_BY.VISITS_ALPHABET}>\n                  По числу посещений\n                </MenuItem>\n                <MenuItem value={SORT_VISITS_BY.RATING_ALPHABET}>\n                  По рейтингу\n                </MenuItem>\n              </Select>\n            </FormControl>\n          </ListItem>\n        )}\n      </List>\n    ),\n    [groupBy, sortBy],\n  );\n\n  return { groupBy, sortBy };\n}\n\nfunction resolveActualSortBy(sortByQuery) {\n  return Object.values(SORT_VISITS_BY).includes(sortByQuery)\n    ? sortByQuery\n    : SORT_VISITS_BY_DEFAULT;\n}\nfunction resolveActualGroupBy(groupByQuery, section) {\n  const actualSection = Object.values(VISITS_SECTIONS).includes(section)\n    ? section\n    : VISITS_SECTION_DEFAULT;\n  const visitsSectionGroups = VISITS_SECTIONS_GROUPS[actualSection] || [];\n  const groupBy = visitsSectionGroups.find(({ key }) => key === groupByQuery)\n    ? groupByQuery\n    : GROUP_VISITS_BY_DEFAULTS[actualSection];\n  return [groupBy, visitsSectionGroups];\n}\n","function areInputsEqual(newInputs, lastInputs) {\n    if (newInputs.length !== lastInputs.length) {\n        return false;\n    }\n    for (var i = 0; i < newInputs.length; i++) {\n        if (newInputs[i] !== lastInputs[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoizeOne(resultFn, isEqual) {\n    if (isEqual === void 0) { isEqual = areInputsEqual; }\n    var lastThis;\n    var lastArgs = [];\n    var lastResult;\n    var calledOnce = false;\n    function memoized() {\n        var newArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            newArgs[_i] = arguments[_i];\n        }\n        if (calledOnce && lastThis === this && isEqual(newArgs, lastArgs)) {\n            return lastResult;\n        }\n        lastResult = resultFn.apply(this, newArgs);\n        calledOnce = true;\n        lastThis = this;\n        lastArgs = newArgs;\n        return lastResult;\n    }\n    return memoized;\n}\n\nexport default memoizeOne;\n","import { GROUP_VISITS_BY } from './consts';\n\nexport function resolveTripCountryId(tripId, countryId) {\n  return `t${tripId}_c${countryId}`;\n}\nexport function resolveYearCountryId(year, countryId) {\n  return `y${year}_c${countryId}`;\n}\n\nexport function resolveArrivalYear({ arrivalDateTime }) {\n  if (!arrivalDateTime) {\n    return null;\n  }\n  return arrivalDateTime.getFullYear(arrivalDateTime);\n}\n\nexport function checkIsGroupedByTrip(groupBy) {\n  return (\n    groupBy === GROUP_VISITS_BY.TRIPS ||\n    groupBy === GROUP_VISITS_BY.TRIPS_COUNTRIES\n  );\n}\n\nexport function checkIsGroupedByYear(groupBy) {\n  return (\n    groupBy === GROUP_VISITS_BY.YEARS ||\n    groupBy === GROUP_VISITS_BY.COUNTRIES_YEARS ||\n    groupBy === GROUP_VISITS_BY.YEARS_COUNTRIES\n  );\n}\n\nexport function checkIsGroupedByCountry(groupBy) {\n  return (\n    groupBy === GROUP_VISITS_BY.TRIPS_COUNTRIES ||\n    groupBy === GROUP_VISITS_BY.COUNTRIES ||\n    groupBy === GROUP_VISITS_BY.COUNTRIES_YEARS ||\n    groupBy === GROUP_VISITS_BY.YEARS_COUNTRIES\n  );\n}\n","import {\n  resolveTripCountryId,\n  resolveYearCountryId,\n  resolveArrivalYear,\n} from './utils';\n\nlet lastCacheKey = null;\nlet cachedResult = null;\nexport default function calcCounters(visitsList, cacheKey) {\n  if (cacheKey && cacheKey === lastCacheKey) {\n    return cachedResult;\n  }\n\n  const counters = {\n    totalVisits: {},\n    countries: {},\n    years: {},\n    trips: {},\n    tripsCountries: {},\n    yearsCountries: {},\n    locations: {},\n  };\n\n  visitsList.forEach(visit => {\n    const { locationId, countryId, tripId, visitId } = visit;\n    const year = resolveArrivalYear(visit);\n\n    inc(counters.countries, countryId, 'visits', visitId);\n    inc(counters.countries, countryId, 'locations', locationId);\n    inc(counters.countries, countryId, 'years', year);\n    inc(counters.countries, countryId, 'trips', tripId);\n\n    inc(counters.years, year, 'locations', locationId);\n    inc(counters.years, year, 'countries', countryId);\n    inc(counters.years, year, 'trips', tripId);\n\n    inc(counters.trips, tripId, 'visits', visitId);\n    inc(counters.trips, tripId, 'locations', locationId);\n    inc(counters.trips, tripId, 'countries', countryId);\n\n    inc(counters.locations, locationId, 'visits', visitId);\n    inc(counters.locations, locationId, 'years', year);\n    inc(counters.locations, locationId, 'trips', tripId);\n\n    inc(\n      counters.tripsCountries,\n      resolveTripCountryId(tripId, countryId),\n      'locations',\n      locationId,\n    );\n    inc(\n      counters.yearsCountries,\n      resolveYearCountryId(year, countryId),\n      'locations',\n      locationId,\n    );\n  }, {});\n\n  lastCacheKey = cacheKey;\n  cachedResult = counters;\n\n  return counters;\n}\n\nfunction inc(ref, refKey, counterName, counterKey) {\n  /* eslint-disable no-multi-assign, no-param-reassign */\n  let countersRef = ref[refKey];\n  if (!countersRef) {\n    countersRef = ref[refKey] = {};\n  }\n\n  let counterRef = countersRef[counterName];\n  if (!counterRef) {\n    counterRef = countersRef[counterName] = {};\n  }\n  /* eslint-enable no-multi-assign, no-param-reassign */\n\n  const currentCount = counterRef[counterKey] || 0;\n  counterRef[counterKey] = currentCount + 1;\n}\n\nexport function getLocationVisitsCount(counters = {}, locationId) {\n  const { locations: { [locationId]: { visits = {} } = {} } = {} } = counters;\n  return Object.keys(visits).length;\n}\n\nexport function getCountryVisitsCount(counters = {}, countryId) {\n  const { countries: { [countryId]: { visits = {} } = {} } = {} } = counters;\n  return Object.keys(visits).length;\n}\n\nexport function getLocationVisitsByYearCount(counters, locationId, year) {\n  const {\n    years: {\n      [year]: {\n        locations: { [locationId]: locationVisitsByYearCount } = {},\n      } = {},\n    } = {},\n  } = counters;\n  return locationVisitsByYearCount;\n}\n\nexport function getYearsOfVisits(counters, locationId) {\n  const { locations: { [locationId]: { years = {} } = {} } = {} } = counters;\n  return Object.keys(years);\n}\n","import warning from 'warning';\nimport memoize from 'lodash/memoize';\nimport sum from 'lodash/sum';\nimport memoizeOne from 'memoize-one';\nimport { GROUP_VISITS_BY, SORT_VISITS_BY, COMPARATORS } from './consts';\nimport { getLocationVisitsCount, getCountryVisitsCount } from './calcCounters';\n\nconst COMPARATOR_FUNCTIONS_MAPPING = {\n  [COMPARATORS.VISIT.ARRIVAL_YEAR]: createArrivalYearComparator,\n  [COMPARATORS.COUNTRY.NAME_ID]: createCountryNameIdComparator,\n  [COMPARATORS.COUNTRY.RATING]: createCountryRatingComparator,\n  [COMPARATORS.COUNTRY.VISITS]: createCountryVisitsComparator,\n  [COMPARATORS.LOCATION.NAME_ID]: createLocationNameIdComparator,\n  [COMPARATORS.LOCATION.RATING]: createLocationRatingComparator,\n  [COMPARATORS.LOCATION.VISITS]: createLocationVisitsComparator,\n  [COMPARATORS.TRIP.PRESERVE_ORDER]: createTripPreserveOrderComparator,\n  [COMPARATORS.TRIP.DEPARTURE_TIME]: createTripDepartureTimeComparator,\n  [COMPARATORS.TRIP.ID]: createTripIdComparator,\n};\n\nexport default function switchSortingFn(queryFilter, provision, counters) {\n  const { groupBy, sortBy } = queryFilter;\n  switch (groupBy) {\n    case GROUP_VISITS_BY.TRIPS:\n      // sorting is not applicable, as locations ordered chronologically\n      return createComparator(provision, counters, [\n        COMPARATORS.TRIP.PRESERVE_ORDER,\n        COMPARATORS.TRIP.DEPARTURE_TIME,\n        COMPARATORS.TRIP.ID,\n        COMPARATORS.LOCATION.NAME,\n      ]);\n    case GROUP_VISITS_BY.TRIPS_COUNTRIES:\n      return createComparator(provision, counters, [\n        COMPARATORS.TRIP.PRESERVE_ORDER,\n        COMPARATORS.TRIP.DEPARTURE_TIME,\n        COMPARATORS.TRIP.ID,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.COUNTRY),\n        COMPARATORS.COUNTRY.NAME_ID,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n    case GROUP_VISITS_BY.COUNTRIES:\n      return createComparator(provision, counters, [\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.COUNTRY),\n        COMPARATORS.COUNTRY.NAME_ID,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n    case GROUP_VISITS_BY.YEARS:\n      return createComparator(provision, counters, [\n        COMPARATORS.VISIT.ARRIVAL_YEAR,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n    case GROUP_VISITS_BY.YEARS_COUNTRIES:\n      return createComparator(provision, counters, [\n        COMPARATORS.VISIT.ARRIVAL_YEAR,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.COUNTRY),\n        COMPARATORS.COUNTRY.NAME_ID,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n    case GROUP_VISITS_BY.COUNTRIES_YEARS:\n      return createComparator(provision, counters, [\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.COUNTRY),\n        COMPARATORS.COUNTRY.NAME_ID,\n        COMPARATORS.VISIT.ARRIVAL_YEAR,\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n    case GROUP_VISITS_BY.LOCATIONS:\n    default:\n      return createComparator(provision, counters, [\n        ...resolveComparatorBySortFn(sortBy, COMPARATORS.LOCATION),\n        COMPARATORS.LOCATION.NAME_ID,\n      ]);\n  }\n}\n\nfunction resolveComparatorBySortFn(sortFn, ENTITY_COMPARATORS) {\n  switch (sortFn) {\n    case SORT_VISITS_BY.VISITS_ALPHABET:\n      return [ENTITY_COMPARATORS?.VISITS];\n    case SORT_VISITS_BY.RATING_ALPHABET:\n      return [ENTITY_COMPARATORS?.RATING, ENTITY_COMPARATORS?.VISITS];\n    default:\n      return [];\n  }\n}\n\nfunction createComparator(provision, counters, comparatorsKeys) {\n  const comparatorFuncs = comparatorsKeys\n    .map(comparatorKey => {\n      const comparatorFnCreator = COMPARATOR_FUNCTIONS_MAPPING[comparatorKey];\n      warning(comparatorFnCreator, 'missing comparatorKey: %s', comparatorKey);\n      if (!comparatorFnCreator) {\n        return null;\n      }\n      return comparatorFnCreator(provision, counters);\n    })\n    .filter(Boolean);\n\n  return (visitA, visitB) => {\n    for (let fnIdx = 0; fnIdx < comparatorFuncs.length; fnIdx += 1) {\n      const comparisonResult = comparatorFuncs[fnIdx](visitA, visitB);\n      if (comparisonResult) {\n        return comparisonResult;\n      }\n    }\n    return 0;\n  };\n}\n\nfunction createLocationNameIdComparator() {\n  return (visitA, visitB) => {\n    const { locationId: locationIdA, locationName: locationNameA } = visitA;\n    const { locationId: locationIdB, locationName: locationNameB } = visitB;\n    if (locationNameA > locationNameB) {\n      return 1;\n    }\n    if (locationNameB > locationNameA) {\n      return -1;\n    }\n    return locationIdA - locationIdB;\n  };\n}\n\nfunction createLocationRatingComparator({ locationsRating }) {\n  return (visitA, visitB) => {\n    const { locationId: locationIdA } = visitA;\n    const { locationId: locationIdB } = visitB;\n    const ratingA = locationsRating[locationIdA] || 10;\n    const ratingB = locationsRating[locationIdB] || 10;\n    return ratingA - ratingB;\n  };\n}\n\nfunction createLocationVisitsComparator(_, counters) {\n  return (visitA, visitB) => {\n    const { locationId: locationIdA } = visitA;\n    const { locationId: locationIdB } = visitB;\n    return (\n      getLocationVisitsCount(counters, locationIdB) -\n      getLocationVisitsCount(counters, locationIdA)\n    );\n  };\n}\n\nfunction createCountryNameIdComparator({ countriesDict }) {\n  return (visitA, visitB) => {\n    const { countryId: countryIdA } = visitA;\n    const { countryId: countryIdB } = visitB;\n    const { countryName: countryNameA } = countriesDict[countryIdA] || {};\n    const { countryName: countryNameB } = countriesDict[countryIdB] || {};\n\n    if (countryNameA > countryNameB) {\n      return 1;\n    }\n    if (countryNameB > countryNameA) {\n      return -1;\n    }\n    return countryIdA - countryIdB;\n  };\n}\n\nconst resolveCountryRating = memoizeOne(locationsDict =>\n  memoize(countryId => {\n    const ratings = Object.values(locationsDict)\n      .filter(\n        ({ countryId: countryIdToCompare }) => countryId === countryIdToCompare,\n      )\n      .map(({ rating }) => rating);\n    if (!ratings.length) {\n      return 0;\n    }\n    return sum(ratings) / ratings.length;\n  }),\n);\n\nfunction createCountryRatingComparator({ countriesRating }) {\n  return (visitA, visitB) => {\n    const { countryId: countryIdA } = visitA;\n    const { countryId: countryIdB } = visitB;\n    const ratingA = countriesRating[countryIdA] || 10;\n    const ratingB = countriesRating[countryIdB] || 10;\n    return ratingA - ratingB;\n  };\n}\n\nfunction createCountryVisitsComparator(_, counters) {\n  return (visitA, visitB) => {\n    const { countryId: countryIdA } = visitA;\n    const { countryId: countryIdB } = visitB;\n    return (\n      getCountryVisitsCount(counters, countryIdB) -\n      getCountryVisitsCount(counters, countryIdA)\n    );\n  };\n}\n\nfunction createTripPreserveOrderComparator({ tripsIds }) {\n  return (visitA, visitB) => {\n    if (!tripsIds) {\n      return 0;\n    }\n    const { tripId: tripIdA } = visitA;\n    const { tripId: tripIdB } = visitB;\n    const indexA = tripsIds.indexOf(tripIdA);\n    const indexB = tripsIds.indexOf(tripIdB);\n    if (indexA < 0 || indexB < 0) {\n      if (indexA < 0 && indexB < 0) {\n        return 0;\n      }\n      if (indexB < 0) {\n        return -1;\n      }\n      return 1;\n    }\n    return indexA - indexB;\n  };\n}\n\nfunction createTripDepartureTimeComparator({ tripsDict }) {\n  return (visitA, visitB) => {\n    const { tripId: tripIdA } = visitA;\n    const { tripId: tripIdB } = visitB;\n    const { departureDateTime: departureDateTimeA } = tripsDict[tripIdA] || {};\n    const { departureDateTime: departureDateTimeB } = tripsDict[tripIdB] || {};\n\n    if (!departureDateTimeA && !departureDateTimeB) {\n      return 0;\n    }\n    if (!departureDateTimeA || !departureDateTimeB) {\n      // here also considered previous check: !arrivalDateTimeA && !arrivalDateTimeB\n      return departureDateTimeA ? -1 : 1;\n    }\n    return departureDateTimeB.getFullYear() - departureDateTimeA.getFullYear();\n  };\n}\n\nfunction createTripIdComparator() {\n  return (visitA, visitB) => {\n    const { tripId: tripIdA } = visitA;\n    const { tripId: tripIdB } = visitB;\n\n    return tripIdA - tripIdB;\n  };\n}\n\nfunction createArrivalYearComparator() {\n  return (visitA, visitB) => {\n    const { arrivalDateTime: arrivalDateTimeA } = visitA;\n    const { arrivalDateTime: arrivalDateTimeB } = visitB;\n\n    if (!arrivalDateTimeA && !arrivalDateTimeB) {\n      return 0;\n    }\n    if (!arrivalDateTimeA || !arrivalDateTimeB) {\n      // here also considered previous check: !arrivalDateTimeA && !arrivalDateTimeB\n      return arrivalDateTimeA ? -1 : 1;\n    }\n    return arrivalDateTimeB.getFullYear() - arrivalDateTimeA.getFullYear();\n  };\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport useVisitsPageStyles from '../../../../pages/VisitsPage/useVisitsPageStyles';\n\nexport default function CountryInfo({\n  country: { countryName } = {},\n  isSubgroup,\n  isDetail,\n  className,\n  children,\n}) {\n  const classes = useVisitsPageStyles();\n  if (isDetail) {\n    return <span className={className}>{countryName}</span>;\n  }\n  return (\n    <Typography variant={isSubgroup ? 'h5' : 'h4'} className={className}>\n      {countryName} {children}\n    </Typography>\n  );\n}\n","import React from 'react';\nimport CountryInfo from 'travel/components/models/countries/CountryInfo';\nimport { GROUP_VISITS_BY } from '../consts';\nimport { resolveTripCountryId, resolveYearCountryId } from '../utils';\n\nexport default function renderCountry({\n  visit: { tripId, visitId, countryId },\n  changes: { isTripChanged, isCountryChanged },\n  provision: { countriesDict },\n  groupBy,\n  year,\n  counters,\n  classes,\n}) {\n  const isGroupedByTrip = groupBy === GROUP_VISITS_BY.TRIPS_COUNTRIES;\n  const isGroupedByYearCountries = groupBy === GROUP_VISITS_BY.YEARS_COUNTRIES;\n  const shouldRender = isCountryChanged || (isGroupedByTrip && isTripChanged);\n  if (!shouldRender) {\n    return null;\n  }\n  let locationsCounter = 0;\n  switch (groupBy) {\n    case GROUP_VISITS_BY.COUNTRIES:\n      locationsCounter = Object.keys(\n        counters?.countries?.[countryId]?.locations || {},\n      ).length;\n      break;\n    case GROUP_VISITS_BY.COUNTRIES_YEARS:\n    case GROUP_VISITS_BY.YEARS_COUNTRIES:\n      locationsCounter = Object.keys(\n        counters?.yearsCountries?.[resolveYearCountryId(year, countryId)]\n          ?.locations || {},\n      ).length;\n      break;\n    case GROUP_VISITS_BY.TRIPS_COUNTRIES:\n      locationsCounter = Object.keys(\n        counters?.tripsCountries?.[resolveTripCountryId(tripId, countryId)]\n          ?.locations || {},\n      ).length;\n      break;\n    default:\n      break;\n  }\n\n  const isSubgroup = isGroupedByTrip || isGroupedByYearCountries;\n  return (\n    <CountryInfo\n      key={`c${countryId}_v${visitId}`}\n      country={countriesDict[countryId]}\n      isSubgroup={isSubgroup}\n      className={isSubgroup ? classes.subgroup : classes.group}\n    >\n      {locationsCounter > 2 && (\n        <span className={classes.detail}>{`${locationsCounter} мест`}</span>\n      )}\n    </CountryInfo>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles({\n  autoMargin: { marginLeft: 'auto' },\n});\n\nexport default function LocationInfo({\n  children,\n  shouldJustifyContent,\n  location: { locationName } = {},\n}) {\n  const classes = useStyles();\n  const childrenArray = React.Children.toArray(children);\n  if (!shouldJustifyContent || childrenArray.length <= 1) {\n    return (\n      <Typography>\n        {locationName} {children}\n      </Typography>\n    );\n  }\n\n  const lastChildren = childrenArray.slice(-1);\n  const restChildren = childrenArray.slice(0, -1);\n  return (\n    <Grid container={true} justify=\"space-between\" alignItems=\"center\">\n      <Grid item={true}>\n        <Typography>\n          {locationName} {restChildren}\n        </Typography>\n      </Grid>\n      <Grid item={true} classes={{ item: classes.autoMargin }}>\n        {lastChildren}\n      </Grid>\n    </Grid>\n  );\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport IconStar from '@material-ui/icons/StarBorder';\nimport IconThumbDown from '@material-ui/icons/ThumbDownOutlined';\nimport IconThumbsUpDown from '@material-ui/icons/ThumbsUpDownOutlined';\nimport { visitDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport RideInfo from 'travel/components/models/rides/RideInfo';\nimport LocationInfo from 'travel/components/models/locations/LocationInfo';\nimport CountryInfo from 'travel/components/models/countries/CountryInfo';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\nimport { GROUP_VISITS_BY, SORT_VISITS_BY } from '../consts';\nimport {\n  getYearsOfVisits,\n  getLocationVisitsByYearCount,\n  getLocationVisitsCount,\n} from '../calcCounters';\n\nconst GROUPS_TO_RENDER_COUNTRY = [\n  GROUP_VISITS_BY.LOCATIONS,\n  GROUP_VISITS_BY.YEARS,\n  GROUP_VISITS_BY.TRIPS,\n];\nconst GROUPS_TO_RENDER_YEARS_OF_VISIT = [\n  GROUP_VISITS_BY.LOCATIONS,\n  GROUP_VISITS_BY.COUNTRIES,\n];\n\nexport default function renderLocation({\n  visit,\n  visit: { visitId, locationId, countryId, departureRideId },\n  classes,\n  changes: {\n    isYearChanged,\n    isCountryChanged,\n    isTripChanged,\n    isLocationChanged,\n  },\n  year,\n  provision: {\n    locationsDict,\n    locationsRating,\n    countriesDict,\n    visitsDict,\n    ridesDict,\n  },\n  groupBy,\n  sortBy,\n  counters,\n}) {\n  const isGroupedByTripsOnly = groupBy === GROUP_VISITS_BY.TRIPS;\n  const shouldRender =\n    isGroupedByTripsOnly || // every visit in trip should be shown\n    isTripChanged || // in other grouping show only unique locations\n    isYearChanged ||\n    isCountryChanged ||\n    isLocationChanged;\n\n  if (!shouldRender) {\n    return null;\n  }\n\n  const shouldRenderCountry = GROUPS_TO_RENDER_COUNTRY.includes(groupBy);\n  const countryDetailNode = shouldRenderCountry ? (\n    <CountryInfo\n      country={countriesDict[countryId]}\n      className={classes.detail}\n      isDetail={true}\n    />\n  ) : null;\n\n  const visitsCount = resolveVisitsCounter(visit, counters, year, groupBy);\n  const visitsDetailNode =\n    sortBy !== SORT_VISITS_BY.RATING_ALPHABET && visitsCount > 1 ? (\n      <span className={classes.detail}>{`${visitsCount} визитов`}</span>\n    ) : null;\n\n  const shouldRenderYearOfVisit =\n    sortBy !== SORT_VISITS_BY.RATING_ALPHABET &&\n    GROUPS_TO_RENDER_YEARS_OF_VISIT.includes(groupBy);\n  const yearsOfVisitDetailNode = shouldRenderYearOfVisit ? (\n    <span className={classes.detail}>\n      {`в ${getYearsOfVisits(counters, locationId).join(', ')}`}\n    </span>\n  ) : null;\n\n  const ratingNode =\n    sortBy === SORT_VISITS_BY.RATING_ALPHABET\n      ? renderAlignedRatingNode({\n          classes,\n          locationRating: locationsRating?.[locationId],\n        })\n      : null;\n\n  const childrenNodes = joinNodes(\n    countryDetailNode,\n    ratingNode,\n    visitsDetailNode,\n    yearsOfVisitDetailNode,\n  );\n\n  return (\n    <LocationInfo\n      key={`l${locationId}_v${visitId}`}\n      location={locationsDict[locationId]}\n      country={countriesDict[countryId]}\n      shouldJustifyContent={isGroupedByTripsOnly}\n    >\n      {childrenNodes}\n      {isGroupedByTripsOnly && (\n        <Grid container={true}>\n          <Grid item={true}>\n            <Typography className={classes.detail}>\n              {visitDateTimePeriodToString(visitsDict[visitId])}\n            </Typography>\n          </Grid>\n          <Grid item={true}>\n            <RideInfo ride={ridesDict[departureRideId]} className={classes.halfDown}/>\n          </Grid>\n        </Grid>\n      )}\n    </LocationInfo>\n  );\n}\n\nfunction renderAlignedRatingNode({ locationRating, classes }) {\n  return (\n    <div className={classes.ratingBlock}>\n      {renderRatingNode({ locationRating, classes })}\n    </div>\n  );\n}\n\nfunction renderRatingNode({ locationRating, classes }) {\n  switch (locationRating) {\n    case LOCATION_RATING.PLACE_TO_LIVE:\n      return (\n        <>\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n        </>\n      );\n    case LOCATION_RATING.FEW_PER_YEAR:\n    case LOCATION_RATING.ONCE_PER_YEAR:\n      return (\n        <>\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n        </>\n      );\n    case LOCATION_RATING.ONCE_PER_TWO_YEARS:\n    case LOCATION_RATING.ONCE_PER_FIVE_YEARS:\n      return (\n        <>\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n        </>\n      );\n    case LOCATION_RATING.ONCE_PER_DECADE:\n    case LOCATION_RATING.TWICE_PER_LIVE:\n      return (\n        <>\n          <IconStar className={classes.ratingIcon} />\n          <IconStar className={classes.ratingIcon} />\n        </>\n      );\n    case LOCATION_RATING.ONCE_PER_LIVE:\n      return <IconStar className={classes.ratingIcon} />;\n    case LOCATION_RATING.NEVER:\n      return <IconThumbDown className={classes.ratingIcon} />;\n    default:\n      return <IconThumbsUpDown className={classes.ratingIcon} />;\n  }\n}\n\nfunction joinNodes(...nodes) {\n  return nodes.filter(Boolean).reduce((nodesMemo, node, index) => {\n    if (index > 0) {\n      nodesMemo.push(<span> </span>);\n    }\n    nodesMemo.push(node);\n    return nodesMemo;\n  }, []);\n}\n\nfunction resolveVisitsCounter(visit, counters = {}, year, groupBy) {\n  const { locationId } = visit;\n  switch (groupBy) {\n    case GROUP_VISITS_BY.LOCATIONS:\n      return getLocationVisitsCount(counters, locationId);\n    case GROUP_VISITS_BY.COUNTRIES:\n      return getLocationVisitsCount(counters, locationId);\n    case GROUP_VISITS_BY.YEARS:\n    case GROUP_VISITS_BY.COUNTRIES_YEARS:\n    case GROUP_VISITS_BY.YEARS_COUNTRIES:\n      return getLocationVisitsByYearCount(counters, locationId, year);\n    case GROUP_VISITS_BY.TRIPS_COUNTRIES:\n    default:\n      break;\n  }\n}\n","import React from 'react';\nimport LocationInfo from 'travel/components/models/locations/LocationInfo';\nimport CountryInfo from 'travel/components/models/countries/CountryInfo';\nimport { GROUP_VISITS_BY } from '../consts';\n\nconst GROUPS_TO_RENDER_COUNTRY = [\n  GROUP_VISITS_BY.LOCATIONS,\n  GROUP_VISITS_BY.YEARS,\n  GROUP_VISITS_BY.TRIPS,\n];\n\nexport default function renderOriginLocation({\n  keyBase,\n  children,\n  classes,\n  visit: { tripId },\n  provision: { tripsDict, locationsDict, countriesDict },\n  groupBy,\n}) {\n  const trip = tripsDict[tripId];\n  if (!trip) {\n    return null;\n  }\n  const { originLocationId } = trip;\n\n  const originLocation = locationsDict[originLocationId];\n  if (!originLocation) {\n    return null;\n  }\n\n  const { countryId } = originLocation;\n  const shouldRenderCountry = GROUPS_TO_RENDER_COUNTRY.includes(groupBy);\n  const countryDetailNode = shouldRenderCountry ? (\n    <CountryInfo\n      country={countriesDict[countryId]}\n      className={classes.detail}\n      isDetail={true}\n    />\n  ) : null;\n\n  return (\n    <LocationInfo\n      key={`${keyBase}_t${tripId}_ol${originLocationId}`}\n      location={locationsDict[originLocationId]}\n      country={countriesDict[countryId]}\n      shouldJustifyContent={children != null}\n    >\n      {countryDetailNode}\n      {children}\n    </LocationInfo>\n  );\n}\n","import React from 'react';\nimport RideInfo from 'travel/components/models/rides/RideInfo';\nimport renderOriginLocation from './renderOriginLocation';\n\nexport default function renderDepartureLocation(props) {\n  const {\n    visit: { arrivalRideId },\n    classes,\n    changes: { isTripChanged },\n    provision: { ridesDict },\n  } = props;\n\n  if (!isTripChanged) {\n    return null;\n  }\n\n  return renderOriginLocation({\n    ...props,\n    keyBase: `dl`,\n    children: (\n      <RideInfo ride={ridesDict[arrivalRideId]} className={classes.halfDown} />\n    ),\n  });\n}\n","import React from 'react';\nimport renderOriginLocation from './renderOriginLocation';\n\nexport default function renderArrivalLocation(props) {\n  const {\n    changes: { willTripChange },\n  } = props;\n\n  if (!willTripChange) {\n    return null;\n  }\n\n  return renderOriginLocation({\n    ...props,\n    keyBase: 'al',\n  });\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nexport default function TripInfo({\n  trip: { tripName } = {},\n  children,\n  className,\n}) {\n  return (\n    <Typography variant=\"h4\" className={className} paragraph={true}>\n      <span>{tripName}</span>\n      {children}\n    </Typography>\n  );\n}\n","import React from 'react';\nimport cls from 'classnames';\nimport IconButton from '@material-ui/core/IconButton';\nimport IconEdit from '@material-ui/icons/Edit';\nimport TripInfo from 'travel/components/models/trips/TripInfo';\n\nexport default function renderTrip({\n  visit: { visitId, tripId },\n  changes: { isTripChanged },\n  provision: { tripsDict },\n  travelPaths: { tripEdit: tripEditPath },\n  hasEditRights,\n  userAlias,\n  classes,\n}) {\n  if (!isTripChanged) {\n    return null;\n  }\n\n  const tripEditButtonNode = hasEditRights ? (\n    <IconButton\n      className={classes.visibleOnlyOnHover}\n      href={tripEditPath.toUrl({ userAlias, strTripId: String(tripId) })}\n      size=\"small\"\n    >\n      <IconEdit />\n    </IconButton>\n  ) : null;\n\n  return (\n    <TripInfo\n      key={`t${tripId}_v${visitId}`}\n      className={cls(classes.visibilityTrigger, classes.group)}\n      trip={tripsDict[tripId]}\n    >\n      {tripEditButtonNode}\n    </TripInfo>\n  );\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport useVisitsPageStyles from '../../../pages/VisitsPage/useVisitsPageStyles';\n\nexport default function YearInfo({ year, isSubgroup }) {\n  const classes = useVisitsPageStyles();\n  return (\n    <Typography\n      variant={isSubgroup ? 'h5' : 'h4'}\n      className={isSubgroup ? classes.subgroup : classes.group}\n    >\n      {year}\n    </Typography>\n  );\n}\n","import React from 'react';\nimport YearInfo from 'travel/components/common/YearInfo';\nimport { GROUP_VISITS_BY } from '../consts';\n\nexport default function renderYear({\n  visit: { visitId },\n  changes: { isYearChanged, isCountryChanged },\n  groupBy,\n  year,\n}) {\n  const isGroupedByCountriesYear = groupBy === GROUP_VISITS_BY.COUNTRIES_YEARS;\n  const shouldRender =\n    isYearChanged || (isGroupedByCountriesYear && isCountryChanged);\n  if (!shouldRender) {\n    return null;\n  }\n  return (\n    <YearInfo\n      key={`y${year}_v${visitId}`}\n      year={year}\n      isSubgroup={isGroupedByCountriesYear}\n    />\n  );\n}\n","import {\n  resolveArrivalYear,\n  checkIsGroupedByCountry,\n  checkIsGroupedByTrip,\n  checkIsGroupedByYear,\n} from '../utils';\nimport { GROUP_VISITS_BY } from '../consts';\nimport renderCountry from './renderCountry';\nimport renderLocation from './renderLocation';\nimport renderDepartureLocation from './renderDepartureLocation';\nimport renderArrivalLocation from './renderArrivalLocation';\nimport renderTrip from './renderTrip';\nimport renderYear from './renderYear';\n\nexport default function renderNodesInOrder({\n  prevVisit,\n  visit,\n  nextVisit,\n  groupBy,\n  ...forwardedProps\n}) {\n  const {\n    countryId: prevCountryId,\n    locationId: prevLocationId,\n    tripId: prevTripId,\n  } = prevVisit;\n  const { tripId: nextTripId } = nextVisit;\n  const { countryId, locationId, tripId } = visit;\n\n  const prevYear = resolveArrivalYear(prevVisit);\n  const year = resolveArrivalYear(visit);\n\n  const isGroupedByTrip = checkIsGroupedByTrip(groupBy);\n  const isGroupedByYear = checkIsGroupedByYear(groupBy);\n  const isGroupedByCountry = checkIsGroupedByCountry(groupBy);\n\n  const renderProps = {\n    visit,\n    groupBy,\n    year,\n    changes: {\n      isTripChanged: isGroupedByTrip && prevTripId !== tripId,\n      willTripChange: isGroupedByTrip && nextTripId !== tripId,\n      isYearChanged: isGroupedByYear && prevYear !== year,\n      isCountryChanged: isGroupedByCountry && prevCountryId !== countryId,\n      isLocationChanged: prevLocationId !== locationId,\n    },\n    ...forwardedProps,\n  };\n\n  switch (groupBy) {\n    case GROUP_VISITS_BY.TRIPS:\n      return [\n        renderTrip(renderProps),\n        renderDepartureLocation(renderProps),\n        renderLocation(renderProps),\n        renderArrivalLocation(renderProps),\n      ];\n    case GROUP_VISITS_BY.TRIPS_COUNTRIES:\n      return [\n        renderTrip(renderProps),\n        renderCountry(renderProps),\n        renderLocation(renderProps),\n      ];\n    case GROUP_VISITS_BY.COUNTRIES:\n      return [renderCountry(renderProps), renderLocation(renderProps)];\n    case GROUP_VISITS_BY.YEARS:\n      return [renderYear(renderProps), renderLocation(renderProps)];\n    case GROUP_VISITS_BY.YEARS_COUNTRIES:\n      return [\n        renderYear(renderProps),\n        renderCountry(renderProps),\n        renderLocation(renderProps),\n      ];\n    case GROUP_VISITS_BY.COUNTRIES_YEARS:\n      return [\n        renderCountry(renderProps),\n        renderYear(renderProps),\n        renderLocation(renderProps),\n      ];\n    case GROUP_VISITS_BY.LOCATIONS:\n    default:\n      // return {push:[locationNode], keep: [countryNode, yearNode]};\n      return [renderLocation(renderProps)];\n  }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\nimport { checkIsGroupedByTrip } from '../utils';\n\nexport default function renderTitle({\n  createTripUrl,\n  locationsUrl,\n  locationsCount,\n  countriesCount,\n  groupBy,\n}) {\n  const linkToCreateTripNode = checkIsGroupedByTrip(groupBy) ? (\n    <div>\n      <MUILink to={createTripUrl} component={Link}>\n        Добавить поездку\n      </MUILink>\n    </div>\n  ) : null;\n\n  return (\n    <Typography variant=\"h6\" paragraph={true}>\n      <span>Всего </span>\n      <MUILink to={locationsUrl} component={Link}>\n        {`${locationsCount} городов `}\n      </MUILink>\n      <span>из </span>\n      <span>{`${countriesCount} стран `}</span>\n      {linkToCreateTripNode}\n    </Typography>\n  );\n}\n\nrenderTitle.propTypes = {\n  locationsUrl: PropTypes.string.isRequired,\n  locationsCount: PropTypes.number.isRequired,\n  countriesCount: PropTypes.number.isRequired,\n};\n","import React from 'react';\nimport { usePaths } from 'modules/packages';\nimport { useTripsStats } from 'travel/dataSource';\nimport { useQueryFilter } from 'core/context/QueryFilterContext';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport LocationsMap from 'travel/components/common/LocationsMap';\nimport useVisitsPageStyles from './useVisitsPageStyles';\nimport useVisitsGroupingSidebar from './useVisitsGroupingSidebar';\nimport switchSortingFn from './switchSortingFn';\nimport renderNodesInOrder from './blocks/renderNodesInOrder';\nimport renderTitle from './blocks/renderTitle';\nimport calcCounters from './calcCounters';\n\nexport default function VisitsPage({\n  match: {\n    params: { userAlias, section },\n  },\n}) {\n  const { userAlias: authenticatedUserAlias } = useAuthContext();\n  const hasEditRights = userAlias === authenticatedUserAlias;\n\n  const classes = useVisitsPageStyles();\n  const { queryFilter, setQueryFilter } = useQueryFilter();\n  const { groupBy, sortBy } = useVisitsGroupingSidebar(\n    setQueryFilter,\n    queryFilter,\n    section,\n  );\n\n  const provision = useTripsStats({ userAlias });\n  const { isPending, isError } = provision;\n\n  const { travel: travelPaths } = usePaths();\n  const { locations: locationsPath, tripCreate: tripCreatePath } = travelPaths;\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending) {\n    return <div>...Loading</div>;\n  }\n\n  const { visitsIds, visitsDict } = provision;\n  const unsortedVisitsList = visitsIds\n    .map(visitId => visitsDict[visitId])\n    .filter(Boolean);\n\n  const { updatesCounter } = provision;\n  const counters = calcCounters(unsortedVisitsList, updatesCounter);\n\n  const titleNode = renderTitle({\n    locationsUrl: locationsPath.toUrl({ userAlias }),\n    createTripUrl: tripCreatePath.toUrl({ userAlias }),\n    locationsCount: Object.keys(counters?.locations || {}).length,\n    countriesCount: Object.keys(counters?.countries || {}).length,\n    groupBy,\n  });\n\n  const { locationsDict, locationsIds } = provision;\n  const mapsNode = (\n    <LocationsMap\n      locationsDict={locationsDict}\n      locationsIds={locationsIds}\n      height={300}\n    />\n  );\n\n  const visitsList = unsortedVisitsList.sort(\n    switchSortingFn({ groupBy, sortBy }, provision, counters),\n  );\n  const nodes = visitsList.reduce(\n    (nodesAccumulator, visit, index) => {\n      const prevVisit = index > 0 ? visitsList[index - 1] : {};\n      const nextVisit =\n        index < visitsList.length - 1 ? visitsList[index + 1] : {};\n\n      renderNodesInOrder({\n        prevVisit,\n        visit,\n        nextVisit,\n        provision,\n        classes,\n        counters,\n        groupBy,\n        sortBy,\n        hasEditRights,\n        travelPaths,\n        userAlias,\n      })\n        .filter(Boolean)\n        .forEach(node => nodesAccumulator.push(node));\n\n      return nodesAccumulator;\n    },\n    [titleNode, mapsNode],\n  );\n\n  // without key there is strange bug with reconciling:\n  // when group_by changed from trips to something other, then trips nodes still\n  // rendering in three, but because of nodes keys collisions only\n  // originalLocations is remaining on top of the list\n  return <div key={`${groupBy}_${sortBy}`}>{nodes}</div>;\n}\n\n/*\n// byCities -> groupBy(visits, cities) '123': []\nЧелябинск, Россия, 3 визита в 2011 и 2012\n-> 20 августа 2011\n-> 20-21 июня 2012\n-> 31 июля-1 августа 2012\n\n// byCountries -> groupBy(visits, countries & cities) '1-123': []\n[Россия](/travel/:userAlias/countries/1)\n[Челябинск](/travel/:userAlias/cities/123), 3 визита в [2011](/travel/:userAlias/year/2011) и [2012](/travel/:userAlias/year/2012) [заметки](/travel/:userAlias/cities/123/story)\n-> 20 августа 2011 [заметки](/travel/:userAlias/visits/111/story)\n   до 5 фоток\n-> 20-21 июня 2012 [заметки](/travel/:userAlias/visits/222/story)\n   до 5 фоток\n-> 31 июля-1 августа 2012 [заметки](/travel/:userAlias/visits/333/story)\n   до 5 фоток\n\n// byYears -> groupBy(visits, years & cities) '2011-123': []\n2011\nЧелябинск, Россия\n-> 20 августа 2011\n\n2012\nЧелябинск, Россия, 2 визита\n-> 20-21 июня 2012\n-> 31 июля-1 августа 2012\n\n// byYearsAndCountries -> groupBy(visits, years & countries & cities)  '2011-1-123': []\n2011\nРоссия\nЧелябинск\n-> 20 августа 2011\n\n2012\nРоссия\nЧелябинск, 2 визита\n-> 20-21 июня 2012\n-> 31 июля-1 августа 2012\n\n// byCountriesAndYears -> groupBy(visits, countries & years & cities) 'c1-y2011-l123': []\nРоссия\n\n2011\nЧелябинск\n-> 20 августа 2011\n\n2012\nЧелябинск, 2 визита\n-> 20-21 июня 2012\n-> 31 июля-1 августа 2012\n\n*/\n","import { useSelector } from 'react-redux';\nimport max from 'lodash/max';\nimport min from 'lodash/min';\nimport sum from 'lodash/sum';\nimport mapValues from 'lodash/mapValues';\nimport { useProvision, selectDict } from 'core/connection';\nimport {\n  selectResult,\n  selectIsPending,\n  selectIsReady,\n  selectIsError,\n  selectError,\n  selectIsValid,\n  selectUpdatesCounter,\n} from 'core/connection/request/controllerRedux';\nimport useUser from './useUser';\nimport useCountries from './useCountries';\nimport useLocations from './useLocations';\n\nexport default function useTrips({ userAlias, tripsIds: requiredTripsIds }) {\n  const { tripsDict } = useSelector(state => ({\n    tripsDict: selectDict(state, 'trips') || {},\n  }));\n  const shouldRequireAllTrips = !requiredTripsIds;\n  const missingTripsIds =\n    !shouldRequireAllTrips &&\n    requiredTripsIds.filter(tripId => !tripsDict[tripId]);\n\n  return useProvision({\n    domain: `travel.trips-${userAlias}`,\n    isProvision: true,\n    modelName: 'trips',\n    observe: userAlias,\n    query: {\n      userAlias,\n      navigation: { isDisabled: true },\n      filter: shouldRequireAllTrips\n        ? {}\n        : { id: { comparator: 'in', value: missingTripsIds } },\n    },\n  });\n}\n\nexport function useTripsStats({ userAlias, tripsIds: requiredTripsIds }) {\n  const tripsProvision = useTrips({ userAlias, tripsIds: requiredTripsIds });\n  const { user: { locationsRating = {} } = {}, ...userProvision } = useUser({\n    domain: `travel.trips-${userAlias}.user`,\n    userAlias,\n  });\n\n  const { data: tripsIds = [] } = selectResult(tripsProvision) || {};\n\n  const {\n    tripsDict,\n    visitsDict,\n    ridesDict,\n    countriesDict,\n    locationsDict,\n  } = useSelector(state => ({\n    tripsDict: selectDict(state, 'trips') || {},\n    visitsDict: selectDict(state, 'visits') || {},\n    ridesDict: selectDict(state, 'rides') || {},\n    countriesDict: selectDict(state, 'countries') || {},\n    locationsDict: selectDict(state, 'locations') || {},\n  }));\n\n  const visitsIds = Array.from(\n    new Set(tripsIds.flatMap(tripsId => tripsDict[tripsId]?.visits || [])),\n  );\n\n  const ridesIds = Array.from(\n    new Set(tripsIds.flatMap(tripsId => tripsDict[tripsId]?.rides || [])),\n  );\n\n  const countriesIds = Array.from(\n    new Set(visitsIds.flatMap(visitId => visitsDict[visitId]?.countryId || [])),\n  );\n\n  const locationsIds = Array.from(\n    new Set(\n      visitsIds.flatMap(visitId => visitsDict[visitId]?.locationId || []),\n    ),\n  );\n\n  const countriesProvision = useCountries();\n  const locationsProvision = useLocations({\n    domain: `travel.locations-${userAlias}`,\n    locationsIds,\n  });\n\n  const commonProvisionState = mergeProvisionsState(\n    tripsProvision,\n    userProvision,\n    countriesProvision,\n    locationsProvision,\n  );\n\n  const { isError, isValid, isReady, isPending } = commonProvisionState;\n\n  const countriesRating = calcCountriesRating(\n    locationsIds,\n    locationsDict,\n    locationsRating,\n  );\n\n  return {\n    tripsProvision,\n    countriesProvision,\n    locationsProvision,\n\n    isError,\n    isValid,\n    isReady,\n    isPending,\n\n    tripsIds,\n    tripsDict,\n    visitsIds,\n    visitsDict,\n    ridesIds,\n    ridesDict,\n    ridesStats: calcRidesStats(ridesIds, ridesDict),\n    locationsIds,\n    locationsDict,\n    locationsRating,\n    countriesIds,\n    countriesDict,\n    countriesRating,\n  };\n}\n\nfunction mergeProvisionsState(...provisions) {\n  return {\n    updatesCounter: sum(provisions.map(selectUpdatesCounter)),\n    isReady: provisions.every(selectIsReady),\n    isPending: provisions.some(selectIsPending),\n    isValid: provisions.every(selectIsValid),\n    error: provisions.find(selectIsError),\n    errors: provisions.map(selectError).filter(Boolean),\n    invalidate: () => provisions.forEach(({ invalidate }) => invalidate()),\n  };\n}\n\nfunction calcRidesStats(ridesIds, ridesDict) {\n  return {\n    earliestDeparture: new Date(\n      min(\n        ridesIds.map(rideId => ridesDict[rideId]?.departureDateTime.getTime()),\n      ),\n    ),\n    latestArrival: new Date(\n      max(ridesIds.map(rideId => ridesDict[rideId]?.arrivalDateTime.getTime())),\n    ),\n  };\n}\n\nfunction calcCountriesRating(locationsIds, locationsDict, locationsRating) {\n  const ratingsGroupedByCountries = locationsIds.reduce((memo, locationId) => {\n    const location = locationsDict[locationId];\n    if (!location) {\n      return memo;\n    }\n    const locationRating = locationsRating[locationId];\n    const { countryId } = location;\n    if (!memo[countryId]) {\n      memo[countryId] = [];\n    }\n    memo[countryId].push(locationRating);\n    return memo;\n  }, {});\n\n  return mapValues(ratingsGroupedByCountries, ratingsByCountry =>\n    averageRating(ratingsByCountry),\n  );\n}\n\nfunction averageRating(ratings) {\n  if (!ratings.length) {\n    return Infinity;\n  }\n  const avg =\n    ratings.length / ratings.map(rating => 1 / rating).reduce((a, b) => a + b);\n\n  const best = max(ratings);\n\n  const lengthRatio = Math.log(ratings.length);\n\n  return 1 / (1 / avg + lengthRatio / best);\n}\n","import { useProvision } from 'core/connection';\nimport {\n  selectResult,\n  selectIsReady,\n  selectIsPending,\n  selectIsError,\n} from 'core/connection/request/controllerRedux';\n\nexport default function useCountries() {\n  const provision = useProvision({\n    domain: `travel.countries`,\n    isProvision: true,\n    modelName: 'countries',\n    query: { navigation: { isDisabled: true } },\n  });\n\n  const { data: countriesIds = [] } = selectResult(provision) || {};\n\n  return {\n    countriesIds,\n    isReady: selectIsReady(provision),\n    isLoading: selectIsPending(provision),\n    isError: selectIsError(provision),\n    counters: provision.counters,\n  };\n}\n","import { useSelector } from 'react-redux';\nimport { useProvision, selectItem } from 'core/connection';\n\nexport default function useUser({ domain, userAlias }) {\n  const user = useSelector(state => selectItem(state, 'users', userAlias));\n  const provision = useProvision({\n    domain,\n    applicableSchemaName: 'item',\n    isProvision: true,\n    modelName: 'users',\n    observe: userAlias,\n    condition: Boolean(userAlias),\n    query: {\n      id: userAlias,\n    },\n  });\n  return { ...provision, user };\n}\n","import { useSelector } from 'react-redux';\nimport {\n  useProvision,\n  useRequest,\n  selectDict,\n} from 'core/connection';\nimport {\n  selectIsPending,\n  selectIsError,\n  selectIsReady,\n} from 'core/connection/request/controllerRedux';\n\nexport default function useLocations({\n  domain,\n  locationsIds: requiredLocationIds,\n}) {\n  const locationsDict = useSelector(\n    state => selectDict(state, 'locations') || {},\n  );\n\n  const missingLocationsIds = requiredLocationIds.filter(\n    locationId => !locationsDict[locationId],\n  );\n\n  const provision = useProvision({\n    domain,\n    isProvision: true,\n    modelName: 'locations',\n    observe: requiredLocationIds,\n    condition: Boolean(missingLocationsIds.length),\n    query: {\n      filter: { id: { comparator: 'in', value: missingLocationsIds } },\n      navigation: { isDisabled: true },\n    },\n  });\n\n  return {\n    locationsDict,\n    isReady: selectIsReady(provision),\n    isLoading: selectIsPending(provision),\n    isError: selectIsError(provision),\n    counters: provision.counters,\n  };\n}\n\nexport function useLocationRatingRequest({ domain }) {\n  const [submitLocationRating, provision] = useRequest({\n    domain,\n    modelName: 'locations',\n    method: 'POST',\n  });\n\n  return {\n    ...provision,\n    submitLocationRating,\n  };\n}\n","import isSameDay from 'date-fns/isSameDay';\nimport isSameMonth from 'date-fns/isSameMonth';\nimport isSameYear from 'date-fns/isSameYear';\nimport dateFormat from 'date-fns/format';\nimport ru from 'date-fns/locale/ru';\n\nconst DATE_FORMATS = {\n  FULL: 'd MMMM yyyy',\n  DAY_MONTH: 'd MMMM',\n  DAY_ONLY: 'd',\n};\n\nfunction dateTimePeriodToString(periodStart, periodEnd) {\n  const periodEndString = dateFormat(periodEnd, DATE_FORMATS.FULL, {\n    locale: ru,\n  });\n\n  if (isSameDay(periodStart, periodEnd)) {\n    return periodEndString;\n  }\n\n  let periodStartString = '';\n  if (isSameMonth(periodStart, periodEnd)) {\n    periodStartString = dateFormat(periodStart, DATE_FORMATS.DAY_ONLY, {\n      locale: ru,\n    });\n  } else if (isSameYear(periodStart, periodEnd)) {\n    periodStartString = dateFormat(periodStart, DATE_FORMATS.DAY_MONTH, {\n      locale: ru,\n    });\n  } else {\n    periodStartString = dateFormat(periodStart, DATE_FORMATS.FULL, {\n      locale: ru,\n    });\n  }\n\n  return `${periodStartString}—${periodEndString}`;\n}\n\nexport function rideDateTimePeriodToString({\n  departureDateTime,\n  arrivalDateTime,\n}) {\n  return dateTimePeriodToString(departureDateTime, arrivalDateTime);\n}\n\nexport function visitDateTimePeriodToString({\n  departureDateTime,\n  arrivalDateTime,\n}) {\n  return dateTimePeriodToString(arrivalDateTime, departureDateTime);\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport HichHikingIcon from '@material-ui/icons/ThumbUp';\nimport { rideDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport { RIDE_TYPES } from 'travel/models/rides/consts';\nimport RideIcon from 'travel/components/models/rides/RideIcon';\n\nconst useStyles = makeStyles({\n  icon: { color: 'gray', fontSize: 16, height: 16 },\n  absoluteIcon: {\n    // todo fast decision, need refactor\n    color: 'gray',\n    fontSize: 16,\n    height: 16,\n    position: 'absolute',\n  },\n  detail: { color: 'gray', fontSize: 12 },\n});\n\nexport default function RideInfo({\n  ride,\n  ride: { rideType } = {},\n  className,\n  isLong,\n}) {\n  const classes = useStyles();\n\n  if (!ride) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      <RideIcon ride={ride} className={classes.icon} />\n      {rideType === RIDE_TYPES.HITCH_HIKING && (\n        <HichHikingIcon className={classes.absoluteIcon} />\n      )}\n      {isLong && rideDateTimePeriodToString(ride)}\n    </div>\n  );\n}\n","import React from 'react';\nimport BikeIcon from '@material-ui/icons/DirectionsBike';\nimport BoatIcon from '@material-ui/icons/DirectionsBoat';\nimport BusIcon from '@material-ui/icons/DirectionsBus';\nimport CarIcon from '@material-ui/icons/DirectionsCar';\nimport CustomTransportIcon from '@material-ui/icons/Commute';\nimport FlightIcon from '@material-ui/icons/Flight';\nimport MotorcycleIcon from '@material-ui/icons/Motorcycle';\nimport TerrainIcon from '@material-ui/icons/Terrain';\nimport TrainIcon from '@material-ui/icons/Train';\nimport TruckIcon from '@material-ui/icons/LocalShipping';\nimport VanIcon from '@material-ui/icons/AirportShuttle';\nimport WalkIcon from '@material-ui/icons/DirectionsWalk';\nimport TramIcon from '@material-ui/icons/Tram';\nimport LocalTaxiIcon from '@material-ui/icons/LocalTaxi';\nimport SubwayIcon from '@material-ui/icons/Subway';\nimport SeatIcon from '@material-ui/icons/AirlineSeatReclineNormal';\nimport UnknownRideIcon from '@material-ui/icons/NotListedLocation';\nimport { VEHICLE_TYPES } from 'travel/models/rides/consts';\n\nexport default function RideIcon({ ride: { vehicleType }, className }) {\n  const IconComponent = resolveRideIconComponent(vehicleType);\n  return <IconComponent className={className} />;\n}\n\nfunction resolveRideIconComponent(vehicleType) {\n  switch (vehicleType) {\n    case VEHICLE_TYPES.CAR:\n      return CarIcon;\n    case VEHICLE_TYPES.TRAIN:\n      return TrainIcon;\n    case VEHICLE_TYPES.AIRCRAFT:\n      return FlightIcon;\n    case VEHICLE_TYPES.BUS:\n    case VEHICLE_TYPES.TROLLEY:\n    case VEHICLE_TYPES.CITY_BUS:\n      return BusIcon;\n    case VEHICLE_TYPES.MOTORHOME:\n    case VEHICLE_TYPES.JITNEY:\n      return VanIcon;\n    case VEHICLE_TYPES.LOCAL_TRAIN:\n      return TrainIcon;\n    case VEHICLE_TYPES.FERRY:\n      return BoatIcon;\n    case VEHICLE_TYPES.BIKE:\n      return BikeIcon;\n    case VEHICLE_TYPES.BY_FEET:\n      return WalkIcon;\n    case VEHICLE_TYPES.MOTORBIKE:\n      return MotorcycleIcon;\n    case VEHICLE_TYPES.TRUCK:\n      return TruckIcon;\n    case VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:\n      return TerrainIcon;\n    case VEHICLE_TYPES.TRAM:\n      return TramIcon;\n    case VEHICLE_TYPES.TAXI:\n      return LocalTaxiIcon;\n    case VEHICLE_TYPES.SUBWAY:\n      return SubwayIcon;\n    case VEHICLE_TYPES.PUBLIC_TRANSPORT:\n      return SeatIcon;\n    case VEHICLE_TYPES.ROPEWAY:\n    case VEHICLE_TYPES.FUNICULAR:\n      return CustomTransportIcon;\n    default:\n      return UnknownRideIcon;\n  }\n}\n","import { useMemo, useEffect, useRef } from 'react';\nimport isEqual from 'lodash/isEqual';\n\nconst createControlledPromise = () => {\n  // This fields will be initialized synchronously in promise constructor\n  let resolver = null;\n  let rejector = null;\n\n  const promise = new Promise((resolve, reject) => {\n    resolver = resolve;\n    rejector = reject;\n  });\n  return { promise, resolver, rejector };\n};\n\nexport default markersCoords => {\n  const { promise: apiPromise, resolver: handleGoogleApiLoaded } = useMemo(\n    createControlledPromise,\n    [],\n  );\n\n  const previousCoords = useRef(null);\n  const changesCount = useRef(0);\n\n  useEffect(() => {\n    if (!isEqual(previousCoords, markersCoords)) {\n      changesCount.current += 1;\n    }\n  });\n\n  useEffect(\n    () => {\n      let markers = [];\n      apiPromise.then(api => {\n        const { map, maps } = api;\n        const bounds = new maps.LatLngBounds();\n        markers = markersCoords.map(({ lat, lon }) => {\n          const marker = new maps.Marker({ position: { lat, lng: lon }, map });\n          bounds.extend(marker.position);\n          return marker;\n        });\n        map.fitBounds(bounds);\n        const zoom = map.getZoom();\n        if (zoom > 11) {\n          map.setZoom(11);\n        }\n      });\n      return () => markers.forEach(marker => marker.setMap(null));\n    },\n    [changesCount.current],\n  );\n  return { handleGoogleApiLoaded };\n};\n","/* globals __GOOGLE_MAP_API_KEY__ */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport GoogleMapReact from 'google-map-react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport locationPropTypes from 'travel/models/locations/propTypes';\nimport useMarkers from './useMarkers';\n\nconst useStyles = makeStyles({\n  googleMapContainer: {\n    margin: '12px 0',\n    maxWidth: '100%',\n    height: ({ height }) => height,\n    maxHeight: '100%',\n  },\n});\n\nexport default function LocationsMap({ locationsDict, locationsIds, height }) {\n  const classes = useStyles({ height });\n\n  const { handleGoogleApiLoaded } = useMarkers(\n    locationsIds.map(\n      locationIdToShowMarker => locationsDict[locationIdToShowMarker],\n    ),\n  );\n\n  return (\n    <div className={classes.googleMapContainer}>\n      <GoogleMapReact\n        bootstrapURLKeys={{ key: __GOOGLE_MAP_API_KEY__ }}\n        center={{ lat: 0, lng: 0 }}\n        zoom={11}\n        onGoogleApiLoaded={handleGoogleApiLoaded}\n      />\n    </div>\n  );\n}\n\nLocationsMap.propTypes = {\n  locationsDict: PropTypes.objectOf(PropTypes.shape(locationPropTypes))\n    .isRequired,\n  locationsIds: PropTypes.arrayOf(PropTypes.number).isRequired,\n  height: PropTypes.string,\n};\n\nLocationsMap.defaultProps = {\n  height: '400px',\n};\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport capitalize from '../utils/capitalize';\nimport withStyles from '../styles/withStyles';\nimport { elementTypeAcceptingRef } from '@material-ui/utils';\nimport { useIsFocusVisible } from '../utils/focusVisible';\nimport useForkRef from '../utils/useForkRef';\nimport Typography from '../Typography';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {},\n\n  /* Styles applied to the root element if `underline=\"none\"`. */\n  underlineNone: {\n    textDecoration: 'none'\n  },\n\n  /* Styles applied to the root element if `underline=\"hover\"`. */\n  underlineHover: {\n    textDecoration: 'none',\n    '&:hover': {\n      textDecoration: 'underline'\n    }\n  },\n\n  /* Styles applied to the root element if `underline=\"always\"`. */\n  underlineAlways: {\n    textDecoration: 'underline'\n  },\n  // Same reset as ButtonBase.root\n\n  /* Styles applied to the root element if `component=\"button\"`. */\n  button: {\n    position: 'relative',\n    WebkitTapHighlightColor: 'transparent',\n    backgroundColor: 'transparent',\n    // Reset default value\n    // We disable the focus ring for mouse, touch and keyboard users.\n    outline: 0,\n    border: 0,\n    margin: 0,\n    // Remove the margin in Safari\n    borderRadius: 0,\n    padding: 0,\n    // Remove the padding in Firefox\n    cursor: 'pointer',\n    userSelect: 'none',\n    verticalAlign: 'middle',\n    '-moz-appearance': 'none',\n    // Reset\n    '-webkit-appearance': 'none',\n    // Reset\n    '&::-moz-focus-inner': {\n      borderStyle: 'none' // Remove Firefox dotted outline.\n\n    },\n    '&$focusVisible': {\n      outline: 'auto'\n    }\n  },\n\n  /* Pseudo-class applied to the root element if the link is keyboard focused. */\n  focusVisible: {}\n};\nvar Link = React.forwardRef(function Link(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      _props$color = props.color,\n      color = _props$color === void 0 ? 'primary' : _props$color,\n      _props$component = props.component,\n      component = _props$component === void 0 ? 'a' : _props$component,\n      onBlur = props.onBlur,\n      onFocus = props.onFocus,\n      TypographyClasses = props.TypographyClasses,\n      _props$underline = props.underline,\n      underline = _props$underline === void 0 ? 'hover' : _props$underline,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'inherit' : _props$variant,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\", \"color\", \"component\", \"onBlur\", \"onFocus\", \"TypographyClasses\", \"underline\", \"variant\"]);\n\n  var _useIsFocusVisible = useIsFocusVisible(),\n      isFocusVisible = _useIsFocusVisible.isFocusVisible,\n      onBlurVisible = _useIsFocusVisible.onBlurVisible,\n      focusVisibleRef = _useIsFocusVisible.ref;\n\n  var _React$useState = React.useState(false),\n      focusVisible = _React$useState[0],\n      setFocusVisible = _React$useState[1];\n\n  var handlerRef = useForkRef(ref, focusVisibleRef);\n\n  var handleBlur = function handleBlur(event) {\n    if (focusVisible) {\n      onBlurVisible();\n      setFocusVisible(false);\n    }\n\n    if (onBlur) {\n      onBlur(event);\n    }\n  };\n\n  var handleFocus = function handleFocus(event) {\n    if (isFocusVisible(event)) {\n      setFocusVisible(true);\n    }\n\n    if (onFocus) {\n      onFocus(event);\n    }\n  };\n\n  return React.createElement(Typography, _extends({\n    className: clsx(classes.root, classes[\"underline\".concat(capitalize(underline))], className, focusVisible && classes.focusVisible, component === 'button' && classes.button),\n    classes: TypographyClasses,\n    color: color,\n    component: component,\n    onBlur: handleBlur,\n    onFocus: handleFocus,\n    ref: handlerRef,\n    variant: variant\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? Link.propTypes = {\n  /**\n   * The content of the link.\n   */\n  children: PropTypes.node.isRequired,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object.isRequired,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * The color of the link.\n   */\n  color: PropTypes.oneOf(['default', 'error', 'inherit', 'primary', 'secondary', 'textPrimary', 'textSecondary']),\n\n  /**\n   * The component used for the root node.\n   * Either a string to use a DOM element or a component.\n   */\n  component: elementTypeAcceptingRef,\n\n  /**\n   * @ignore\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * @ignore\n   */\n  onFocus: PropTypes.func,\n\n  /**\n   * `classes` prop applied to the [`Typography`](/api/typography/) element.\n   */\n  TypographyClasses: PropTypes.object,\n\n  /**\n   * Controls when the link should have an underline.\n   */\n  underline: PropTypes.oneOf(['none', 'hover', 'always']),\n\n  /**\n   * Applies the theme typography styles.\n   */\n  variant: PropTypes.string\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiLink'\n})(Link);"],"sourceRoot":""}