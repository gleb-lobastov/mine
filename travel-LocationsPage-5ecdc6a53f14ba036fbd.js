(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1082:function(e,t,n){"use strict";n.r(t);var r,i=n(0),a=n.n(i),o=n(2),c=n.n(o),u=n(782),s=n(130),l=n(867),d=n(1063),O=n(1085),f=n(1080),v=n(1066),b=n(277);function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=(p(r={},b.LOCATION_RATING.PLACE_TO_LIVE,"Жил бы здесь"),p(r,b.LOCATION_RATING.FEW_PER_YEAR,"Несколько раз в год"),p(r,b.LOCATION_RATING.ONCE_PER_YEAR,"Раз в год"),p(r,b.LOCATION_RATING.ONCE_PER_TWO_YEARS,"Раз в пару лет"),p(r,b.LOCATION_RATING.ONCE_PER_FIVE_YEARS,"Раз в пять лет"),p(r,b.LOCATION_RATING.ONCE_PER_DECADE,"Раз в десятилетие"),p(r,b.LOCATION_RATING.TWICE_PER_LIVE,"Пару раз в жизни"),p(r,b.LOCATION_RATING.ONCE_PER_LIVE,"Раз в жизни"),p(r,b.LOCATION_RATING.NEVER,"Никогда"),r),m=Object(u.a)({formControl:{width:"100%"}});function g(e){var t=e.locationId,n=e.locationRating,r=e.isEditable,i=e.onSubmitLocationRating,o=m();return r?a.a.createElement(d.a,{className:o.formControl},a.a.createElement(O.a,{shrink:!0,id:"select-location-rating-label"},"Я бы ездил сюда"),a.a.createElement(f.a,{labelId:"select-location-rating-label",id:"select-location-rating",value:n,onChange:function(e){i(e,t,e.target.value)}},a.a.createElement(v.a,{value:b.LOCATION_RATING.PLACE_TO_LIVE},E[b.LOCATION_RATING.PLACE_TO_LIVE]),a.a.createElement(v.a,{value:b.LOCATION_RATING.FEW_PER_YEAR},E[b.LOCATION_RATING.FEW_PER_YEAR]),a.a.createElement(v.a,{value:b.LOCATION_RATING.ONCE_PER_YEAR},E[b.LOCATION_RATING.ONCE_PER_YEAR]),a.a.createElement(v.a,{value:b.LOCATION_RATING.ONCE_PER_TWO_YEARS},E[b.LOCATION_RATING.ONCE_PER_TWO_YEARS]),a.a.createElement(v.a,{value:b.LOCATION_RATING.ONCE_PER_FIVE_YEARS},E[b.LOCATION_RATING.ONCE_PER_FIVE_YEARS]),a.a.createElement(v.a,{value:b.LOCATION_RATING.ONCE_PER_DECADE},E[b.LOCATION_RATING.ONCE_PER_DECADE]),a.a.createElement(v.a,{value:b.LOCATION_RATING.TWICE_PER_LIVE},E[b.LOCATION_RATING.TWICE_PER_LIVE]),a.a.createElement(v.a,{value:b.LOCATION_RATING.ONCE_PER_LIVE},E[b.LOCATION_RATING.ONCE_PER_LIVE]),a.a.createElement(v.a,{value:b.LOCATION_RATING.NEVER},E[b.LOCATION_RATING.NEVER]))):a.a.createElement("div",null,E[n])}g.propTypes={locationRating:c.a.number,locationId:c.a.number.isRequired,isEditable:c.a.bool.isRequired,onSubmitLocationRating:c.a.func.isRequired},g.defaultProps={locationRating:null};n(798);var I=n(794),A=n(799);n.d(t,"default",(function(){return N}));var R=Object(u.a)({container:{fontSize:"16px",lineHeight:"1.5"},visitContainer:{margin:"20px 0"},location:{fontWeight:"bold",fontSize:"21px"},googleMapContainer:{margin:"12px 0",width:"800px",maxWidth:"100%",height:"400px",maxHeight:"100%"}});function N(e){var t=e.match.params,n=t.userAlias,r=t.strLocationId,o=R(),c=Object(s.c)(),u=c.isAuthenticated,d=c.userAlias,O=function(e){var t=e.domain,n=e.userAlias,r=Object(I.a)({userAlias:n}),i=r.isError,a=r.isPending,o=r.locationsDict,c=r.locationsIds;return{isError:i,isPending:a,locationsDict:o,locationsIds:void 0===c?[]:c,locationsRating:r.locationsRating,submitLocationRating:Object(A.b)({domain:t}).submitLocationRating}}({domain:"travel.LocationsPage",userAlias:n}),f=O.isError,v=O.isPending,b=O.locationsDict,p=O.locationsIds,E=O.locationsRating,m=O.submitLocationRating,N=parseInt(r,10),_=N?[N]:p,j=Object(i.useCallback)((function(e,t,n){m({query:{rating:n,id:String(t)},condition:Boolean(t)})}));if(f)return a.a.createElement("div",null,"...Error");if(v)return a.a.createElement("div",null,"...Loading");if(N&&!p.includes(N))return a.a.createElement("div",null,"Путешественик ".concat(n," еще не посетил данную локацию"));var T=u&&d===n;return a.a.createElement("div",{className:o.container},a.a.createElement(l.a,{locationsDict:b,locationsIds:_}),_.map((function(e){var t=b[e];if(!t)return null;var n=t.locationName;return a.a.createElement(a.a.Fragment,{key:e},a.a.createElement("h1",{className:o.location},n),a.a.createElement(g,{locationId:e,locationRating:E[e],isEditable:T,onSubmitLocationRating:j}))})))}N.propTypes={match:c.a.shape({params:c.a.shape({userAlias:c.a.string.isRequired,strLocationId:c.a.string}).isRequired}).isRequired}},794:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(62),i=n(809),a=n.n(i),o=n(811),c=n.n(o),u=n(803),s=n.n(u),l=n(149),d=n.n(l),O=n(146),f=n(10),v=n(798),b=n(795),p=n(799);function E(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function m(e){var t=e.userAlias,n=function(e){var t=e.userAlias,n=e.tripsIds,i=Object(r.d)((function(e){return{tripsDict:Object(O.d)(e,"trips")||{}}})).tripsDict,a=!n,o=!a&&n.filter((function(e){return!i[e]}));return Object(O.g)({domain:"travel.trips-".concat(t),isProvision:!0,modelName:"trips",observe:t,query:{userAlias:t,navigation:{isDisabled:!0},filter:a?{}:{id:{comparator:"in",value:o}}}})}({userAlias:t,tripsIds:e.tripsIds}),i=Object(v.a)({domain:"travel.trips-".concat(t,".user"),userAlias:t}),o=i.user,c=(o=void 0===o?{}:o).locationsRating,u=void 0===c?{}:c,l=E(i,["user"]),m=(Object(f.o)(n)||{}).data,I=void 0===m?[]:m,A=Object(r.d)((function(e){return{tripsDict:Object(O.d)(e,"trips")||{},visitsDict:Object(O.d)(e,"visits")||{},ridesDict:Object(O.d)(e,"rides")||{},countriesDict:Object(O.d)(e,"countries")||{},locationsDict:Object(O.d)(e,"locations")||{}}})),R=A.tripsDict,N=A.visitsDict,_=A.ridesDict,j=A.countriesDict,T=A.locationsDict,y=Array.from(new Set(I.flatMap((function(e){var t;return(null===(t=R[e])||void 0===t?void 0:t.visits)||[]})))),h=Array.from(new Set(I.flatMap((function(e){var t;return(null===(t=R[e])||void 0===t?void 0:t.rides)||[]})))),P=Array.from(new Set(y.flatMap((function(e){var t;return(null===(t=N[e])||void 0===t?void 0:t.countryId)||[]})))),C=Array.from(new Set(y.flatMap((function(e){var t;return(null===(t=N[e])||void 0===t?void 0:t.locationId)||[]})))),L=Object(b.a)(),D=Object(p.a)({domain:"travel.locations-".concat(t),locationsIds:C}),w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{updatesCounter:s()(t.map(f.p)),isReady:t.every(f.i),isPending:t.some(f.h),isValid:t.every(f.k),error:t.find(f.g),errors:t.map(f.f).filter(Boolean),invalidate:function(){return t.forEach((function(e){return(0,e.invalidate)()}))}}}(n,l,L,D),G=w.isError,S=w.isValid,V=w.isReady,x=w.isPending,q=function(e,t,n){var r=e.reduce((function(e,r){var i=t[r];if(!i)return e;var a=n[r],o=i.countryId;return e[o]||(e[o]=[]),e[o].push(a),e}),{});return d()(r,(function(e){return function(e){if(!e.length)return 1/0;var t=e.length/e.map((function(e){return 1/e})).reduce((function(e,t){return e+t})),n=a()(e),r=Math.log(e.length);return 1/(1/t+r/n)}(e)}))}(C,T,u);return{tripsProvision:n,countriesProvision:L,locationsProvision:D,isError:G,isValid:S,isReady:V,isPending:x,tripsIds:I,tripsDict:R,visitsIds:y,visitsDict:N,ridesIds:h,ridesDict:_,ridesStats:g(h,_),locationsIds:C,locationsDict:T,locationsRating:u,countriesIds:P,countriesDict:j,countriesRating:q}}function g(e,t){return{earliestDeparture:new Date(c()(e.map((function(e){var n;return null===(n=t[e])||void 0===n?void 0:n.departureDateTime.getTime()})))),latestArrival:new Date(a()(e.map((function(e){var n;return null===(n=t[e])||void 0===n?void 0:n.arrivalDateTime.getTime()}))))}}},795:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(146),i=n(10);function a(){var e=Object(r.g)({domain:"travel.countries",isProvision:!0,modelName:"countries",query:{navigation:{isDisabled:!0}}}),t=(Object(i.o)(e)||{}).data;return{countriesIds:void 0===t?[]:t,isReady:Object(i.i)(e),isLoading:Object(i.h)(e),isError:Object(i.g)(e),counters:e.counters}}},798:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(62),i=n(146);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){var t=e.domain,n=e.userAlias,c=Object(r.d)((function(e){return Object(i.e)(e,"users",n)}));return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(i.g)({domain:t,applicableSchemaName:"item",isProvision:!0,modelName:"users",observe:n,condition:Boolean(n),query:{id:n}}),{user:c})}},799:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(62),i=n(146),a=n(10);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){var t=e.domain,n=e.locationsIds,o=Object(r.d)((function(e){return Object(i.d)(e,"locations")||{}})),c=n.filter((function(e){return!o[e]})),u=Object(i.g)({domain:t,isProvision:!0,modelName:"locations",observe:n,condition:Boolean(c.length),query:{filter:{id:{comparator:"in",value:c}},navigation:{isDisabled:!0}}});return{locationsDict:o,isReady:Object(a.i)(u),isLoading:Object(a.h)(u),isError:Object(a.g)(u),counters:u.counters}}function l(e){var t=e.domain,n=u(Object(i.h)({domain:t,modelName:"locations",method:"POST"}),2),r=n[0];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n[1],{submitLocationRating:r})}},867:function(e,t,n){"use strict";var r=n(0),i=n.n(r),a=n(2),o=n.n(a),c=n(881),u=n.n(c),s=n(782),l=n(276),d=n(312),O=n.n(d),f=function(){var e=null,t=null;return{promise:new Promise((function(n,r){e=n,t=r})),resolver:e,rejector:t}};n.d(t,"a",(function(){return b}));var v=Object(s.a)({googleMapContainer:{margin:"12px 0",maxWidth:"100%",height:function(e){return e.height},maxHeight:"100%"}});function b(e){var t=e.locationsDict,n=e.locationsIds,a=e.height,o=v({height:a}),c=function(e){var t=Object(r.useMemo)(f,[]),n=t.promise,i=t.resolver,a=Object(r.useRef)(null),o=Object(r.useRef)(0);return Object(r.useEffect)((function(){O()(a,e)||(o.current+=1)})),Object(r.useEffect)((function(){var t=[];return n.then((function(n){var r=n.map,i=n.maps,a=new i.LatLngBounds;t=e.map((function(e){var t=e.lat,n=e.lon,o=new i.Marker({position:{lat:t,lng:n},map:r});return a.extend(o.position),o})),r.fitBounds(a),r.getZoom()>11&&r.setZoom(11)})),function(){return t.forEach((function(e){return e.setMap(null)}))}}),[o.current]),{handleGoogleApiLoaded:i}}(n.map((function(e){return t[e]}))).handleGoogleApiLoaded;return i.a.createElement("div",{className:o.googleMapContainer},i.a.createElement(u.a,{bootstrapURLKeys:{key:"AIzaSyCvP0e64ui7WpXKBdzOyEmkb4l5RuGy3Zs"},center:{lat:0,lng:0},zoom:11,onGoogleApiLoaded:c}))}b.propTypes={locationsDict:o.a.objectOf(o.a.shape(l.default)).isRequired,locationsIds:o.a.arrayOf(o.a.number).isRequired,height:o.a.string},b.defaultProps={height:"400px"}}}]);
//# sourceMappingURL=travel-LocationsPage-5ecdc6a53f14ba036fbd.js.map