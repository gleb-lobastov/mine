(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1007:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(1),o=a.n(i),l=a(33),s=a(242),c=a.n(s),u=a(908),d=a(120),p=a(112),m=a(736),f=a(19),v=a(100),b=a(761),E=a(1015),g=a(1e3),y=a(998),h=a(999),O=a(997),I=a(160),S=a(105),R=a(13),T=a(1010),P=a(1018),C=a(994),j=a(1022),V=a(1008),N=function(e){var t=e.caption,a=e.classes,n=e.hasNullOption,i=e.inputId,o=e.name,l=e.onChange,s=e.optionRender,c=e.options,u=e.value;return r.a.createElement("div",{className:a.container},r.a.createElement(P.a,{component:"label",shrink:!0,htmlFor:i},t),r.a.createElement(V.a,{name:o,value:u,displayEmpty:!0,onChange:l,input:r.a.createElement(C.a,{id:i}),className:a.selectRoot},n&&r.a.createElement(j.a,{key:null,value:null},s({option:null,index:-1,options:c})),c.map(function(e,t){return r.a.createElement(j.a,{key:e,value:e},s({option:e,index:t,options:c}))})))},w=o.a.oneOfType([o.a.number,o.a.string]);N.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(w),value:w},N.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var L=Object(R.a)({container:{display:"inline-block",flexGrow:"1",flexBasis:"0"},selectRoot:{display:"block"}})(N),D=a(973),A=a(996),_=a(726),q=function(e){var t=e.inputValue,a=e.sourceProps,n=(a=void 0===a?{}:a).suggestions,i=void 0===n?[]:n,o=e.children,l=t.toLowerCase();return r.a.createElement(r.a.Fragment,null,o(i.filter(function(e){return e.label.toLowerCase().includes(l)})))};q.propTypes={inputValue:o.a.string.isRequired,sourceProps:o.a.shape({suggestions:o.a.array}).isRequired,children:o.a.func.isRequired};var Y=q;function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){k(e,t,a[t])})}return e}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function U(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var F=function(e){var t=e.inputProps,a=e.classes,n=e.ref,i=U(e,["inputProps","classes","ref"]);return r.a.createElement(T.a,H({InputProps:x({inputRef:n,classes:{root:a.inputRoot,input:a.inputInput}},t)},i))},M=a(995);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var G=function(e){var t=e.itemProps,a=e.isHighlighted,n=e.isSelected,i=e.children,o=i.label,l=i.details;return r.a.createElement(j.a,B({},t,{selected:a,component:"div",style:{fontWeight:n?500:400}}),r.a.createElement(M.a,{primary:o,secondary:l}))};G.propTypes={itemProps:o.a.object,isHighlighted:o.a.bool,isSelected:o.a.bool,children:o.a.func.isRequired},G.defaultProps={itemProps:void 0,isHighlighted:!1,isSelected:!1};var W=G;function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function K(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function J(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var $=Object(A.a)(function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}}),X=function(e){return(e||{}).label},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.SuggestionsResolver,a=void 0===t?Y:t,n=e.SuggestionItemComponent,i=void 0===n?W:n,o=e.InputComponent,l=void 0===o?F:o;return function(e){var t=e.classes,n=e.sourceProps,o=e.inputProps,s=e.inputFieldProps,c=J(e,["classes","sourceProps","inputProps","inputFieldProps"]),u=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){K(e,t,a[t])})}return e}({},$(),t);return r.a.createElement("div",{className:u.root},r.a.createElement(D.a,z({itemToString:X},c),function(e){var t=e.getInputProps,c=e.getItemProps,d=e.getMenuProps,p=e.highlightedIndex,m=e.inputValue,f=e.isOpen,v=e.selectedItem;return r.a.createElement("div",{className:u.container},r.a.createElement(l,z({fullWidth:!0,classes:u,inputProps:t(o)},s)),r.a.createElement("div",d(),f&&r.a.createElement(_.a,{className:u.paper,square:!0},r.a.createElement(a,{inputValue:m,sourceProps:n},function(e){return e.map(function(e,t){return r.a.createElement(i,{key:e.label,itemProps:c({item:e}),isHighlighted:p===t,isSelected:Boolean(v)&&v.label===e.label},e)})}))))}))}};Q();function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ee,te="FILTER",ae="SEARCH",ne=function(e){var t=e.queryFormat,a=e.filterField,n=e.inputValue,r={pageSize:e.numberOfItemsToRequest};switch(t){case ae:return{navigation:r,search:n};case te:default:return{navigation:r,filter:Z({},a,{comparator:"~",value:"%".concat(n,"%")})}}},re=Q({SuggestionsResolver:Object(m.a)(function(e,t){var a=t.inputValue,n=t.sourceProps,r=n.modelName,i=n.domain,o=n.filterField,l=n.numberOfItemsToRequest,s=n.queryFormat;return{domain:i,identity:a,request:{entities:{modelName:r,observe:a,query:ne({queryFormat:s,filterField:o,inputValue:a,numberOfItemsToRequest:l})}},debounceRequest:500}})(function(e){var t=e.sourceProps,a=(t=void 0===t?{}:t).filterField,n=t.resolveDetails,r=t.convertEntityToSuggestion,i=void 0===r?function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Z(e,t,a[t])})}return e}({},e,{label:e[a],details:n?n(e):void 0})}:r,o=e.entities,l=(o=void 0===o?{}:o).data,s=void 0===l?[]:l;return(0,e.children)((s||[]).map(i))})}),ie=a(165);function oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var le=(oe(ee={},ie.TRIP_TYPES.LEISURE,"Отдых"),oe(ee,ie.TRIP_TYPES.BUSINESS,"Работа"),oe(ee,ie.TRIP_TYPES.MIXED,"Смешанный"),oe(ee,ie.TRIP_TYPES.RELOCATION,"Переезд"),oe(ee,ie.TRIP_TYPES.OTHER,"Другой"),ee);function se(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.option;return t?le[t]:"Не указан"},de=function(e){var t=e.tripName,a=e.tripType,r=e.originLocationId,i=e.originGeonameId,o=ce(Object(n.useState)({tripName:t,tripType:a,originLocationId:r,originGeonameId:i}),2),l=o[0],s=o[1];return{tripState:l,setTripState:function(e){return s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){se(e,t,a[t])})}return e}({},l,e))}}},pe=function(e){var t=e.classes,a=e.locationsDict,i=e.tripState,o=i.tripType,l=i.tripName,s=i.originLocationId,c=e.setTripState,u=Object(n.useCallback)(function(e){var t=e.target.value;return c({tripName:t})},[c]),d=Object(n.useCallback)(function(e){var t=e.target.value;return c({tripType:t})},[c]),p=Object(n.useCallback)(function(e){var t=e.geonameId;return c({originGeonameId:t})},[c]),m=(a[s]||{}).locationName;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{fullWidth:!0,label:"Название поездки",value:l,onChange:u})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(re,{classes:{root:t.suggest},textFieldProps:{label:"Старт из"},initialInputValue:m,inputProps:{placeholder:"Пункт отправления..."},onChange:p,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"tripEditCard.geoname",queryFormat:ae,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{caption:"Тип поездки",inputId:"TripEditCard-TripTypeOptions",onChange:d,optionRender:ue,options:Object.values(ie.TRIP_TYPES),hasNullOption:!0,value:o})))};pe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},pe.defaultProps={className:void 0};var me=c()(Object(S.b)(function(e){return{locationsDict:Object(p.d)(e,"locations")}}),Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}}))(pe);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ve=function(e){var t=e.initialState,a=e.children,n=e.onSubmit,i=de(t),o=i.tripState,l=i.setTripState,s=fe(r.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return r.a.createElement(r.a.Fragment,null,r.a.cloneElement(a,{onClick:function(){return d(!0)}}),c&&r.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},"Поездка"),r.a.createElement(y.a,null,r.a.createElement(h.a,null,"Редактирование поездки"),r.a.createElement(me,{tripState:o,setTripState:l})),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:function(){n(o),p()},color:"primary"},"Сохранить"))))};ve.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},ve.defaultProps={};var be=ve,Ee=a(163),ge=a(768),ye=a(166),he=a(161),Oe=a(162),Ie=a(909),Se=a(1001),Re=a(334),Te=a.n(Re),Pe=a(804),Ce=a.n(Pe),je=function(e){for(var t=e.target;t;){if(t.dataset&&"enabled"===t.dataset.sortHandler)return!1;t=t.parentNode}return!0};function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ne=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},we=a(286),Le=function(e){var t=e.location,a=t.locationId,n=t.locationName,i=void 0===n?"unknown":n,o=e.locationPath,l=e.Icon,s=e.classes,c=o?r.a.createElement(Oe.b,{to:o.toUrl({strLocationId:String(a)})},i):i;return r.a.createElement("div",{className:s.container},l&&r.a.createElement(l,{className:s.icon}),c)};Le.propTypes={classes:o.a.objectOf(o.a.string).isRequired,location:o.a.shape(Ee.default),Icon:we.a,locationPath:f.d},Le.defaultProps={location:{},Icon:void 0,locationPath:void 0};var De,Ae=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"}})(Le),_e=a(763),qe=a.n(_e),Ye=a(912),He=a.n(Ye),xe=a(910),ke=a.n(xe),Ue=a(803),Fe=a.n(Ue),Me=a(911),Be=a.n(Me),Ge=a(164);function We(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ze=(We(De={},Ge.VISIT_TYPES.TRANSIT,"Транзит"),We(De,Ge.VISIT_TYPES.REGULAR,"Посещение"),We(De,Ge.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),We(De,Ge.VISIT_TYPES.RELOCATION,"Переезд"),De);function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $e=function(e){var t=e.option;return t?ze[t]:"Не указан"},Xe=function(e){var t=e.visitType,a=e.visitComment,r=e.locationId,i=e.locationName,o=e.geonameId,l=Je(Object(n.useState)({visitComment:a,visitType:t,locationId:r,locationName:i,geonameId:o}),2),s=l[0],c=l[1];return{visitState:s,setVisitState:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Ke(e,t,a[t])})}return e}({},s,e))}}},Qe=function(e){var t=e.classes,a=e.visitState,i=a.visitType,o=a.visitComment,l=a.locationName,s=e.setVisitState,c=Object(n.useCallback)(function(e){var t=e.target.value;return s({visitType:t})},[s]),u=Object(n.useCallback)(function(e){var t=e.geonameId;return s({geonameId:t})},[s]),d=Object(n.useCallback)(function(e){var t=e.target.value;return s({visitComment:t})},[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(re,{classes:{root:t.suggest},textFieldProps:{label:"Место посещения"},initialInputValue:l,inputProps:{placeholder:"Населенный пункт..."},onChange:u,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"visitEditCard.geoname",queryFormat:ae,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",onChange:c,optionRender:$e,options:Object.values(Ge.VISIT_TYPES),hasNullOption:!0,value:i})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{label:"Комментарий",fullWidth:!0,value:o,onChange:d,multiline:!0,rows:1,rowsMax:12})))};Qe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Qe.defaultProps={className:void 0};var Ze=Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}})(Qe);function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tt=function(e){var t=e.initialState,a=e.children,n=e.onSubmit,i=Xe(t),o=i.visitState,l=i.setVisitState,s=et(r.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return r.a.createElement(r.a.Fragment,null,r.a.cloneElement(a,{onClick:function(){return d(!0)}}),c&&r.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},"Посещение"),r.a.createElement(y.a,null,r.a.createElement(h.a,null,"Редактирование посещения"),r.a.createElement(Ze,{visitState:o,setVisitState:l})),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:function(){n(o),p()},color:"primary"},"Сохранить"))))};tt.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},tt.defaultProps={};var at=tt;function nt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var rt=function(e){var t=e.visit,a=e.onVisitUpdate,n=e.classes,i=e.isEditable,o=e.locationPath;if(!t)return"Не указано";var l=t.locationName,s=t.visitType,c=t.locationId,u=function(e){switch(e){case"Transit":return ke.a;case"BaseCamp":return Be.a;case"Relocation":return Fe.a;case"Regular":default:return He.a}}(s);return r.a.createElement("div",{className:n.container},u&&r.a.createElement(u,{className:n.icon}),r.a.createElement(Oe.b,{to:o.toUrl({strLocationId:String(c)})},l),i&&r.a.createElement(at,{initialState:t,onSubmit:function(e){return a(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){nt(e,t,a[t])})}return e}({},t,e))}},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement(Ce.a,{className:n.editIcon}))))};rt.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isEditable:o.a.bool,onVisitUpdate:o.a.func.isRequired,visit:o.a.shape(he.default),locationPath:f.d.isRequired},rt.defaultProps={isEditable:!1,visit:{}};var it=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}})(rt),ot=a(926),lt=a.n(ot),st=a(925),ct=a.n(st),ut=a(923),dt=a.n(ut),pt=a(920),mt=a.n(pt),ft=a(934),vt=a.n(ft),bt=a(922),Et=a.n(bt),gt=a(928),yt=a.n(gt),ht=a(929),Ot=a.n(ht),It=a(921),St=a.n(It),Rt=a(924),Tt=a.n(Rt),Pt=a(927),Ct=a.n(Pt),jt=a(930),Vt=a.n(jt),Nt=a(931),wt=a.n(Nt),Lt=a(932),Dt=a.n(Lt),At=a(933),_t=a.n(At),qt=a(936),Yt=a.n(qt),Ht=a(935),xt=a.n(Ht),kt=a(68),Ut=a(227),Ft=a(972);function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Bt(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Gt=function(e){var t=e.children,a=e.description,n=e.onReject,i=e.onSubmit,o=e.title,l=Bt(e,["children","description","onReject","onSubmit","title"]);return r.a.createElement(Ft.a,Mt({},l,{onSubmit:i}),function(e){var i=e.handleSubmit,l=Bt(e,["handleSubmit"]);return r.a.createElement(E.a,{transitionDuration:500,open:!0,onClose:n,"aria-labelledby":"form-dialog-title"},r.a.createElement(O.a,{id:"form-dialog-title"},o),r.a.createElement(y.a,null,r.a.createElement(h.a,null,a),r.a.cloneElement(t,l)),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:n,color:"secondary"},"Отмена"),r.a.createElement(u.a,{onClick:i,color:"primary"},"Сохранить")))})};Gt.propTypes={children:o.a.node.isRequired,description:o.a.node,onReject:o.a.func.isRequired,onSubmit:o.a.func.isRequired,title:o.a.node},Gt.defaultProps={description:void 0,title:void 0};var Wt=Gt,zt=a(1003),Kt=a(1011),Jt=a(1016),$t=a(1017),Xt=a(780),Qt=a(284),Zt=a(285),ea=a(224),ta=a(148),aa=function(e){var t=e.dateFrom,a=e.timeFrom;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())},na=function(e){var t=e.values,a=t.rideDeparture,n=t.rideArrival,r=e.handleChange,i=Object(Qt.a)(a,n),o=function(e,t){var i,o,l=(i=e,o=t,Object(ta.a)(i,o)),s=l?t:e,c=l?e:t;Object(Zt.a)(a,s)||function(e){r("departureDateTime")(e)}(s),Object(Zt.a)(n,c)||function(e){r("arrivalDateTime")(e)}(c)};return{isSameDateField:{value:i,onChange:function(e){Boolean(i)!==Boolean(e)&&o(a,aa({dateFrom:e?a:Object(ea.a)(a,1),timeFrom:n}))}},rideDepartureField:{value:a,onChange:function(e){var t=i?aa({timeFrom:n,dateFrom:e}):n;o(e,t)}},rideArrivalField:{value:n,onChange:function(e){var t=i?aa({timeFrom:a,dateFrom:e}):a;o(t,e)}}}};function ra(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ia=null,oa=function(e){var t=e.option;return t?Xt.d[t]:"Не указан"},la=function(e){var t=e.option;return t?Xt.c[t]:"Не указан"},sa=function(e){var t=e.option;return t?Xt.a[t]:"Не указан"},ca=function(e){var t=e.option;return t?Xt.b[t]:"Не указан"},ua=function(e){var t=e.classes,a=e.availableVisits,i=e.originLocation,o=e.values,l=o.departureVisitId,s=o.arrivalVisitId,c=o.vehicleType,u=o.rideType,d=o.rideComment,p=o.rideClass,m=o.rideOccupation,f=o.departureDateTime,v=o.arrivalDateTime,b=e.handleChange,E=a.map(function(e){return e.visitId}),g=Object.fromEntries(a.map(function(e){return[e.visitId,e]})),y=na({values:{rideDeparture:f,rideArrival:v},handleChange:b}),h=y.rideArrivalField,O=y.rideDepartureField,I=y.isSameDateField,S=Object(n.useCallback)(function(e){var t=e.option;if(t===ia)return i.locationName;var a=g[t];return a?a.locationName:"Не указано"},[g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:S,hasNullOption:!1,options:[ia].concat(ra(E)),value:l,onChange:b}),r.a.createElement(L,{name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:S,options:[].concat(ra(E),[ia]),onChange:b,value:s})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:oa,options:Object.values(kt.VEHICLE_TYPES),onChange:b,value:c}),r.a.createElement(L,{name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:la,options:Object.values(kt.RIDE_TYPES),onChange:b,value:u})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(L,{name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:sa,options:Object.values(kt.RIDE_CLASSES),onChange:b,value:p}),r.a.createElement(L,{name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:ca,options:Object.values(kt.RIDE_OCCUPATION),onChange:b,value:m})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(Jt.a,{name:"departureDateTime",autoOk:!0,className:t.option,label:"Дата отправления",value:O.value,onChange:O.onChange,format:"eeeeee, d MMMM yyyy"}),I.value?r.a.createElement(zt.a,{control:r.a.createElement(Kt.a,{checked:I.value,onChange:function(e){return I.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):r.a.createElement(Jt.a,{name:"arrivalDateTime",autoOk:!0,className:t.option,label:"Дата прибытия",value:h.value,onChange:h.onChange,format:"eeeeee, d MMMM yyyy"})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement($t.a,{name:"departureDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время отправления",value:O.value,onChange:O.onChange}),r.a.createElement($t.a,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время прибытия",value:h.value,onChange:h.onChange})),r.a.createElement("div",{className:t.optionGroup},r.a.createElement(T.a,{name:"rideComment",className:t.option,label:"Комментарий",multiline:!0,onChange:b,rows:1,rowsMax:12,value:d})))};ua.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},ua.defaultProps={className:void 0};var da=Object(R.a)({optionGroup:{display:"flex"},option:{flexGrow:"1"}})(ua);function pa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ma=function(e){var t=e.availableVisits,a=e.initialState,n=e.children,i=e.className,o=e.onSubmit,l=e.originLocation,s=pa(r.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return r.a.createElement("div",{className:i},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},n),c&&r.a.createElement(Wt,{initialValues:a,enableReinitialize:!0,onSubmit:function(e){o(e),d()},onReject:d,title:"Транспорт",description:"Как вы добрались в место назначения и как уехали из него?"},r.a.createElement(da,{availableVisits:t,originLocation:l})))};ma.propTypes={availableVisits:o.a.arrayOf(o.a.shape(he.default)),initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,className:o.a.string,onSubmit:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired},ma.defaultProps={className:void 0,availableVisits:[]};var fa=ma;function va(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ba=function(e){var t=e.availableVisits,a=e.originLocation,n=e.classes,i=e.className,o=e.defaultArrivalVisitId,l=e.defaultDepartureVisitId,s=e.isEditable,c=e.onRideUpdate,u=e.ride,d=e.ride,p=d.rideId,m=d.vehicleType,f=d.rideType,v=d.arrivalDateTime,b=d.departureDateTime,E=e.showDetails,g=p?u:Object(Ut.a)({defaultDepartureVisitId:l,defaultArrivalVisitId:o}),y=p?function(e){switch(e){case kt.VEHICLE_TYPES.CAR:return mt.a;case kt.VEHICLE_TYPES.TRAIN:return St.a;case kt.VEHICLE_TYPES.AIRCRAFT:return Et.a;case kt.VEHICLE_TYPES.BUS:case kt.VEHICLE_TYPES.TROLLEY:case kt.VEHICLE_TYPES.CITY_BUS:return dt.a;case kt.VEHICLE_TYPES.MOTORHOME:case kt.VEHICLE_TYPES.JITNEY:return Tt.a;case kt.VEHICLE_TYPES.LOCAL_TRAIN:return St.a;case kt.VEHICLE_TYPES.FERRY:return ct.a;case kt.VEHICLE_TYPES.BIKE:return lt.a;case kt.VEHICLE_TYPES.BY_FEET:return Ct.a;case kt.VEHICLE_TYPES.MOTORBIKE:return yt.a;case kt.VEHICLE_TYPES.TRUCK:return Fe.a;case kt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return Ot.a;case kt.VEHICLE_TYPES.TRAM:return Vt.a;case kt.VEHICLE_TYPES.TAXI:return wt.a;case kt.VEHICLE_TYPES.SUBWAY:return Dt.a;case kt.VEHICLE_TYPES.PUBLIC_TRANSPORT:return _t.a;case kt.VEHICLE_TYPES.ROPEWAY:case kt.VEHICLE_TYPES.FUNICULAR:default:return vt.a}}(m):xt.a,h=r.a.createElement(y,{className:n.icon}),O=s?r.a.createElement(fa,{className:n.editDialogTrigger,initialState:g,availableVisits:t,onSubmit:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){va(e,t,a[t])})}return e}({},u,e))},originLocation:a},h):h;return r.a.createElement("div",{className:qe()(i,n.container)},f===kt.RIDE_TYPES.HITCH_HIKING&&r.a.createElement(Yt.a,{className:n.icon}),O,Boolean(p&&E)&&r.a.createElement("span",{className:n.details},function(e,t){var a=Boolean(t)&&t.toLocaleDateString(),n=Boolean(e)&&e.toLocaleDateString();return a===n?a:"".concat(n,"—").concat(a)}(b,v)))};ba.propTypes={availableVisits:o.a.arrayOf(o.a.shape(he.default)),classes:o.a.objectOf(o.a.string).isRequired,className:o.a.string,defaultArrivalVisitId:o.a.number,defaultDepartureVisitId:o.a.number,isEditable:o.a.bool,onRideUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,ride:o.a.shape(I.default),showDetails:o.a.bool},ba.defaultProps={availableVisits:[],className:void 0,defaultArrivalVisitId:void 0,defaultDepartureVisitId:void 0,isEditable:!1,ride:{},showDetails:!1};var Ea=Object(R.a)({container:{display:"inline-block"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},editDialogTrigger:{display:"inline-block"}})(ba),ga=a(937),ya=a.n(ga),ha=function(e){var t=e.className,a=e.classes;return r.a.createElement(ya.a,{className:qe()(t,a.dragHandler),"data-sort-handler":"enabled"})};ha.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},ha.defaultProps={className:void 0};var Oa=Object(R.a)({dragHandler:{cursor:"grab",marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block"}})(ha);function Ia(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Sa=function(e){var t,a,n=e.visit,i=e.visit,o=(i=void 0===i?{}:i).visitId,l=i.arrivalRideId,s=i.departureRideId,c=e.ridesDict,u=e.classes,d=e.prevVisitId,p=e.nextVisitId,m=e.tripVisitsList,f=e.isEditable,v=e.isSortable,b=e.isSorting,E=e.isArrivalRideMatch,g=e.isDepartureRideMatch,y=e.onRideUpdate,h=e.onVisitUpdate,O=e.originLocation,I=e.locationPath,S=f&&!E,R=f&&!g;return r.a.createElement("div",{className:u.container},r.a.createElement(Ea,{availableVisits:m,defaultDepartureVisitId:d,defaultArrivalVisitId:o,visitId:o,isEditable:f,className:qe()(u.ride,(t={},Ia(t,u.alwaysVisible,b||!g),Ia(t,u.warning,S),t)),ride:c[l],showDetails:b||S,onRideUpdate:y,originLocation:O}),r.a.createElement(it,{classes:{editIcon:u.visibleOnlyOnHover},isEditable:f,onVisitUpdate:h,visit:n,locationPath:I}),(!g||b)&&r.a.createElement(Ea,{className:qe()(u.ride,(a={},Ia(a,u.alwaysVisible,b||!g),Ia(a,u.warning,R),a)),ride:c[s],availableVisits:m,defaultDepartureVisitId:o,defaultArrivalVisitId:p,isEditable:f&&!g,showDetails:b||R,onRideUpdate:y,originLocation:O}),v&&!b&&r.a.createElement(Oa,{className:u.visibleOnlyOnHover}))};Sa.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isArrivalRideMatch:o.a.bool,isDepartureRideMatch:o.a.bool,isEditable:o.a.bool,isSortable:o.a.bool,isSorting:o.a.bool,nextVisitId:o.a.number,onRideUpdate:o.a.func.isRequired,onVisitUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,prevVisitId:o.a.number,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(he.default)),visit:o.a.shape(he.default).isRequired,locationPath:f.d.isRequired},Sa.defaultProps={isArrivalRideMatch:!0,isDepartureRideMatch:!0,isEditable:!1,isSortable:!1,isSorting:!1,nextVisitId:null,prevVisitId:null,tripVisitsList:[]};var Ra=Object(R.a)({alwaysVisible:{},container:{position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}})(Sa);var Ta=function(e){var t,a,n,i=e.classes,o=e.isSorting,l=e.onVisitUpdate;return r.a.createElement("div",{className:qe()((t={},a=i.draggableContainer,n=!o,a in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t))},r.a.createElement(at,{initialState:{visitType:null,visitComment:""},onSubmit:l},r.a.createElement(u.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement("span",null,"Добавить посещение"))),r.a.createElement(Oa,{className:i.visibleOnlyOnHover}))};Ta.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isSorting:o.a.bool,onVisitUpdate:o.a.func.isRequired},Ta.defaultProps={isSorting:!1};var Pa=Object(R.a)({visibleOnlyOnHover:{visibility:"hidden"},draggableContainer:{position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}}})(Ta);function Ca(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ja(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Va(){return(Va=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Na(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var wa=Object(Ie.SortableContainer)(function(e){var t=e.children;return r.a.createElement("div",null,t)}),La=Object(Ie.SortableElement)(function(e){var t=e.replaceWithNode,a=e.onVisitUpdate,n=Na(e,["replaceWithNode","onVisitUpdate"]);return t||r.a.createElement(Ra,Va({onVisitUpdate:a},n))}),Da=function(e){var t=e.classes,a=e.countriesDict,i=e.isEditable,o=e.locationsDict,l=e.onRideUpdate,s=e.onVisitsOrderUpdate,c=e.ridesDict,u=e.trip,d=e.trip,p=d.tripId,m=d.originLocationId,f=d.tripName,v=d.tripType,b=e.tripIndex,E=e.tripVisitsList,g=e.onTripUpdate,y=e.onVisitUpdate,h=e.storyPath,O=e.locationPath,I=i,S=ja(Object(n.useState)(!1),2),R=S[0],T=S[1],P=ja(Object(n.useState)(E.length),2),C=P[0],j=P[1],V=I?La:Ra,N=(i?function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return[].concat(Ve(e.slice(0,a)),[t],Ve(e.slice(a)))}(E,{isItVisitCreatorControl:!0},C):E).map(function(e,t){var a=e.isItVisitCreatorControl,n=e.visitId;if(a)return r.a.createElement(La,{key:"visitCreator",index:t,replaceWithNode:r.a.createElement(Pa,{isSorting:R,onVisitUpdate:function(e){return y(e,{indexInCollection:C,collection:E,tripId:p})}})});var s=ja(function(e,t,a){var n=t-1-(t>a?1:0),r=t+1-(t+1>a?1:0);return[n>=0?e[n]:null,r<e.length?e[r]:null]}(E,t,C),2),u=s[0],d=s[1],f=(u||{}).visitId,v=(d||{}).visitId;return r.a.createElement(V,{index:t,isArrivalRideMatch:Ne(u,e),isDepartureRideMatch:Ne(e,d),isEditable:i,isSortable:I,isSorting:R,key:n,nextVisitId:v,onRideUpdate:l,onVisitUpdate:y,originLocation:o[m],prevVisitId:f,ridesDict:c,tripVisitsList:E,visit:e,locationPath:O})}),w=I?r.a.createElement(wa,{onSortEnd:function(e,t){T(!1);var a=e.oldIndex,n=e.newIndex;a===C?j(n):s(t,{oldIndex:a>C?a-1:a,newIndex:n>C?n-1:n,collection:E})},shouldCancelStart:je,updateBeforeSortStart:function(){return T(!0)},lockAxis:"y",lockToContainerEdges:!0},N):r.a.createElement("div",null,N),L=r.a.createElement(Ae,{location:o[m],Icon:Te.a,locationPath:O}),D=r.a.createElement(be,{initialState:u,onSubmit:function(e){return g(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Ca(e,t,a[t])})}return e}({},u,e))}},r.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},r.a.createElement(Ce.a,{className:t.visibleOnlyOnHover}))),A=E[E.length-1],_=E[E.length-2],q=A||{},Y=q.departureRideId,H=q.visitId,x=v===ie.TRIP_TYPES.RELOCATION,k=x?null:r.a.createElement(Ea,{availableVisits:E,defaultDepartureVisitId:H,isEditable:i,onRideUpdate:l,originLocation:o[m],ride:c[Y],showDetails:R||Ne(_,A)}),U=E.some(function(e){var t=e.visitComment,a=e.arrivalRideId,n=e.departureRideId;if(t)return!0;if((c[a]||{}).rideComment)return!0;var r=(c[n]||{}).rideComment;return Boolean(r)});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:t.container},"".concat(b+1,". ").concat(Object(ge.b)(E,a,o[m]&&o[m].countryId,f)),i&&D),L,w,!x&&r.a.createElement(r.a.Fragment,null,k,L),U&&r.a.createElement("div",null,r.a.createElement(Oe.b,{to:h.toUrl({strTripId:String(p)})},"Заметки")))};Da.propTypes={classes:o.a.objectOf(o.a.string).isRequired,tripIndex:o.a.number.isRequired,isEditable:o.a.bool,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired,onRideUpdate:o.a.func.isRequired,onTripUpdate:o.a.func.isRequired,onVisitsOrderUpdate:o.a.func.isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,trip:o.a.shape(ye.default).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(he.default)),storyPath:f.d.isRequired,locationPath:f.d.isRequired},Da.defaultProps={isSortable:!1,tripVisitsList:[]};var Aa=Object(R.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}})(Da);function _a(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){qa(e,t,a[t])})}return e}function qa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ya,Ha=(Ya={orderResolver:function(e){return e.orderInTrip}}.orderResolver,function(e){var t=e.index,a=e.collection;if(!a.length)return 100;if(t<=0)return Ya(a[0])-1;if(t>=a.length-1)return Ya(a[a.length-1])+1;var n=Ya(a[t-1]),r=Ya(a[t]);return(n+r)/2+(Math.random()-.5)*(r-n)/2}),xa=a(744),ka=a.n(xa),Ua=Object(d.a)(ge.a),Fa=function(e){var t=e.match.params.userAlias,a=e.isTripsComplete,i=e.trips,o=(i=void 0===i?{}:i).data,l=void 0===o?[]:o,s=e.visits,c=(s=void 0===s?{}:s).data,d=void 0===c?[]:c,p=e.countriesDict,m=e.locationsDict,f=e.namedPaths,E=e.ridesDict,g=e.request,y=e.invalidateRequest,h=Object(v.c)(),O=h.isAuthenticated,I=h.userAlias,S=O&&I===t,R=Object(n.useCallback)(function(e,t){var a=t.oldIndex,n=t.newIndex,r=t.collection;a!==n&&g(function(e){var t=e.oldIndex,a=e.newIndex,n=e.collection;return{domain:"tripsPage.visits.sort",modelName:"visits",query:{id:n[t].visitId,body:{orderInTrip:Ha({index:a,collection:n})}}}}({oldIndex:a,newIndex:n,collection:r}))},[g]),T=Object(n.useCallback)(function(e){return g(function(e){var t=e.ride;return{domain:"tripsPage.visits.rides",modelName:"rides",query:{id:e.ride.rideId,body:t}}}({ride:e}))},[g]),P=Object(n.useCallback)(function(e){return g(function(e){var t=e.trip;return{domain:"tripsPage.visits.trips",modelName:"trips",query:{id:e.trip.tripId,body:t}}}({trip:e})).then(function(){return y({domain:"tripsPage.trips"})})},[g]),C=Object(n.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.indexInCollection,n=t.collection,r=t.tripId;return g(function(e){var t=e.visit,a=e.visit.visitId,n=e.tripId,r=e.indexInCollection,i=e.collection;return{domain:"tripsPage.visits.visit",modelName:"visits",query:{id:a,body:_a({},t,{tripId:n,orderInTrip:r||0===r?Ha({index:r,collection:i}):void 0})}}}({visit:e,tripId:r,indexInCollection:a,collection:n})).then(function(){return y({domain:"tripsPage.visits"})})},[g]),j=Object(n.useMemo)(function(){return r.a.createElement(be,{initialState:{tripType:null},onSubmit:P},r.a.createElement(u.a,{size:"small",variant:"outlined",color:"primary"},"Добавить поездку"))},[P]);if(a&&!l.length)return r.a.createElement(b.a,{shouldShowLinkToTrips:!1},j);var V=Ua(d);return r.a.createElement(r.a.Fragment,null,S&&j,l.map(function(e,t){var a=e.tripId;return r.a.createElement("div",{key:a},r.a.createElement(Aa,{locationsDict:m,countriesDict:p,onRideUpdate:T,onTripUpdate:P,onVisitUpdate:C,onVisitsOrderUpdate:R,ridesDict:E,trip:e,tripIndex:t,tripVisitsList:V[a],isEditable:S,storyPath:f.travel.tripStory,locationPath:f.travel.locationPath}))}))};Fa.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired,namedPaths:f.e.namedPaths.isRequired,request:o.a.func.isRequired,isTripsComplete:o.a.bool.isRequired,trips:o.a.shape({data:o.a.arrayOf(o.a.shape(ye.default))}).isRequired,visits:o.a.shape({data:o.a.arrayOf(o.a.shape(he.default))}).isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired};t.default=c()(l.g,f.g,Object(m.a)(function(e,t){var a=t.countriesDict,n=t.match.params.userAlias,r=function(e){return((Object(p.e)(e,"tripsPage.trips")||{}).fallback["tripsPage.trips"]||{}).data}(e),i=function(e,t){var a=Object(p.d)(e,"trips"),n=Object(p.d)(e,"locations"),r=t?ka()(t.reduce(function(e,t){var n=a[t];if(n){var r=n.originLocationId;r&&e.push(r)}return e},[])):[],i=r.filter(function(e){return!n[e]});return{requiredLocationsIds:r,missingLocationsIds:i}}(e,r),o=i.requiredLocationsIds,l=i.missingLocationsIds;return{domain:"tripsPage",request:{countries:{isNoop:a&&Object.keys(a).length,modelName:"countries",query:{navigation:{isDisabled:!0}}},trips:{modelName:"trips",observe:n,query:{userAlias:n,navigation:{isDisabled:!0}}},locations:{modelName:"locations",observe:o,isNoop:!l.length,query:{filter:{id:{comparator:"in",value:l}},navigation:{isDisabled:!0}}},rides:{modelName:"rides",observe:r,isNoop:!r||!r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}},visits:{modelName:"visits",observe:r,isNoop:!r||!r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}}}}},function(e){return{countriesDict:Object(p.d)(e,"countries"),locationsDict:Object(p.d)(e,"locations"),ridesDict:Object(p.d)(e,"rides"),isTripsComplete:Object(p.e)(e,"tripsPage.trips").isComplete}}))(Fa)},736:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(244),o=function(e){return function(t){var a=t.provision,n=(a=void 0===a?{}:a).isPending,o=void 0===n||n,l=a.hasFallback;return o&&!l?r.a.createElement(i.a,null):r.a.createElement(e,t)}},l=a(112);t.a=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}(l.a.apply(void 0,t),o)(e)}}},761:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(1),o=a.n(i),l=a(33),s=a(242),c=a.n(s),u=a(121),d=a(19),p=a(100),m=function(e){var t=e.children,a=e.match.params.userAlias,i=e.namedPaths,o=(i=void 0===i?{}:i).travel,s=(o=void 0===o?{}:o).trips,c=Object(p.c)().userAlias;if(a!==c)return r.a.createElement("span",null,"Пользователь пока еще не внес информацию о своих поездках");var u=Object(n.useCallback)(function(){return r.a.createElement("div",null,r.a.createElement("span",null,"Нам пока ничего не известно о ваших путешествиях. Но очень интересно узнать. Создайте вашу первую поездку, а мы подготовим по ней отчет"),t)},[t]);return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:s.toUrl({userAlias:c}),component:u}),r.a.createElement(l.a,{to:s.toUrl({userAlias:c})}))};m.propTypes={children:o.a.node,match:o.a.shape({params:o.a.shape({userAlias:o.a.string})}).isRequired,namedPaths:o.a.shape({travel:o.a.shape({trips:o.a.instanceOf(u.a)})}).isRequired},m.defaultProps={children:null},t.a=c()(l.g,d.g)(m)},768:function(e,t,a){"use strict";var n=a(739),r=a.n(n),i=a(783),o=a.n(i),l=a(744),s=a.n(l),c=function(e,t){var a=t.maxLength,n=t.separator,r=void 0===n?", ":n,i=s()(e),o=i.slice(0,a).join(r);return i.length>a?"".concat(o,"..."):o},u=a(164),d=function(e,t,a,n){if(!e.length)return n;var i=Object.keys(r()(e.filter(function(e){return e.visitType!==u.VISIT_TYPES.TRANSIT}),"countryId"));return 1===i.length?c(e.map(function(e){return e.locationName}),{maxLength:4})||n:c(i.map(function(e){return Number(e)!==a&&t[e]&&t[e].countryName}).filter(Boolean),{maxLength:4})||n};a.d(t,"c",function(){return p}),a.d(t,"a",function(){return m}),a.d(t,"b",function(){return d});var p=function(e){return e.sort(function(e,t){return e.orderInTrip-t.orderInTrip})},m=function(e){return o()(r()(e,"tripId"),p)}},780:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return u}),a.d(t,"c",function(){return d}),a.d(t,"d",function(){return p});var n,r,i,o,l=a(68);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=(s(n={},l.RIDE_CLASSES.ECONOMY,"Эконом"),s(n,l.RIDE_CLASSES.COMFORT,"Комфорт"),s(n,l.RIDE_CLASSES.BUSINESS,"Бизнес"),s(n,l.RIDE_CLASSES.FIRST,"Первый"),s(n,l.RIDE_CLASSES.PRIVATE,"Частный"),n),u=(s(r={},l.RIDE_OCCUPATION.PASSENGER,"Пассажир"),s(r,l.RIDE_OCCUPATION.STUFF,"Персонал"),s(r,l.RIDE_OCCUPATION.DRIVER,"Водитель"),r),d=(s(i={},l.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),s(i,l.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),s(i,l.RIDE_TYPES.CHARTER,"Чартерный рейс"),s(i,l.RIDE_TYPES.TOUR,"Тур"),s(i,l.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),s(i,l.RIDE_TYPES.HITCH_HIKING,"Автостоп"),s(i,l.RIDE_TYPES.DROP_OFF,"Подбросили до места"),i),p=(s(o={},l.VEHICLE_TYPES.CAR,"Автомобиль"),s(o,l.VEHICLE_TYPES.TRAIN,"Поезд"),s(o,l.VEHICLE_TYPES.AIRCRAFT,"Самолет"),s(o,l.VEHICLE_TYPES.BUS,"Автобус"),s(o,l.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),s(o,l.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),s(o,l.VEHICLE_TYPES.FERRY,"Паром"),s(o,l.VEHICLE_TYPES.BIKE,"Велосипед"),s(o,l.VEHICLE_TYPES.BY_FEET,"Пешком"),s(o,l.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),s(o,l.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),s(o,l.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),s(o,l.VEHICLE_TYPES.TRUCK,"Грузовик"),s(o,l.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),s(o,l.VEHICLE_TYPES.TRAM,"Трамвай"),s(o,l.VEHICLE_TYPES.TROLLEY,"Троллейбус"),s(o,l.VEHICLE_TYPES.TAXI,"Такси"),s(o,l.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),s(o,l.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),s(o,l.VEHICLE_TYPES.SUBWAY,"Метро"),s(o,l.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),o)}}]);
//# sourceMappingURL=travel-Trips-c23da84c5d1bbd946beb.js.map