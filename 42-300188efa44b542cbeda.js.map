{"version":3,"file":"42-300188efa44b542cbeda.js","mappings":"2QAGe,SAASA,EAAeC,GACrC,I,IAAA,G,GAAsCC,EAAAA,EAAAA,WAAS,kBCFFC,EDGpBF,GCDrBG,EAAAA,YAAAA,mBAA8BC,EAAAA,EAAAA,gBAAeF,IAC7CC,EAAAA,YAAAA,cAHS,IAAgCD,K,EDE7C,E,8zBAIA,MAAO,CAAEG,YAJT,KAIsBC,eAJtB,M,6IEDa,SAASC,EAAT,GAA6C,IAAdL,EAAc,EAApBM,KAChCC,GAAOC,EAAAA,EAAAA,UAAQ,kBAAMC,EAAAA,EAAAA,GAAYT,KAAa,CAACA,IACrD,OAAO,uBAAKU,wBAAyB,CAAEC,OAAQJ,KCHlC,SAASK,EAASC,GAC/B,OAAOC,EAAAA,EAAAA,cAAaD,EAAaE,qBCMpB,SAASC,EAAT,GAAqD,IAA/Bb,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eAC1Ca,GAAeC,EAAAA,EAAAA,cAAY,SAAAC,GAC/Bf,EAAee,MAGXC,GAAmBF,EAAAA,EAAAA,cACvB,SAACG,EAASF,GACR,IAAMG,EAAWC,EAAAA,UAAAA,iBAA2BJ,EAAWE,GAEvD,OAAIC,GACFL,EAAaK,GACN,WAGF,gBAET,CAACL,IAGH,OACE,gBAAC,EAAAO,OAAD,CACErB,YAAaA,EACbsB,SAAUR,EACVG,iBAAkBA,M,+VC3BT,SAASM,EAAT,GAIZ,IAHDC,EAGC,EAHDA,SACAC,EAEC,EAFDA,SACGC,E,kXACF,MAQD,OAPiBC,SACdH,GACCE,EAAgBE,MAChBF,EAAgBG,IAChBH,EAAgBI,SAQlB,gBAAC,IAAD,KAAaJ,EAAb,CAA8BK,UAAWC,EAAAA,KACtCP,GALI,gBAAC,IAAeC,EAAkBD,GAU7CF,EAAcU,aAAe,CAC3BT,UAAU,I,4mCCjBG,SAASU,IACtB,IAAMC,GAAoBC,EAAAA,EAAAA,IAAa,CACrCC,OAAQ,WACRC,aAAa,EACbC,UAAW,WACXC,SAAS,EACTC,MAAO,CACLC,WAAY,CAAEC,YAAY,MAG9B,IAAmCC,EAAAA,EAAAA,IAAaT,IAAsB,IAA9DhC,KAAM0C,OAAd,MAA4B,GAA5B,EACMC,GAAeC,EAAAA,EAAAA,KAAY,SAAAC,GAAK,OACpCC,EAAAA,EAAAA,IAAWD,EAAO,WAAYH,MAEhC,cACKV,GADL,IAEEW,aAAAA,EACAI,SAASC,EAAAA,EAAAA,IAAchB,KAIpB,SAASiB,EAAT,GAAsC,IAAhBC,EAAgB,EAAhBA,KAAMhB,EAAU,EAAVA,OAC3BF,GAAoBC,EAAAA,EAAAA,IAAa,CACrCC,OAAAA,EACAC,aAAa,EACbC,UAAW,WACXC,QAASa,EACTC,UAAW3B,QAAQ0B,GACnBZ,MAAO,CACLc,GAAIF,KAGFG,GAAUT,EAAAA,EAAAA,KAAY,SAAAC,GAAK,OAAIS,EAAAA,EAAAA,IAAWT,EAAO,WAAYK,MACnE,cAAYlB,GAAZ,IAA+BqB,QAAAA,IAG1B,SAASE,EAAT,GAAsC,I,IAAVrB,EAAU,EAAVA,OACjC,G,GAAmCsB,EAAAA,EAAAA,IAAW,CAC5CtB,OAAAA,EACAE,UAAW,WACXqB,OAAQ,S,EAHV,E,8zBAAOC,EAAP,KAAsBC,EAAtB,KAMA,cACKA,GADL,IAEEC,cAAe,CAAC,EAAG,GAAGC,SAASF,EAAUG,YACzCJ,cAAAA,M,kRC/CW,SAASK,EAAT,GAA2B,IAARb,EAAQ,EAARA,KAChC,GAAyDc,EAAAA,EAAAA,MAAjDC,EAAR,EAAQA,gBAAyBC,EAAjC,EAAyBC,OACjBd,GAAYJ,EAAAA,EAAAA,IAAW,CAAEC,KAAAA,EAAMhB,OAJ1B,kBAILmB,QACR,GAAyDe,EAAAA,EAAAA,MAArCC,EAApB,EAAQC,WAAmCC,EAA3C,EAAqCC,KAC/BC,EAAYJ,GAAmBE,EACrC,GAAIrB,IAASG,EACX,OACE,gBAACqB,EAAA,EAAD,CAAYC,QAAQ,QAApB,wDAKJ,IAAQC,EAAiCvB,EAAjCuB,KAAMC,EAA2BxB,EAA3BwB,MAAOV,EAAoBd,EAApBc,OAAQW,EAAYzB,EAAZyB,QACvBC,EAAad,GAAmBC,IAAwBC,EAC9D,OAAMY,GAAcD,IAAaF,EAE7B,gBAACF,EAAA,EAAD,CAAYC,QAAQ,QAApB,wDAMF,gCACE,gBAACD,EAAA,EAAD,CAAYC,QAAQ,MAAME,GACzBE,GACC,gBAAC3D,EAAA,EAAD,CAAeM,GAAI+C,EAAUO,YAAYC,MAAM,CAAE/B,KAAAA,KAAjD,iBAIF,gBAAC,KAAD,CAAelD,MAAMJ,EAAAA,EAAAA,gBAAegF,MCT1C,SAAeM,EAAAA,EAAAA,KARC,SAAC,GAAa,IAAXhC,EAAW,EAAXA,KACXiC,EApBc,SAAAjC,GACpB,OAAQA,GACN,IAAK,WACH,OAAOkC,EAAAA,MAAW,kBAChB,0DAEJ,IAAK,YACH,OAAOA,EAAAA,MAAW,kBAChB,0DAEJ,IAAK,aACH,OAAOA,EAAAA,MAAW,kBAChB,0DAEJ,QACE,OAAOC,GAKcC,CAAcpC,GACvC,OAAKiC,EAGE,gBAACA,EAAD,CAAkBjC,KAAMA,IAFtB,mDCbX,IAAMqC,GAAYC,EAAAA,EAAAA,GAAW,CAC3BC,UAAW,CACTC,QAAS,QAEXC,SAAU,CACRC,QAAS,UAEXC,SAAU,CACRC,KAAM,aAERC,OAAQ,CACNC,OAAQ,UA8GZ,QA1GA,WACE,IAAMC,EAAUV,IAChB,GAAsBW,EAAAA,EAAAA,MAAdhD,EAAR,EAAQA,KAAMiD,EAAd,EAAcA,IAEd,GAIInC,EAAAA,EAAAA,MAHFC,EADF,EACEA,gBACWmC,EAFb,EAEEC,UACQnC,EAHV,EAGEC,OAGF,GAAkCpC,EAAAA,EAAAA,IAAY,CAC5CsE,UAAWD,IADLzD,EAAR,EAAQA,aAAcI,EAAtB,EAAsBA,QAItB,GAAyDqB,EAAAA,EAAAA,MAArCC,EAApB,EAAQC,WAAmCC,EAA3C,EAAqCC,KAC/B8B,GAAiBH,GAAe,YAARA,EACxBI,GAAcJ,GAAe,SAARA,EACrB1B,EAAYJ,GAAmBE,EACrC,OACE,iCACIF,GACA,gBAACjD,EAAA,EAAD,CACEM,GAAI+C,EAAU+B,MAAMvB,QACpBwB,UAAWR,EAAQN,UAEnB,gBAAC,IAAD,OAGJ,uBAAKc,UAAWR,EAAQR,WACpB1C,EAGA,gBAAC2D,EAAA,EAAD,CACE9E,UAAU,MACV,aAAW,WACXqE,QAAS,CAAEU,KAAMV,EAAQJ,WAExBS,GACC,gBAACM,EAAA,EAAD,CACEC,QAAQ,EACRjF,UAAWR,EAAAA,EACXM,GAAI+C,EAAUqC,SAAS7B,MAAM,CAAE/B,KAAM,cAErC,gBAAC6D,EAAA,EAAD,CAAcC,QAAQ,oCAGzBV,GACC,gBAACM,EAAA,EAAD,CACEC,QAAQ,EACRjF,UAAWR,EAAAA,EACXM,GAAI+C,EAAUqC,SAAS7B,MAAM,CAAE/B,KAAM,eAErC,gBAAC6D,EAAA,EAAD,CAAcC,QAAQ,4BAGzBT,GACC,gBAACK,EAAA,EAAD,CACEC,QAAQ,EACRjF,UAAWR,EAAAA,EACXM,GAAI+C,EAAUqC,SAAS7B,MAAM,CAAE/B,KAAM,gBAErC,gBAAC6D,EAAA,EAAD,CAAcC,QAAQ,uEAGzBrE,EAAasE,KAAI,SAAA5D,GAChB,IAAQc,EAA8Cd,EAA9Cc,OAAQW,EAAsCzB,EAAtCyB,QAASD,EAA6BxB,EAA7BwB,MAAaqC,EAAgB7D,EAAtBH,KAChC,GACE4B,KACEb,GAAmBC,IAAwBC,GAE7C,OAAO,KAET,IAAMgD,EAAUrC,EAAU,aAAH,OAAgBD,GAAUA,EACjD,OACE,gBAAC+B,EAAA,EAAD,CACEC,QAAQ,EACRjF,UAAWR,EAAAA,EACXM,GAAI+C,EAAUqC,SAAS7B,MAAM,CAAE/B,KAAMgE,KAErC,gBAACH,EAAA,EAAD,CAAcC,QAASG,QAI5BlD,GACC,gBAAC2C,EAAA,EAAD,CACEC,QAAQ,EACRjF,UAAWR,EAAAA,EACXM,GAAI+C,EAAU2C,cAAcnC,MAAM,CAChCoB,UAAWD,KAGb,gBAACW,EAAA,EAAD,CAAcC,QAAQ,sBA7D5B,uBAAKP,UAAWR,EAAQF,QAAxB,cAkED7C,GACC,2BACE,gBAAC,EAAD,CAASA,KAAMA","sources":["webpack://mine/./src/modules/MineEditor/useEditorState.js","webpack://mine/./src/modules/MineEditor/createStateFromContent.js","webpack://mine/./src/modules/MineEditor/RenderContent.jsx","webpack://mine/./src/modules/MineEditor/exportContentFromState.js","webpack://mine/./src/modules/MineEditor/MineEditor.jsx","webpack://mine/./src/modules/components/muiExtended/ConnectedLink/ConnectedLink.jsx","webpack://mine/./src/packages/literature/dataSource/articles.js","webpack://mine/./src/packages/literature/pages/Article/Article.jsx","webpack://mine/./src/packages/literature/pages/Articles/blocks/Article/Article.jsx","webpack://mine/./src/packages/literature/pages/Articles/Articles.jsx"],"sourcesContent":["import { useState } from 'react';\nimport createStateFromContent from './createStateFromContent';\n\nexport default function useEditorState(initialContent) {\n  const [editorState, setEditorState] = useState(() =>\n    createStateFromContent(initialContent),\n  );\n\n  return { editorState, setEditorState };\n}\n","import { EditorState, convertFromRaw } from 'draft-js';\n\nexport default function createStateFromContent(rawContent) {\n  return rawContent\n    ? EditorState.createWithContent(convertFromRaw(rawContent))\n    : EditorState.createEmpty();\n}\n","import React, { useMemo } from 'react';\nimport { stateToHTML } from 'draft-js-export-html';\n\nexport default function RenderContent({ data: rawContent }) {\n  const html = useMemo(() => stateToHTML(rawContent), [rawContent]);\n  return <div dangerouslySetInnerHTML={{ __html: html }} />;\n}\n","import { convertToRaw } from 'draft-js';\n\nexport default function toString(draftJSState) {\n  return convertToRaw(draftJSState.getCurrentContent());\n}\n","import React, { useCallback } from 'react';\nimport { Editor, RichUtils } from 'draft-js';\nimport 'draft-js/dist/Draft.css';\n\nexport { default as useEditorState } from './useEditorState';\nexport { default as RenderContent } from './RenderContent';\nexport { default as exportContentFromState } from './exportContentFromState';\nexport { default as createStateFromContent } from './createStateFromContent';\n\nexport default function MineEditor({ editorState, setEditorState }) {\n  const handleChange = useCallback(nextState => {\n    setEditorState(nextState);\n  });\n\n  const handleKeyCommand = useCallback(\n    (command, nextState) => {\n      const newState = RichUtils.handleKeyCommand(nextState, command);\n\n      if (newState) {\n        handleChange(newState);\n        return 'handled';\n      }\n\n      return 'not-handled';\n    },\n    [handleChange],\n  );\n\n  return (\n    <Editor\n      editorState={editorState}\n      onChange={handleChange}\n      handleKeyCommand={handleKeyCommand}\n    />\n  );\n}\n","import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport MUILink from '@material-ui/core/Link';\nimport { Typography } from '@material-ui/core';\n\nexport default function ConnectedLink({\n  optional,\n  children,\n  ...forwardingProps\n}) {\n  const linkable = Boolean(\n    !optional ||\n      forwardingProps.href ||\n      forwardingProps.to ||\n      forwardingProps.onClick,\n  );\n\n  if (!linkable) {\n    return <Typography {...forwardingProps}>{children}</Typography>;\n  }\n\n  return (\n    <MUILink {...forwardingProps} component={RouterLink}>\n      {children}\n    </MUILink>\n  );\n}\n\nConnectedLink.defaultProps = {\n  optional: false,\n};\n","import { useSelector } from 'react-redux';\nimport {\n  useProvision,\n  useRequest,\n  selectItem,\n  selectList,\n} from 'core/connection';\nimport {\n  selectResult,\n  selectIsReady,\n} from 'core/connection/request/controllerRedux';\n\nexport default function useArticles() {\n  const articlesProvision = useProvision({\n    domain: 'articles',\n    isProvision: true,\n    modelName: 'articles',\n    observe: false,\n    query: {\n      navigation: { isDisabled: true },\n    },\n  });\n  const { data: articlesIds = [] } = selectResult(articlesProvision) || {};\n  const articlesList = useSelector(state =>\n    selectList(state, 'articles', articlesIds),\n  );\n  return {\n    ...articlesProvision,\n    articlesList,\n    isReady: selectIsReady(articlesProvision),\n  };\n}\n\nexport function useArticle({ slug, domain }) {\n  const articlesProvision = useProvision({\n    domain,\n    isProvision: true,\n    modelName: 'articles',\n    observe: slug,\n    condition: Boolean(slug),\n    query: {\n      id: slug,\n    },\n  });\n  const article = useSelector(state => selectItem(state, 'articles', slug));\n  return { ...articlesProvision, article };\n}\n\nexport function useSubmitArticle({ domain }) {\n  const [submitArticle, provision] = useRequest({\n    domain,\n    modelName: 'articles',\n    method: 'POST',\n  });\n\n  return {\n    ...provision,\n    isSubmitting: ![0, 4].includes(provision.readyState),\n    submitArticle,\n  };\n}\n","import React from 'react';\nimport { convertFromRaw } from 'draft-js';\nimport Typography from '@material-ui/core/Typography';\nimport { usePaths } from 'modules/packages';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport { useArticle } from '../../dataSource/articles';\nimport { RenderContent } from 'modules/MineEditor';\n\nconst domain = 'ArticleEditor';\n\nexport default function Article({ slug }) {\n  const { isAuthenticated, userId: authenticatedUserId } = useAuthContext();\n  const { article } = useArticle({ slug, domain });\n  const { literature: literaturePaths, code: codePaths } = usePaths();\n  const selfPaths = literaturePaths || codePaths;\n  if (slug && !article) {\n    return (\n      <Typography variant=\"body\">\n        Статья еще не опубликована или недоступна для чтения\n      </Typography>\n    );\n  }\n  const { body, title, userId, isDraft } = article;\n  const isEditable = isAuthenticated && authenticatedUserId === userId;\n  if ((!isEditable && isDraft) || !body) {\n    return (\n      <Typography variant=\"body\">\n        Статья еще не опубликована или недоступна для чтения\n      </Typography>\n    );\n  }\n  return (\n    <>\n      <Typography variant=\"h6\">{title}</Typography>\n      {isEditable && (\n        <ConnectedLink to={selfPaths.editArticle.toUrl({ slug })}>\n          Редактировать\n        </ConnectedLink>\n      )}\n      <RenderContent data={convertFromRaw(body)} />\n    </>\n  );\n}\n","import React from 'react';\nimport { withRouter } from 'react-router';\nimport DBArticle from '../../../Article';\n\nconst selectArticle = slug => {\n  switch (slug) {\n    case 'chaldini':\n      return React.lazy(() =>\n        import(/* webpackChunkName: 'literature-Chaldini' */ './designed/Chaldini'),\n      );\n    case 'blackSwan':\n      return React.lazy(() =>\n        import(/* webpackChunkName: 'literature-BlackSwan' */ './designed/BlackSwan'),\n      );\n    case 'importThis':\n      return React.lazy(() =>\n        import(/* webpackChunkName: 'literature-ImportThis' */ './designed/ImportThis'),\n      );\n    default:\n      return DBArticle;\n  }\n};\n\nconst Article = ({ slug }) => {\n  const ArticleComponent = selectArticle(slug);\n  if (!ArticleComponent) {\n    return <div>Статья не найдена</div>;\n  }\n  return <ArticleComponent slug={slug} />;\n};\n\nexport default withRouter(Article);\n","import React from 'react';\nimport { useParams } from 'react-router';\nimport { makeStyles } from '@material-ui/core/styles';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport IconHome from '@material-ui/icons/Home';\nimport { usePaths } from 'modules/packages';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport useArticles from '../../dataSource/articles';\nimport Article from './blocks/Article';\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n  },\n  iconHome: {\n    padding: '0 16px',\n  },\n  slugList: {\n    flex: '0 1 350px',\n  },\n  loader: {\n    margin: '12px',\n  },\n});\n\nfunction Articles() {\n  const classes = useStyles();\n  const { slug, tag } = useParams();\n\n  const {\n    isAuthenticated,\n    userAlias: authenticatedUserAlias,\n    userId: authenticatedUserId,\n  } = useAuthContext();\n\n  const { articlesList, isReady } = useArticles({\n    userAlias: authenticatedUserAlias,\n  });\n\n  const { literature: literaturePaths, code: codePaths } = usePaths();\n  const hasSummaryTag = !tag || tag === 'summary';\n  const hasCodeTag = !tag || tag === 'code';\n  const selfPaths = literaturePaths || codePaths;\n  return (\n    <>\n      {!literaturePaths && (\n        <ConnectedLink\n          to={selfPaths.entry.toUrl()}\n          className={classes.iconHome}\n        >\n          <IconHome />\n        </ConnectedLink>\n      )}\n      <div className={classes.container}>\n        {!isReady ? (\n          <div className={classes.loader}>...Loading</div>\n        ) : (\n          <List\n            component=\"nav\"\n            aria-label=\"articles\"\n            classes={{ root: classes.slugList }}\n          >\n            {hasSummaryTag && (\n              <ListItem\n                button={true}\n                component={ConnectedLink}\n                to={selfPaths.articles.toUrl({ slug: 'chaldini' })}\n              >\n                <ListItemText primary=\"&laquo;Психология убеждения&raquo; Чалдини\" />\n              </ListItem>\n            )}\n            {hasSummaryTag && (\n              <ListItem\n                button={true}\n                component={ConnectedLink}\n                to={selfPaths.articles.toUrl({ slug: 'blackSwan' })}\n              >\n                <ListItemText primary=\"&laquo;Черный лебедь&raquo; Талеба\" />\n              </ListItem>\n            )}\n            {hasCodeTag && (\n              <ListItem\n                button={true}\n                component={ConnectedLink}\n                to={selfPaths.articles.toUrl({ slug: 'importThis' })}\n              >\n                <ListItemText primary=\"19 принципов достижения дзена при написании компьютерных программ\" />\n              </ListItem>\n            )}\n            {articlesList.map(article => {\n              const { userId, isDraft, title, slug: currentSlug } = article;\n              if (\n                isDraft &&\n                (!isAuthenticated || authenticatedUserId !== userId)\n              ) {\n                return null;\n              }\n              const caption = isDraft ? `Черновик: ${title}` : title;\n              return (\n                <ListItem\n                  button={true}\n                  component={ConnectedLink}\n                  to={selfPaths.articles.toUrl({ slug: currentSlug })}\n                >\n                  <ListItemText primary={caption} />\n                </ListItem>\n              );\n            })}\n            {isAuthenticated && (\n              <ListItem\n                button={true}\n                component={ConnectedLink}\n                to={selfPaths.createArticle.toUrl({\n                  userAlias: authenticatedUserAlias,\n                })}\n              >\n                <ListItemText primary=\"Добавить статью\" />\n              </ListItem>\n            )}\n          </List>\n        )}\n        {slug && (\n          <div>\n            <Article slug={slug} />\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\nexport default Articles;\n"],"names":["useEditorState","initialContent","useState","rawContent","EditorState","convertFromRaw","editorState","setEditorState","RenderContent","data","html","useMemo","stateToHTML","dangerouslySetInnerHTML","__html","toString","draftJSState","convertToRaw","getCurrentContent","MineEditor","handleChange","useCallback","nextState","handleKeyCommand","command","newState","RichUtils","Editor","onChange","ConnectedLink","optional","children","forwardingProps","Boolean","href","to","onClick","component","RouterLink","defaultProps","useArticles","articlesProvision","useProvision","domain","isProvision","modelName","observe","query","navigation","isDisabled","selectResult","articlesIds","articlesList","useSelector","state","selectList","isReady","selectIsReady","useArticle","slug","condition","id","article","selectItem","useSubmitArticle","useRequest","method","submitArticle","provision","isSubmitting","includes","readyState","Article","useAuthContext","isAuthenticated","authenticatedUserId","userId","usePaths","literaturePaths","literature","codePaths","code","selfPaths","Typography","variant","body","title","isDraft","isEditable","editArticle","toUrl","withRouter","ArticleComponent","React","DBArticle","selectArticle","useStyles","makeStyles","container","display","iconHome","padding","slugList","flex","loader","margin","classes","useParams","tag","authenticatedUserAlias","userAlias","hasSummaryTag","hasCodeTag","entry","className","List","root","ListItem","button","articles","ListItemText","primary","map","currentSlug","caption","createArticle"],"sourceRoot":""}