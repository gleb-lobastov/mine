(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{804:function(e,t,a){"use strict";var r=a(0),n=a.n(r),i=a(266),o=function(e){return function(t){var a=t.provision,r=(a=void 0===a?{}:a).isPending,o=void 0===r||r,l=a.hasFallback;return o&&!l?n.a.createElement(i.a,null):n.a.createElement(e,t)}},l=a(129);t.a=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}(l.a.apply(void 0,t),o)(e)}}},829:function(e,t,a){"use strict";var r=a(0),n=a.n(r),i=a(2),o=a.n(i),l=a(41),s=a(267),c=a.n(s),u=a(118),d=a(28),p=a(116),m=function(e){var t=e.children,a=e.match.params.userAlias,i=e.namedPaths,o=(i=void 0===i?{}:i).travel,s=(o=void 0===o?{}:o).trips,c=Object(p.c)().userAlias;if(a!==c)return n.a.createElement("span",null,"Пользователь пока еще не внес информацию о своих поездках");var u=Object(r.useCallback)(function(){return n.a.createElement("div",null,n.a.createElement("span",null,"Нам пока ничего не известно о ваших путешествиях. Но очень интересно узнать. Создайте вашу первую поездку, а мы подготовим по ней отчет"),t)},[t]);return n.a.createElement(l.d,null,n.a.createElement(l.b,{path:s.toUrl({userAlias:c}),component:u}),n.a.createElement(l.a,{to:s.toUrl({userAlias:c})}))};m.propTypes={children:o.a.node,match:o.a.shape({params:o.a.shape({userAlias:o.a.string})}).isRequired,namedPaths:o.a.shape({travel:o.a.shape({trips:o.a.instanceOf(u.a)})}).isRequired},m.defaultProps={children:null},t.a=c()(l.g,d.f)(m)},830:function(e,t,a){"use strict";a.d(t,"b",function(){return l}),a.d(t,"a",function(){return s});var r=a(807),n=a.n(r),i=a(831),o=a.n(i),l=function(e){return e.sort(function(e,t){return e.orderInTrip-t.orderInTrip})},s=function(e){return o()(n()(e,"tripId"),l)}},979:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(2),o=a.n(i),l=a(41),s=a(267),c=a.n(s),u=a(789),d=a(137),p=a(129),m=a(804),f=a(28),v=a(116),b=a(829),E=a(798),g=a(792),y=a(791),O=a(975),h=a(974),I=a(176),S=a(119),R=a(7),T=a(797),P=a(799),C=a(793),j=a(985),V=a(794),N=function(e){var t=e.caption,a=e.classes,r=e.hasNullOption,i=e.inputId,o=e.name,l=e.onChange,s=e.optionRender,c=e.options,u=e.value;return n.a.createElement("div",{className:a.container},n.a.createElement(P.a,{component:"label",shrink:!0,htmlFor:i},t),n.a.createElement(V.a,{name:o,value:u,displayEmpty:!0,onChange:l,input:n.a.createElement(C.a,{id:i}),className:a.selectRoot},r&&n.a.createElement(j.a,{key:null,value:null},s({option:null,index:-1,options:c})),c.map(function(e,t){return n.a.createElement(j.a,{key:e,value:e},s({option:e,index:t,options:c}))})))},w=o.a.oneOfType([o.a.number,o.a.string]);N.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(w),value:w},N.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var L=Object(R.a)({container:{display:"inline-block",flexGrow:"1",flexBasis:"0"},selectRoot:{display:"block"}})(N),A=a(966),D=a(788),_=a(786),q=function(e){var t=e.inputValue,a=e.sourceProps,r=(a=void 0===a?{}:a).suggestions,i=void 0===r?[]:r,o=e.children,l=t.toLowerCase();return n.a.createElement(n.a.Fragment,null,o(i.filter(function(e){return e.label.toLowerCase().includes(l)})))};q.propTypes={inputValue:o.a.string.isRequired,sourceProps:o.a.shape({suggestions:o.a.array}).isRequired,children:o.a.func.isRequired};var Y=q;function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){k(e,t,a[t])})}return e}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function U(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var F=function(e){var t=e.inputProps,a=e.classes,r=e.ref,i=U(e,["inputProps","classes","ref"]);return n.a.createElement(T.a,H({InputProps:x({inputRef:r,classes:{root:a.inputRoot,input:a.inputInput}},t)},i))},M=a(973);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var G=function(e){var t=e.itemProps,a=e.isHighlighted,r=e.isSelected,i=e.children,o=i.label,l=i.details;return n.a.createElement(j.a,B({},t,{selected:a,component:"div",style:{fontWeight:r?500:400}}),n.a.createElement(M.a,{primary:o,secondary:l}))};G.propTypes={itemProps:o.a.object,isHighlighted:o.a.bool,isSelected:o.a.bool,children:o.a.func.isRequired},G.defaultProps={itemProps:void 0,isHighlighted:!1,isSelected:!1};var W=G;function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function K(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function J(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var $=Object(D.a)(function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}}),X=function(e){return(e||{}).label},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.SuggestionsResolver,a=void 0===t?Y:t,r=e.SuggestionItemComponent,i=void 0===r?W:r,o=e.InputComponent,l=void 0===o?F:o;return function(e){var t=e.classes,r=e.sourceProps,o=e.inputProps,s=e.inputFieldProps,c=J(e,["classes","sourceProps","inputProps","inputFieldProps"]),u=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){K(e,t,a[t])})}return e}({},$(),t);return n.a.createElement("div",{className:u.root},n.a.createElement(A.a,z({itemToString:X},c),function(e){var t=e.getInputProps,c=e.getItemProps,d=e.getMenuProps,p=e.highlightedIndex,m=e.inputValue,f=e.isOpen,v=e.selectedItem;return n.a.createElement("div",{className:u.container},n.a.createElement(l,z({fullWidth:!0,classes:u,inputProps:t(o)},s)),n.a.createElement("div",d(),f&&n.a.createElement(_.a,{className:u.paper,square:!0},n.a.createElement(a,{inputValue:m,sourceProps:r},function(e){return e.map(function(e,t){return n.a.createElement(i,{key:e.label,itemProps:c({item:e}),isHighlighted:p===t,isSelected:Boolean(v)&&v.label===e.label},e)})}))))}))}};Q();function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ee,te="FILTER",ae="SEARCH",re=function(e){var t=e.queryFormat,a=e.filterField,r=e.inputValue,n={pageSize:e.numberOfItemsToRequest};switch(t){case ae:return{navigation:n,search:r};case te:default:return{navigation:n,filter:Z({},a,{comparator:"~",value:"%".concat(r,"%")})}}},ne=Q({SuggestionsResolver:Object(m.a)(function(e,t){var a=t.inputValue,r=t.sourceProps,n=r.modelName,i=r.domain,o=r.filterField,l=r.numberOfItemsToRequest,s=r.queryFormat;return{domain:i,identity:a,request:{entities:{modelName:n,observe:a,query:re({queryFormat:s,filterField:o,inputValue:a,numberOfItemsToRequest:l})}},debounceRequest:500}})(function(e){var t=e.sourceProps,a=(t=void 0===t?{}:t).filterField,r=t.resolveDetails,n=t.convertEntityToSuggestion,i=void 0===n?function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){Z(e,t,a[t])})}return e}({},e,{label:e[a],details:r?r(e):void 0})}:n,o=e.entities,l=(o=void 0===o?{}:o).data,s=void 0===l?[]:l;return(0,e.children)((s||[]).map(i))})}),ie=a(182);function oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var le=(oe(ee={},ie.TRIP_TYPES.LEISURE,"Отдых"),oe(ee,ie.TRIP_TYPES.BUSINESS,"Работа"),oe(ee,ie.TRIP_TYPES.MIXED,"Смешанный"),oe(ee,ie.TRIP_TYPES.RELOCATION,"Переезд"),oe(ee,ie.TRIP_TYPES.OTHER,"Другой"),ee);function se(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.option;return t?le[t]:"Не указан"},de=function(e){var t=e.tripName,a=e.tripType,n=e.originLocationId,i=e.originGeonameId,o=ce(Object(r.useState)({tripName:t,tripType:a,originLocationId:n,originGeonameId:i}),2),l=o[0],s=o[1];return{tripState:l,setTripState:function(e){return s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){se(e,t,a[t])})}return e}({},l,e))}}},pe=function(e){var t=e.classes,a=e.locationsDict,i=e.tripState,o=i.tripType,l=i.tripName,s=i.originLocationId,c=e.setTripState,u=Object(r.useCallback)(function(e){var t=e.target.value;return c({tripName:t})},[c]),d=Object(r.useCallback)(function(e){var t=e.target.value;return c({tripType:t})},[c]),p=Object(r.useCallback)(function(e){var t=e.geonameId;return c({originGeonameId:t})},[c]),m=(a[s]||{}).locationName;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(T.a,{fullWidth:!0,label:"Название поездки",value:l,onChange:u})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(ne,{classes:{root:t.suggest},textFieldProps:{label:"Старт из"},initialInputValue:m,inputProps:{placeholder:"Пункт отправления..."},onChange:p,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"tripEditCard.geoname",queryFormat:ae,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(L,{caption:"Тип поездки",inputId:"TripEditCard-TripTypeOptions",onChange:d,optionRender:ue,options:Object.values(ie.TRIP_TYPES),hasNullOption:!0,value:o})))};pe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},pe.defaultProps={className:void 0};var me=c()(Object(S.b)(function(e){return{locationsDict:Object(p.d)(e,"locations")}}),Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}}))(pe);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ve=function(e){var t=e.initialState,a=e.children,r=e.onSubmit,i=de(t),o=i.tripState,l=i.setTripState,s=fe(n.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return n.a.createElement(n.a.Fragment,null,n.a.cloneElement(a,{onClick:function(){return d(!0)}}),c&&n.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},n.a.createElement(h.a,{id:"form-dialog-title"},"Поездка"),n.a.createElement(y.a,null,n.a.createElement(O.a,null,"Редактирование поездки"),n.a.createElement(me,{tripState:o,setTripState:l})),n.a.createElement(g.a,null,n.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),n.a.createElement(u.a,{onClick:function(){r(o),p()},color:"primary"},"Сохранить"))))};ve.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},ve.defaultProps={};var be=ve,Ee=a(179),ge=a(830),ye=a(183),Oe=a(177),he=a(178),Ie=a(926),Se=a(790),Re=a(357),Te=a.n(Re),Pe=a(843),Ce=a.n(Pe),je=function(e){for(var t=e.target;t;){if(t.dataset&&"enabled"===t.dataset.sortHandler)return!1;t=t.parentNode}return!0};function Ve(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ne=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},we=a(310),Le=function(e){var t=e.location.locationName,a=void 0===t?"unknown":t,r=e.Icon,i=e.classes;return n.a.createElement("div",{className:i.container},r&&n.a.createElement(r,{className:i.icon}),a)};Le.propTypes={classes:o.a.objectOf(o.a.string).isRequired,location:o.a.shape(Ee.default),Icon:we.a},Le.defaultProps={location:{},Icon:void 0};var Ae,De=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"}})(Le),_e=a(817),qe=a.n(_e),Ye=a(929),He=a.n(Ye),xe=a(927),ke=a.n(xe),Ue=a(842),Fe=a.n(Ue),Me=a(928),Be=a.n(Me),Ge=a(242);function We(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ze=(We(Ae={},Ge.VISIT_TYPES.TRANSIT,"Транзит"),We(Ae,Ge.VISIT_TYPES.REGULAR,"Посещение"),We(Ae,Ge.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),We(Ae,Ge.VISIT_TYPES.RELOCATION,"Переезд"),Ae);function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $e=function(e){var t=e.option;return t?ze[t]:"Не указан"},Xe=function(e){var t=e.visitType,a=e.visitComment,n=e.locationId,i=e.locationName,o=e.geonameId,l=Je(Object(r.useState)({visitComment:a,visitType:t,locationId:n,locationName:i,geonameId:o}),2),s=l[0],c=l[1];return{visitState:s,setVisitState:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){Ke(e,t,a[t])})}return e}({},s,e))}}},Qe=function(e){var t=e.classes,a=e.visitState,i=a.visitType,o=a.visitComment,l=a.locationName,s=e.setVisitState,c=Object(r.useCallback)(function(e){var t=e.target.value;return s({visitType:t})},[s]),u=Object(r.useCallback)(function(e){var t=e.geonameId;return s({geonameId:t})},[s]),d=Object(r.useCallback)(function(e){var t=e.target.value;return s({visitComment:t})},[s]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(ne,{classes:{root:t.suggest},textFieldProps:{label:"Место посещения"},initialInputValue:l,inputProps:{placeholder:"Населенный пункт..."},onChange:u,sourceProps:{filterField:"locationName",modelName:"geonames",domain:"visitEditCard.geoname",queryFormat:ae,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}}})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(L,{caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",onChange:c,optionRender:$e,options:Object.values(Ge.VISIT_TYPES),hasNullOption:!0,value:i})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(T.a,{label:"Комментарий",fullWidth:!0,value:o,onChange:d,multiline:!0,rows:1,rowsMax:12})))};Qe.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Qe.defaultProps={className:void 0};var Ze=Object(R.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}})(Qe);function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tt=function(e){var t=e.initialState,a=e.children,r=e.onSubmit,i=Xe(t),o=i.visitState,l=i.setVisitState,s=et(n.a.useState(!1),2),c=s[0],d=s[1],p=function(){return d(!1)};return n.a.createElement(n.a.Fragment,null,n.a.cloneElement(a,{onClick:function(){return d(!0)}}),c&&n.a.createElement(E.a,{transitionDuration:500,open:c,onClose:p,"aria-labelledby":"form-dialog-title"},n.a.createElement(h.a,{id:"form-dialog-title"},"Посещение"),n.a.createElement(y.a,null,n.a.createElement(O.a,null,"Редактирование посещения"),n.a.createElement(Ze,{visitState:o,setVisitState:l})),n.a.createElement(g.a,null,n.a.createElement(u.a,{onClick:p,color:"secondary"},"Отмена"),n.a.createElement(u.a,{onClick:function(){r(o),p()},color:"primary"},"Сохранить"))))};tt.propTypes={initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},tt.defaultProps={};var at=tt;function rt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var nt=function(e){var t=e.visit,a=e.onVisitUpdate,r=e.classes,i=e.isEditable;if(!t)return"Не указано";var o=t.locationName,l=function(e){switch(e){case"Transit":return ke.a;case"BaseCamp":return Be.a;case"Relocation":return Fe.a;case"Regular":default:return He.a}}(t.visitType);return n.a.createElement("div",{className:r.container},l&&n.a.createElement(l,{className:r.icon}),o,i&&n.a.createElement(at,{initialState:t,onSubmit:function(e){return a(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){rt(e,t,a[t])})}return e}({},t,e))}},n.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},n.a.createElement(Ce.a,{className:r.editIcon}))))};nt.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isEditable:o.a.bool,onVisitUpdate:o.a.func.isRequired,visit:o.a.shape(Oe.default)},nt.defaultProps={isEditable:!1,visit:{}};var it=Object(R.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}})(nt),ot=a(939),lt=a.n(ot),st=a(938),ct=a.n(st),ut=a(936),dt=a.n(ut),pt=a(933),mt=a.n(pt),ft=a(947),vt=a.n(ft),bt=a(935),Et=a.n(bt),gt=a(941),yt=a.n(gt),Ot=a(942),ht=a.n(Ot),It=a(934),St=a.n(It),Rt=a(937),Tt=a.n(Rt),Pt=a(940),Ct=a.n(Pt),jt=a(943),Vt=a.n(jt),Nt=a(944),wt=a.n(Nt),Lt=a(945),At=a.n(Lt),Dt=a(946),_t=a.n(Dt),qt=a(949),Yt=a.n(qt),Ht=a(948),xt=a.n(Ht),kt=a(83),Ut=a(248),Ft=a(965);function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Bt(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Gt=function(e){var t=e.children,a=e.description,r=e.onReject,i=e.onSubmit,o=e.title,l=Bt(e,["children","description","onReject","onSubmit","title"]);return n.a.createElement(Ft.a,Mt({},l,{onSubmit:i}),function(e){var i=e.handleSubmit,l=Bt(e,["handleSubmit"]);return n.a.createElement(E.a,{transitionDuration:500,open:!0,onClose:r,"aria-labelledby":"form-dialog-title"},n.a.createElement(h.a,{id:"form-dialog-title"},o),n.a.createElement(y.a,null,n.a.createElement(O.a,null,a),n.a.cloneElement(t,l)),n.a.createElement(g.a,null,n.a.createElement(u.a,{onClick:r,color:"secondary"},"Отмена"),n.a.createElement(u.a,{onClick:i,color:"primary"},"Сохранить")))})};Gt.propTypes={children:o.a.node.isRequired,description:o.a.node,onReject:o.a.func.isRequired,onSubmit:o.a.func.isRequired,title:o.a.node},Gt.defaultProps={description:void 0,title:void 0};var Wt,zt,Kt,Jt,$t=Gt,Xt=a(976),Qt=a(980),Zt=a(358);function ea(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ta=(ea(Wt={},kt.RIDE_CLASSES.ECONOMY,"Эконом"),ea(Wt,kt.RIDE_CLASSES.COMFORT,"Комфорт"),ea(Wt,kt.RIDE_CLASSES.BUSINESS,"Бизнес"),ea(Wt,kt.RIDE_CLASSES.FIRST,"Первый"),ea(Wt,kt.RIDE_CLASSES.PRIVATE,"Частный"),Wt),aa=(ea(zt={},kt.RIDE_OCCUPATION.PASSENGER,"Пассажир"),ea(zt,kt.RIDE_OCCUPATION.STUFF,"Персонал"),ea(zt,kt.RIDE_OCCUPATION.DRIVER,"Водитель"),zt),ra=(ea(Kt={},kt.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),ea(Kt,kt.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),ea(Kt,kt.RIDE_TYPES.CHARTER,"Чартерный рейс"),ea(Kt,kt.RIDE_TYPES.TOUR,"Тур"),ea(Kt,kt.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),ea(Kt,kt.RIDE_TYPES.HITCH_HIKING,"Автостоп"),ea(Kt,kt.RIDE_TYPES.DROP_OFF,"Подбросили до места"),Kt),na=(ea(Jt={},kt.VEHICLE_TYPES.CAR,"Автомобиль"),ea(Jt,kt.VEHICLE_TYPES.TRAIN,"Поезд"),ea(Jt,kt.VEHICLE_TYPES.AIRCRAFT,"Самолет"),ea(Jt,kt.VEHICLE_TYPES.BUS,"Автобус"),ea(Jt,kt.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),ea(Jt,kt.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),ea(Jt,kt.VEHICLE_TYPES.FERRY,"Паром"),ea(Jt,kt.VEHICLE_TYPES.BIKE,"Велосипед"),ea(Jt,kt.VEHICLE_TYPES.BY_FEET,"Пешком"),ea(Jt,kt.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),ea(Jt,kt.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),ea(Jt,kt.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),ea(Jt,kt.VEHICLE_TYPES.TRUCK,"Грузовик"),ea(Jt,kt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),ea(Jt,kt.VEHICLE_TYPES.TRAM,"Трамвай"),ea(Jt,kt.VEHICLE_TYPES.TROLLEY,"Троллейбус"),ea(Jt,kt.VEHICLE_TYPES.TAXI,"Такси"),ea(Jt,kt.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),ea(Jt,kt.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),ea(Jt,kt.VEHICLE_TYPES.SUBWAY,"Метро"),ea(Jt,kt.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),Jt),ia=a(308),oa=a(309),la=a(244),sa=a(160),ca=function(e){var t=e.dateFrom,a=e.timeFrom;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())},ua=function(e){var t=e.values,a=t.rideDeparture,r=t.rideArrival,n=e.handleChange,i=Object(ia.a)(a,r),o=function(e,t){var i,o,l=(i=e,o=t,Object(sa.a)(i,o)),s=l?t:e,c=l?e:t;Object(oa.a)(a,s)||function(e){n("departureDateTime")(e)}(s),Object(oa.a)(r,c)||function(e){n("arrivalDateTime")(e)}(c)};return{isSameDateField:{value:i,onChange:function(e){Boolean(i)!==Boolean(e)&&o(a,ca({dateFrom:e?a:Object(la.a)(a,1),timeFrom:r}))}},rideDepartureField:{value:a,onChange:function(e){var t=i?ca({timeFrom:r,dateFrom:e}):r;o(e,t)}},rideArrivalField:{value:r,onChange:function(e){var t=i?ca({timeFrom:a,dateFrom:e}):a;o(t,e)}}}};function da(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var pa=null,ma=function(e){var t=e.option;return t?na[t]:"Не указан"},fa=function(e){var t=e.option;return t?ra[t]:"Не указан"},va=function(e){var t=e.option;return t?ta[t]:"Не указан"},ba=function(e){var t=e.option;return t?aa[t]:"Не указан"},Ea=function(e){var t=e.classes,a=e.availableVisits,i=e.originLocation,o=e.values,l=o.departureVisitId,s=o.arrivalVisitId,c=o.vehicleType,u=o.rideType,d=o.rideComment,p=o.rideClass,m=o.rideOccupation,f=o.departureDateTime,v=o.arrivalDateTime,b=e.handleChange,E=a.map(function(e){return e.visitId}),g=Object.fromEntries(a.map(function(e){return[e.visitId,e]})),y=ua({values:{rideDeparture:f,rideArrival:v},handleChange:b}),O=y.rideArrivalField,h=y.rideDepartureField,I=y.isSameDateField,S=Object(r.useCallback)(function(e){var t=e.option;if(t===pa)return i.locationName;var a=g[t];return a?a.locationName:"Не указано"},[g]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(L,{name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:S,hasNullOption:!1,options:[pa].concat(da(E)),value:l,onChange:b}),n.a.createElement(L,{name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:S,options:[].concat(da(E),[pa]),onChange:b,value:s})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(L,{name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:ma,options:Object.values(kt.VEHICLE_TYPES),onChange:b,value:c}),n.a.createElement(L,{name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:fa,options:Object.values(kt.RIDE_TYPES),onChange:b,value:u})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(L,{name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:va,options:Object.values(kt.RIDE_CLASSES),onChange:b,value:p}),n.a.createElement(L,{name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:ba,options:Object.values(kt.RIDE_OCCUPATION),onChange:b,value:m})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(Zt.a,{name:"departureDateTime",autoOk:!0,className:t.option,label:"Дата отправления",value:h.value,onChange:h.onChange,format:"eeeeee, d MMMM yyyy"}),I.value?n.a.createElement(Xt.a,{control:n.a.createElement(Qt.a,{checked:I.value,onChange:function(e){return I.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):n.a.createElement(Zt.a,{name:"arrivalDateTime",autoOk:!0,className:t.option,label:"Дата прибытия",value:O.value,onChange:O.onChange,format:"eeeeee, d MMMM yyyy"})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(Zt.c,{name:"departureDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время отправления",value:h.value,onChange:h.onChange}),n.a.createElement(Zt.c,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:t.option,label:"Время прибытия",value:O.value,onChange:O.onChange})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(T.a,{name:"rideComment",className:t.option,label:"Комментарий",multiline:!0,onChange:b,rows:1,rowsMax:12,value:d})))};Ea.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Ea.defaultProps={className:void 0};var ga=Object(R.a)({optionGroup:{display:"flex"},option:{flexGrow:"1"}})(Ea);function ya(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Oa=function(e){var t=e.availableVisits,a=e.initialState,r=e.children,i=e.className,o=e.onSubmit,l=e.originLocation,s=ya(n.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return n.a.createElement("div",{className:i},n.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},r),c&&n.a.createElement($t,{initialValues:a,enableReinitialize:!0,onSubmit:function(e){o(e),d()},onReject:d,title:"Транспорт",description:"Как вы добрались в место назначения и как уехали из него?"},n.a.createElement(ga,{availableVisits:t,originLocation:l})))};Oa.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),initialState:o.a.shape(I.default).isRequired,children:o.a.node.isRequired,className:o.a.string,onSubmit:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired},Oa.defaultProps={className:void 0,availableVisits:[]};var ha=Oa;function Ia(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Sa=function(e){var t=e.availableVisits,a=e.originLocation,r=e.classes,i=e.className,o=e.defaultArrivalVisitId,l=e.defaultDepartureVisitId,s=e.isEditable,c=e.onRideUpdate,u=e.ride,d=e.ride,p=d.rideId,m=d.vehicleType,f=d.rideType,v=d.arrivalDateTime,b=d.departureDateTime,E=e.showDetails,g=p?u:Object(Ut.a)({defaultDepartureVisitId:l,defaultArrivalVisitId:o}),y=p?function(e){switch(e){case kt.VEHICLE_TYPES.CAR:return mt.a;case kt.VEHICLE_TYPES.TRAIN:return St.a;case kt.VEHICLE_TYPES.AIRCRAFT:return Et.a;case kt.VEHICLE_TYPES.BUS:case kt.VEHICLE_TYPES.TROLLEY:case kt.VEHICLE_TYPES.CITY_BUS:return dt.a;case kt.VEHICLE_TYPES.MOTORHOME:case kt.VEHICLE_TYPES.JITNEY:return Tt.a;case kt.VEHICLE_TYPES.LOCAL_TRAIN:return St.a;case kt.VEHICLE_TYPES.FERRY:return ct.a;case kt.VEHICLE_TYPES.BIKE:return lt.a;case kt.VEHICLE_TYPES.BY_FEET:return Ct.a;case kt.VEHICLE_TYPES.MOTORBIKE:return yt.a;case kt.VEHICLE_TYPES.TRUCK:return Fe.a;case kt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return ht.a;case kt.VEHICLE_TYPES.TRAM:return Vt.a;case kt.VEHICLE_TYPES.TAXI:return wt.a;case kt.VEHICLE_TYPES.SUBWAY:return At.a;case kt.VEHICLE_TYPES.PUBLIC_TRANSPORT:return _t.a;case kt.VEHICLE_TYPES.ROPEWAY:case kt.VEHICLE_TYPES.FUNICULAR:default:return vt.a}}(m):xt.a,O=n.a.createElement(y,{className:r.icon}),h=s?n.a.createElement(ha,{className:r.editDialogTrigger,initialState:g,availableVisits:t,onSubmit:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){Ia(e,t,a[t])})}return e}({},u,e))},originLocation:a},O):O;return n.a.createElement("div",{className:qe()(i,r.container)},f===kt.RIDE_TYPES.HITCH_HIKING&&n.a.createElement(Yt.a,{className:r.icon}),h,Boolean(p&&E)&&n.a.createElement("span",{className:r.details},function(e,t){var a=Boolean(t)&&t.toLocaleDateString(),r=Boolean(e)&&e.toLocaleDateString();return a===r?a:"".concat(r,"—").concat(a)}(b,v)))};Sa.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),classes:o.a.objectOf(o.a.string).isRequired,className:o.a.string,defaultArrivalVisitId:o.a.number,defaultDepartureVisitId:o.a.number,isEditable:o.a.bool,onRideUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,ride:o.a.shape(I.default),showDetails:o.a.bool},Sa.defaultProps={availableVisits:[],className:void 0,defaultArrivalVisitId:void 0,defaultDepartureVisitId:void 0,isEditable:!1,ride:{},showDetails:!1};var Ra=Object(R.a)({container:{display:"inline-block"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},editDialogTrigger:{display:"inline-block"}})(Sa),Ta=a(950),Pa=a.n(Ta),Ca=function(e){var t=e.className,a=e.classes;return n.a.createElement(Pa.a,{className:qe()(t,a.dragHandler),"data-sort-handler":"enabled"})};Ca.propTypes={className:o.a.string,classes:o.a.objectOf(o.a.string).isRequired},Ca.defaultProps={className:void 0};var ja=Object(R.a)({dragHandler:{cursor:"grab",marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block"}})(Ca);function Va(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Na=function(e){var t,a,r=e.visit,i=e.visit,o=(i=void 0===i?{}:i).visitId,l=i.arrivalRideId,s=i.departureRideId,c=e.ridesDict,u=e.classes,d=e.prevVisitId,p=e.nextVisitId,m=e.tripVisitsList,f=e.isEditable,v=e.isSortable,b=e.isSorting,E=e.isArrivalRideMatch,g=e.isDepartureRideMatch,y=e.onRideUpdate,O=e.onVisitUpdate,h=e.originLocation,I=f&&!E,S=f&&!g;return n.a.createElement("div",{className:u.container},n.a.createElement(Ra,{availableVisits:m,defaultDepartureVisitId:d,defaultArrivalVisitId:o,visitId:o,isEditable:f,className:qe()(u.ride,(t={},Va(t,u.alwaysVisible,b||!g),Va(t,u.warning,I),t)),ride:c[l],showDetails:b||I,onRideUpdate:y,originLocation:h}),n.a.createElement(it,{classes:{editIcon:u.visibleOnlyOnHover},isEditable:f,onVisitUpdate:O,visit:r}),(!g||b)&&n.a.createElement(Ra,{className:qe()(u.ride,(a={},Va(a,u.alwaysVisible,b||!g),Va(a,u.warning,S),a)),ride:c[s],availableVisits:m,defaultDepartureVisitId:o,defaultArrivalVisitId:p,isEditable:f&&!g,showDetails:b||S,onRideUpdate:y,originLocation:h}),v&&!b&&n.a.createElement(ja,{className:u.visibleOnlyOnHover}))};Na.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isArrivalRideMatch:o.a.bool,isDepartureRideMatch:o.a.bool,isEditable:o.a.bool,isSortable:o.a.bool,isSorting:o.a.bool,nextVisitId:o.a.number,onRideUpdate:o.a.func.isRequired,onVisitUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,prevVisitId:o.a.number,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default)),visit:o.a.shape(Oe.default).isRequired},Na.defaultProps={isArrivalRideMatch:!0,isDepartureRideMatch:!0,isEditable:!1,isSortable:!1,isSorting:!1,nextVisitId:null,prevVisitId:null,tripVisitsList:[]};var wa=Object(R.a)({alwaysVisible:{},container:{position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}})(Na);var La=function(e){var t,a,r,i=e.classes,o=e.isSorting,l=e.onVisitUpdate;return n.a.createElement("div",{className:qe()((t={},a=i.draggableContainer,r=!o,a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t))},n.a.createElement(at,{initialState:{visitType:null,visitComment:""},onSubmit:l},n.a.createElement(u.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},n.a.createElement("span",null,"Добавить посещение"))),n.a.createElement(ja,{className:i.visibleOnlyOnHover}))};La.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isSorting:o.a.bool,onVisitUpdate:o.a.func.isRequired},La.defaultProps={isSorting:!1};var Aa=Object(R.a)({visibleOnlyOnHover:{visibility:"hidden"},draggableContainer:{position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}}})(La);function Da(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],r=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qa(){return(qa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Ya(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var Ha=Object(Ie.SortableContainer)(function(e){var t=e.children;return n.a.createElement("div",null,t)}),xa=Object(Ie.SortableElement)(function(e){var t=e.replaceWithNode,a=e.onVisitUpdate,r=Ya(e,["replaceWithNode","onVisitUpdate"]);return t||n.a.createElement(wa,qa({onVisitUpdate:a},r))}),ka=function(e){var t=e.classes,a=e.isEditable,i=e.locationsDict,o=e.onRideUpdate,l=e.onVisitsOrderUpdate,s=e.ridesDict,c=e.trip,u=e.trip,d=u.tripId,p=u.originLocationId,m=u.tripName,f=u.tripType,v=e.tripIndex,b=e.tripVisitsList,E=e.onTripUpdate,g=e.onVisitUpdate,y=e.storyUrl,O=a,h=_a(Object(r.useState)(!1),2),I=h[0],S=h[1],R=_a(Object(r.useState)(b.length),2),T=R[0],P=R[1],C=O?xa:wa,j=(a?function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return[].concat(Ve(e.slice(0,a)),[t],Ve(e.slice(a)))}(b,{isItVisitCreatorControl:!0},T):b).map(function(e,t){var r=e.isItVisitCreatorControl,l=e.visitId;if(r)return n.a.createElement(xa,{key:"visitCreator",index:t,replaceWithNode:n.a.createElement(Aa,{isSorting:I,onVisitUpdate:function(e){return g(e,{indexInCollection:T,collection:b,tripId:d})}})});var c=_a(function(e,t,a){var r=t-1-(t>a?1:0),n=t+1-(t+1>a?1:0);return[r>=0?e[r]:null,n<e.length?e[n]:null]}(b,t,T),2),u=c[0],m=c[1],f=(u||{}).visitId,v=(m||{}).visitId;return n.a.createElement(C,{index:t,isArrivalRideMatch:Ne(u,e),isDepartureRideMatch:Ne(e,m),isEditable:a,isSortable:O,isSorting:I,key:l,nextVisitId:v,onRideUpdate:o,onVisitUpdate:g,originLocation:i[p],prevVisitId:f,ridesDict:s,tripVisitsList:b,visit:e})}),V=O?n.a.createElement(Ha,{onSortEnd:function(e,t){S(!1);var a=e.oldIndex,r=e.newIndex;a===T?P(r):l(t,{oldIndex:a>T?a-1:a,newIndex:r>T?r-1:r,collection:b})},shouldCancelStart:je,updateBeforeSortStart:function(){return S(!0)},lockAxis:"y",lockToContainerEdges:!0},j):n.a.createElement("div",null,j),N=n.a.createElement(De,{location:i[p],Icon:Te.a}),w=n.a.createElement(be,{initialState:c,onSubmit:function(e){return E(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){Da(e,t,a[t])})}return e}({},c,e))}},n.a.createElement(Se.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary"},n.a.createElement(Ce.a,{className:t.visibleOnlyOnHover}))),L=b[b.length-1],A=b[b.length-2],D=L||{},_=D.departureRideId,q=D.visitId,Y=f===ie.TRIP_TYPES.RELOCATION,H=Y?null:n.a.createElement(Ra,{availableVisits:b,defaultDepartureVisitId:q,isEditable:a,onRideUpdate:o,originLocation:i[p],ride:s[_],showDetails:I||Ne(A,L)}),x=b.some(function(e){var t=e.visitComment,a=e.arrivalRideId,r=e.departureRideId;if(t)return!0;if((s[a]||{}).rideComment)return!0;var n=(s[r]||{}).rideComment;return Boolean(n)});return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:t.container},"".concat(v+1,". ").concat(m),a&&w),N,V,!Y&&n.a.createElement(n.a.Fragment,null,H,N),x&&n.a.createElement("div",null,n.a.createElement(he.b,{to:y},"Заметки")))};ka.propTypes={classes:o.a.objectOf(o.a.string).isRequired,tripIndex:o.a.number.isRequired,isEditable:o.a.bool,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired,onRideUpdate:o.a.func.isRequired,onTripUpdate:o.a.func.isRequired,onVisitsOrderUpdate:o.a.func.isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,trip:o.a.shape(ye.default).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default))},ka.defaultProps={isSortable:!1,tripVisitsList:[]};var Ua=Object(R.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}})(ka);function Fa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){Ma(e,t,a[t])})}return e}function Ma(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ba,Ga=(Ba={orderResolver:function(e){return e.orderInTrip}}.orderResolver,function(e){var t=e.index,a=e.collection;if(!a.length)return 100;if(t<=0)return Ba(a[0])-1;if(t>=a.length-1)return Ba(a[a.length-1])+1;var r=Ba(a[t-1]),n=Ba(a[t]);return(r+n)/2+(Math.random()-.5)*(n-r)/2}),Wa=a(825),za=a.n(Wa),Ka=Object(d.a)(ge.a),Ja=function(e){var t=e.match.params.userAlias,a=e.isTripsComplete,i=e.trips,o=(i=void 0===i?{}:i).data,l=void 0===o?[]:o,s=e.visits,c=(s=void 0===s?{}:s).data,d=void 0===c?[]:c,p=e.locationsDict,m=e.namedPaths,f=e.ridesDict,E=e.request,g=e.invalidateRequest,y=Object(v.c)(),O=y.isAuthenticated,h=y.userAlias,I=O&&h===t,S=Object(r.useCallback)(function(e,t){var a=t.oldIndex,r=t.newIndex,n=t.collection;a!==r&&E(function(e){var t=e.oldIndex,a=e.newIndex,r=e.collection;return{domain:"tripsPage.visits.sort",modelName:"visits",query:{id:r[t].visitId,body:{orderInTrip:Ga({index:a,collection:r})}}}}({oldIndex:a,newIndex:r,collection:n}))},[E]),R=Object(r.useCallback)(function(e){return E(function(e){var t=e.ride;return{domain:"tripsPage.visits.rides",modelName:"rides",query:{id:e.ride.rideId,body:t}}}({ride:e}))},[E]),T=Object(r.useCallback)(function(e){return E(function(e){var t=e.trip;return{domain:"tripsPage.visits.trips",modelName:"trips",query:{id:e.trip.tripId,body:t}}}({trip:e})).then(function(){return g({domain:"tripsPage.trips"})})},[E]),P=Object(r.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.indexInCollection,r=t.collection,n=t.tripId;return E(function(e){var t=e.visit,a=e.visit.visitId,r=e.tripId,n=e.indexInCollection,i=e.collection;return{domain:"tripsPage.visits.visit",modelName:"visits",query:{id:a,body:Fa({},t,{tripId:r,orderInTrip:n||0===n?Ga({index:n,collection:i}):void 0})}}}({visit:e,tripId:n,indexInCollection:a,collection:r})).then(function(){return g({domain:"tripsPage.visits"})})},[E]),C=Object(r.useMemo)(function(){return n.a.createElement(be,{initialState:{tripType:null},onSubmit:T},n.a.createElement(u.a,{size:"small",variant:"outlined",color:"primary"},"Добавить поездку"))},[T]);if(a&&!l.length)return n.a.createElement(b.a,{shouldShowLinkToTrips:!1},C);var j=Ka(d);return n.a.createElement(n.a.Fragment,null,I&&C,l.map(function(e,t){var a=e.tripId;return n.a.createElement("div",{key:a},n.a.createElement(Ua,{locationsDict:p,onRideUpdate:R,onTripUpdate:T,onVisitUpdate:P,onVisitsOrderUpdate:S,ridesDict:f,trip:e,tripIndex:t,tripVisitsList:j[a],isEditable:I,storyUrl:m.travel.tripStory.toUrl({strTripId:String(a)})}))}))};Ja.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired,namedPaths:f.d.namedPaths.isRequired,request:o.a.func.isRequired,isTripsComplete:o.a.bool.isRequired,trips:o.a.shape({data:o.a.arrayOf(o.a.shape(ye.default))}).isRequired,visits:o.a.shape({data:o.a.arrayOf(o.a.shape(Oe.default))}).isRequired,ridesDict:o.a.objectOf(o.a.shape(I.default)).isRequired,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired};t.default=c()(l.g,f.f,Object(m.a)(function(e,t){var a=t.match.params.userAlias,r=function(e){return((Object(p.e)(e,"tripsPage.trips")||{}).fallback["tripsPage.trips"]||{}).data}(e),n=function(e,t){var a=Object(p.d)(e,"trips"),r=Object(p.d)(e,"locations"),n=t?za()(t.reduce(function(e,t){var r=a[t];if(r){var n=r.originLocationId;n&&e.push(n)}return e},[])):[],i=n.filter(function(e){return!r[e]});return{requiredLocationsIds:n,missingLocationsIds:i}}(e,r),i=n.requiredLocationsIds,o=n.missingLocationsIds;return{domain:"tripsPage",request:{trips:{modelName:"trips",observe:a,query:{userAlias:a,navigation:{isDisabled:!0}}},locations:{modelName:"locations",observe:i,isNoop:!o.length,query:{filter:{id:{comparator:"in",value:o}},navigation:{isDisabled:!0}}},rides:{modelName:"rides",observe:r,isNoop:!r||!r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}},visits:{modelName:"visits",observe:r,isNoop:!r||!r.length,query:{filter:{trip_id:{comparator:"in",value:r}},navigation:{isDisabled:!0}}}}}},function(e){return{locationsDict:Object(p.d)(e,"locations"),ridesDict:Object(p.d)(e,"rides"),isTripsComplete:Object(p.e)(e,"tripsPage.trips").isComplete}}))(Ja)}}]);
//# sourceMappingURL=travel-Trips-d346b51951211d3dd190.js.map