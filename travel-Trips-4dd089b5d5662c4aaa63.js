(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{796:function(e,t,r){"use strict";var a=r(0),n=r.n(a),i=r(262),o=function(e){return function(t){var r=t.provision,a=(r=void 0===r?{}:r).isComplete,o=void 0!==a&&a,l=r.isPending;return!o||(void 0===l||l)?n.a.createElement(i.a,null):n.a.createElement(e,t)}},l=r(127);t.a=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}(l.a.apply(void 0,t),o)(e)}}},811:function(e,t,r){"use strict";var a=r(0),n=r.n(a),i=r(2),o=r.n(i),l=r(176),s=r(38),c=r(260),u=r.n(c),d=r(113),p=r(27),f=function(e){var t=e.children,r=e.match.params.userAlias,a=e.namedPaths,i=(a=void 0===a?{}:a).travel,o=(i=void 0===i?{}:i).trips,s=e.shouldShowLinkToTrips;return n.a.createElement("div",null,n.a.createElement("span",null,"Нам пока ничего не известно о ваших путешествиях. Но очень интересно узнать.")," ",s?n.a.createElement(l.b,{to:o.toUrl({userAlias:r})},"Создайте"):n.a.createElement("span",null,"Создайте")," ",n.a.createElement("span",null,"вашу первую поездку, а мы подготовим по ней отчет"),t)};f.propTypes={children:o.a.node,match:o.a.shape({params:o.a.shape({userAlias:o.a.string})}).isRequired,namedPaths:o.a.shape({travel:o.a.shape({trips:o.a.instanceOf(d.a)})}).isRequired,shouldShowLinkToTrips:o.a.bool},f.defaultProps={children:null,shouldShowLinkToTrips:!0},t.a=u()(s.g,p.f)(f)},824:function(e,t,r){"use strict";r.d(t,"b",function(){return l}),r.d(t,"a",function(){return s});var a=r(799),n=r.n(a),i=r(825),o=r.n(i),l=function(e){return e.sort(function(e,t){return e.orderInTrip-t.orderInTrip})},s=function(e){return o()(n()(e,"tripId"),l)}},962:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(2),o=r.n(i),l=r(38),s=r(260),c=r.n(s),u=r(823),d=r.n(u),p=r(815),f=r.n(p),v=r(135),m=r(127),b=r(796),E=r(27),y=r(136),g=r(811),O=r(784),I=r(783),h=r(792),S=r(786),T=r(785),R=r(959),P=r(958),C=r(175),j=r(114),V=r(7),w=r(791),N=r(794),L=r(787),A=r(967),D=r(788),_=function(e){var t=e.caption,r=e.classes,a=e.hasNullOption,i=e.inputId,o=e.onChange,l=e.optionRender,s=e.options,c=e.value;return n.a.createElement("div",{className:r.container},n.a.createElement(N.a,{component:"label",shrink:!0,htmlFor:i},t),n.a.createElement(D.a,{value:c,displayEmpty:!0,onChange:o,input:n.a.createElement(L.a,{id:i}),className:r.selectRoot},a&&n.a.createElement(A.a,{key:null,value:null},l({option:null,index:-1,options:s})),s.map(function(e,t){return n.a.createElement(A.a,{key:e,value:e},l({option:e,index:t,options:s}))})))},Y=o.a.oneOfType([o.a.number,o.a.string]);_.propTypes={caption:o.a.string.isRequired,classes:o.a.arrayOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(Y),value:Y},_.defaultProps={hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var k=Object(V.a)({container:{display:"inline-block",flexGrow:"1",flexBasis:"0"},selectRoot:{display:"block"}})(_),H=r(953),q=r(782),x=r(780),U=function(e){var t=e.inputValue,r=e.sourceProps,a=(r=void 0===r?{}:r).suggestions,i=void 0===a?[]:a,o=e.children,l=t.toLowerCase();return n.a.createElement(n.a.Fragment,null,o(i.filter(function(e){return e.label.toLowerCase().includes(l)})))};U.propTypes={inputValue:o.a.string.isRequired,sourceProps:o.a.shape({suggestions:o.a.array}).isRequired,children:o.a.func.isRequired};var F=U;function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){G(e,t,r[t])})}return e}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var K=function(e){var t=e.inputProps,r=e.classes,a=e.ref,i=W(e,["inputProps","classes","ref"]);return n.a.createElement(w.a,M({InputProps:B({inputRef:a,classes:{root:r.inputRoot,input:r.inputInput}},t)},i))};function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var J=function(e){var t=e.itemProps,r=e.isHighlighted,a=e.isSelected,i=e.children;return n.a.createElement(A.a,z({},t,{selected:r,component:"div",style:{fontWeight:a?500:400}}),i)};J.propTypes={itemProps:o.a.object,isHighlighted:o.a.bool,isSelected:o.a.bool,children:o.a.func.isRequired},J.defaultProps={itemProps:void 0,isHighlighted:!1,isSelected:!1};var X=J;function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Q(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Z=Object(q.a)(function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}}),ee=function(e){return(e||{}).label},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.SuggestionsResolver,r=void 0===t?F:t,a=e.SuggestionItemComponent,i=void 0===a?X:a,o=e.InputComponent,l=void 0===o?K:o;return function(e){var t=e.sourceProps,a=e.inputProps,o=e.inputFieldProps,s=Q(e,["sourceProps","inputProps","inputFieldProps"]),c=Z();return n.a.createElement("div",{className:c.root},n.a.createElement(H.a,$({itemToString:ee},s),function(e){var s=e.getInputProps,u=e.getItemProps,d=e.getMenuProps,p=e.highlightedIndex,f=e.inputValue,v=e.isOpen,m=e.selectedItem;return n.a.createElement("div",{className:c.container},n.a.createElement(l,$({fullWidth:!0,classes:c,inputProps:s(a)},o)),n.a.createElement("div",d(),v&&n.a.createElement(x.a,{className:c.paper,square:!0},n.a.createElement(r,{inputValue:f,sourceProps:t},function(e){return e.map(function(e,t){return n.a.createElement(i,{key:e.label,itemProps:u({item:e}),isHighlighted:p===t,isSelected:Boolean(m)&&m.label===e.label},e.label)})}))))}))}};te();function re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ae,ne=te({SuggestionsResolver:Object(b.a)(function(e,t){var r=t.inputValue,a=t.sourceProps,n=a.modelName,i=a.domain,o=a.filterField,l=a.numberOfItemsToRequest;return{identity:r,require:{entities:{modelName:n,query:{filter:re({},o,{comparator:"~",value:"%".concat(r,"%")}),navigation:{pageSize:l}}}},meta:{domain:i},debounceRequest:500}})(function(e){var t=e.sourceProps,r=(t=void 0===t?{}:t).filterField,a=t.convertEntityToSuggestion,n=void 0===a?function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){re(e,t,r[t])})}return e}({},e,{label:e[r]})}:a,i=e.entities,o=(i=void 0===i?{}:i).data,l=void 0===o?[]:o;return(0,e.children)((l||[]).map(n))})}),ie=r(239);function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le=(oe(ae={},ie.TRIP_TYPES.LEISURE,"Отдых"),oe(ae,ie.TRIP_TYPES.BUSINESS,"Работа"),oe(ae,ie.TRIP_TYPES.MIXED,"Смешанный"),oe(ae,ie.TRIP_TYPES.OTHER,"Другой"),ae);function se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ue=function(e){var t=e.option;return t?le[t]:"Не указан"},de=function(e){var t=e.tripName,r=e.tripType,n=e.originLocationId,i=ce(Object(a.useState)({tripName:t,tripType:r,originLocationId:n}),2),o=i[0],l=i[1];return{tripState:o,setTripState:function(e){return l(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){se(e,t,r[t])})}return e}({},o,e))}}},pe=function(e){var t=e.classes,r=e.locationsDict,i=e.tripState,o=i.tripType,l=i.tripName,s=i.originLocationId,c=e.setTripState,u=Object(a.useCallback)(function(e){var t=e.target.value;return c({tripName:t})},[c]),d=Object(a.useCallback)(function(e){var t=e.target.value;return c({tripType:t})},[c]),p=Object(a.useCallback)(function(e){var t=e.locationId;return c({originLocationId:t})},[c]),f=(r[s]||{}).locationName;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(w.a,{label:"Название поездки",value:l,onChange:u})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(ne,{textFieldProps:{label:"Старт из"},initialInputValue:f,inputProps:{placeholder:"Населенный пункт..."},onChange:p,sourceProps:{filterField:"locationName",modelName:"locations",domain:"tripEditCard.location"}})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(k,{caption:"Тип поездки",inputId:"TripEditCard-TripTypeOptions",onChange:d,optionRender:ue,options:Object.values(ie.TRIP_TYPES),hasNullOption:!0,value:o})))};pe.propTypes={className:o.a.string,classes:o.a.arrayOf(o.a.string).isRequired},pe.defaultProps={className:void 0};var fe=c()(Object(j.b)(function(e){return{locationsDict:Object(m.d)(e,"locations")}}),Object(V.a)({optionGroup:{display:"block"}}))(pe);function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var me=function(e){var t=e.initialState,r=e.children,a=e.onSubmit,i=de(t),o=i.tripState,l=i.setTripState,s=ve(n.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return n.a.createElement(n.a.Fragment,null,n.a.createElement(O.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},r),c&&n.a.createElement(h.a,{transitionDuration:500,open:c,onClose:d,"aria-labelledby":"form-dialog-title"},n.a.createElement(P.a,{id:"form-dialog-title"},"Поездка"),n.a.createElement(T.a,null,n.a.createElement(R.a,null,"Редактирование поездки"),n.a.createElement(fe,{tripState:o,setTripState:l})),n.a.createElement(S.a,null,n.a.createElement(I.a,{onClick:d,color:"secondary"},"Отмена"),n.a.createElement(I.a,{onClick:function(){a(o),d()},color:"primary"},"Сохранить"))))};me.propTypes={initialState:o.a.shape(C.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},me.defaultProps={};var be=me,Ee=r(177),ye=r(824),ge=r(180),Oe=r(174),Ie=r(176),he=r(917),Se=r(350),Te=r.n(Se),Re=function(e){for(var t=e.target;t;){if(t.dataset&&"enabled"===t.dataset.sortHandler)return!1;t=t.parentNode}return!0};function Pe(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Ce=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},je=r(303),Ve=function(e){var t=e.location.locationName,r=void 0===t?"unknown":t,a=e.Icon,i=e.classes;return n.a.createElement("div",{className:i.container},a&&n.a.createElement(a,{className:i.icon}),r)};Ve.propTypes={classes:o.a.objectOf(o.a.string).isRequired,location:o.a.shape(Ee.default),Icon:je.a},Ve.defaultProps={location:{},Icon:void 0};var we,Ne=Object(V.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"}})(Ve),Le=r(814),Ae=r.n(Le),De=r(920),_e=r.n(De),Ye=r(918),ke=r.n(Ye),He=r(835),qe=r.n(He),xe=r(919),Ue=r.n(xe),Fe=r(240);function Me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Be=(Me(we={},Fe.VISIT_TYPES.TRANSIT,"Транзит"),Me(we,Fe.VISIT_TYPES.REGULAR,"Посещение"),Me(we,Fe.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),Me(we,Fe.VISIT_TYPES.RELOCATION,"Переезд"),we);function Ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ke=function(e){var t=e.option;return t?Be[t]:"Не указан"},ze=function(e){var t=e.visitType,r=e.visitComment,n=e.locationId,i=We(Object(a.useState)({visitComment:r,visitType:t,locationId:n}),2),o=i[0],l=i[1];return{visitState:o,setVisitState:function(e){return l(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Ge(e,t,r[t])})}return e}({},o,e))}}},Je=function(e){var t=e.classes,r=e.locationsDict,i=e.visitState,o=i.visitType,l=i.visitComment,s=i.locationId,c=e.setVisitState,u=Object(a.useCallback)(function(e){var t=e.target.value;return c({visitType:t})},[c]),d=Object(a.useCallback)(function(e){var t=e.locationId;return c({locationId:t})},[c]),p=Object(a.useCallback)(function(e){var t=e.target.value;return c({visitComment:t})},[c]),f=(r[s]||{}).locationName;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(ne,{textFieldProps:{label:"Место посещения"},initialInputValue:f,inputProps:{placeholder:"Населенный пункт..."},onChange:d,sourceProps:{filterField:"locationName",modelName:"locations",domain:"visitEditCard.location"}})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(k,{caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",onChange:u,optionRender:Ke,options:Object.values(Fe.VISIT_TYPES),hasNullOption:!0,value:o})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(w.a,{label:"Комментарий",value:l,onChange:p,multiline:!0,rows:1,rowsMax:12})))};Je.propTypes={className:o.a.string,classes:o.a.arrayOf(o.a.string).isRequired},Je.defaultProps={className:void 0};var Xe=c()(Object(j.b)(function(e){return{locationsDict:Object(m.d)(e,"locations")}}),Object(V.a)({optionGroup:{display:"block"}}))(Je);function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Qe=function(e){var t=e.initialState,r=e.children,a=e.onSubmit,i=ze(t),o=i.visitState,l=i.setVisitState,s=$e(n.a.useState(!1),2),c=s[0],u=s[1],d=function(){return u(!1)};return n.a.createElement(n.a.Fragment,null,n.a.createElement(O.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return u(!0)}},r),c&&n.a.createElement(h.a,{transitionDuration:500,open:c,onClose:d,"aria-labelledby":"form-dialog-title"},n.a.createElement(P.a,{id:"form-dialog-title"},"Посещение"),n.a.createElement(T.a,null,n.a.createElement(R.a,null,"Редактирование посещения"),n.a.createElement(Xe,{visitState:o,setVisitState:l})),n.a.createElement(S.a,null,n.a.createElement(I.a,{onClick:d,color:"secondary"},"Отмена"),n.a.createElement(I.a,{onClick:function(){a(o),d()},color:"primary"},"Сохранить"))))};Qe.propTypes={initialState:o.a.shape(C.default).isRequired,children:o.a.node.isRequired,onSubmit:o.a.func.isRequired},Qe.defaultProps={};var Ze=Qe;function et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tt=function(e){var t=e.visit,r=e.onVisitUpdate,a=e.classes,i=e.isEditable;if(!t)return"Не указано";var o=t.locationName,l=function(e){switch(e){case"Transit":return ke.a;case"BaseCamp":return Ue.a;case"Relocation":return qe.a;case"Regular":default:return _e.a}}(t.visitType);return n.a.createElement("div",{className:a.container},l&&n.a.createElement(l,{className:a.icon}),o,i&&n.a.createElement(Ze,{initialState:t,onSubmit:function(e){return r(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){et(e,t,r[t])})}return e}({},t,e))}},n.a.createElement(f.a,{className:a.editIcon})))};tt.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isEditable:o.a.bool,onVisitUpdate:o.a.func.isRequired,visit:o.a.shape(Oe.default)},tt.defaultProps={isEditable:!1,visit:{}};var rt,at,nt,it,ot=Object(V.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}})(tt),lt=r(927),st=r.n(lt),ct=r(926),ut=r.n(ct),dt=r(924),pt=r.n(dt),ft=r(921),vt=r.n(ft),mt=r(935),bt=r.n(mt),Et=r(923),yt=r.n(Et),gt=r(929),Ot=r.n(gt),It=r(930),ht=r.n(It),St=r(922),Tt=r.n(St),Rt=r(925),Pt=r.n(Rt),Ct=r(928),jt=r.n(Ct),Vt=r(931),wt=r.n(Vt),Nt=r(932),Lt=r.n(Nt),At=r(933),Dt=r.n(At),_t=r(934),Yt=r.n(_t),kt=r(937),Ht=r.n(kt),qt=r(936),xt=r.n(qt),Ut=r(80),Ft=r(245),Mt=r(351);function Bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Gt=(Bt(rt={},Ut.RIDE_CLASSES.ECONOMY,"Эконом"),Bt(rt,Ut.RIDE_CLASSES.COMFORT,"Комфорт"),Bt(rt,Ut.RIDE_CLASSES.BUSINESS,"Бизнес"),Bt(rt,Ut.RIDE_CLASSES.FIRST,"Первый"),Bt(rt,Ut.RIDE_CLASSES.PRIVATE,"Частный"),rt),Wt=(Bt(at={},Ut.RIDE_OCCUPATION.PASSENGER,"Пассажир"),Bt(at,Ut.RIDE_OCCUPATION.STUFF,"Персонал"),Bt(at,Ut.RIDE_OCCUPATION.DRIVER,"Водитель"),at),Kt=(Bt(nt={},Ut.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),Bt(nt,Ut.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),Bt(nt,Ut.RIDE_TYPES.CHARTER,"Чартерный рейс"),Bt(nt,Ut.RIDE_TYPES.TOUR,"Тур"),Bt(nt,Ut.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),Bt(nt,Ut.RIDE_TYPES.HITCH_HIKING,"Автостоп"),Bt(nt,Ut.RIDE_TYPES.DROP_OFF,"Подбросили до места"),nt),zt=(Bt(it={},Ut.VEHICLE_TYPES.CAR,"Автомобиль"),Bt(it,Ut.VEHICLE_TYPES.TRAIN,"Поезд"),Bt(it,Ut.VEHICLE_TYPES.AIRCRAFT,"Самолет"),Bt(it,Ut.VEHICLE_TYPES.BUS,"Автобус"),Bt(it,Ut.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),Bt(it,Ut.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),Bt(it,Ut.VEHICLE_TYPES.FERRY,"Паром"),Bt(it,Ut.VEHICLE_TYPES.BIKE,"Велосипед"),Bt(it,Ut.VEHICLE_TYPES.BY_FEET,"Пешком"),Bt(it,Ut.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),Bt(it,Ut.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),Bt(it,Ut.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),Bt(it,Ut.VEHICLE_TYPES.TRUCK,"Грузовик"),Bt(it,Ut.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),Bt(it,Ut.VEHICLE_TYPES.TRAM,"Трамвай"),Bt(it,Ut.VEHICLE_TYPES.TROLLEY,"Троллейбус"),Bt(it,Ut.VEHICLE_TYPES.TAXI,"Такси"),Bt(it,Ut.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),Bt(it,Ut.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),Bt(it,Ut.VEHICLE_TYPES.SUBWAY,"Метро"),Bt(it,Ut.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),it);function Jt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Qt=null,Zt=function(e){var t=e.option;return t?zt[t]:"Не указан"},er=function(e){var t=e.option;return t?Kt[t]:"Не указан"},tr=function(e){var t=e.option;return t?Gt[t]:"Не указан"},rr=function(e){var t=e.option;return t?Wt[t]:"Не указан"},ar=function(e){var t=e.departureVisitId,r=e.arrivalVisitId,n=e.vehicleType,i=e.rideType,o=e.rideComment,l=e.rideClass,s=e.rideOccupation,c=e.departureDateTime,u=e.arrivalDateTime,d=$t(Object(a.useState)({departureVisitId:t,arrivalVisitId:r,vehicleType:n,rideType:i,rideComment:o,rideClass:l,rideOccupation:s,departureDateTime:c,arrivalDateTime:u}),2),p=d[0],f=d[1];return{rideState:p,setRideState:function(e){return f(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Xt(e,t,r[t])})}return e}({},p,e))}}},nr=function(e){var t=e.classes,r=e.availableVisits,i=e.originLocation,o=e.rideState,l=o.departureVisitId,s=o.arrivalVisitId,c=o.vehicleType,u=o.rideType,d=o.rideComment,p=o.rideClass,f=o.rideOccupation,v=o.departureDateTime,m=o.arrivalDateTime,b=e.setRideState,E=Object(a.useCallback)(function(e){var t=e.target.value;return b({departureVisitId:t})},[b]),y=Object(a.useCallback)(function(e){var t=e.target.value;return b({arrivalVisitId:t})},[b]),g=Object(a.useCallback)(function(e){var t=e.target.value;return b({vehicleType:t})},[b]),O=Object(a.useCallback)(function(e){var t=e.target.value;return b({rideType:t})},[b]),I=Object(a.useCallback)(function(e){var t=e.target.value;return b({rideClass:t})},[b]),h=Object(a.useCallback)(function(e){var t=e.target.value;return b({rideOccupation:t})},[b]),S=Object(a.useCallback)(function(e){return b({arrivalDateTime:e})},[b]),T=Object(a.useCallback)(function(e){return b({departureDateTime:e})},[b]),R=Object(a.useCallback)(function(e){var t=e.target.value;return b({rideComment:t})},[b]),P=r.map(function(e){return e.visitId}),C=Object.fromEntries(r.map(function(e){return[e.visitId,e]})),j=Object(a.useCallback)(function(e){var t=e.option;if(t===Qt)return i.locationName;var r=C[t];return r?r.locationName:"Не указано"},[C]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:t.optionGroup},n.a.createElement(k,{caption:"Отправление из",inputId:"RideEditCard-departureVisitId",onChange:E,optionRender:j,hasNullOption:!1,options:[Qt].concat(Jt(P)),value:l}),n.a.createElement(k,{caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",onChange:y,hasNullOption:!1,optionRender:j,options:[].concat(Jt(P),[Qt]),value:s})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(k,{caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",onChange:g,optionRender:Zt,options:Object.values(Ut.VEHICLE_TYPES),value:c}),n.a.createElement(k,{caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",onChange:O,optionRender:er,options:Object.values(Ut.RIDE_TYPES),value:u})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(k,{caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",onChange:I,optionRender:tr,options:Object.values(Ut.RIDE_CLASSES),value:p}),n.a.createElement(k,{caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",onChange:h,optionRender:rr,options:Object.values(Ut.RIDE_OCCUPATION),value:f})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(Mt.a,{autoOk:!0,className:t.option,label:"Дата отправления",onChange:T,value:v}),n.a.createElement(Mt.c,{ampm:!1,autoOk:!0,className:t.option,label:"Время отправления",onChange:T,value:v})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(Mt.a,{autoOk:!0,className:t.option,label:"Дата прибытия",onChange:S,value:m}),n.a.createElement(Mt.c,{ampm:!1,autoOk:!0,className:t.option,label:"Время прибытия",onChange:S,value:m})),n.a.createElement("div",{className:t.optionGroup},n.a.createElement(w.a,{className:t.option,label:"Комментарий",multiline:!0,onChange:R,rows:1,rowsMax:12,value:d})))};nr.propTypes={className:o.a.string,classes:o.a.arrayOf(o.a.string).isRequired},nr.defaultProps={className:void 0};var ir=Object(V.a)({optionGroup:{display:"flex"},option:{flexGrow:"1"}})(nr);function or(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var lr=function(e){var t=e.availableVisits,r=e.initialState,a=e.children,i=e.className,o=e.onSubmit,l=e.originLocation,s=ar(r),c=s.rideState,u=s.setRideState,d=or(n.a.useState(!1),2),p=d[0],f=d[1],v=function(){return f(!1)};return n.a.createElement("div",{className:i},n.a.createElement(O.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return f(!0)}},a),p&&n.a.createElement(h.a,{transitionDuration:500,open:!0,onClose:v,"aria-labelledby":"form-dialog-title"},n.a.createElement(P.a,{id:"form-dialog-title"},"Транспорт"),n.a.createElement(T.a,null,n.a.createElement(R.a,null,"Как вы добрались в место назначения и как уехали из него?"),n.a.createElement(ir,{availableVisits:t,rideState:c,setRideState:u,originLocation:l})),n.a.createElement(S.a,null,n.a.createElement(I.a,{onClick:v,color:"secondary"},"Отмена"),n.a.createElement(I.a,{onClick:function(){o(c),v()},color:"primary"},"Сохранить"))))};lr.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),initialState:o.a.shape(C.default).isRequired,children:o.a.node.isRequired,className:o.a.string,onSubmit:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired},lr.defaultProps={className:void 0,availableVisits:[]};var sr=lr;function cr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ur=function(e){var t=e.availableVisits,r=e.originLocation,a=e.classes,i=e.className,o=e.defaultArrivalVisitId,l=e.defaultDepartureVisitId,s=e.isEditable,c=e.onRideUpdate,u=e.ride,d=e.ride,p=d.rideId,f=d.vehicleType,v=d.rideType,m=d.arrivalDateTime,b=d.departureDateTime,E=e.showDetails,y=p?u:Object(Ft.a)({defaultDepartureVisitId:l,defaultArrivalVisitId:o}),g=p?function(e){switch(e){case Ut.VEHICLE_TYPES.CAR:return vt.a;case Ut.VEHICLE_TYPES.TRAIN:return Tt.a;case Ut.VEHICLE_TYPES.AIRCRAFT:return yt.a;case Ut.VEHICLE_TYPES.BUS:case Ut.VEHICLE_TYPES.TROLLEY:case Ut.VEHICLE_TYPES.CITY_BUS:return pt.a;case Ut.VEHICLE_TYPES.MOTORHOME:case Ut.VEHICLE_TYPES.JITNEY:return Pt.a;case Ut.VEHICLE_TYPES.LOCAL_TRAIN:return Tt.a;case Ut.VEHICLE_TYPES.FERRY:return ut.a;case Ut.VEHICLE_TYPES.BIKE:return st.a;case Ut.VEHICLE_TYPES.BY_FEET:return jt.a;case Ut.VEHICLE_TYPES.MOTORBIKE:return Ot.a;case Ut.VEHICLE_TYPES.TRUCK:return qe.a;case Ut.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return ht.a;case Ut.VEHICLE_TYPES.TRAM:return wt.a;case Ut.VEHICLE_TYPES.TAXI:return Lt.a;case Ut.VEHICLE_TYPES.SUBWAY:return Dt.a;case Ut.VEHICLE_TYPES.PUBLIC_TRANSPORT:return Yt.a;case Ut.VEHICLE_TYPES.ROPEWAY:case Ut.VEHICLE_TYPES.FUNICULAR:default:return bt.a}}(f):xt.a,O=n.a.createElement(g,{className:a.icon}),I=s?n.a.createElement(sr,{className:a.editDialogTrigger,initialState:y,availableVisits:t,onSubmit:function(e){return c(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){cr(e,t,r[t])})}return e}({},u,e))},originLocation:r},O):O;return n.a.createElement("div",{className:Ae()(i,a.container)},v===Ut.RIDE_TYPES.HITCH_HIKING&&n.a.createElement(Ht.a,{className:a.icon}),I,Boolean(p&&E)&&n.a.createElement("span",{className:a.details},function(e,t){var r=Boolean(t)&&t.toLocaleDateString(),a=Boolean(e)&&e.toLocaleDateString();return r===a?r:"".concat(a,"—").concat(r)}(b,m)))};ur.propTypes={availableVisits:o.a.arrayOf(o.a.shape(Oe.default)),classes:o.a.objectOf(o.a.string).isRequired,className:o.a.string,defaultArrivalVisitId:o.a.number,defaultDepartureVisitId:o.a.number,isEditable:o.a.bool,onRideUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,ride:o.a.shape(C.default),showDetails:o.a.bool},ur.defaultProps={availableVisits:[],className:void 0,defaultArrivalVisitId:void 0,defaultDepartureVisitId:void 0,isEditable:!1,ride:{},showDetails:!1};var dr=Object(V.a)({container:{display:"inline-block"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},editDialogTrigger:{display:"inline-block"}})(ur),pr=r(938),fr=r.n(pr),vr=function(e){var t=e.className,r=e.classes;return n.a.createElement(fr.a,{className:Ae()(t,r.dragHandler),"data-sort-handler":"enabled"})};vr.propTypes={className:o.a.string,classes:o.a.arrayOf(o.a.string).isRequired},vr.defaultProps={className:void 0};var mr=Object(V.a)({dragHandler:{cursor:"grab",marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block"}})(vr);function br(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Er=function(e){var t,r,a=e.visit,i=e.visit,o=(i=void 0===i?{}:i).visitId,l=i.arrivalRideId,s=i.departureRideId,c=e.ridesDict,u=e.classes,d=e.prevVisitId,p=e.nextVisitId,f=e.tripVisitsList,v=e.isEditable,m=e.isSortable,b=e.isSorting,E=e.isArrivalRideMatch,y=e.isDepartureRideMatch,g=e.onRideUpdate,O=e.onVisitUpdate,I=e.originLocation,h=v&&!E,S=v&&!y;return n.a.createElement("div",{className:u.container},n.a.createElement(dr,{availableVisits:f,defaultDepartureVisitId:d,defaultArrivalVisitId:o,visitId:o,isEditable:v,className:Ae()(u.ride,(t={},br(t,u.alwaysVisible,b||!y),br(t,u.warning,h),t)),ride:c[l],showDetails:b||h,onRideUpdate:g,originLocation:I}),n.a.createElement(ot,{classes:{editIcon:u.visibleOnlyOnHover},isEditable:v,onVisitUpdate:O,visit:a}),(!y||b)&&n.a.createElement(dr,{className:Ae()(u.ride,(r={},br(r,u.alwaysVisible,b||!y),br(r,u.warning,S),r)),ride:c[s],availableVisits:f,defaultDepartureVisitId:o,defaultArrivalVisitId:p,isEditable:v&&!y,showDetails:b||S,onRideUpdate:g,originLocation:I}),m&&!b&&n.a.createElement(mr,{className:u.visibleOnlyOnHover}))};Er.propTypes={classes:o.a.objectOf(o.a.string).isRequired,isArrivalRideMatch:o.a.bool,isDepartureRideMatch:o.a.bool,isEditable:o.a.bool,isSortable:o.a.bool,isSorting:o.a.bool,nextVisitId:o.a.number,onRideUpdate:o.a.func.isRequired,onVisitUpdate:o.a.func.isRequired,originLocation:o.a.shape(Ee.default).isRequired,prevVisitId:o.a.number,ridesDict:o.a.objectOf(o.a.shape(C.default)).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default)),visit:o.a.shape(Oe.default).isRequired},Er.defaultProps={isArrivalRideMatch:!0,isDepartureRideMatch:!0,isEditable:!1,isSortable:!1,isSorting:!1,nextVisitId:null,prevVisitId:null,tripVisitsList:[]};var yr=Object(V.a)({alwaysVisible:{},container:{position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}})(Er);var gr=function(e){var t,r,a,i=e.classes,o=e.isSorting,l=e.onVisitUpdate;return n.a.createElement("div",{className:Ae()((t={},r=i.draggableContainer,a=!o,r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t))},n.a.createElement("span",null,"Добавить поездку"),n.a.createElement(Ze,{initialState:{visitType:null,visitComment:""},onSubmit:l},n.a.createElement(f.a,{className:i.visibleOnlyOnHover})),n.a.createElement(mr,{className:i.visibleOnlyOnHover}))};gr.propTypes={classes:o.a.arrayOf(o.a.string).isRequired,isSorting:o.a.bool,onVisitUpdate:o.a.func.isRequired},gr.defaultProps={isSorting:!1};var Or=Object(V.a)({visibleOnlyOnHover:{visibility:"hidden"},draggableContainer:{position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}}})(gr);function Ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Sr(){return(Sr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Tr(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Rr=Object(he.SortableContainer)(function(e){var t=e.children;return n.a.createElement("div",null,t)}),Pr=Object(he.SortableElement)(function(e){var t=e.replaceWithNode,r=e.onVisitUpdate,a=Tr(e,["replaceWithNode","onVisitUpdate"]);return t||n.a.createElement(yr,Sr({onVisitUpdate:r},a))}),Cr=function(e){var t=e.isEditable,r=e.locationsDict,i=e.onRideUpdate,o=e.onVisitsOrderUpdate,l=e.ridesDict,s=e.trip,c=e.trip,u=c.tripId,d=c.originLocationId,p=c.tripName,v=e.tripIndex,m=e.tripVisitsList,b=e.onTripUpdate,E=e.onVisitUpdate,y=e.storyUrl,g=t,O=hr(Object(a.useState)(!1),2),I=O[0],h=O[1],S=hr(Object(a.useState)(m.length),2),T=S[0],R=S[1],P=g?Pr:yr,C=(t?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return[].concat(Pe(e.slice(0,r)),[t],Pe(e.slice(r)))}(m,{isItVisitCreatorControl:!0},T):m).map(function(e,a){var o=e.isItVisitCreatorControl,s=e.visitId;if(o)return n.a.createElement(Pr,{key:"visitCreator",index:a,replaceWithNode:n.a.createElement(Or,{isSorting:I,onVisitUpdate:function(e){return E(e,{indexInCollection:T,collection:m,tripId:u})}})});var c=hr(function(e,t,r){var a=t-1-(t>r?1:0),n=t+1-(t+1>r?1:0);return[a>=0?e[a]:null,n<e.length?e[n]:null]}(m,a,T),2),p=c[0],f=c[1],v=(p||{}).visitId,b=(f||{}).visitId;return n.a.createElement(P,{index:a,isArrivalRideMatch:Ce(p,e),isDepartureRideMatch:Ce(e,f),isEditable:t,isSortable:g,isSorting:I,key:s,nextVisitId:b,onRideUpdate:i,onVisitUpdate:E,originLocation:r[d],prevVisitId:v,ridesDict:l,tripVisitsList:m,visit:e})}),j=g?n.a.createElement(Rr,{onSortEnd:function(e,t){h(!1);var r=e.oldIndex,a=e.newIndex;r===T?R(a):o(t,{oldIndex:r>T?r-1:r,newIndex:a>T?a-1:a,collection:m})},shouldCancelStart:Re,updateBeforeSortStart:function(){return h(!0)},lockAxis:"y",lockToContainerEdges:!0},C):n.a.createElement("div",null,C),V=n.a.createElement(Ne,{location:r[d],Icon:Te.a}),w=n.a.createElement(be,{initialState:s,onSubmit:function(e){return b(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Ir(e,t,r[t])})}return e}({},s,e))}},n.a.createElement(f.a,null)),N=m[m.length-1],L=m[m.length-2],A=N||{},D=A.departureRideId,_=A.visitId,Y=n.a.createElement(dr,{availableVisits:m,defaultDepartureVisitId:_,isEditable:t,onRideUpdate:i,originLocation:r[d],ride:l[D],showDetails:I||Ce(L,N)}),k=m.some(function(e){var t=e.visitComment,r=e.arrivalRideId,a=e.departureRideId;if(t)return!0;if((l[r]||{}).rideComment)return!0;var n=(l[a]||{}).rideComment;return Boolean(n)});return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,"".concat(v+1,". ").concat(p),t&&w),V,j,Y,V,k&&n.a.createElement("div",null,n.a.createElement(Ie.b,{to:y},"Заметки")))};Cr.propTypes={tripIndex:o.a.number.isRequired,isEditable:o.a.bool,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired,onRideUpdate:o.a.func.isRequired,onTripUpdate:o.a.func.isRequired,onVisitsOrderUpdate:o.a.func.isRequired,ridesDict:o.a.objectOf(o.a.shape(C.default)).isRequired,trip:o.a.shape(ge.default).isRequired,tripVisitsList:o.a.arrayOf(o.a.shape(Oe.default))},Cr.defaultProps={isSortable:!1,tripVisitsList:[]};var jr=Cr;function Vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){wr(e,t,r[t])})}return e}function wr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nr,Lr=(Nr={orderResolver:function(e){return e.orderInTrip}}.orderResolver,function(e){var t=e.index,r=e.collection;if(!r.length)return 100;if(t<=0)return Nr(r[0])-1;if(t>=r.length-1)return Nr(r[r.length-1])+1;var a=Nr(r[t-1]),n=Nr(r[t]);return(a+n)/2+(Math.random()-.5)*(n-a)/2}),Ar=Object(v.a)(ye.a),Dr=function(e){var t=e.trips,r=(t=void 0===t?{}:t).data,i=void 0===r?[]:r,o=e.visits,l=(o=void 0===o?{}:o).data,s=void 0===l?[]:l,c=e.locationsDict,u=e.namedPaths,d=e.ridesDict,p=e.request,v=Object(y.c)().isAuthenticated,m=Object(a.useCallback)(function(e,t){var r=t.oldIndex,a=t.newIndex,n=t.collection;r!==a&&p(function(e){var t=e.oldIndex,r=e.newIndex,a=e.collection;return{modelName:"visits",query:{id:a[t].visitId,body:{orderInTrip:Lr({index:r,collection:a})}},meta:{domain:"trips.visits.sort"}}}({oldIndex:r,newIndex:a,collection:n}))},[p]),b=Object(a.useCallback)(function(e){return p(function(e){var t=e.ride;return{modelName:"rides",query:{id:e.ride.rideId,body:t},meta:{domain:"trips.visits.rides"}}}({ride:e}))},[p]),E=Object(a.useCallback)(function(e){return p(function(e){var t=e.trip;return{modelName:"trips",query:{id:e.trip.tripId,body:t},meta:{domain:"trips.visits.trips"}}}({trip:e}))},[p]),O=Object(a.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.indexInCollection,a=t.collection,n=t.tripId;return p(function(e){var t=e.visit,r=e.visit.visitId,a=e.tripId,n=e.indexInCollection,i=e.collection;return{modelName:"visits",query:{id:r,body:Vr({},t,{tripId:a,orderInTrip:n||0===n?Lr({index:n,collection:i}):void 0})},meta:{domain:"trips.visits.visit"}}}({visit:e,tripId:n,indexInCollection:r,collection:a}))},[p]),I=n.a.createElement(be,{initialState:{tripType:null},onSubmit:E},n.a.createElement(f.a,null));if(!i.length)return n.a.createElement(g.a,{shouldShowLinkToTrips:!1},I);var h=Ar(s);return n.a.createElement(n.a.Fragment,null,v&&I,i.map(function(e,t){var r=e.tripId;return n.a.createElement("div",{key:r},n.a.createElement(jr,{locationsDict:c,onRideUpdate:b,onTripUpdate:E,onVisitUpdate:O,onVisitsOrderUpdate:m,ridesDict:d,trip:e,tripIndex:t,tripVisitsList:h[r],isEditable:v,storyUrl:u.travel.tripStory.toUrl({strTripId:String(r)})}))}))};Dr.propTypes={namedPaths:E.d.namedPaths.isRequired,isAuthenticated:y.a.isAuthenticated.isRequired,request:o.a.func.isRequired,trips:o.a.shape({data:o.a.arrayOf(o.a.shape(ge.default))}).isRequired,visits:o.a.shape({data:o.a.arrayOf(o.a.shape(Oe.default))}).isRequired,ridesDict:o.a.objectOf(o.a.shape(C.default)).isRequired,locationsDict:o.a.objectOf(o.a.shape(Ee.default)).isRequired};t.default=c()(l.g,E.f,Object(b.a)(function(e,t){var r=t.locationsDict,a=void 0===r?{}:r,n=t.match.params.userAlias,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).userAlias,o=Object(m.e)(e,"trips.trips")||{},l=o.isComplete,s=(o.fallback[0]||{}).data,c=void 0===s?[]:s,u=Object(m.d)(e,"trips"),p=d()(c.reduce(function(e,t){var r=u[t];if(r){var a=r.originLocationId;a&&e.push(a)}return e},[])).filter(function(e){return!a[e]}),f=i!==n;return{identity:{userAlias:n,userTripsIds:c,missingLocationsIds:p},require:{locations:{modelName:"locations",isMissingIf:p.length,query:{filter:{id:{comparator:"in",value:p}},navigation:{isDisabled:!0}}},trips:{modelName:"trips",isMissingIf:f,query:{userAlias:n,navigation:{isDisabled:!0}}},rides:{modelName:"rides",isMissingIf:l&&c.length,query:{filter:{trip_id:{comparator:"in",value:c}},navigation:{isDisabled:!0}}},visits:{modelName:"visits",isMissingIf:l&&c.length,query:{filter:{trip_id:{comparator:"in",value:c}},navigation:{isDisabled:!0}}}},meta:{domain:"trips"}}},function(e){return{locationsDict:Object(m.d)(e,"locations"),ridesDict:Object(m.d)(e,"rides")}}))(Dr)}}]);
//# sourceMappingURL=travel-Trips-4dd089b5d5662c4aaa63.js.map