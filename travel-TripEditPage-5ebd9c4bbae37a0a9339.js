"use strict";(self.webpackChunkmine=self.webpackChunkmine||[]).push([[993],{40043:(e,t,r)=>{r.d(t,{Z:()=>u}),r(47941),r(82772),r(82526),r(19601);var n=r(67294),i=r(73727),a=r(89659),o=r(22318),l=["optional","children"];function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}function u(e){var t=e.optional,r=e.children,u=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,l);return Boolean(!t||u.href||u.to||u.onClick)?n.createElement(a.Z,c({},u,{component:i.rU}),r):n.createElement(o.Z,u,r)}u.defaultProps={optional:!1}},81376:(e,t,r)=>{r.d(t,{xK:()=>p,JH:()=>d,Gd:()=>m}),r(92222);var n=r(3151),i=r(49160),a=r(60792),o=r(28523),l=r(41297),c="d MMMM yyyy",u="LLLL yyyy";function s(e,t,r){var s=r?u:c,p=(0,l.Z)(t,s,{locale:o.Z});if((0,n.Z)(e,t))return p;var d="";if((0,i.Z)(e,t))r||(d=(0,l.Z)(e,"d",{locale:o.Z}));else if((0,a.Z)(e,t)){var m=r?"LLLL":"d MMMM";d=(0,l.Z)(e,m,{locale:o.Z})}else d=(0,l.Z)(e,s,{locale:o.Z});return"".concat(d,"—").concat(p)}function p(e,t){return s(e.departureDateTime,e.arrivalDateTime,t)}function d(e,t){var r=e.departureDateTime;return s(e.arrivalDateTime,r,t)}function m(e){var t=e.periodStart,r=e.periodEnd,n=e.isObscure,i=e.placeholder;if(!r){var a=n?u:c,p=(0,l.Z)(t,a,{locale:o.Z});return"".concat(p,"—").concat(i)}return s(t,r,n)}},13090:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(67294),i=r(99930),a=r(85329),o=r(13200),l=r(78),c=r(85976),u=r(29509),s=r(30913),p=r(72106),d=r(56647),m=r(22074),f=r(83612),v=r(50429),E=r(83562),y=r(38756),b=r(97856),O=r(22940),g=r(23518),I=r(17493);function h(e){var t=e.ride.vehicleType,r=e.className,h=function(e){switch(e){case I.VEHICLE_TYPES.CAR:return l.Z;case I.VEHICLE_TYPES.TRAIN:return d.Z;case I.VEHICLE_TYPES.AIRCRAFT:return u.Z;case I.VEHICLE_TYPES.BUS:case I.VEHICLE_TYPES.TROLLEY:case I.VEHICLE_TYPES.CITY_BUS:return o.Z;case I.VEHICLE_TYPES.MOTORHOME:case I.VEHICLE_TYPES.JITNEY:return f.Z;case I.VEHICLE_TYPES.LOCAL_TRAIN:return d.Z;case I.VEHICLE_TYPES.FERRY:return a.Z;case I.VEHICLE_TYPES.BIKE:return i.Z;case I.VEHICLE_TYPES.BY_FEET:return v.Z;case I.VEHICLE_TYPES.MOTORBIKE:return s.Z;case I.VEHICLE_TYPES.TRUCK:return m.Z;case I.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return p.Z;case I.VEHICLE_TYPES.TRAM:return E.Z;case I.VEHICLE_TYPES.TAXI:return y.Z;case I.VEHICLE_TYPES.SUBWAY:return b.Z;case I.VEHICLE_TYPES.PUBLIC_TRANSPORT:return O.Z;case I.VEHICLE_TYPES.ROPEWAY:case I.VEHICLE_TYPES.FUNICULAR:return c.Z;default:return g.Z}}(t);return n.createElement(h,{className:r})}},3807:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(67294),i=r(41120),a=r(45928),o=r(81376),l=r(17493),c=r(13090),u=(0,i.Z)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function s(e){var t=e.ride,r=e.ride,i=(r=void 0===r?{}:r).rideType,s=e.className,p=e.isLong,d=u();return t?n.createElement("div",{className:s},n.createElement(c.Z,{ride:t,className:d.icon}),i===l.RIDE_TYPES.HITCH_HIKING&&n.createElement(a.Z,{className:d.absoluteIcon}),p&&(0,o.xK)(t)):null}},37587:(e,t,r)=>{r.d(t,{w:()=>m}),r(2707),r(21249),r(57640),r(9924),r(47941),r(57327),r(41539),r(88449),r(2490),r(59849),r(92222),r(9653);var n=r(37950),i=r(99890),a=r(7739),o=r.n(a),l=(r(69600),r(47042),r(44908)),c=r.n(l);const u=function(e,t){var r=t.maxLength,n=t.separator,i=void 0===n?", ":n,a=c()(e),o=a.slice(0,r).join(i);return a.length>r?"".concat(o,"..."):o};var s=r(56941),p=r(81376),d="Без названия";function m(e,t,r,a){var l,c=e||{},m=c.visits,f=c.originLocationId,v=c.tripName,E=c.hasAutogeneratedTripName,y=null===(l=a[f])||void 0===l?void 0:l.countryId;if(!E)return v||d;if(!m.length)return d;var b=(0,p.JH)({arrivalDateTime:(0,n.Z)(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime}))),departureDateTime:(0,i.Z)(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime})))}),O=Object.keys(o()(m.filter((function(e){var r;return(null===(r=t[e])||void 0===r?void 0:r.visitType)!==s.VISIT_TYPES.TRANSIT})),"countryId"));if(1===O.length){var g=u(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.locationName})),{maxLength:4});return"".concat(g||d,", ").concat(b)}var I=u(O.map((function(e){return Number(e)!==y&&r[e]&&r[e].countryName})).filter(Boolean),{maxLength:4});return"".concat(I||d,", ").concat(b)}},35118:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ur}),r(74916),r(4723),r(91058);var n=r(67294),i=r(5977),a=r(94649),o=r(84090),l=r(27610),c=r(30822),u=r(89407),s=r(41120),p=r(282),d=(r(66992),r(41539),r(33948),r(69600),r(57327),r(88449),r(2490),r(59849),r(26833),r(79753),r(82526),r(41817),r(32165),r(78783),r(47042),r(68309),r(91038),r(77601),r(69070),r(47941),r(38880),r(89554),r(15581),r(34514),r(54747),r(49337),r(33321),r(41749)),m=r(30553),f=r(13258),v=r(8286),E=(r(21249),r(57640),r(9924),r(92015)),y=r(43700),b=r(38799),O=r(85639),g=r(23200),I=function(e){var t=e["data-locator"],r=e.caption,i=e.classes,a=e.hasNullOption,o=e.inputId,l=e.name,c=e.onChange,u=e.optionRender,s=e.options,p=e.value;return n.createElement("div",{"data-locator":t,className:i.container},n.createElement(y.Z,{component:"label",shrink:!0,htmlFor:o},r),n.createElement(g.Z,{name:l,value:p,displayEmpty:!0,onChange:c,input:n.createElement(b.Z,{id:o}),className:i.selectRoot,MenuProps:{"data-locator":"options-".concat(o)}},a&&n.createElement(O.Z,{"data-locator":"option-null",key:null,value:null},u({option:null,index:-1,options:s})),s.map((function(e,t){return n.createElement(O.Z,{"data-locator":"option-".concat(e),key:e,value:e},u({option:e,index:t,options:s}))}))))};I.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};const h=(0,E.Z)({container:{display:"block"},selectRoot:{display:"block"}})(I);r(82772),r(19601);var T=r(71755),P=r(79895),S=r(95757),C=["isHighlighted","isSelected","option"];function R(){return R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R.apply(this,arguments)}function D(e){var t=e.isHighlighted,r=e.isSelected,i=e.option,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,C);return n.createElement(O.Z,R({component:"div",selected:t,style:{fontWeight:r?500:400}},a),n.createElement(S.Z,{primary:i.label,secondary:i.details}))}function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_.apply(this,arguments)}function j(e){var t=e.isOpen,r=e.options,i=e.classes,a=e.getMenuProps,o=e.getItemProps,l=e.selectedItem,c=e.highlightedIndex;return n.createElement("div",a(),t&&n.createElement(P.Z,{className:i.paper,square:!0},r.map((function(e,t){return n.createElement(D,_({key:e.label},o({item:e}),{isHighlighted:c===t,isSelected:Boolean(l)&&l.label===e.label,option:e}))}))))}var A=r(57557),N=r.n(A);function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){var t=e.classes,r=e.triggerProps,i=e.triggerInputProps;return n.createElement(v.Z,w({InputProps:L({classes:{root:t.inputRoot,input:t.inputInput}},i),fullWidth:!0,classes:N()(t,"inputRoot","inputInput")},r))}var k=["data-locator","classes","options","inputProps","triggerProps"];function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y.apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B=(0,s.Z)((function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}})),U=function(e){return(e||{}).label};function G(e){var t=e["data-locator"],r=e.classes,i=e.options,a=e.inputProps,o=e.triggerProps,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,k),c=F(F({},B()),r);return n.createElement("div",{"data-locator":t,className:c.root},n.createElement(T.ZP,Y({itemToString:U},l),(function(e){var t=e.getInputProps,r=e.getItemProps,l=e.getMenuProps,u=e.highlightedIndex,s=e.inputValue,p=e.isOpen,d=e.selectedItem;return n.createElement("div",{className:c.container},n.createElement(x,{classes:c,inputValue:s,triggerProps:o,triggerInputProps:t(a)}),n.createElement(j,{isOpen:p,options:i,classes:c,getMenuProps:l,getItemProps:r,selectedItem:d,highlightedIndex:u}))})))}var q=r(12291),K=r(91949),z=r(24774);function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){J(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Q="SEARCH";function X(e){var t=e.queryFormat,r=e.filterField,n=e.inputValue,i={pageSize:e.numberOfItemsToRequest};return W(W({},e.customQuery),{},t===Q?{navigation:i,search:n}:{navigation:i,filter:J({},r,{comparator:"~",value:"%".concat(n,"%")})})}var ee=["classes","inputProps","triggerProps","sourceProps","transformSuggestionToOption"];function te(){return te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},te.apply(this,arguments)}function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oe(e){var t,r,i=e.classes,a=e.inputProps,o=e.triggerProps,l=e.sourceProps,c=e.transformSuggestionToOption,u=void 0===c?function(e){return e}:c,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,ee),p=(t=(0,n.useState)(""),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=p[0],m=p[1],f=function(e){var t=e.domain,r=e.modelName,n=e.inputValue,i=e.queryFormat,a=e.filterField,o=e.customQuery,l=e.numberOfItemsToRequest,c=e.debounceRequestDelayMs,u=void 0===c?400:c,s=(0,z.xv)({debounceRequest:u,domain:t,isProvision:!0,modelName:r,observe:n,query:X({queryFormat:i,filterField:a,inputValue:n,numberOfItemsToRequest:l,customQuery:o})}),p=((0,K.tF)(s)||{}).data,d=void 0===p?[]:p,m=(0,q.v9)((function(e){return(0,z.d5)(e,r)||{}}));return{provision:s,suggestions:d.map((function(e){return m[e]})).filter(Boolean)}}(ne(ne({},l),{},{inputValue:d})),v=f.suggestions,E=(0,n.useCallback)((function(e){var t;m(null===(t=e.target)||void 0===t?void 0:t.value)})),y=(0,n.useMemo)((function(){return ne(ne({},a),{},{onChange:E})}),[a,E]),b=(0,n.useMemo)((function(){return v.map(u)}),[v]);return n.createElement(G,te({classes:i,inputProps:y,triggerProps:o,options:b},s))}var le,ce=r(32584);function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var se=(ue(le={},ce.TRIP_TYPES.LEISURE,"Отдых"),ue(le,ce.TRIP_TYPES.BUSINESS,"Работа"),ue(le,ce.TRIP_TYPES.MIXED,"Смешанный"),ue(le,ce.TRIP_TYPES.RELOCATION,"Переезд"),ue(le,ce.TRIP_TYPES.OTHER,"Другой"),le),pe=function(e){var t=e.option;return t?se[t]:"Не указан"},de=(0,s.Z)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}});function me(e){var t,r,i,a,o=e.provision,l=(o=void 0===o?{}:o).locationsDict,c=void 0===l?{}:l,u=e.formikProps,s=de(),p=u.handleChange,E=u.setFieldValue,y=u.handleBlur,b=u.errors,O=u.touched,g=u.values.trip,I=void 0===g?{}:g,T=(c[I.originLocationId]||{}).locationName;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},n.createElement(d.Z,{item:!0,xs:6},n.createElement(m.Z,{control:n.createElement(f.Z,{"data-locator":"TRIP_EDIT_PAGE.AUTOGENERATED_NAME_CHECKBOX",fullWidth:!0,helperText:(null===(t=O.trip)||void 0===t?void 0:t.hasAutogeneratedTripName)&&(null===(r=b.trip)||void 0===r?void 0:r.hasAutogeneratedTripName),name:"trip.hasAutogeneratedTripName",onBlur:y,onChange:p,checked:I.hasAutogeneratedTripName}),label:"Автогенерируемое название"})),n.createElement(d.Z,{item:!0,xs:6},!I.hasAutogeneratedTripName&&n.createElement(v.Z,{"data-locator":"TRIP_EDIT_PAGE.TRIP_NAME_INPUT",className:s.textField,fullWidth:!0,helperText:(null===(i=O.trip)||void 0===i?void 0:i.tripName)&&(null===(a=b.trip)||void 0===a?void 0:a.tripName),label:"Название поездки",margin:"normal",name:"trip.tripName",onBlur:y,onChange:p,value:I.tripName})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(oe,{"data-locator":"TRIP_EDIT_PAGE.ORIGIN_LOCATION_SUGGEST",classes:{root:s.suggest},inputProps:{placeholder:"Пункт отправления..."},initialInputValue:T,onChange:function(e){var t=e.suggestion.geonameId;return E("trip.originGeonameId",t)},onBlur:y,sourceProps:{domain:"tripEditCard.geoname",modelName:"geonames",filterField:"locationName",queryFormat:Q,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}},transformSuggestionToOption:fe,triggerProps:{label:"Старт из"}})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"TRIP_EDIT_PAGE.TRIP_TYPE_SELECT",caption:"Тип поездки",name:"trip.tripType",inputId:"TripEditCard-TripTypeOptions",onChange:p,onBlur:y,optionRender:pe,options:Object.values(ce.TRIP_TYPES),hasNullOption:!0,value:I.tripType})))}function fe(e){return{label:e.locationName,detail:e.countryName,suggestion:e}}me.defaultProps={},r(86535),r(99244),r(74326),r(82499);var ve=r(94184),Ee=r.n(ve);const ye=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId};var be=r(27503);const Oe=function(e){for(var t=e.target;t;){var r=t.dataset;if(r){var n=r.sortHandler;if("enabled"===n)return!1;if("disabled"===n)return!0}t=t.parentNode}return!0};var ge=["children"];function Ie(){return Ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ie.apply(this,arguments)}var he=(0,be.JN)((function(e){var t=e.children,r=e.className;return n.createElement("div",{className:r},t)})),Te=(0,be.W8)((function(e){return e.node}));function Pe(e){var t=e.children,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,ge);return n.createElement(he,Ie({shouldCancelStart:Oe,lockAxis:"y",lockToContainerEdges:!0},r),n.Children.map(t,(function(e,t){return n.createElement(Te,{node:e,index:t})})))}var Se=r(79756),Ce=(0,s.Z)({dragHandler:{cursor:"grab"}});function Re(e){var t=e.className,r=Ce();return n.createElement(Se.Z,{className:Ee()(t,r.dragHandler),"data-sort-handler":"enabled"})}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Re.defaultProps={className:void 0};var _e="RIDE_CREATE_DIALOG",je="RIDE_EDIT_DIALOG",Ae="VISIT_CREATE_DIALOG",Ne="VISIT_EDIT_DIALOG",we="VISIT_DELETE_DIALOG",Ze=(0,s.Z)({container:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}});function Le(e){var t=e.showDialog,r=Ze();return n.createElement("div",{className:r.container,"data-sort-handler":"enabled"},n.createElement(p.Z,{"data-locator":"TRIP_EDIT_PAGE.ADD_VISIT_BUTTON","data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return t(Ae)}},n.createElement("span",null,"Добавить посещение")),n.createElement(Re,{className:r.visibleOnlyOnHover}))}Le.defaultProps={};var Ve=r(17812),xe=r(76220),ke=["onClick"];function Ye(){return Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ye.apply(this,arguments)}function He(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,ke);return n.createElement(Ve.Z,Ye({"data-locator":"ACTIONS.CREATE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(xe.Z,null))}He.defaultProps={};var Fe=r(59067),Me=["onClick"];function Be(){return Be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Be.apply(this,arguments)}function Ue(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Me);return n.createElement(Ve.Z,Be({"data-locator":"ACTIONS.EDIT_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(Fe.Z,null))}Ue.defaultProps={};var Ge=r(28428),qe=["onClick"];function Ke(){return Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ke.apply(this,arguments)}function ze(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,qe);return n.createElement(Ve.Z,Ke({"data-locator":"ACTIONS.DELETE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(Ge.Z,null))}ze.defaultProps={};var $e=(0,s.Z)({actions:{display:"inline-block"}});function We(e){var t=e["data-locator"],r=e.className,i=e.isEntityExist,a=e.onEditClick,o=e.onDeleteClick,l=e.onCreateClick,c=$e(),u=!i&&Boolean(l),s=i&&Boolean(a),p=i&&Boolean(o);return n.createElement("div",{"data-locator":t,"data-sort-handler":"disabled",className:Ee()(c.actions,r)},u&&n.createElement(He,{onClick:l}),s&&n.createElement(Ue,{onClick:a}),p&&n.createElement(ze,{onClick:o}))}var Je=r(24587),Qe=r(20576),Xe=r(22074),et=r(92715),tt=r(56941);function rt(e){var t=e.visit.visitType,r=e.className,i=function(e){switch(e){case tt.VISIT_TYPES.TRANSIT:return Qe.Z;case tt.VISIT_TYPES.BASE_CAMP:return et.Z;case tt.VISIT_TYPES.RELOCATION:return Xe.Z;case tt.VISIT_TYPES.REGULAR:default:return Je.Z}}(t);return n.createElement(i,{className:r})}var nt=(0,s.Z)({container:{display:"inline-block",marginRight:"4px","&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},visibleOnHover:{visibility:"hidden"}}),it=function(e){var t=e.visit,r=e.showDialog,i=nt();if(!t)return"Не указано";var a=t.locationName;return n.createElement("div",{className:i.container,"data-locator":"TRIP_EDIT_PAGE.VISIT_BLOCK"},n.createElement(rt,{visit:t,className:i.icon}),a,n.createElement(We,{className:i.visibleOnHover,isEntityExist:!0,onEditClick:function(){return r(Ne,t)},onDeleteClick:function(){return r(we,t)}}))};it.defaultProps={visit:{}};const at=it;var ot=r(81376),lt=r(13090),ct=(0,s.Z)({container:{"&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},visibleOnHover:{visibility:"hidden"}}),ut=function(e){var t,r,i,a=e.className,o=e.ride,l=e.showDialog,c=ct(),u=o||{},s=u.rideId,p=u.arrivalDateTime,d=u.departureDateTime,m=Boolean(s);return n.createElement("div",{className:Ee()(a,c.container),"data-locator":"TRIP_EDIT_PAGE.RIDE_BLOCK"},m&&n.createElement(n.Fragment,null,n.createElement(lt.Z,{ride:o,className:c.icon}),n.createElement("span",{className:c.details},(0,ot.xK)({departureDateTime:d,arrivalDateTime:p}))),n.createElement(We,{"data-locator":"TRIP_EDIT_PAGE.RIDE_ACTIONS",className:Ee()((t={},r=c.visibleOnHover,i=m,r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t)),isEntityExist:m,onCreateClick:function(){return l(_e)},onEditClick:function(){return l(je,o)}}))};ut.defaultProps={className:void 0,ride:{}};const st=ut;function pt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(r),!0).forEach((function(t){mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ft=(0,s.Z)({alwaysVisible:{},container:{margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}});function vt(e){var t=e.style,r=e.className,i=e.prevVisit,a=e.visit,o=e.nextVisit,l=e.showDialog,c=e.isArrivalRideMatch,u=e.isDepartureRideMatch,s=(e.tripId,e.provision),p=ft(),d=s.ridesDict,m=a||{},f=m.visitId,v=m.arrivalRideId,E=m.departureRideId,y=(i||{}).visitId,b=(o||{}).visitId;return n.createElement("div",{className:Ee()(p.container,r),style:t,"data-sort-handler":"enabled"},n.createElement(st,{showDialog:function(e,t){return l(e,dt(dt({},t),{},{departureVisitId:c?y:void 0,arrivalVisitId:f}))},className:Ee()(p.ride,mt({},p.warning,!c)),ride:d[v],provision:s}),n.createElement(at,{showDialog:l,classes:{editIcon:p.visibleOnlyOnHover},visit:a,provision:s}),n.createElement(st,{showDialog:function(e,t){return l(e,dt(dt({},t),{},{departureVisitId:f,arrivalVisitId:u?b:void 0}))},visitId:f,className:Ee()(p.ride,mt({},p.warning,!u)),ride:d[E],provision:s}))}function Et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(r),!0).forEach((function(t){bt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}vt.defaultProps={};var It=(0,s.Z)({creatorsContainer:{display:"flex",justifyContent:"space-between"},compact:{"&:not($ghost)":{marginTop:"-52px"}},ghost:{},resetFlow:{transform:"translate(0, 0)"}});function ht(e){var t=e.showDialog,r=e.provision,i=e.formikProps,o=i.values.trip.visits,l=r.visitsDict,c=It(),u=Ot((0,n.useState)(o.length),2),s=u[0],p=u[1],d=Ot((0,n.useState)(null),2),m=d[0],f=d[1],v=function(e,r){var n=Ot(Pt(o,s).map((function(e){return e&&l[e]||null})),2),i=n[0],a=n[1];t(e,yt(yt({},r),{},{orderInTrip:Tt(i,a)}))};return o.length?n.createElement(a.F2,{name:"trip.visits",render:function(e){return n.createElement(Pe,{useWindowAsScrollContainer:!0,className:c.resetFlow,onSortStart:function(e){var t=e.index;f(t)},onSortEnd:function(t){f(null);var r=t.oldIndex,n=t.newIndex;r===s?p(n):e.move(r,n)}},o.flatMap((function(e,a){var u,p=Ot(Pt(o,a).map((function(e){return e&&l[e]||null})),3),d=p[0],f=p[1],E=p[2],y=function(e,t,r){var n=ye(e,t);return{isDepartureRideMatch:ye(t,r),isArrivalRideMatch:n}}(d,f,E),b=y.isArrivalRideMatch,O=y.isDepartureRideMatch,g=a>=1&&b&&s!==a,I=n.createElement(vt,{key:"v".concat(e),index:a,style:{zIndex:o.length-a},className:Ee()((u={},bt(u,c.compact,g),bt(u,c.ghost,m===a),u)),showDialog:t,isArrivalRideMatch:b,isDepartureRideMatch:O,prevVisit:d,visit:f,nextVisit:E,formikProps:i,provision:r}),h=s===a,T=s===o.length&&s===a+1;if(!h&&!T)return I;var P=n.createElement("div",{style:{zIndex:o.length+1}},n.createElement(Le,{key:"visitCreator",showDialog:v}));return h?[P,I]:[I,P]})))}}):n.createElement(Le,{key:"visitCreator",showDialog:v})}function Tt(e,t){var r=(e||{}).orderInTrip,n=(t||{}).orderInTrip;return e?t?(r+n)/2+(Math.random()-.5)*(n-r)/2:r+1:n-1}function Pt(e,t){return[e[t-1]||null,e[t]||null,e[t+1]||null]}ht.defaultProps={},r(92222);var St=r(22318),Ct=r(37587);function Rt(e){var t=e.isCreation,r=e.className,i=e.provision,a=e.formikProps.values.trip,o=i.visitsDict,l=i.countriesDict,c=i.locationsDict,u=t?"Создание поездки":"Редактирование поездки",s=(0,Ct.w)(a,o,l,c),p="".concat(u,': "').concat(s,'"');return n.createElement(St.Z,{variant:"h6",className:r},p)}var Dt=(0,s.Z)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"},actionButton:{marginTop:"24px"},hint:{color:"gray",fontSize:12,paddingLeft:"8px"}}),_t=function(e){var t=e.isCreation,r=e.showDialog,i=e.provision,o=e.formikProps,l=Dt();return n.createElement(n.Fragment,null,n.createElement(Rt,{className:l.container,formikProps:o,isCreation:t,provision:i}),n.createElement(a.l0,null,n.createElement(me,{formikProps:o,provision:i}),!t&&n.createElement(ht,{classes:l,showDialog:r,formikProps:o,provision:i}),n.createElement(p.Z,{"data-locator":"TRIP_EDIT_PAGE.SUBMIT_TRIP_BUTTON",className:l.actionButton,type:"submit",color:"primary"},t?"Создать":"Сохранить"),t&&n.createElement("div",{className:l.hint},"После создания поездки в нее можно будет добавить места посещения и маршрут")))};_t.defaultProps={};const jt=_t;var At=r(50773),Nt=r(714),wt=r(52663),Zt=r(66856),Lt=r(29525),Vt=r(7212),xt=r(66083);function kt(e){var t=e["data-locator"],r=e.isOpen,i=e.title,a=e.description,o=e.children,l=e.primaryButtonCaption,c=e.primaryButtonHandler,u=e.secondaryButtonCaption,s=e.secondaryButtonHandler,d=e.onClose;return n.createElement(wt.Z,{"data-locator":t,transitionDuration:500,open:r,onClose:d,"aria-labelledby":"form-dialog"},n.createElement(xt.Z,{id:"form-dialog-title"},i),n.createElement(Lt.Z,null,n.createElement(Vt.Z,null,a),o),n.createElement(Zt.Z,null,s&&n.createElement(p.Z,{"data-locator":"DIALOG.RESET_BUTTON",onClick:s,color:"secondary"},u),c&&n.createElement(p.Z,{"data-locator":"DIALOG.SUBMIT_BUTTON",onClick:c,color:"primary"},l)))}function Yt(e){var t=e["data-locator"],r=e.initialValues,i=e.isOpen,o=e.onSubmit,l=e.onReset,c=e.title,u=e.description,s=e.children;return n.createElement(a.J9,{initialValues:r,enableReinitialize:!0,onSubmit:o},(function(e){return n.createElement(kt,{"data-locator":t,description:u,onClose:l,isOpen:i,primaryButtonCaption:"Сохранить",primaryButtonHandler:e.handleSubmit,secondaryButtonCaption:"Отмена",secondaryButtonHandler:l,title:c},n.cloneElement(s,{formikProps:e}))}))}var Ht=r(63430),Ft=r(28749),Mt=r(40043),Bt=(0,s.Z)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},period:{display:"inline",color:"gray",fontSize:12}}),Ut=function(e){var t=e.visit,r=e.isLong,i=e.locationUrl,a=Bt();if(!t)return"Не указано";var o=t.locationName;return n.createElement("div",{className:a.container},n.createElement(rt,{visit:t,className:a.icon}),n.createElement(Mt.Z,{to:i,optional:!0},o),r?", ":"",n.createElement("div",{className:a.period},r&&(0,ot.JH)(t)))};Ut.defaultProps={visit:{}};const Gt=Ut;var qt,Kt,zt,$t,Wt=r(17493);function Jt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qt=(Jt(qt={},Wt.RIDE_CLASSES.ECONOMY,"Эконом"),Jt(qt,Wt.RIDE_CLASSES.COMFORT,"Комфорт"),Jt(qt,Wt.RIDE_CLASSES.BUSINESS,"Бизнес"),Jt(qt,Wt.RIDE_CLASSES.FIRST,"Первый"),Jt(qt,Wt.RIDE_CLASSES.PRIVATE,"Частный"),qt),Xt=(Jt(Kt={},Wt.RIDE_OCCUPATION.PASSENGER,"Пассажир"),Jt(Kt,Wt.RIDE_OCCUPATION.STUFF,"Персонал"),Jt(Kt,Wt.RIDE_OCCUPATION.DRIVER,"Водитель"),Kt),er=(Jt(zt={},Wt.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),Jt(zt,Wt.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),Jt(zt,Wt.RIDE_TYPES.CHARTER,"Чартерный рейс"),Jt(zt,Wt.RIDE_TYPES.TOUR,"Тур"),Jt(zt,Wt.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),Jt(zt,Wt.RIDE_TYPES.HITCH_HIKING,"Автостоп"),Jt(zt,Wt.RIDE_TYPES.DROP_OFF,"Подбросили до места"),zt),tr=(Jt($t={},Wt.VEHICLE_TYPES.CAR,"Автомобиль"),Jt($t,Wt.VEHICLE_TYPES.TRAIN,"Поезд"),Jt($t,Wt.VEHICLE_TYPES.AIRCRAFT,"Самолет"),Jt($t,Wt.VEHICLE_TYPES.BUS,"Автобус"),Jt($t,Wt.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),Jt($t,Wt.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),Jt($t,Wt.VEHICLE_TYPES.FERRY,"Паром"),Jt($t,Wt.VEHICLE_TYPES.BIKE,"Велосипед"),Jt($t,Wt.VEHICLE_TYPES.BY_FEET,"Пешком"),Jt($t,Wt.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),Jt($t,Wt.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),Jt($t,Wt.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),Jt($t,Wt.VEHICLE_TYPES.TRUCK,"Грузовик"),Jt($t,Wt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),Jt($t,Wt.VEHICLE_TYPES.TRAM,"Трамвай"),Jt($t,Wt.VEHICLE_TYPES.TROLLEY,"Троллейбус"),Jt($t,Wt.VEHICLE_TYPES.TAXI,"Такси"),Jt($t,Wt.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),Jt($t,Wt.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),Jt($t,Wt.VEHICLE_TYPES.SUBWAY,"Метро"),Jt($t,Wt.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),$t),rr=(r(83710),r(3151)),nr=r(96843),ir=r(77349),ar=r(44268),or=function(e){var t=e.dateFrom,r=e.timeFrom,n=(0,ar.Z)(r),i=(0,ar.Z)(t);return n&&i?new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()):new Date(NaN)};function lr(e,t){return(0,ar.Z)(e)&&!(0,nr.Z)(t,e)}function cr(e){return function(e){if(Array.isArray(e))return ur(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ur(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ur(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sr=null,pr=function(e){return function(t){var r=t.option;return r===sr?"Пункт отправления":n.createElement(Gt,{visit:e[r]})}},dr=function(e){var t=e.option;return t?tr[t]:"Не указан"},mr=function(e){var t=e.option;return t?er[t]:"Не указан"},fr=function(e){var t=e.option;return t?Qt[t]:"Не указан"},vr=function(e){var t=e.option;return t?Xt[t]:"Не указан"},Er=(0,s.Z)({option:{width:"100%"}}),yr=function(e){var t,r,i,a,o,l,c,u,s,p,E,y=e.tripVisitsIds,b=e.visitsDict,O=e.formikProps,g=O.values,I=g.vehicleType,T=g.rideType,P=g.rideComment,S=g.rideClass,C=g.rideOccupation,R=g.departureVisitId,D=g.departureDateTime,_=g.arrivalVisitId,j=g.arrivalDateTime,A=O.handleChange,N=O.setFieldValue,w=Er(),Z=y&&y.length>0,L=(r=(t={arrivalDateTimeField:{value:j,onChange:function(e){return N("arrivalDateTime",e)}},departureDateTimeField:{value:D,onChange:function(e){return N("departureDateTime",e)}}}).arrivalDateTimeField,i=r.value,a=r.onChange,l=(o=t.departureDateTimeField).value,c=o.onChange,u=(0,rr.Z)(l,i),s=function(e,t){lr(e,l)&&c(e),lr(t,i)&&a(t)},p=function(e){var t=u?or({timeFrom:i,dateFrom:e}):i;s(e,t)},E=function(e){var t=u?or({timeFrom:l,dateFrom:e}):l;s(t,e)},{isSameDateField:{value:u,onChange:function(e){Boolean(u)!==Boolean(e)&&s(l,or({dateFrom:e?l:(0,ir.Z)(l,1),timeFrom:i}))}},rideDepartureDateField:{value:l,onChange:function(e){p(or({dateFrom:e,timeFrom:l}))}},rideArrivalDateField:{value:i,onChange:function(e){E(or({dateFrom:e,timeFrom:i}))}},rideDepartureTimeField:{value:l,onChange:function(e){p(or({dateFrom:l,timeFrom:e}))}},rideArrivalTimeField:{value:i,onChange:function(e){E(or({dateFrom:i,timeFrom:e}))}}}),V=L.rideArrivalDateField,x=L.rideArrivalTimeField,k=L.rideDepartureDateField,Y=L.rideDepartureTimeField,H=L.isSameDateField;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},Z&&n.createElement(n.Fragment,null,n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_VISIT_SELECT",name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:pr(b),hasNullOption:!1,options:[sr].concat(cr(y)),value:R,onChange:A})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_VISIT_SELECT",name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:pr(b),options:[].concat(cr(y),[sr]),onChange:A,value:_}))),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.VEHICLE_TYPE_SELECT",name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:dr,options:Object.values(Wt.VEHICLE_TYPES),onChange:A,value:I})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_TYPE_SELECT",name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:mr,options:Object.values(Wt.RIDE_TYPES),onChange:A,value:T})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_CLASS_SELECT",name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:fr,options:Object.values(Wt.RIDE_CLASSES),onChange:A,value:S})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_OCCUPATION_SELECT",name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:vr,options:Object.values(Wt.RIDE_OCCUPATION),onChange:A,value:C})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(Ht.e,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_DATE_PICKER",name:"departureDateTime",autoOk:!0,className:w.option,label:"Дата отправления",value:k.value,onChange:k.onChange,format:"dd/MM/yyyy"})),n.createElement(d.Z,{item:!0,xs:6},H.value?n.createElement(m.Z,{control:n.createElement(f.Z,{checked:H.value,onChange:function(e){return H.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):n.createElement(Ht.e,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_DATE_PICKER",name:"arrivalDateTime",autoOk:!0,className:w.option,label:"Дата прибытия",value:V.value,onChange:V.onChange,format:"dd/MM/yyyy"})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(Ft.e,{name:"departureDateTime",ampm:!1,autoOk:!0,className:w.option,label:"Время отправления",value:Y.value,onChange:Y.onChange})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(Ft.e,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:w.option,label:"Время прибытия",value:x.value,onChange:x.onChange})),n.createElement(d.Z,{item:!0,xs:12},n.createElement(v.Z,{name:"rideComment",className:w.option,label:"Комментарий",multiline:!0,onChange:A,rows:1,rowsMax:12,value:P})))};yr.defaultProps={};const br=yr;var Or=["isCreation","tripVisitsIds","visitsDict"];function gr(){return gr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gr.apply(this,arguments)}function Ir(e){var t=e.isCreation,r=e.tripVisitsIds,i=e.visitsDict,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Or);return n.createElement(Yt,gr({"data-locator":"TRIP_EDIT_PAGE.RIDE_DIALOG",title:t?"Создание маршрута":"Редактирование маршрута"},a),n.createElement(br,{tripVisitsIds:r,visitsDict:i,formikProps:null}))}var hr,Tr=r(3807);function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Cr=(Sr(hr={},tt.VISIT_TYPES.TRANSIT,"Транзит"),Sr(hr,tt.VISIT_TYPES.REGULAR,"Посещение"),Sr(hr,tt.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),Sr(hr,tt.VISIT_TYPES.RELOCATION,"Переезд"),hr),Rr=function(e){return function(t){var r=t.option;return n.createElement(Tr.Z,{ride:e[r],isLong:!0})}},Dr=function(e){var t=e.option;return t?Cr[t]:"Не указан"},_r=(0,s.Z)({option:{width:"100%"}});function jr(e){var t,r,i=e.tripRidesIds,a=e.ridesDict,o=e.formikProps,l=o.values,c=l.locationName,u=l.visitType,s=l.visitComment,p=l.arrivalRideId,E=l.departureRideId,y=o.handleChange,b=o.handleBlur,O=o.setFieldValue,g=_r(),I=(t=(0,n.useState)(!0),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Pr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pr(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=I[0],P=I[1],S=i&&i.length>0;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},n.createElement(d.Z,{item:!0,xs:12},n.createElement(oe,{"data-locator":"VISIT_EDIT_FORM_SECTION.LOCATION_SUGGEST",inputProps:{placeholder:"Место посещения..."},initialInputValue:c,onChange:function(e){var t=e.suggestion.geonameId;return O("geonameId",t)},onBlur:b,sourceProps:{domain:"visitEditFormSection.geoname",modelName:"geonames",filterField:"locationName",customQuery:T?{class:"P"}:void 0,queryFormat:Q},transformSuggestionToOption:function(e){return function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).showFeatureClass,r=e.locationName,n=e.countryName,i=e.regionName,a=e.featureClassName;return{label:r,details:[n,i,t?a:null].filter(Boolean).join(", "),suggestion:e}}(e,{showFeatureClass:!T})},triggerProps:{label:"Место посещения"}})),n.createElement(d.Z,{item:!0,xs:12},n.createElement(m.Z,{control:n.createElement(f.Z,{checked:T,onChange:function(e){return P(e.target.checked)}}),label:"Искать только населенные пункты"})),S&&n.createElement(n.Fragment,null,n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{name:"arrivalRideId",caption:"Прибытие",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:Rr(a),options:i,onChange:y,value:p})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{name:"departureRideId",caption:"Отправление",inputId:"RideEditCard-departureVisitId",optionRender:Rr(a),hasNullOption:!1,options:i,value:E,onChange:y}))),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"VISIT_EDIT_FORM_SECTION.VISIT_TYPE_SELECT",name:"visitType",value:u,onChange:y,caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",optionRender:Dr,options:Object.values(tt.VISIT_TYPES),hasNullOption:!0})),n.createElement(d.Z,{item:!0,xs:12},n.createElement(v.Z,{className:g.option,name:"visitComment",value:s,onChange:y,label:"Комментарий",fullWidth:!0,multiline:!0,rows:1,rowsMax:12})))}jr.defaultProps={};var Ar=["isCreation","tripRidesIds","ridesDict"];function Nr(){return Nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nr.apply(this,arguments)}function wr(e){var t=e.isCreation,r=e.tripRidesIds,i=e.ridesDict,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Ar);return n.createElement(Yt,Nr({"data-locator":"TRIP_EDIT_PAGE.VISIT_DIALOG",title:t?"Создание посещения":"Редактирование посещения"},a),n.createElement(jr,{tripRidesIds:r,ridesDict:i,formikProps:null}))}var Zr=["visit","onSubmit","onReset"];function Lr(){return Lr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lr.apply(this,arguments)}function Vr(e){var t=e.visit,r=e.onSubmit,i=e.onReset,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Zr);return n.createElement(kt,Lr({title:"Удалить посещение",description:"Вы действительно хотите удалить посещение",primaryButtonCaption:"Да",primaryButtonHandler:function(e){return r(e,t)},secondaryButtonCaption:"Нет",secondaryButtonHandler:i},a),n.createElement(Gt,{visit:t}))}function xr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(r),!0).forEach((function(t){Yr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hr(e){var t=e.provision,r=e.dialogsState,i=e.hideDialog,a=e.handleSubmitRide,o=e.handleSubmitVisit,l=e.handleDeleteVisit,c=e.trip,u=t.ridesDict,s=t.visitsDict,p=c.tripId,d=c.visits,m=c.rides,f=r.dialogName,v=r.dialogParams,E=void 0===v?{}:v,y=(0,n.useMemo)((function(){var e=E.rideId;return kr(kr(kr({},e?u[e]:(0,At.vA)()),E),{},{tripId:p})}),[u,p,E]),b=(0,n.useMemo)((function(){var e=E.visitId;return kr(kr(kr({},e?s[e]:(0,Nt.Tl)()),E),{},{tripId:p})}),[s,p,E]),O=function(e){return e===je||e===_e}(f),g=function(e){return e===Ne||e===Ae}(f),I=f===we;return n.createElement(n.Fragment,null,n.createElement(Ir,{initialValues:y,tripVisitsIds:d,isOpen:O,onSubmit:function(e){a(e),i()},onReset:i,isCreation:f===_e,visitsDict:s}),n.createElement(wr,{initialValues:b,tripRidesIds:m,isOpen:g,onSubmit:function(e){o(e),i()},onReset:i,isCreation:f===Ae,ridesDict:u}),n.createElement(Vr,{visit:s[E.visitId],isOpen:I,onSubmit:function(e,t){var r=t.visitId;l(r),i()},onReset:i}))}function Fr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Mr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(88674),r(17727);var Br="travel.TripEditPage";const Ur=function(e){var t=e.match.params,r=t.userAlias,s=t.strTripId,p=t.action,d=(0,o._l)().travel.tripEdit,m=(0,i.k6)(),f="create"===p,v=(0,l.Eu)(),E=v.isAuthenticated,y=v.userAlias,b=s&&parseInt(s,10),O=(0,c.Yy)({userAlias:r,tripsIds:b?[b]:[]}),g=O.tripsDict,I=O.tripsProvision,h=f?(0,u.fX)():g[b],T=function(e){var t=Fr((0,z.QT)({domain:"".concat(Br,".rides"),modelName:"rides"}),1)[0],r=(0,n.useCallback)((function(r){return t({query:{id:r.rideId,body:r}}).then(e)}),[]),i=Fr((0,z.QT)({domain:"".concat(Br,".trips"),modelName:"trips"}),1)[0],a=(0,n.useCallback)((function(t){return i({query:{id:t.tripId,body:t}}).finally(e)}),[]),o=Fr((0,z.QT)({domain:"".concat(Br,".visits"),modelName:"visits"}),1)[0],l=(0,n.useCallback)((function(t){return o({query:{id:t.visitId,body:t}}).then(e)}),[]),c=Fr((0,z.QT)({domain:"".concat(Br,".visits"),modelName:"visits"}),1)[0];return{handleSubmitRide:r,handleSubmitTrip:a,handleSubmitVisit:l,handleDeleteVisit:(0,n.useCallback)((function(t){return c({method:"DELETE",query:{id:t}}).then(e)}),[])}}(I.invalidate),P=T.handleSubmitRide,S=T.handleSubmitTrip,C=T.handleSubmitVisit,R=T.handleDeleteVisit,D=function(){var e,t,r=(e=(0,n.useState)({name:null}),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];return{showDialog:function(e,t){a({dialogName:e,dialogParams:t})},hideDialog:function(){a({name:null})},dialogsState:i}}(),_=D.showDialog,j=D.hideDialog,A=D.dialogsState,N=O.isError,w=O.isReady,Z=O.isPending;return b&&(!w||h)||f?E&&y===r?N?n.createElement("div",null,"...Error"):Z?n.createElement("div",null,"...Loading"):h?n.createElement(n.Fragment,null,n.createElement(a.J9,{initialValues:{trip:h},onSubmit:function(e){return S(e.trip).then((function(e){if(!b&&e){var t=d.toUrl({userAlias:r,strTripId:String(e)});m.push(t)}}))}},(function(e){return n.createElement(jt,{isCreation:f,showDialog:_,formikProps:e,provision:O})})),n.createElement(Hr,{provision:O,dialogsState:A,hideDialog:j,handleSubmitRide:P,handleSubmitVisit:C,handleDeleteVisit:R,trip:h})):n.createElement("div",null,"...Error, no trip is provided"):n.createElement("div",null,"У вас не достаочно прав для просмотра данной страницы"):n.createElement("div",null,"Запрашиваемая вами страница не найдена")}}}]);
//# sourceMappingURL=travel-TripEditPage-5ebd9c4bbae37a0a9339.js.map