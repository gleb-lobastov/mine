"use strict";(self.webpackChunkmine=self.webpackChunkmine||[]).push([[993],{40043:(e,t,r)=>{r.d(t,{Z:()=>u}),r(47941),r(82772),r(82526),r(19601);var n=r(67294),i=r(73727),a=r(89659),o=r(22318),l=["optional","children"];function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}function u(e){var t=e.optional,r=e.children,u=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,l);return Boolean(!t||u.href||u.to||u.onClick)?n.createElement(a.Z,c({},u,{component:i.rU}),r):n.createElement(o.Z,u,r)}u.defaultProps={optional:!1}},81376:(e,t,r)=>{r.d(t,{xK:()=>p,JH:()=>d,Gd:()=>m}),r(92222);var n=r(3151),i=r(49160),a=r(60792),o=r(28523),l=r(41297),c="d MMMM yyyy",u="LLLL yyyy";function s(e,t,r){var s=r?u:c,p=(0,l.Z)(t,s,{locale:o.Z});if((0,n.Z)(e,t))return p;var d="";if((0,i.Z)(e,t))r||(d=(0,l.Z)(e,"d",{locale:o.Z}));else if((0,a.Z)(e,t)){var m=r?"LLLL":"d MMMM";d=(0,l.Z)(e,m,{locale:o.Z})}else d=(0,l.Z)(e,s,{locale:o.Z});return"".concat(d,"—").concat(p)}function p(e,t){return s(e.departureDateTime,e.arrivalDateTime,t)}function d(e,t){var r=e.departureDateTime;return s(e.arrivalDateTime,r,t)}function m(e){var t=e.periodStart,r=e.periodEnd,n=e.isObscure,i=e.placeholder;if(!r){var a=n?u:c,p=(0,l.Z)(t,a,{locale:o.Z});return"".concat(p,"—").concat(i)}return s(t,r,n)}},13090:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(67294),i=r(99930),a=r(85329),o=r(13200),l=r(78),c=r(85976),u=r(29509),s=r(30913),p=r(72106),d=r(56647),m=r(22074),f=r(83612),E=r(50429),v=r(83562),b=r(38756),y=r(97856),O=r(22940),g=r(23518),I=r(17493);function h(e){var t=e.ride.vehicleType,r=e.className,h=function(e){switch(e){case I.VEHICLE_TYPES.CAR:return l.Z;case I.VEHICLE_TYPES.TRAIN:return d.Z;case I.VEHICLE_TYPES.AIRCRAFT:return u.Z;case I.VEHICLE_TYPES.BUS:case I.VEHICLE_TYPES.TROLLEY:case I.VEHICLE_TYPES.CITY_BUS:return o.Z;case I.VEHICLE_TYPES.MOTORHOME:case I.VEHICLE_TYPES.JITNEY:return f.Z;case I.VEHICLE_TYPES.LOCAL_TRAIN:return d.Z;case I.VEHICLE_TYPES.FERRY:return a.Z;case I.VEHICLE_TYPES.BIKE:return i.Z;case I.VEHICLE_TYPES.BY_FEET:return E.Z;case I.VEHICLE_TYPES.MOTORBIKE:return s.Z;case I.VEHICLE_TYPES.TRUCK:return m.Z;case I.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return p.Z;case I.VEHICLE_TYPES.TRAM:return v.Z;case I.VEHICLE_TYPES.TAXI:return b.Z;case I.VEHICLE_TYPES.SUBWAY:return y.Z;case I.VEHICLE_TYPES.PUBLIC_TRANSPORT:return O.Z;case I.VEHICLE_TYPES.ROPEWAY:case I.VEHICLE_TYPES.FUNICULAR:return c.Z;default:return g.Z}}(t);return n.createElement(h,{className:r})}},3807:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(67294),i=r(41120),a=r(45928),o=r(81376),l=r(17493),c=r(13090),u=(0,i.Z)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function s(e){var t=e.ride,r=e.ride,i=(r=void 0===r?{}:r).rideType,s=e.className,p=e.isLong,d=u();return t?n.createElement("div",{className:s},n.createElement(c.Z,{ride:t,className:d.icon}),i===l.RIDE_TYPES.HITCH_HIKING&&n.createElement(a.Z,{className:d.absoluteIcon}),p&&(0,o.xK)(t)):null}},37587:(e,t,r)=>{r.d(t,{w:()=>m}),r(2707),r(21249),r(57640),r(9924),r(47941),r(57327),r(41539),r(88449),r(2490),r(59849),r(92222),r(9653);var n=r(37950),i=r(99890),a=r(7739),o=r.n(a),l=(r(69600),r(47042),r(44908)),c=r.n(l);const u=function(e,t){var r=t.maxLength,n=t.separator,i=void 0===n?", ":n,a=c()(e),o=a.slice(0,r).join(i);return a.length>r?"".concat(o,"..."):o};var s=r(56941),p=r(81376),d="Без названия";function m(e,t,r,a){var l,c=e||{},m=c.visits,f=c.originLocationId,E=c.tripName,v=c.hasAutogeneratedTripName,b=null===(l=a[f])||void 0===l?void 0:l.countryId;if(!v)return E||d;if(!m.length)return d;var y=(0,p.JH)({arrivalDateTime:(0,n.Z)(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime}))),departureDateTime:(0,i.Z)(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime})))}),O=Object.keys(o()(m.filter((function(e){var r;return(null===(r=t[e])||void 0===r?void 0:r.visitType)!==s.VISIT_TYPES.TRANSIT})),"countryId"));if(1===O.length){var g=u(m.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.locationName})),{maxLength:4});return"".concat(g||d,", ").concat(y)}var I=u(O.map((function(e){return Number(e)!==b&&r[e]&&r[e].countryName})).filter(Boolean),{maxLength:4});return"".concat(I||d,", ").concat(y)}},35118:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Fr}),r(74916),r(4723),r(91058);var n=r(67294),i=r(5977),a=r(94649),o=r(84090),l=r(27610),c=r(30822),u=r(89407),s=r(41120),p=r(282),d=(r(66992),r(41539),r(33948),r(69600),r(57327),r(88449),r(2490),r(59849),r(26833),r(79753),r(82526),r(41817),r(32165),r(78783),r(47042),r(68309),r(91038),r(77601),r(69070),r(47941),r(38880),r(89554),r(15581),r(34514),r(54747),r(49337),r(33321),r(41749)),m=r(30553),f=r(13258),E=r(8286),v=(r(21249),r(57640),r(9924),r(92015)),b=r(43700),y=r(38799),O=r(85639),g=r(23200),I=function(e){var t=e["data-locator"],r=e.caption,i=e.classes,a=e.hasNullOption,o=e.inputId,l=e.name,c=e.onChange,u=e.optionRender,s=e.options,p=e.value;return n.createElement("div",{"data-locator":t,className:i.container},n.createElement(b.Z,{component:"label",shrink:!0,htmlFor:o},r),n.createElement(g.Z,{name:l,value:p,displayEmpty:!0,onChange:c,input:n.createElement(y.Z,{id:o}),className:i.selectRoot,MenuProps:{"data-locator":"options-".concat(o)}},a&&n.createElement(O.Z,{"data-locator":"option-null",key:null,value:null},u({option:null,index:-1,options:s})),s.map((function(e,t){return n.createElement(O.Z,{"data-locator":"option-".concat(e),key:e,value:e},u({option:e,index:t,options:s}))}))))};I.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};const h=(0,v.Z)({container:{display:"block"},selectRoot:{display:"block"}})(I);r(82772),r(19601);var T=r(71755),P=r(79895),S=r(95757),C=["isHighlighted","isSelected","option"];function R(){return R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R.apply(this,arguments)}function _(e){var t=e.isHighlighted,r=e.isSelected,i=e.option,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,C);return n.createElement(O.Z,R({component:"div",selected:t,style:{fontWeight:r?500:400}},a),n.createElement(S.Z,{primary:i.label,secondary:i.details}))}function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)}function j(e){var t=e.isOpen,r=e.options,i=e.classes,a=e.getMenuProps,o=e.getItemProps,l=e.selectedItem,c=e.highlightedIndex;return n.createElement("div",a(),t&&n.createElement(P.Z,{className:i.paper,square:!0},r.map((function(e,t){return n.createElement(_,D({key:e.label},o({item:e}),{isHighlighted:c===t,isSelected:Boolean(l)&&l.label===e.label,option:e}))}))))}var N=r(57557),A=r.n(N);function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){var t=e.classes,r=e.triggerProps,i=e.triggerInputProps;return n.createElement(E.Z,w({InputProps:L({classes:{root:t.inputRoot,input:t.inputInput}},i),fullWidth:!0,classes:A()(t,"inputRoot","inputInput")},r))}var k=["data-locator","classes","options","inputProps","triggerProps"];function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y.apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B=(0,s.Z)((function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}})),U=function(e){return(e||{}).label};function G(e){var t=e["data-locator"],r=e.classes,i=e.options,a=e.inputProps,o=e.triggerProps,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,k),c=F(F({},B()),r);return n.createElement("div",{"data-locator":t,className:c.root},n.createElement(T.ZP,Y({itemToString:U},l),(function(e){var t=e.getInputProps,r=e.getItemProps,l=e.getMenuProps,u=e.highlightedIndex,s=e.inputValue,p=e.isOpen,d=e.selectedItem;return n.createElement("div",{className:c.container},n.createElement(x,{classes:c,inputValue:s,triggerProps:o,triggerInputProps:t(a)}),n.createElement(j,{isOpen:p,options:i,classes:c,getMenuProps:l,getItemProps:r,selectedItem:d,highlightedIndex:u}))})))}var q=r(12291),K=r(91949),z=r(24774),$="SEARCH";function W(e){var t,r,n,i=e.queryFormat,a=e.filterField,o=e.inputValue,l={pageSize:e.numberOfItemsToRequest};return i===$?{navigation:l,search:o}:{navigation:l,filter:(t={},r=a,n={comparator:"~",value:"%".concat(o,"%")},r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t)}}var J=["classes","inputProps","triggerProps","sourceProps","transformSuggestionToOption"];function X(){return X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X.apply(this,arguments)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){te(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ne(e){var t,r,i=e.classes,a=e.inputProps,o=e.triggerProps,l=e.sourceProps,c=e.transformSuggestionToOption,u=void 0===c?function(e){return e}:c,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,J),p=(t=(0,n.useState)(""),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=p[0],m=p[1],f=function(e){var t=e.domain,r=e.modelName,n=e.inputValue,i=e.queryFormat,a=e.filterField,o=e.numberOfItemsToRequest,l=e.debounceRequestDelayMs,c=void 0===l?400:l,u=(0,z.xv)({debounceRequest:c,domain:t,isProvision:!0,modelName:r,observe:n,query:W({queryFormat:i,filterField:a,inputValue:n,numberOfItemsToRequest:o})}),s=((0,K.tF)(u)||{}).data,p=void 0===s?[]:s,d=(0,q.v9)((function(e){return(0,z.d5)(e,r)||{}}));return{provision:u,suggestions:p.map((function(e){return d[e]})).filter(Boolean)}}(ee(ee({},l),{},{inputValue:d})),E=f.suggestions,v=(0,n.useCallback)((function(e){var t;m(null===(t=e.target)||void 0===t?void 0:t.value)})),b=(0,n.useMemo)((function(){return ee(ee({},a),{},{onChange:v})}),[a,v]),y=(0,n.useMemo)((function(){return E.map(u)}),[E]);return n.createElement(G,X({classes:i,inputProps:b,triggerProps:o,options:y},s))}var ie,ae=r(32584);function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le=(oe(ie={},ae.TRIP_TYPES.LEISURE,"Отдых"),oe(ie,ae.TRIP_TYPES.BUSINESS,"Работа"),oe(ie,ae.TRIP_TYPES.MIXED,"Смешанный"),oe(ie,ae.TRIP_TYPES.RELOCATION,"Переезд"),oe(ie,ae.TRIP_TYPES.OTHER,"Другой"),ie),ce=function(e){var t=e.option;return t?le[t]:"Не указан"},ue=(0,s.Z)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}});function se(e){var t,r,i,a,o=e.provision,l=(o=void 0===o?{}:o).locationsDict,c=void 0===l?{}:l,u=e.formikProps,s=ue(),p=u.handleChange,v=u.setFieldValue,b=u.handleBlur,y=u.errors,O=u.touched,g=u.values.trip,I=void 0===g?{}:g,T=(c[I.originLocationId]||{}).locationName;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},n.createElement(d.Z,{item:!0,xs:6},n.createElement(m.Z,{control:n.createElement(f.Z,{"data-locator":"TRIP_EDIT_PAGE.AUTOGENERATED_NAME_CHECKBOX",fullWidth:!0,helperText:(null===(t=O.trip)||void 0===t?void 0:t.hasAutogeneratedTripName)&&(null===(r=y.trip)||void 0===r?void 0:r.hasAutogeneratedTripName),name:"trip.hasAutogeneratedTripName",onBlur:b,onChange:p,checked:I.hasAutogeneratedTripName}),label:"Автогенерируемое название"})),n.createElement(d.Z,{item:!0,xs:6},!I.hasAutogeneratedTripName&&n.createElement(E.Z,{"data-locator":"TRIP_EDIT_PAGE.TRIP_NAME_INPUT",className:s.textField,fullWidth:!0,helperText:(null===(i=O.trip)||void 0===i?void 0:i.tripName)&&(null===(a=y.trip)||void 0===a?void 0:a.tripName),label:"Название поездки",margin:"normal",name:"trip.tripName",onBlur:b,onChange:p,value:I.tripName})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(ne,{"data-locator":"TRIP_EDIT_PAGE.ORIGIN_LOCATION_SUGGEST",classes:{root:s.suggest},inputProps:{placeholder:"Пункт отправления..."},initialInputValue:T,onChange:function(e){var t=e.suggestion.geonameId;return v("trip.originGeonameId",t)},onBlur:b,sourceProps:{domain:"tripEditCard.geoname",modelName:"geonames",filterField:"locationName",queryFormat:$,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}},transformSuggestionToOption:pe,triggerProps:{label:"Старт из"}})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"TRIP_EDIT_PAGE.TRIP_TYPE_SELECT",caption:"Тип поездки",name:"trip.tripType",inputId:"TripEditCard-TripTypeOptions",onChange:p,onBlur:b,optionRender:ce,options:Object.values(ae.TRIP_TYPES),hasNullOption:!0,value:I.tripType})))}function pe(e){return{label:e.locationName,detail:e.countryName,suggestion:e}}se.defaultProps={},r(86535),r(99244),r(74326),r(82499);var de=r(94184),me=r.n(de);const fe=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId};var Ee=r(37905);const ve=function(e){for(var t=e.target;t;){var r=t.dataset;if(r){var n=r.sortHandler;if("enabled"===n)return!1;if("disabled"===n)return!0}t=t.parentNode}return!0};var be=["children"];function ye(){return ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ye.apply(this,arguments)}var Oe=(0,Ee.SortableContainer)((function(e){var t=e.children,r=e.className;return n.createElement("div",{className:r},t)})),ge=(0,Ee.SortableElement)((function(e){return e.node}));function Ie(e){var t=e.children,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,be);return n.createElement(Oe,ye({shouldCancelStart:ve,lockAxis:"y",lockToContainerEdges:!0},r),n.Children.map(t,(function(e,t){return n.createElement(ge,{node:e,index:t})})))}var he=r(79756),Te=(0,s.Z)({dragHandler:{cursor:"grab"}});function Pe(e){var t=e.className,r=Te();return n.createElement(he.Z,{className:me()(t,r.dragHandler),"data-sort-handler":"enabled"})}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Pe.defaultProps={className:void 0};var Ce="RIDE_CREATE_DIALOG",Re="RIDE_EDIT_DIALOG",_e="VISIT_CREATE_DIALOG",De="VISIT_EDIT_DIALOG",je="VISIT_DELETE_DIALOG",Ne=(0,s.Z)({container:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}});function Ae(e){var t=e.showDialog,r=Ne();return n.createElement("div",{className:r.container,"data-sort-handler":"enabled"},n.createElement(p.Z,{"data-locator":"TRIP_EDIT_PAGE.ADD_VISIT_BUTTON","data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return t(_e)}},n.createElement("span",null,"Добавить посещение")),n.createElement(Pe,{className:r.visibleOnlyOnHover}))}Ae.defaultProps={};var we=r(17812),Ze=r(76220),Le=["onClick"];function Ve(){return Ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ve.apply(this,arguments)}function xe(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Le);return n.createElement(we.Z,Ve({"data-locator":"ACTIONS.CREATE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(Ze.Z,null))}xe.defaultProps={};var ke=r(59067),Ye=["onClick"];function He(){return He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},He.apply(this,arguments)}function Fe(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Ye);return n.createElement(we.Z,He({"data-locator":"ACTIONS.EDIT_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(ke.Z,null))}Fe.defaultProps={};var Me=r(28428),Be=["onClick"];function Ue(){return Ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ue.apply(this,arguments)}function Ge(e){var t=e.onClick,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Be);return n.createElement(we.Z,Ue({"data-locator":"ACTIONS.DELETE_BUTTON",size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),n.createElement(Me.Z,null))}Ge.defaultProps={};var qe=(0,s.Z)({actions:{display:"inline-block"}});function Ke(e){var t=e["data-locator"],r=e.className,i=e.isEntityExist,a=e.onEditClick,o=e.onDeleteClick,l=e.onCreateClick,c=qe(),u=!i&&Boolean(l),s=i&&Boolean(a),p=i&&Boolean(o);return n.createElement("div",{"data-locator":t,"data-sort-handler":"disabled",className:me()(c.actions,r)},u&&n.createElement(xe,{onClick:l}),s&&n.createElement(Fe,{onClick:a}),p&&n.createElement(Ge,{onClick:o}))}var ze=r(24587),$e=r(20576),We=r(22074),Je=r(92715),Xe=r(56941);function Qe(e){var t=e.visit.visitType,r=e.className,i=function(e){switch(e){case Xe.VISIT_TYPES.TRANSIT:return $e.Z;case Xe.VISIT_TYPES.BASE_CAMP:return Je.Z;case Xe.VISIT_TYPES.RELOCATION:return We.Z;case Xe.VISIT_TYPES.REGULAR:default:return ze.Z}}(t);return n.createElement(i,{className:r})}var et=(0,s.Z)({container:{display:"inline-block",marginRight:"4px","&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},visibleOnHover:{visibility:"hidden"}}),tt=function(e){var t=e.visit,r=e.showDialog,i=et();if(!t)return"Не указано";var a=t.locationName;return n.createElement("div",{className:i.container,"data-locator":"TRIP_EDIT_PAGE.VISIT_BLOCK"},n.createElement(Qe,{visit:t,className:i.icon}),a,n.createElement(Ke,{className:i.visibleOnHover,isEntityExist:!0,onEditClick:function(){return r(De,t)},onDeleteClick:function(){return r(je,t)}}))};tt.defaultProps={visit:{}};const rt=tt;var nt=r(81376),it=r(13090),at=(0,s.Z)({container:{"&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},visibleOnHover:{visibility:"hidden"}}),ot=function(e){var t,r,i,a=e.className,o=e.ride,l=e.showDialog,c=at(),u=o||{},s=u.rideId,p=u.arrivalDateTime,d=u.departureDateTime,m=Boolean(s);return n.createElement("div",{className:me()(a,c.container),"data-locator":"TRIP_EDIT_PAGE.RIDE_BLOCK"},m&&n.createElement(n.Fragment,null,n.createElement(it.Z,{ride:o,className:c.icon}),n.createElement("span",{className:c.details},(0,nt.xK)({departureDateTime:d,arrivalDateTime:p}))),n.createElement(Ke,{"data-locator":"TRIP_EDIT_PAGE.RIDE_ACTIONS",className:me()((t={},r=c.visibleOnHover,i=m,r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t)),isEntityExist:m,onCreateClick:function(){return l(Ce)},onEditClick:function(){return l(Re,o)}}))};ot.defaultProps={className:void 0,ride:{}};const lt=ot;function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){st(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function st(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pt=(0,s.Z)({alwaysVisible:{},container:{margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}});function dt(e){var t=e.style,r=e.className,i=e.prevVisit,a=e.visit,o=e.nextVisit,l=e.showDialog,c=e.isArrivalRideMatch,u=e.isDepartureRideMatch,s=(e.tripId,e.provision),p=pt(),d=s.ridesDict,m=a||{},f=m.visitId,E=m.arrivalRideId,v=m.departureRideId,b=(i||{}).visitId,y=(o||{}).visitId;return n.createElement("div",{className:me()(p.container,r),style:t,"data-sort-handler":"enabled"},n.createElement(lt,{showDialog:function(e,t){return l(e,ut(ut({},t),{},{departureVisitId:c?b:void 0,arrivalVisitId:f}))},className:me()(p.ride,st({},p.warning,!c)),ride:d[E],provision:s}),n.createElement(rt,{showDialog:l,classes:{editIcon:p.visibleOnlyOnHover},visit:a,provision:s}),n.createElement(lt,{showDialog:function(e,t){return l(e,ut(ut({},t),{},{departureVisitId:f,arrivalVisitId:u?y:void 0}))},visitId:f,className:me()(p.ride,st({},p.warning,!u)),ride:d[v],provision:s}))}function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){Et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Et(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return bt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}dt.defaultProps={};var yt=(0,s.Z)({creatorsContainer:{display:"flex",justifyContent:"space-between"},isCompact:{marginTop:"-52px"},resetFlow:{transform:"translate(0, 0)"}});function Ot(e){var t=e.showDialog,r=e.provision,i=e.formikProps,o=i.values.trip.visits,l=r.visitsDict,c=yt(),u=vt((0,n.useState)(o.length),2),s=u[0],p=u[1],d=vt((0,n.useState)(!1),2),m=d[0],f=d[1],E=function(e,r){var n=vt(It(o,s).map((function(e){return e&&l[e]||null})),2),i=n[0],a=n[1];t(e,ft(ft({},r),{},{orderInTrip:gt(i,a)}))};return o.length?n.createElement(a.F2,{name:"trip.visits",render:function(e){return n.createElement(Ie,{className:c.resetFlow,updateBeforeSortStart:function(){return f(!0)},onSortEnd:function(t){f(!1);var r=t.oldIndex,n=t.newIndex;r===s?p(n):e.move(r,n)}},o.flatMap((function(e,a){var u=vt(It(o,a).map((function(e){return e&&l[e]||null})),3),p=u[0],d=u[1],f=u[2],v=function(e,t,r){var n=fe(e,t);return{isDepartureRideMatch:fe(t,r),isArrivalRideMatch:n}}(p,d,f),b=v.isArrivalRideMatch,y=v.isDepartureRideMatch,O=a>=1&&!m&&b&&s!==a,g=n.createElement(dt,{key:"v".concat(e),index:a,style:{zIndex:o.length-a},className:me()(Et({},c.isCompact,O)),showDialog:t,isArrivalRideMatch:b,isDepartureRideMatch:y,prevVisit:p,visit:d,nextVisit:f,formikProps:i,provision:r}),I=s===a,h=s===o.length&&s===a+1;if(!I&&!h)return g;var T=n.createElement("div",{style:{zIndex:o.length+1}},n.createElement(Ae,{key:"visitCreator",showDialog:E}));return I?[T,g]:[g,T]})))}}):n.createElement(Ae,{key:"visitCreator",showDialog:E})}function gt(e,t){var r=(e||{}).orderInTrip,n=(t||{}).orderInTrip;return e?t?(r+n)/2+(Math.random()-.5)*(n-r)/2:r+1:n-1}function It(e,t){return[e[t-1]||null,e[t]||null,e[t+1]||null]}Ot.defaultProps={},r(92222);var ht=r(22318),Tt=r(37587);function Pt(e){var t=e.isCreation,r=e.className,i=e.provision,a=e.formikProps.values.trip,o=i.visitsDict,l=i.countriesDict,c=i.locationsDict,u=t?"Создание поездки":"Редактирование поездки",s=(0,Tt.w)(a,o,l,c),p="".concat(u,': "').concat(s,'"');return n.createElement(ht.Z,{variant:"h6",className:r},p)}var St=(0,s.Z)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"},actionButton:{marginTop:"24px"},hint:{color:"gray",fontSize:12,paddingLeft:"8px"}}),Ct=function(e){var t=e.isCreation,r=e.showDialog,i=e.provision,o=e.formikProps,l=St();return n.createElement(n.Fragment,null,n.createElement(Pt,{className:l.container,formikProps:o,isCreation:t,provision:i}),n.createElement(a.l0,null,n.createElement(se,{formikProps:o,provision:i}),!t&&n.createElement(Ot,{classes:l,showDialog:r,formikProps:o,provision:i}),n.createElement(p.Z,{"data-locator":"TRIP_EDIT_PAGE.SUBMIT_TRIP_BUTTON",className:l.actionButton,type:"submit",color:"primary"},t?"Создать":"Сохранить"),t&&n.createElement("div",{className:l.hint},"После создания поездки в нее можно будет добавить места посещения и маршрут")))};Ct.defaultProps={};const Rt=Ct;var _t=r(50773),Dt=r(714),jt=r(52663),Nt=r(66856),At=r(29525),wt=r(7212),Zt=r(66083);function Lt(e){var t=e["data-locator"],r=e.isOpen,i=e.title,a=e.description,o=e.children,l=e.primaryButtonCaption,c=e.primaryButtonHandler,u=e.secondaryButtonCaption,s=e.secondaryButtonHandler,d=e.onClose;return n.createElement(jt.Z,{"data-locator":t,transitionDuration:500,open:r,onClose:d,"aria-labelledby":"form-dialog"},n.createElement(Zt.Z,{id:"form-dialog-title"},i),n.createElement(At.Z,null,n.createElement(wt.Z,null,a),o),n.createElement(Nt.Z,null,s&&n.createElement(p.Z,{"data-locator":"DIALOG.RESET_BUTTON",onClick:s,color:"secondary"},u),c&&n.createElement(p.Z,{"data-locator":"DIALOG.SUBMIT_BUTTON",onClick:c,color:"primary"},l)))}function Vt(e){var t=e["data-locator"],r=e.initialValues,i=e.isOpen,o=e.onSubmit,l=e.onReset,c=e.title,u=e.description,s=e.children;return n.createElement(a.J9,{initialValues:r,enableReinitialize:!0,onSubmit:o},(function(e){return n.createElement(Lt,{"data-locator":t,description:u,onClose:l,isOpen:i,primaryButtonCaption:"Сохранить",primaryButtonHandler:e.handleSubmit,secondaryButtonCaption:"Отмена",secondaryButtonHandler:l,title:c},n.cloneElement(s,{formikProps:e}))}))}var xt=r(63430),kt=r(28749),Yt=r(40043),Ht=(0,s.Z)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},period:{display:"inline",color:"gray",fontSize:12}}),Ft=function(e){var t=e.visit,r=e.isLong,i=e.locationUrl,a=Ht();if(!t)return"Не указано";var o=t.locationName;return n.createElement("div",{className:a.container},n.createElement(Qe,{visit:t,className:a.icon}),n.createElement(Yt.Z,{to:i,optional:!0},o),r?", ":"",n.createElement("div",{className:a.period},r&&(0,nt.JH)(t)))};Ft.defaultProps={visit:{}};const Mt=Ft;var Bt,Ut,Gt,qt,Kt=r(17493);function zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $t=(zt(Bt={},Kt.RIDE_CLASSES.ECONOMY,"Эконом"),zt(Bt,Kt.RIDE_CLASSES.COMFORT,"Комфорт"),zt(Bt,Kt.RIDE_CLASSES.BUSINESS,"Бизнес"),zt(Bt,Kt.RIDE_CLASSES.FIRST,"Первый"),zt(Bt,Kt.RIDE_CLASSES.PRIVATE,"Частный"),Bt),Wt=(zt(Ut={},Kt.RIDE_OCCUPATION.PASSENGER,"Пассажир"),zt(Ut,Kt.RIDE_OCCUPATION.STUFF,"Персонал"),zt(Ut,Kt.RIDE_OCCUPATION.DRIVER,"Водитель"),Ut),Jt=(zt(Gt={},Kt.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),zt(Gt,Kt.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),zt(Gt,Kt.RIDE_TYPES.CHARTER,"Чартерный рейс"),zt(Gt,Kt.RIDE_TYPES.TOUR,"Тур"),zt(Gt,Kt.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),zt(Gt,Kt.RIDE_TYPES.HITCH_HIKING,"Автостоп"),zt(Gt,Kt.RIDE_TYPES.DROP_OFF,"Подбросили до места"),Gt),Xt=(zt(qt={},Kt.VEHICLE_TYPES.CAR,"Автомобиль"),zt(qt,Kt.VEHICLE_TYPES.TRAIN,"Поезд"),zt(qt,Kt.VEHICLE_TYPES.AIRCRAFT,"Самолет"),zt(qt,Kt.VEHICLE_TYPES.BUS,"Автобус"),zt(qt,Kt.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),zt(qt,Kt.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),zt(qt,Kt.VEHICLE_TYPES.FERRY,"Паром"),zt(qt,Kt.VEHICLE_TYPES.BIKE,"Велосипед"),zt(qt,Kt.VEHICLE_TYPES.BY_FEET,"Пешком"),zt(qt,Kt.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),zt(qt,Kt.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),zt(qt,Kt.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),zt(qt,Kt.VEHICLE_TYPES.TRUCK,"Грузовик"),zt(qt,Kt.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),zt(qt,Kt.VEHICLE_TYPES.TRAM,"Трамвай"),zt(qt,Kt.VEHICLE_TYPES.TROLLEY,"Троллейбус"),zt(qt,Kt.VEHICLE_TYPES.TAXI,"Такси"),zt(qt,Kt.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),zt(qt,Kt.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),zt(qt,Kt.VEHICLE_TYPES.SUBWAY,"Метро"),zt(qt,Kt.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),qt),Qt=(r(83710),r(3151)),er=r(96843),tr=r(77349),rr=r(44268),nr=function(e){var t=e.dateFrom,r=e.timeFrom,n=(0,rr.Z)(r),i=(0,rr.Z)(t);return n&&i?new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()):new Date(NaN)};function ir(e,t){return(0,rr.Z)(e)&&!(0,er.Z)(t,e)}function ar(e){return function(e){if(Array.isArray(e))return or(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return or(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?or(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lr=null,cr=function(e){return function(t){var r=t.option;return r===lr?"Пункт отправления":n.createElement(Mt,{visit:e[r]})}},ur=function(e){var t=e.option;return t?Xt[t]:"Не указан"},sr=function(e){var t=e.option;return t?Jt[t]:"Не указан"},pr=function(e){var t=e.option;return t?$t[t]:"Не указан"},dr=function(e){var t=e.option;return t?Wt[t]:"Не указан"},mr=(0,s.Z)({option:{width:"100%"}}),fr=function(e){var t,r,i,a,o,l,c,u,s,p,v,b=e.tripVisitsIds,y=e.visitsDict,O=e.formikProps,g=O.values,I=g.vehicleType,T=g.rideType,P=g.rideComment,S=g.rideClass,C=g.rideOccupation,R=g.departureVisitId,_=g.departureDateTime,D=g.arrivalVisitId,j=g.arrivalDateTime,N=O.handleChange,A=O.setFieldValue,w=mr(),Z=b&&b.length>0,L=(r=(t={arrivalDateTimeField:{value:j,onChange:function(e){return A("arrivalDateTime",e)}},departureDateTimeField:{value:_,onChange:function(e){return A("departureDateTime",e)}}}).arrivalDateTimeField,i=r.value,a=r.onChange,l=(o=t.departureDateTimeField).value,c=o.onChange,u=(0,Qt.Z)(l,i),s=function(e,t){ir(e,l)&&c(e),ir(t,i)&&a(t)},p=function(e){var t=u?nr({timeFrom:i,dateFrom:e}):i;s(e,t)},v=function(e){var t=u?nr({timeFrom:l,dateFrom:e}):l;s(t,e)},{isSameDateField:{value:u,onChange:function(e){Boolean(u)!==Boolean(e)&&s(l,nr({dateFrom:e?l:(0,tr.Z)(l,1),timeFrom:i}))}},rideDepartureDateField:{value:l,onChange:function(e){p(nr({dateFrom:e,timeFrom:l}))}},rideArrivalDateField:{value:i,onChange:function(e){v(nr({dateFrom:e,timeFrom:i}))}},rideDepartureTimeField:{value:l,onChange:function(e){p(nr({dateFrom:l,timeFrom:e}))}},rideArrivalTimeField:{value:i,onChange:function(e){v(nr({dateFrom:i,timeFrom:e}))}}}),V=L.rideArrivalDateField,x=L.rideArrivalTimeField,k=L.rideDepartureDateField,Y=L.rideDepartureTimeField,H=L.isSameDateField;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},Z&&n.createElement(n.Fragment,null,n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_VISIT_SELECT",name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:cr(y),hasNullOption:!1,options:[lr].concat(ar(b)),value:R,onChange:N})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_VISIT_SELECT",name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:cr(y),options:[].concat(ar(b),[lr]),onChange:N,value:D}))),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.VEHICLE_TYPE_SELECT",name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:ur,options:Object.values(Kt.VEHICLE_TYPES),onChange:N,value:I})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_TYPE_SELECT",name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:sr,options:Object.values(Kt.RIDE_TYPES),onChange:N,value:T})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_CLASS_SELECT",name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:pr,options:Object.values(Kt.RIDE_CLASSES),onChange:N,value:S})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"RIDE_EDIT_FORM_SECTION.RIDE_OCCUPATION_SELECT",name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:dr,options:Object.values(Kt.RIDE_OCCUPATION),onChange:N,value:C})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(xt.e,{"data-locator":"RIDE_EDIT_FORM_SECTION.DEPARTURE_DATE_PICKER",name:"departureDateTime",autoOk:!0,className:w.option,label:"Дата отправления",value:k.value,onChange:k.onChange,format:"dd/MM/yyyy"})),n.createElement(d.Z,{item:!0,xs:6},H.value?n.createElement(m.Z,{control:n.createElement(f.Z,{checked:H.value,onChange:function(e){return H.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):n.createElement(xt.e,{"data-locator":"RIDE_EDIT_FORM_SECTION.ARRIVAL_DATE_PICKER",name:"arrivalDateTime",autoOk:!0,className:w.option,label:"Дата прибытия",value:V.value,onChange:V.onChange,format:"dd/MM/yyyy"})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(kt.e,{name:"departureDateTime",ampm:!1,autoOk:!0,className:w.option,label:"Время отправления",value:Y.value,onChange:Y.onChange})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(kt.e,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:w.option,label:"Время прибытия",value:x.value,onChange:x.onChange})),n.createElement(d.Z,{item:!0,xs:12},n.createElement(E.Z,{name:"rideComment",className:w.option,label:"Комментарий",multiline:!0,onChange:N,rows:1,rowsMax:12,value:P})))};fr.defaultProps={};const Er=fr;var vr=["isCreation","tripVisitsIds","visitsDict"];function br(){return br=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},br.apply(this,arguments)}function yr(e){var t=e.isCreation,r=e.tripVisitsIds,i=e.visitsDict,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,vr);return n.createElement(Vt,br({"data-locator":"TRIP_EDIT_PAGE.RIDE_DIALOG",title:t?"Создание маршрута":"Редактирование маршрута"},a),n.createElement(Er,{tripVisitsIds:r,visitsDict:i,formikProps:null}))}var Or,gr=r(3807);function Ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hr=(Ir(Or={},Xe.VISIT_TYPES.TRANSIT,"Транзит"),Ir(Or,Xe.VISIT_TYPES.REGULAR,"Посещение"),Ir(Or,Xe.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),Ir(Or,Xe.VISIT_TYPES.RELOCATION,"Переезд"),Or),Tr=function(e){return function(t){var r=t.option;return n.createElement(gr.Z,{ride:e[r],isLong:!0})}},Pr=function(e){var t=e.option;return t?hr[t]:"Не указан"},Sr=(0,s.Z)({option:{width:"100%"}});function Cr(e){var t=e.tripRidesIds,r=e.ridesDict,i=e.formikProps,a=i.values,o=a.locationName,l=a.visitType,c=a.visitComment,u=a.arrivalRideId,s=a.departureRideId,p=i.handleChange,m=i.handleBlur,f=i.setFieldValue,v=Sr(),b=t&&t.length>0;return n.createElement(d.Z,{container:!0,spacing:3,alignItems:"center"},n.createElement(d.Z,{item:!0,xs:12},n.createElement(ne,{"data-locator":"VISIT_EDIT_FORM_SECTION.LOCATION_SUGGEST",inputProps:{placeholder:"Место посещения..."},initialInputValue:o,onChange:function(e){var t=e.suggestion.geonameId;return f("geonameId",t)},onBlur:m,sourceProps:{domain:"visitEditFormSection.geoname",modelName:"geonames",filterField:"locationName",queryFormat:$},transformSuggestionToOption:Rr,triggerProps:{label:"Место посещения"}})),b&&n.createElement(n.Fragment,null,n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{name:"arrivalRideId",caption:"Прибытие",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:Tr(r),options:t,onChange:p,value:u})),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{name:"departureRideId",caption:"Отправление",inputId:"RideEditCard-departureVisitId",optionRender:Tr(r),hasNullOption:!1,options:t,value:s,onChange:p}))),n.createElement(d.Z,{item:!0,xs:6},n.createElement(h,{"data-locator":"VISIT_EDIT_FORM_SECTION.VISIT_TYPE_SELECT",name:"visitType",value:l,onChange:p,caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",optionRender:Pr,options:Object.values(Xe.VISIT_TYPES),hasNullOption:!0})),n.createElement(d.Z,{item:!0,xs:12},n.createElement(E.Z,{className:v.option,name:"visitComment",value:c,onChange:p,label:"Комментарий",fullWidth:!0,multiline:!0,rows:1,rowsMax:12})))}function Rr(e){return{label:e.locationName,details:[e.countryName,e.regionName].filter(Boolean).join(", "),suggestion:e}}Cr.defaultProps={};var _r=["isCreation","tripRidesIds","ridesDict"];function Dr(){return Dr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dr.apply(this,arguments)}function jr(e){var t=e.isCreation,r=e.tripRidesIds,i=e.ridesDict,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,_r);return n.createElement(Vt,Dr({"data-locator":"TRIP_EDIT_PAGE.VISIT_DIALOG",title:t?"Создание посещения":"Редактирование посещения"},a),n.createElement(Cr,{tripRidesIds:r,ridesDict:i,formikProps:null}))}var Nr=["visit","onSubmit","onReset"];function Ar(){return Ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ar.apply(this,arguments)}function wr(e){var t=e.visit,r=e.onSubmit,i=e.onReset,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Nr);return n.createElement(Lt,Ar({title:"Удалить посещение",description:"Вы действительно хотите удалить посещение",primaryButtonCaption:"Да",primaryButtonHandler:function(e){return r(e,t)},secondaryButtonCaption:"Нет",secondaryButtonHandler:i},a),n.createElement(Mt,{visit:t}))}function Zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(r),!0).forEach((function(t){Vr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xr(e){var t=e.provision,r=e.dialogsState,i=e.hideDialog,a=e.handleSubmitRide,o=e.handleSubmitVisit,l=e.handleDeleteVisit,c=e.trip,u=t.ridesDict,s=t.visitsDict,p=c.tripId,d=c.visits,m=c.rides,f=r.dialogName,E=r.dialogParams,v=void 0===E?{}:E,b=(0,n.useMemo)((function(){var e=v.rideId;return Lr(Lr(Lr({},e?u[e]:(0,_t.vA)()),v),{},{tripId:p})}),[u,p,v]),y=(0,n.useMemo)((function(){var e=v.visitId;return Lr(Lr(Lr({},e?s[e]:(0,Dt.Tl)()),v),{},{tripId:p})}),[s,p,v]),O=function(e){return e===Re||e===Ce}(f),g=function(e){return e===De||e===_e}(f),I=f===je;return n.createElement(n.Fragment,null,n.createElement(yr,{initialValues:b,tripVisitsIds:d,isOpen:O,onSubmit:function(e){a(e),i()},onReset:i,isCreation:f===Ce,visitsDict:s}),n.createElement(jr,{initialValues:y,tripRidesIds:m,isOpen:g,onSubmit:function(e){o(e),i()},onReset:i,isCreation:f===_e,ridesDict:u}),n.createElement(wr,{visit:s[v.visitId],isOpen:I,onSubmit:function(e,t){var r=t.visitId;l(r),i()},onReset:i}))}function kr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(88674),r(17727);var Hr="travel.TripEditPage";const Fr=function(e){var t=e.match.params,r=t.userAlias,s=t.strTripId,p=t.action,d=(0,o._l)().travel.tripEdit,m=(0,i.k6)(),f="create"===p,E=(0,l.Eu)(),v=E.isAuthenticated,b=E.userAlias,y=s&&parseInt(s,10),O=(0,c.Yy)({userAlias:r,tripsIds:y?[y]:[]}),g=O.tripsDict,I=O.tripsProvision,h=f?(0,u.fX)():g[y],T=function(e){var t=kr((0,z.QT)({domain:"".concat(Hr,".rides"),modelName:"rides"}),1)[0],r=(0,n.useCallback)((function(r){return t({query:{id:r.rideId,body:r}}).then(e)}),[]),i=kr((0,z.QT)({domain:"".concat(Hr,".trips"),modelName:"trips"}),1)[0],a=(0,n.useCallback)((function(t){return i({query:{id:t.tripId,body:t}}).finally(e)}),[]),o=kr((0,z.QT)({domain:"".concat(Hr,".visits"),modelName:"visits"}),1)[0],l=(0,n.useCallback)((function(t){return o({query:{id:t.visitId,body:t}}).then(e)}),[]),c=kr((0,z.QT)({domain:"".concat(Hr,".visits"),modelName:"visits"}),1)[0];return{handleSubmitRide:r,handleSubmitTrip:a,handleSubmitVisit:l,handleDeleteVisit:(0,n.useCallback)((function(t){return c({method:"DELETE",query:{id:t}}).then(e)}),[])}}(I.invalidate),P=T.handleSubmitRide,S=T.handleSubmitTrip,C=T.handleSubmitVisit,R=T.handleDeleteVisit,_=function(){var e,t,r=(e=(0,n.useState)({name:null}),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Se(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];return{showDialog:function(e,t){a({dialogName:e,dialogParams:t})},hideDialog:function(){a({name:null})},dialogsState:i}}(),D=_.showDialog,j=_.hideDialog,N=_.dialogsState,A=O.isError,w=O.isReady,Z=O.isPending;return y&&(!w||h)||f?v&&b===r?A?n.createElement("div",null,"...Error"):Z?n.createElement("div",null,"...Loading"):h?n.createElement(n.Fragment,null,n.createElement(a.J9,{initialValues:{trip:h},onSubmit:function(e){return S(e.trip).then((function(e){if(!y&&e){var t=d.toUrl({userAlias:r,strTripId:String(e)});m.push(t)}}))}},(function(e){return n.createElement(Rt,{isCreation:f,showDialog:D,formikProps:e,provision:O})})),n.createElement(xr,{provision:O,dialogsState:N,hideDialog:j,handleSubmitRide:P,handleSubmitVisit:C,handleDeleteVisit:R,trip:h})):n.createElement("div",null,"...Error, no trip is provided"):n.createElement("div",null,"У вас не достаочно прав для просмотра данной страницы"):n.createElement("div",null,"Запрашиваемая вами страница не найдена")}}}]);
//# sourceMappingURL=travel-TripEditPage-09bd3f09a7a1c09f622c.js.map