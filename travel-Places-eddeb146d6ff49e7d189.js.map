{"version":3,"file":"travel-Places-eddeb146d6ff49e7d189.js","mappings":"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","sources":["webpack://mine/./src/modules/components/muiExtended/ConnectedLink/ConnectedLink.jsx","webpack://mine/./src/modules/utilities/dateTime/dateTimePeriodToString.js","webpack://mine/./src/packages/travel/components/RideIcon/RideIcon.jsx","webpack://mine/./src/packages/travel/components/RideInfo/RideInfo.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/CountryVisitsGroup/CountryVisitsGroup.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/utils/resolveGroupingUtils.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/LocationVisitsGroup/LocationVisitsGroup.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/YearVisitsGroup/YearVisitsGroup.jsx","webpack://mine/./src/modules/utilities/hooks/makeVisibleOnlyOnHoverStyles.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/TripVisitsGroup/TripInfo/TripInfo.jsx","webpack://mine/./src/modules/components/AutoMargin/AutoMargin.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/VisitsItselfGroup/components/LocationWithRideInfo/LocationWithRideInfo.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/VisitsItselfGroup/components/VisitInfo/VisitInfo.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/VisitsItselfGroup/VisitsItselfGroup.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/consts.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/components/TripVisitsGroup/TripVisitsGroup.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/groupping/utils/groupVisitsBy.js","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/utils/createCalcByYearUtils.js","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/utils/calcDaysTravellingStats.js","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/utils/calcStats.js","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/components/StatsIndicator/StatsIndicator.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/components/CountriesStats/CountriesStats.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/components/LocationStats/LocationStats.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/components/DaysTravellingStats/DaysTravellingStats.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/StatsPanel.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/statistics/components/StatsPanel/utils/isNewbie.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/sorting/consts.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/sorting/utils/sortVisitsBy.js","webpack://mine/./src/packages/travel/components/VisitsArranger/components/Expandable/components/ExpandableActions/ExpandableActions.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/Expandable/Expandable.jsx","webpack://mine/./src/modules/utilities/virtual/useRect.js","webpack://mine/./src/modules/utilities/virtual/calculateRange.js","webpack://mine/./src/modules/utilities/virtual/index.js","webpack://mine/./src/modules/utilities/virtual/useRange.js","webpack://mine/./src/packages/travel/components/VisitsArranger/components/Virtualizer/components/Virtualized/Virtualized.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/Virtualizer/components/BypassVirtualized/BypassVirtualized.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/Virtualizer/Virtualizer.jsx","webpack://mine/./src/modules/components/LazyWithPlaceholder/LazyWithPlaceholder.jsx","webpack://mine/./src/modules/components/PhotosGallery/components/ZoomableImage/ZoomableImage.jsx","webpack://mine/./src/modules/components/PhotosGallery/components/LazyImage/BlurhashErrorBoundary.jsx","webpack://mine/./src/modules/components/PhotosGallery/components/LazyImage/LazyImage.jsx","webpack://mine/./src/modules/components/PhotosGallery/components/GallerySkeleton/GallerySkeleton.jsx","webpack://mine/./src/modules/components/PhotosGallery/components/FullscreenFallback/FullscreenFallback.jsx","webpack://mine/./src/modules/components/PhotosGallery/PhotosGallery.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/VisitsPhotosGallery/VisitsPhotosGallery.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/VisitsLocationsMap/VisitsLocationsMap.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/components/VisitGroup/VisitGroup.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/filtering/consts.js","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/filtering/switchFilteringFn.js","webpack://mine/./src/packages/travel/components/VisitsArranger/VisitsArranger.jsx","webpack://mine/./src/packages/travel/components/VisitsArranger/arrangement/collapsing/useCollapsible.js","webpack://mine/./src/packages/travel/components/VisitsArranger/index.js","webpack://mine/./src/modules/utilities/text/uniqTrimAndJoin.js","webpack://mine/./src/packages/travel/models/trips/utils/resolveTripCaption.js","webpack://mine/./src/packages/travel/pages/CountryPage/CountryPage.jsx","webpack://mine/./src/packages/travel/pages/CountryPage/useCountryWithTripStats.js","webpack://mine/./src/packages/travel/pages/LocationPage/blocks/LocationRating.jsx","webpack://mine/./src/packages/travel/pages/LocationPage/useLocationWithTripStats.js","webpack://mine/./src/packages/travel/dataSource/useLocation.js","webpack://mine/./src/packages/travel/pages/LocationPage/LocationPage.jsx","webpack://mine/./src/packages/travel/pages/LocationsPage/blocks/LocationRating.jsx","webpack://mine/./src/packages/travel/pages/LocationsPage/LocationsPage.jsx","webpack://mine/./src/packages/travel/pages/LocationsPage/useUserLocations.js","webpack://mine/./src/packages/travel/pages/TripPage/TripPage.jsx","webpack://mine/./src/packages/travel/pages/VisitPage/resolveDropzoneStyles.js","webpack://mine/./src/packages/travel/pages/VisitPage/components/PhotosDropzone/calcBlurhashInWorker.js","webpack://mine/./src/packages/travel/pages/VisitPage/components/PhotosDropzone/PhotosDropzone.jsx","webpack://mine/./src/packages/travel/pages/VisitPage/VisitPage.jsx","webpack://mine/./src/modules/components/loaders/BackdropLoader.jsx","webpack://mine/./src/packages/travel/pages/VisitsPage/sidebarConsts.js","webpack://mine/./src/packages/travel/pages/VisitsPage/consts.js","webpack://mine/./src/packages/travel/pages/VisitsPage/useVisitsGroupingSidebar.jsx","webpack://mine/./src/packages/travel/pages/VisitsPage/components/VisitsTitle/VisitsTitle.jsx","webpack://mine/./src/packages/travel/pages/VisitsPage/locators.js","webpack://mine/./src/packages/travel/pages/VisitsPage/resolveGroupsOrder.js","webpack://mine/./src/packages/travel/pages/VisitsPage/resolveSortingOrder.js","webpack://mine/./src/packages/travel/pages/VisitsPage/resolveFiltering.js","webpack://mine/./src/packages/travel/pages/VisitsPage/VisitsPage.jsx","webpack://mine/./src/packages/travel/pages/YearPage/YearPage.jsx","webpack://mine/./src/packages/travel/pages/YearPage/useYearWithTripStats.js","webpack://mine/./src/packages/travel/utils/useVisitsUrls.js"],"sourcesContent":["import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport MUILink from '@material-ui/core/Link';\nimport { Typography } from '@material-ui/core';\n\nexport default function ConnectedLink({\n  optional,\n  children,\n  ...forwardingProps\n}) {\n  const linkable = Boolean(\n    !optional ||\n      forwardingProps.href ||\n      forwardingProps.to ||\n      forwardingProps.onClick,\n  );\n\n  if (!linkable) {\n    return <Typography {...forwardingProps}>{children}</Typography>;\n  }\n\n  return (\n    <MUILink {...forwardingProps} component={RouterLink}>\n      {children}\n    </MUILink>\n  );\n}\n\nConnectedLink.defaultProps = {\n  optional: false,\n};\n","import isSameDay from 'date-fns/isSameDay';\nimport isSameMonth from 'date-fns/isSameMonth';\nimport isSameYear from 'date-fns/isSameYear';\nimport ru from 'date-fns/locale/ru';\nimport dateFormat from 'modules/utilities/dateTime/safeDateFormat';\n\nconst DATE_FORMATS = {\n  FULL: 'd MMMM yyyy',\n  MONTH_YEAR: 'LLLL yyyy',\n  MONTH_ONLY: 'LLLL',\n  DAY_MONTH: 'd MMMM',\n  DAY_ONLY: 'd',\n};\n\nexport function dateTimePeriodToString(periodStart, periodEnd, isObscure) {\n  const fullFormat = isObscure ? DATE_FORMATS.MONTH_YEAR : DATE_FORMATS.FULL;\n  const periodEndString = dateFormat(periodEnd, fullFormat, {\n    locale: ru,\n  });\n\n  if (isSameDay(periodStart, periodEnd)) {\n    return periodEndString;\n  }\n\n  let periodStartString = '';\n  if (isSameMonth(periodStart, periodEnd)) {\n    if (!isObscure) {\n      periodStartString = dateFormat(periodStart, DATE_FORMATS.DAY_ONLY, {\n        locale: ru,\n      });\n    }\n  } else if (isSameYear(periodStart, periodEnd)) {\n    const shortFormat = isObscure\n      ? DATE_FORMATS.MONTH_ONLY\n      : DATE_FORMATS.DAY_MONTH;\n    periodStartString = dateFormat(periodStart, shortFormat, { locale: ru });\n  } else {\n    periodStartString = dateFormat(periodStart, fullFormat, { locale: ru });\n  }\n\n  return `${periodStartString}—${periodEndString}`;\n}\n\nexport function rideDateTimePeriodToString(\n  { departureDateTime, arrivalDateTime },\n  isObscure,\n) {\n  return dateTimePeriodToString(departureDateTime, arrivalDateTime, isObscure);\n}\n\nexport function visitDateTimePeriodToString(\n  { departureDateTime, arrivalDateTime },\n  isObscure,\n) {\n  return dateTimePeriodToString(arrivalDateTime, departureDateTime, isObscure);\n}\n\nexport function dateTimeOpenPeriodToString({\n  periodStart,\n  periodEnd,\n  isObscure,\n  placeholder,\n}) {\n  if (!periodEnd) {\n    const format = isObscure ? DATE_FORMATS.MONTH_YEAR : DATE_FORMATS.FULL;\n    const startDateStr = dateFormat(periodStart, format, { locale: ru });\n    return `${startDateStr}—${placeholder}`;\n  }\n  return dateTimePeriodToString(periodStart, periodEnd, isObscure);\n}\n","import React from 'react';\nimport BikeIcon from '@material-ui/icons/DirectionsBike';\nimport BoatIcon from '@material-ui/icons/DirectionsBoat';\nimport BusIcon from '@material-ui/icons/DirectionsBus';\nimport CarIcon from '@material-ui/icons/DirectionsCar';\nimport CustomTransportIcon from '@material-ui/icons/Commute';\nimport FlightIcon from '@material-ui/icons/Flight';\nimport MotorcycleIcon from '@material-ui/icons/Motorcycle';\nimport TerrainIcon from '@material-ui/icons/Terrain';\nimport TrainIcon from '@material-ui/icons/Train';\nimport TruckIcon from '@material-ui/icons/LocalShipping';\nimport VanIcon from '@material-ui/icons/AirportShuttle';\nimport WalkIcon from '@material-ui/icons/DirectionsWalk';\nimport TramIcon from '@material-ui/icons/Tram';\nimport LocalTaxiIcon from '@material-ui/icons/LocalTaxi';\nimport SubwayIcon from '@material-ui/icons/Subway';\nimport SeatIcon from '@material-ui/icons/AirlineSeatReclineNormal';\nimport UnknownRideIcon from '@material-ui/icons/NotListedLocation';\nimport { VEHICLE_TYPES } from 'travel/models/rides/consts';\n\nexport default function RideIcon({ ride: { vehicleType }, className }) {\n  const IconComponent = resolveRideIconComponent(vehicleType);\n  return <IconComponent className={className} />;\n}\n\nfunction resolveRideIconComponent(vehicleType) {\n  switch (vehicleType) {\n    case VEHICLE_TYPES.CAR:\n      return CarIcon;\n    case VEHICLE_TYPES.TRAIN:\n      return TrainIcon;\n    case VEHICLE_TYPES.AIRCRAFT:\n      return FlightIcon;\n    case VEHICLE_TYPES.BUS:\n    case VEHICLE_TYPES.TROLLEY:\n    case VEHICLE_TYPES.CITY_BUS:\n      return BusIcon;\n    case VEHICLE_TYPES.MOTORHOME:\n    case VEHICLE_TYPES.JITNEY:\n      return VanIcon;\n    case VEHICLE_TYPES.LOCAL_TRAIN:\n      return TrainIcon;\n    case VEHICLE_TYPES.FERRY:\n      return BoatIcon;\n    case VEHICLE_TYPES.BIKE:\n      return BikeIcon;\n    case VEHICLE_TYPES.BY_FEET:\n      return WalkIcon;\n    case VEHICLE_TYPES.MOTORBIKE:\n      return MotorcycleIcon;\n    case VEHICLE_TYPES.TRUCK:\n      return TruckIcon;\n    case VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:\n      return TerrainIcon;\n    case VEHICLE_TYPES.TRAM:\n      return TramIcon;\n    case VEHICLE_TYPES.TAXI:\n      return LocalTaxiIcon;\n    case VEHICLE_TYPES.SUBWAY:\n      return SubwayIcon;\n    case VEHICLE_TYPES.PUBLIC_TRANSPORT:\n      return SeatIcon;\n    case VEHICLE_TYPES.ROPEWAY:\n    case VEHICLE_TYPES.FUNICULAR:\n      return CustomTransportIcon;\n    default:\n      return UnknownRideIcon;\n  }\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport HichHikingIcon from '@material-ui/icons/ThumbUp';\nimport { rideDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport { RIDE_TYPES } from 'travel/models/rides/consts';\nimport RideIcon from 'travel/components/RideIcon';\n\nconst useStyles = makeStyles({\n  icon: { color: 'gray', fontSize: 16, height: 16 },\n  absoluteIcon: {\n    // todo fast decision, need refactor\n    color: 'gray',\n    fontSize: 16,\n    height: 16,\n    position: 'absolute',\n  },\n  detail: { color: 'gray', fontSize: 12 },\n});\n\nexport default function RideInfo({\n  ride,\n  ride: { rideType } = {},\n  className,\n  isLong,\n}) {\n  const classes = useStyles();\n\n  if (!ride) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      <RideIcon ride={ride} className={classes.icon} />\n      {rideType === RIDE_TYPES.HITCH_HIKING && (\n        <HichHikingIcon className={classes.absoluteIcon} />\n      )}\n      {isLong && rideDateTimePeriodToString(ride)}\n    </div>\n  );\n}\n","import React from 'react';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\n\nexport default function CountryVisitsGroup({\n  children,\n  visitsGroup: {\n    field: { value: countryId },\n  },\n  classes,\n  provision: { countriesDict },\n  urls,\n  config: {\n    CountryVisitsGroup: {\n      hyperlinks: { country: countryHyperlink = true } = {},\n    } = {},\n  },\n}) {\n  return (\n    <CountryInfo\n      country={countriesDict[countryId]}\n      className={classes.container}\n      classes={classes}\n      countryUrl={\n        countryHyperlink ? urls?.resolveCountryUrl({ countryId }) : null\n      }\n    >\n      {children}\n    </CountryInfo>\n  );\n}\n\nexport function CountryInfo({\n  variant,\n  country: { countryName },\n  children,\n  className,\n  classes,\n  countryUrl,\n}) {\n  return (\n    <div className={className}>\n      <ConnectedLink\n        to={countryUrl}\n        optional={true}\n        display=\"inline\"\n        variant={variant}\n        className={classes.header}\n      >\n        {countryName}\n      </ConnectedLink>\n      {children}\n    </div>\n  );\n}\n\nCountryVisitsGroup.defaultProps = {\n  config: {},\n};\n","export function findClosestGroupValue(visitsGroup, plainGroup) {\n  return findClosestGroup(visitsGroup, plainGroup)?.field?.value;\n}\n\nexport function findClosestGroup(visitsGroup, plainGroup) {\n  let currentVisitsGroup = visitsGroup;\n  while (currentVisitsGroup) {\n    if (plainGroup === currentVisitsGroup.plainGroup) {\n      return currentVisitsGroup;\n    }\n    currentVisitsGroup = currentVisitsGroup.parent;\n  }\n  return null;\n}\n","import React from 'react';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\nimport { findClosestGroupValue } from '../../utils/resolveGroupingUtils';\nimport { PLAIN_GROUPS } from '../../consts';\n\nexport default function LocationVisitsGroup({\n  children,\n  visitsGroup,\n  visitsGroup: {\n    field: { value: locationIdStr },\n  },\n  classes,\n  provision,\n  provision: { locationsDict },\n  urls,\n  config: {\n    LocationVisitsGroup: {\n      appearance,\n      hyperlinks: {\n        location: locationHyperlink = true,\n        country: countryHyperlink = true,\n      } = {},\n    } = {},\n  },\n}) {\n  const location = locationsDict[locationIdStr];\n  const groupCountryId = findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.COUNTRIES,\n  );\n  const { locationId, countryId } = location ?? {};\n\n  const locationUrl = locationHyperlink\n    ? urls?.resolveLocationUrl({ locationId })\n    : null;\n  const countryUrl = countryHyperlink\n    ? urls?.resolveCountryUrl({ countryId })\n    : null;\n\n  return (\n    <LocationInfo\n      className={classes.container}\n      classes={classes}\n      location={location}\n      provision={provision}\n      showCountry={!groupCountryId}\n      locationUrl={locationUrl}\n      countryUrl={countryUrl}\n      appearance={appearance}\n    >\n      {children}\n    </LocationInfo>\n  );\n}\n\nLocationVisitsGroup.defaultProps = {\n  config: {},\n};\n\nexport function LocationInfo({\n  children,\n  variant,\n  className,\n  classes = {},\n  location: { locationName, countryId } = {},\n  provision: { countriesDict },\n  showCountry,\n  locationUrl,\n  countryUrl,\n  appearance: { country: countryAppearance = true },\n}) {\n  const countryName = countriesDict[countryId]?.countryName;\n  const countryNode =\n    countryAppearance && countryName && showCountry ? (\n      <ConnectedLink\n        to={countryUrl}\n        optional={true}\n        display=\"inline\"\n        variant=\"body1\"\n      >\n        {countriesDict[countryId]?.countryName}\n      </ConnectedLink>\n    ) : null;\n\n  const locationNode = (\n    <ConnectedLink\n      to={locationUrl}\n      optional={true}\n      display=\"inline\"\n      variant={variant}\n      className={classes.header}\n    >\n      {locationName}\n      {countryNode ? ',' : ''}\n    </ConnectedLink>\n  );\n\n  return (\n    <div className={className}>\n      <div>\n        {locationNode}\n        {countryNode ? ' ' : null}\n        {countryNode}\n      </div>\n      {children}\n    </div>\n  );\n}\n\nLocationInfo.defaultProps = {\n  appearance: {},\n  classes: {},\n};\n","import React from 'react';\nimport cls from 'classnames';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\n\nconst useStyles = makeStyles({\n  container: {},\n});\n\nexport default function YearVisitsGroup({\n  children,\n  visitsGroup: {\n    field: { value: year },\n  },\n  classes,\n  urls,\n  config: {\n    YearVisitsGroup: { hyperlinks: { year: yearHyperlink = true } = {} } = {},\n  } = {}\n}) {\n  const ownClasses = useStyles();\n\n  return (\n    <YearInfo\n      className={cls(classes.container, ownClasses.container)}\n      classes={classes}\n      year={year}\n      yearUrl={yearHyperlink ? urls?.resolveYearUrl({ year }) : null}\n    >\n      {children}\n    </YearInfo>\n  );\n}\n\nfunction YearInfo({ children, variant, className, classes, year, yearUrl }) {\n  return (\n    <div className={className}>\n      <ConnectedLink\n        to={(year && yearUrl) || undefined}\n        optional={true}\n        display=\"inline\"\n        variant={variant}\n        className={classes.header}\n      >\n        {year || 'Без указания даты'}\n      </ConnectedLink>\n      {children}\n    </div>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\n\nexport default function makeVisibleOnHoverStyles({\n  containerClassName = 'hoverTrigger',\n  contentClassName = 'visibleOnHover',\n} = {}) {\n  return makeStyles({\n    [containerClassName]: {\n      [`&:hover $${contentClassName}`]: {\n        visibility: 'visible',\n      },\n    },\n    [contentClassName]: {\n      visibility: 'hidden',\n    },\n  });\n}\n\nexport const useVisibleOnHoverStyles = makeVisibleOnHoverStyles();\n","import React from 'react';\nimport cls from 'classnames';\nimport Typography from '@material-ui/core/Typography';\nimport { resolveTripCaption } from 'travel/models/trips/utils';\nimport IconButton from '@material-ui/core/IconButton';\nimport EditIcon from '@material-ui/icons/Edit';\nimport { useVisibleOnHoverStyles } from 'modules/utilities/hooks/makeVisibleOnlyOnHoverStyles';\n\nexport default function TripInfo({\n  trip,\n  visitsDict,\n  countriesDict,\n  locationsDict,\n  children,\n  className,\n  variant,\n  urls,\n}) {\n  const { hoverTrigger, visibleOnHover } = useVisibleOnHoverStyles();\n  const tripEditUrl = urls?.resolveTripEditUrl({ tripId: trip.tripId });\n\n  return (\n    <Typography\n      variant={variant ?? undefined}\n      className={cls(className, hoverTrigger)}\n      paragraph={true}\n    >\n      <span>\n        {resolveTripCaption(trip, visitsDict, countriesDict, locationsDict)}\n      </span>\n      {children}\n      {tripEditUrl && (\n        <IconButton className={visibleOnHover} href={tripEditUrl}>\n          <EditIcon />\n        </IconButton>\n      )}\n    </Typography>\n  );\n}\n\nTripInfo.defaultProps = { variant: 'h4' };\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles({\n  autoMargin: { marginLeft: 'auto' },\n});\n\nexport default function AutoMargin({ children, className }) {\n  const classes = useStyles();\n  const childrenArray = React.Children.toArray(children);\n  if (childrenArray.length <= 1) {\n    return <Typography className={className}>{children}</Typography>;\n  }\n\n  const lastChildren = childrenArray.slice(-1);\n  const restChildren = childrenArray.slice(0, -1);\n  return (\n    <Grid\n      className={className}\n      container={true}\n      justify=\"space-between\"\n      alignItems=\"center\"\n    >\n      <Grid item={true}>{restChildren}</Grid>\n      <Grid item={true} classes={{ item: classes.autoMargin }}>\n        {lastChildren}\n      </Grid>\n    </Grid>\n  );\n}\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport RideInfo from 'travel/components/RideInfo';\nimport AutoMargin from 'modules/components/AutoMargin';\nimport { LocationInfo } from '../../../LocationVisitsGroup/LocationVisitsGroup';\n\nconst useStyles = makeStyles({\n  halfDown: { position: 'relative', top: 12 },\n});\n\nexport default function LocationWithRideInfo({\n  locationId,\n  rideId,\n  provision,\n  provision: { ridesDict, locationsDict },\n  groupCountryId,\n  children,\n  locationInfoChildren,\n  className,\n  classes,\n  urls,\n}) {\n  const ownClasses = useStyles();\n  const location = locationsDict[locationId];\n\n  return (\n    <AutoMargin className={className}>\n      <LocationInfo\n        className={classes.locationContainer}\n        provision={provision}\n        location={location}\n        showCountry={!groupCountryId}\n        locationUrl={urls?.resolveLocationUrl({ locationId })}\n        countryUrl={urls?.resolveCountryUrl({ countryId: location?.countryId })}\n      >\n        {locationInfoChildren}\n      </LocationInfo>\n      {groupCountryId ? (\n        children\n      ) : (\n        <Grid container={true}>\n          <Grid item={true}>{children}</Grid>\n          <Grid item={true}>\n            <RideInfo\n              ride={ridesDict[rideId]}\n              className={ownClasses.halfDown}\n            />\n          </Grid>\n        </Grid>\n      )}\n    </AutoMargin>\n  );\n}\n\nLocationWithRideInfo.defaultProps = {\n  classes: {},\n};\n","import React from 'react';\nimport cls from 'classnames';\nimport { Link } from 'react-router-dom';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport EventIcon from '@material-ui/icons/Event';\nimport { visitDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport LocationWithRideInfo from '../LocationWithRideInfo';\nimport { useVisibleOnHoverStyles } from 'modules/utilities/hooks/makeVisibleOnlyOnHoverStyles';\n\nconst useStyles = makeStyles({\n  locationContainer: {\n    position: 'relative',\n  },\n  detail: {\n    color: 'gray',\n    fontSize: 12,\n  },\n  editButton: {\n    position: 'absolute',\n    top: '-50%',\n    left: '100%',\n  },\n});\n\nexport default function VisitInfo({\n  visit: { visitId, locationId, departureRideId },\n  provision,\n  provision: { visitsDict },\n  urls,\n  isObscure,\n  groupCountryId,\n  className,\n}) {\n  const classes = useStyles();\n  const { hoverTrigger, visibleOnHover } = useVisibleOnHoverStyles();\n\n  const visitUrl = urls?.resolveVisitUrl({ visitId });\n  return (\n    <LocationWithRideInfo\n      className={cls(className, hoverTrigger)}\n      classes={{ locationContainer: classes.locationContainer }}\n      locationId={locationId}\n      rideId={departureRideId}\n      provision={provision}\n      groupCountryId={groupCountryId}\n      urls={urls}\n      locationInfoChildren={\n        visitUrl && (\n          <IconButton\n            className={cls(classes.editButton, visibleOnHover)}\n            component={Link}\n            to={visitUrl}\n          >\n            <EventIcon />\n          </IconButton>\n        )\n      }\n    >\n      <Typography className={classes.detail}>\n        {visitDateTimePeriodToString(visitsDict[visitId], isObscure)}\n      </Typography>\n    </LocationWithRideInfo>\n  );\n}\n","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport uniqBy from 'lodash/uniqBy';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\nimport { visitDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport { findClosestGroupValue } from '../../utils/resolveGroupingUtils';\nimport { PLAIN_GROUPS } from '../../consts';\nimport { LocationInfo } from '../LocationVisitsGroup';\nimport VisitInfo from './components/VisitInfo';\nimport LocationWithRideInfo from './components/LocationWithRideInfo';\n\nconst useStyles = makeStyles({\n  placeDetails: {\n    display: 'inline-block',\n    marginRight: '8px',\n  },\n});\n\nexport default function VisitsItselfGroup({\n  visitsGroup,\n  visitsGroup: { visitsList },\n  provision,\n  provision: { tripsDict, locationsDict },\n  classes,\n  urls,\n  config: {\n    VisitsItselfGroup: {\n      appearance: {\n        country: countryAppearance = true,\n        location: locationAppearance = true,\n      } = {},\n    } = {},\n  } = {},\n}) {\n  const ownClasses = useStyles();\n  const groupTripId = findClosestGroupValue(visitsGroup, PLAIN_GROUPS.TRIPS);\n  const groupCountryId = findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.COUNTRIES,\n  );\n  const groupLocationId = findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.LOCATIONS,\n  );\n\n  // currently remains only first visit, and only dates for this visit is shown to user\n  // todo: solve the issue, show all periods, or show no dates, whatever\n  const actualVisitsList = useMemo(\n    () => (groupCountryId ? uniqBy(visitsList, 'locationId') : visitsList),\n    [groupCountryId, visitsList],\n  );\n\n  if (!groupTripId) {\n    return (\n      <>\n        {visitsList.map(visit => {\n          const { locationId, countryId } = visit;\n          const locationUrl =\n            locationAppearance && !groupLocationId\n              ? urls?.resolveLocationUrl({ locationId })\n              : null;\n          const countryUrl =\n            countryAppearance && !groupLocationId\n              ? urls?.resolveCountryUrl({ countryId })\n              : null;\n          return (\n            <div className={classes.level}>\n              {locationUrl && (\n                <LocationInfo\n                  className={ownClasses.placeDetails}\n                  location={locationsDict[locationId]}\n                  provision={provision}\n                  showCountry={Boolean(countryUrl) && !groupCountryId}\n                  locationUrl={locationUrl}\n                  countryUrl={countryUrl}\n                />\n              )}\n              <ConnectedLink\n                to={urls.resolveVisitUrl({ visitId: visit.visitId })}\n                optional={true}\n                display=\"inline\"\n              >\n                {visitDateTimePeriodToString(visit, false)}\n              </ConnectedLink>\n            </div>\n          );\n        })}\n      </>\n    );\n  }\n\n  const { originLocationId, departureRideId } = tripsDict[groupTripId] ?? {};\n  const originLocation = locationsDict[originLocationId];\n\n  return (\n    <div className={classes.level}>\n      {!groupCountryId && (\n        <LocationWithRideInfo\n          locationId={originLocationId}\n          rideId={departureRideId}\n          provision={provision}\n          groupCountryId={groupCountryId}\n          className={classes.header}\n          urls={urls}\n        />\n      )}\n      {actualVisitsList.map(visit => (\n        <VisitInfo\n          className={classes.header}\n          key={`v${visit.visitId}`}\n          visit={visit}\n          provision={provision}\n          isObscure={false}\n          groupCountryId={groupCountryId}\n          urls={urls}\n        />\n      ))}\n      {/* todo: Don't show for relocation trip */}\n      {!groupCountryId && (\n        <LocationInfo\n          className={classes.header}\n          provision={provision}\n          location={originLocation}\n          showCountry={!groupCountryId}\n          locationUrl={urls?.resolveLocationUrl({\n            locationId: originLocationId,\n          })}\n          countryUrl={urls?.resolveCountryUrl({\n            countryId: originLocation?.countryId,\n          })}\n        />\n      )}\n    </div>\n  );\n}\n","import CountryVisitsGroup from './components/CountryVisitsGroup';\nimport LocationVisitsGroup from './components/LocationVisitsGroup';\nimport YearVisitsGroup from './components/YearVisitsGroup';\nimport TripVisitsGroup from './components/TripVisitsGroup';\nimport VisitsItselfGroup from './components/VisitsItselfGroup';\n\nexport const PLAIN_GROUPS = {\n  // ALL: 'ALL',\n  LOCATIONS: 'LOCATIONS',\n  COUNTRIES: 'COUNTRIES',\n  YEARS: 'YEARS',\n  TRIPS: 'TRIPS',\n  JUST_VISITS: 'JUST_VISITS',\n};\n\nexport const PLAIN_GROUPS_CONFIG = {\n  [PLAIN_GROUPS.TRIPS]: {\n    groupFieldName: 'tripId',\n    component: TripVisitsGroup,\n    adapter: Number, // Will be applied to value of \"groupFieldName\" field\n  },\n  [PLAIN_GROUPS.YEARS]: {\n    groupFieldName: function getArrivalYear({ arrivalDateTime }) {\n      return arrivalDateTime.getFullYear();\n    },\n    component: YearVisitsGroup,\n    adapter: Number,\n  },\n  [PLAIN_GROUPS.COUNTRIES]: {\n    groupFieldName: 'countryId',\n    component: CountryVisitsGroup,\n    adapter: Number,\n  },\n  [PLAIN_GROUPS.LOCATIONS]: {\n    groupFieldName: 'locationId',\n    component: LocationVisitsGroup,\n    adapter: Number,\n  },\n  [PLAIN_GROUPS.JUST_VISITS]: {\n    groupFieldName: 'visitId',\n    component: VisitsItselfGroup,\n    adapter: Number,\n  },\n};\n","import React from 'react';\nimport cls from 'classnames';\nimport TripInfo from './TripInfo';\n\nexport default function TripVisitsGroup({\n  classes,\n  children,\n  visitsGroup: {\n    field: { value: tripId },\n  },\n  provision: { tripsDict, visitsDict, countriesDict, locationsDict },\n  urls,\n}) {\n  return (\n    <TripInfo\n      key={`t${tripId}`}\n      className={cls(classes.container, classes.header)}\n      classes={classes}\n      trip={tripsDict[tripId]}\n      visitsDict={visitsDict}\n      countriesDict={countriesDict}\n      locationsDict={locationsDict}\n      variant={null}\n      urls={urls}\n    >\n      {children}\n    </TripInfo>\n  );\n}\n","import groupByFn from 'lodash/groupBy';\nimport isFunction from 'lodash/isFunction';\nimport { PLAIN_GROUPS, PLAIN_GROUPS_CONFIG } from '../consts';\n\nexport default function groupVisitsBy(visitsList, plainGroup) {\n  const { groupFieldName, adapter } = PLAIN_GROUPS_CONFIG[plainGroup];\n  return plainGroup === PLAIN_GROUPS.JUST_VISITS\n    ? [{ field: { name: groupFieldName, value: null }, visitsList }]\n    : groupVisitsByValue(visitsList, groupFieldName, adapter);\n}\n\nfunction groupVisitsByValue(visitsList, groupFieldName, adapter) {\n  return Object.entries(groupByFn(visitsList, groupFieldName)).map(\n    ([groupFieldValue, groupVisitsList]) => ({\n      field: {\n        name: isFunction(groupFieldName) ? groupFieldName.name : groupFieldName,\n        value: adapter ? adapter(groupFieldValue) : groupFieldValue,\n      },\n      visitsList: groupVisitsList,\n    }),\n  );\n}\n","import memoizeOne from 'memoize-one';\nimport memoize from 'lodash/memoize';\n\nexport default function createCalcByYearUtils(lookupKey) {\n  const memoizedCalcOldies = memoizeOne(visitsDict =>\n    memoize(year => calcOldies(year, visitsDict)),\n  );\n\n  return {\n    calcTotal,\n    calcByYear,\n  };\n\n  function calcTotal(visitsList) {\n    return {\n      total: new Set(visitsList.map(({ [lookupKey]: entityId }) => entityId))\n        .size,\n    };\n  }\n\n  function calcByYear(visitsDict, visitsList, year) {\n    const oldies = memoizedCalcOldies(visitsDict)(year);\n\n    const freshies = visitsList.reduce(\n      (acc, { arrivalYear, [lookupKey]: entityId }) => {\n        if (arrivalYear === year) {\n          acc.add(entityId);\n        }\n        return acc;\n      },\n      new Set(),\n    );\n\n    const newbies = freshies.difference(oldies);\n    return {\n      totalAtYear: freshies.size,\n      newAtYear: newbies.size,\n      newbies,\n    };\n  }\n\n  function calcOldies(year, visitsDict) {\n    return Object.values(visitsDict).reduce(\n      (acc, { [lookupKey]: entityId, arrivalYear }) => {\n        if (arrivalYear < year) {\n          acc.add(entityId);\n        }\n        return acc;\n      },\n      new Set(),\n    );\n  }\n}\n","import differenceInCalendarDays from 'date-fns/differenceInCalendarDays';\nimport createPeriods from 'modules/utilities/dateTime/periods';\n\nexport default function calcDaysTravellingStats(\n  visitsList,\n  { visitsDict, ridesDict },\n  { considerRides },\n) {\n  const visitToPeriodMapper = considerRides\n    ? createMapperWithRides(visitsDict, ridesDict, considerRides)\n    : simpleMapper;\n  const visitsPeriods = visitsList.map(visitToPeriodMapper);\n  const detailedStats = createPeriods([...visitsPeriods])\n    .toArray()\n    .reduce(\n      (\n        acc,\n        {\n          startDate: arrivalDateTime,\n          endDate: departureDateTime,\n          stack: visitsIds,\n        },\n      ) => {\n        const stay =\n          differenceInCalendarDays(departureDateTime, arrivalDateTime) + 1;\n        if (stay > 0) {\n          acc.push({ stay, visitsIds, departureDateTime, arrivalDateTime });\n        }\n        return acc;\n      },\n      [],\n    );\n  return {\n    detailedStats,\n    totalStay: detailedStats.reduce((total, { stay }) => total + stay, 0),\n  };\n}\n\nfunction simpleMapper({ arrivalDateTime, departureDateTime }) {\n  return {\n    startDate: arrivalDateTime,\n    endDate: departureDateTime,\n  };\n}\n\nfunction createMapperWithRides(visitsDict, ridesDict, considerRides) {\n  return function mapperWithRides({\n    visitId,\n    countryId,\n    arrivalRideId,\n    arrivalDateTime,\n    departureRideId,\n    departureDateTime,\n  }) {\n    let startDate;\n    const arrivalRide = ridesDict[arrivalRideId];\n    if (!arrivalRide) {\n      startDate = arrivalDateTime;\n    } else {\n      const {\n        departureVisitId: prevVisitId,\n        departureDateTime: rideStartDate,\n      } = arrivalRide;\n      if (\n        considerRides !== 'country' ||\n        (countryId && countryId === visitsDict[prevVisitId]?.countryId)\n      ) {\n        startDate = rideStartDate;\n      }\n    }\n\n    let endDate;\n    const departureRide = ridesDict[departureRideId];\n    if (!departureRide) {\n      endDate = departureDateTime;\n    } else {\n      const {\n        arrivalVisitId: nextVisitId,\n        arrivalDateTime: rideEndDate,\n      } = departureRide;\n      if (\n        considerRides !== 'country' ||\n        (countryId && countryId === visitsDict[nextVisitId]?.countryId)\n      ) {\n        endDate = rideEndDate;\n      }\n    }\n    return { startDate, endDate, stack: new Set([visitId]) };\n  };\n}\n","import minBy from 'lodash/minBy';\nimport maxBy from 'lodash/maxBy';\nimport { PLAIN_GROUPS } from '../../arrangement/groupping/consts';\nimport { findClosestGroupValue } from '../../arrangement/groupping/utils/resolveGroupingUtils';\nimport createCalcByYearUtils from './createCalcByYearUtils';\nimport calcDaysTravellingStats from './calcDaysTravellingStats';\n\nexport default function calcStats(visitsGroup, provision) {\n  const locationId = findClosestGroupValue(visitsGroup, PLAIN_GROUPS.LOCATIONS);\n  const countryId = findClosestGroupValue(visitsGroup, PLAIN_GROUPS.COUNTRIES);\n  const year = findClosestGroupValue(visitsGroup, PLAIN_GROUPS.YEARS);\n  const { plainGroup, visitsList } = visitsGroup;\n\n  return {\n    visitsStats: calcVisitsStats(visitsList, provision),\n    countriesStats: countryId\n      ? null\n      : calcCountriesStats(visitsList, provision, { year }),\n    locationsStats: locationId\n      ? null\n      : calcLocationsStats(visitsList, provision, { year }),\n    daysTravellingStats: calcDaysTravellingStats(visitsList, provision, {\n      // Consider rides time, when count travelling days in groups, like country\n      // or year. So when you move across country, you still in trip,\n      // even if you sleep in train.\n      considerRides: [PLAIN_GROUPS.COUNTRIES, PLAIN_GROUPS.YEARS].includes(\n        plainGroup,\n      )\n        ? plainGroup\n        : false,\n    }),\n  };\n}\n\nconst {\n  calcTotal: calcCountriesTotal,\n  calcByYear: calcCountriesByYear,\n} = createCalcByYearUtils('countryId');\n\nfunction calcCountriesStats(visitsList, { visitsDict }, { year }) {\n  const { newAtYear, totalAtYear, total, newbies } = year\n    ? calcCountriesByYear(visitsDict, visitsList, year)\n    : calcCountriesTotal(visitsList);\n  return { year, newAtYear, totalAtYear, total, newbies };\n}\n\nconst {\n  calcTotal: calcLocationsTotal,\n  calcByYear: calcLocationsByYear,\n} = createCalcByYearUtils('locationId');\n\nfunction calcVisitsStats(visitsList) {\n  return {\n    visitsCount: visitsList.length,\n    firstVisit: minBy(visitsList, 'arrivalDateTime'),\n    lastVisit: maxBy(visitsList, 'departureDateTime'),\n  };\n}\n\nfunction calcLocationsStats(visitsList, { visitsDict }, { year }) {\n  const { newAtYear, totalAtYear, total, newbies } = year\n    ? calcLocationsByYear(visitsDict, visitsList, year)\n    : calcLocationsTotal(visitsList);\n  return {\n    year,\n    newAtYear,\n    totalAtYear,\n    total,\n    newbies,\n  };\n}\n","import React from 'react';\nimport cls from 'classnames';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles({\n  statsIndicator: {\n    display: 'inline-flex',\n    alignItems: 'center',\n    marginRLeft: '2px',\n    marginRight: '4px',\n  },\n});\n\nexport default function StatsIndicator({ className, icon, children, hint }) {\n  const classes = useStyles();\n\n  const contentNode = (\n    <Typography\n      variant=\"subtitle1\"\n      className={cls(className, classes.statsIndicator)}\n    >\n      {React.cloneElement(icon, { fontSize: 'inherit' })}\n      {children}\n    </Typography>\n  );\n\n  if (!hint) {\n    return contentNode;\n  }\n  return <Tooltip title={hint}>{contentNode}</Tooltip>;\n}\n","import React from 'react';\nimport FlagIcon from '@material-ui/icons/Flag';\nimport StatsIndicator from '../StatsIndicator';\n\nexport default function CountriesStats({\n  countriesStats: { year, newAtYear, totalAtYear, total },\n}) {\n  const showByYear = Boolean(year);\n  const hintNode = renderHint({\n    showByYear,\n    year,\n    newAtYear,\n    totalAtYear,\n    total,\n  });\n\n  const detailsNode = renderDetails({\n    showByYear,\n    newAtYear,\n    totalAtYear,\n    total,\n  });\n\n  return (\n    <StatsIndicator hint={hintNode} icon={<FlagIcon />}>\n      {detailsNode}\n    </StatsIndicator>\n  );\n}\n\nexport function renderDetails({ showByYear, newAtYear, totalAtYear, total }) {\n  if (!showByYear) {\n    return String(total);\n  }\n  if (!newAtYear) {\n    return String(totalAtYear);\n  }\n  if (totalAtYear === newAtYear) {\n    return `+${newAtYear}`;\n  }\n  return `${totalAtYear} (+${newAtYear})`;\n}\n\nfunction renderHint({ showByYear, year, newAtYear, totalAtYear, total }) {\n  if (!showByYear) {\n    return <div>{`Посещено ${total} стран`}</div>;\n  }\n  return (\n    <div>\n      <div>{`За ${year} год посещено ${totalAtYear} стран`}</div>\n      <div>\n        {newAtYear\n          ? `Из них впервые ${newAtYear} стран`\n          : 'Новых стран в этом году не было'}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport PlaceIcon from '@material-ui/icons/Place';\nimport { renderDetails } from '../CountriesStats';\nimport StatsIndicator from '../StatsIndicator';\n\nexport default function LocationStats({\n  locationsStats: { year, newAtYear, totalAtYear, total },\n}) {\n  const showByYear = Boolean(year);\n  const hintNode = renderHint({\n    showByYear,\n    year,\n    newAtYear,\n    totalAtYear,\n    total,\n  });\n\n  const detailsNode = renderDetails({\n    showByYear,\n    newAtYear,\n    totalAtYear,\n    total,\n  });\n\n  return (\n    <StatsIndicator hint={hintNode} icon={<PlaceIcon />}>\n      {detailsNode}\n    </StatsIndicator>\n  );\n}\n\nfunction renderHint({ showByYear, year, newAtYear, totalAtYear, total }) {\n  if (!showByYear) {\n    return <div>{`Посещено ${total} мест`}</div>;\n  }\n  return (\n    <div>\n      <div>{`За ${year} год посещено ${totalAtYear} мест`}</div>\n      <div>\n        {newAtYear\n          ? `Из них впервые ${newAtYear} мест`\n          : 'Новых мест в этом году не было'}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport TimelapseIcon from '@material-ui/icons/Timelapse';\nimport { visitDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\nimport StatsIndicator from '../StatsIndicator';\n\nexport default function DaysTravellingStats({\n  className,\n  daysTravellingStats: { detailedStats, totalStay },\n  provision: { visitsDict },\n}) {\n  if (!totalStay) {\n    return null;\n  }\n\n  return (\n    <StatsIndicator\n      className={className}\n      hint={renderHint(detailedStats, totalStay, visitsDict)}\n      icon={<TimelapseIcon />}\n    >\n      {totalStay}\n    </StatsIndicator>\n  );\n}\n\nfunction renderHint(detailedStats, totalStay, visitsDict) {\n  const totalStr = `Всего ${totalStay} дней в этом месте`;\n\n  if (detailedStats.length === 1) {\n    const { visitsIds, departureDateTime, arrivalDateTime } = detailedStats[0];\n    const periodStr = visitDateTimePeriodToString({\n      departureDateTime,\n      arrivalDateTime,\n    });\n    const locationsStr = renderLocations(visitsIds, visitsDict);\n    return <div>{`${totalStr} ${periodStr}. ${locationsStr}`}</div>;\n  }\n\n  return (\n    <div>\n      <div>{totalStr}</div>\n      {detailedStats.map(\n        ({ stay, visitsIds, departureDateTime, arrivalDateTime }, index) => {\n          const periodStr = visitDateTimePeriodToString({\n            departureDateTime,\n            arrivalDateTime,\n          });\n          const locationsStr = renderLocations(visitsIds, visitsDict);\n          // No good alternative 4 array index key\n          /* eslint-disable react/no-array-index-key */\n          return (\n            <div\n              key={`v${index}`}\n            >{`${stay} дней, ${periodStr}. ${locationsStr}`}</div>\n          );\n          /* eslint-enable react/no-array-index-key */\n        },\n      )}\n    </div>\n  );\n}\n\nfunction renderLocations(visitsIds, visitsDict) {\n  return (\n    visitsIds\n      ?.map(visitId => visitsDict[visitId]?.locationName ?? '')\n      ?.join(', ') ?? ''\n  );\n}\n","import React from 'react';\nimport cls from 'classnames';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport FiberNewIcon from '@material-ui/icons/FiberNew';\nimport { findClosestGroupValue } from '../../../arrangement/groupping/utils/resolveGroupingUtils';\nimport { PLAIN_GROUPS } from '../../../arrangement/groupping/consts';\nimport CountriesStats from './components/CountriesStats';\nimport LocationStats from './components/LocationStats';\nimport DaysTravellingStats from './components/DaysTravellingStats';\nimport isNewbie from './utils/isNewbie';\n\nconst useStyles = makeStyles({\n  container: {\n    color: 'gray',\n    display: 'inline-flex',\n    alignItems: 'center',\n    marginLeft: '4px',\n  },\n});\n\nexport default function StatsPanel({\n  provision,\n  visitsGroup,\n  visitsGroup: {\n    stats: { countriesStats, locationsStats, daysTravellingStats },\n  },\n  config: {\n    StatsPanel: {\n      appearance: {\n        CountriesStats: countriesStatsAppearance = true,\n        LocationsStats: locationStatsAppearance = true,\n        DaysTravellingStats: daysTravellingStatsAppearance = true,\n      } = {},\n    } = {},\n  },\n  isObscure,\n}) {\n  const classes = useStyles();\n\n  const isLocationGroup = visitsGroup.plainGroup === PLAIN_GROUPS.LOCATIONS;\n  const hasCountryGroup = Boolean(\n    findClosestGroupValue(visitsGroup, PLAIN_GROUPS.COUNTRIES),\n  );\n  const hasLocationGroup = Boolean(\n    findClosestGroupValue(visitsGroup, PLAIN_GROUPS.LOCATIONS),\n  );\n  const hasYearGroup = Boolean(\n    findClosestGroupValue(visitsGroup, PLAIN_GROUPS.YEARS),\n  );\n\n  const daysTravellingStatsNode =\n    daysTravellingStatsAppearance && daysTravellingStats && !isObscure ? (\n      <DaysTravellingStats\n        className={cls({\n          [classes.visibleOnlyOnHover]: isLocationGroup,\n        })}\n        daysTravellingStats={daysTravellingStats}\n        provision={provision}\n      />\n    ) : null;\n\n  return (\n    <Typography variant=\"body1\" className={classes.container}>\n      {hasYearGroup && isNewbie(visitsGroup) && <FiberNewIcon />}\n      {countriesStatsAppearance &&\n        !hasCountryGroup && <CountriesStats countriesStats={countriesStats} />}\n      {locationStatsAppearance &&\n        !hasLocationGroup && <LocationStats locationsStats={locationsStats} />}\n      {daysTravellingStatsNode}\n    </Typography>\n  );\n}\n\nStatsPanel.defaultProps = {\n  config: {},\n};\n","import { PLAIN_GROUPS } from '../../../../arrangement/groupping/consts';\nimport { findClosestGroupValue } from '../../../../arrangement/groupping/utils/resolveGroupingUtils';\n\nexport default function isNewbie(visitsGroup) {\n  const {\n    plainGroup,\n    field: { value: entityId },\n  } = visitsGroup;\n\n  switch (plainGroup) {\n    case PLAIN_GROUPS.COUNTRIES:\n      return isNewbieCountry(visitsGroup, entityId);\n    case PLAIN_GROUPS.LOCATIONS:\n      return isNewbieLocation(visitsGroup, entityId);\n    default:\n      return false;\n  }\n}\n\nfunction isNewbieCountry(visitsGroup, countryId) {\n  return findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.YEARS,\n  )?.stats?.countriesStats?.newbies?.has(countryId);\n}\n\nfunction isNewbieLocation(visitsGroup, locationId) {\n  const yearVisitsGroup = findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.YEARS,\n  );\n  const countriesVisitsGroup = findClosestGroupValue(\n    visitsGroup,\n    PLAIN_GROUPS.COUNTRIES,\n  );\n\n  const countryLocationStats = countriesVisitsGroup?.stats?.locationsStats;\n  const allLocationsIsNew =\n    !countryLocationStats ||\n    !countryLocationStats.newAtYear ||\n    !countryLocationStats.totalAtYear ||\n    countryLocationStats.newAtYear === countryLocationStats.totalAtYear;\n\n  return (\n    !allLocationsIsNew &&\n    yearVisitsGroup?.stats?.locationsStats?.newbies?.has(locationId)\n  );\n}\n","export const PLAIN_SORTING = {\n  ALPHABET: 'ALPHABET',\n  RATING: 'RATING',\n  FIRST_VISIT: 'FIRST_VISIT',\n  LAST_VISIT: 'LAST_VISIT',\n  VISITS_COUNT: 'VISITS_COUNT',\n};\n","import sortBy from 'lodash/sortBy';\nimport orderBy from 'lodash/orderBy';\nimport iterateeFn from 'lodash/iteratee';\nimport property from 'lodash/property';\nimport { PLAIN_GROUPS } from '../../groupping/consts';\nimport { PLAIN_SORTING } from '../consts';\n\nexport default function sortVisitsBy(\n  visitsGroups,\n  sortingOrder,\n  plainGroup,\n  provision,\n) {\n  const comparators = sortingOrder.flatMap(switchComparator);\n  const hasOrder = comparators.some(property('order'));\n\n  return hasOrder\n    ? orderBy(visitsGroups, ...withOrder(comparators))\n    : sortBy(visitsGroups, comparators);\n\n  function switchComparator(plainSorting) {\n    switch (plainSorting) {\n      case PLAIN_SORTING.FIRST_VISIT:\n        return dates('stats.visitsStats.firstVisit.arrivalDateTime');\n      case PLAIN_SORTING.LAST_VISIT:\n        return {\n          iteratee: nullsLast(\n            dates('stats.visitsStats.lastVisit.departureDateTime'),\n          ),\n          order: 'desc',\n        };\n      case PLAIN_SORTING.RATING:\n        return createRatingComparator(plainGroup, provision);\n      case PLAIN_SORTING.VISITS_COUNT:\n        return {\n          iteratee: 'stats.locationsStats.total',\n          order: 'desc',\n        };\n      case PLAIN_SORTING.ALPHABET:\n      default:\n        return createAlphabetComparator(plainGroup, provision);\n    }\n  }\n}\n\nfunction withOrder(comparators) {\n  return Object.values(\n    comparators.reduce(\n      (acc, current) => {\n        const { iteratee = [], order = 'asc' } = current.order\n          ? current\n          : { iteratee: current };\n        acc.iteratee.push(iteratee);\n        acc.order.push(order);\n        return acc;\n      },\n      {\n        iteratee: [],\n        order: [],\n      },\n    ),\n  );\n}\n\nfunction createRatingComparator(plainGroup, provision) {\n  switch (plainGroup) {\n    // case PLAIN_GROUPS.COUNTRIES:\n    //   return createCountryRatingComparator(provision);\n    case PLAIN_GROUPS.LOCATIONS:\n      return createLocationRatingComparator(provision);\n    default:\n      return () => 0;\n  }\n}\n\nfunction createAlphabetComparator(plainGroup, provision) {\n  switch (plainGroup) {\n    case PLAIN_GROUPS.YEARS:\n      return [\n        {\n          iteratee: nullsLast('stats.visitsStats.firstVisit.arrivalYear'),\n          order: 'desc',\n        },\n      ];\n    case PLAIN_GROUPS.COUNTRIES:\n      return createCountryNameComparator(provision);\n    case PLAIN_GROUPS.LOCATIONS:\n      return createLocationNameComparator(provision);\n    default:\n      return () => 0;\n  }\n}\n\nfunction createCountryNameComparator({ countriesDict }) {\n  return ({ field: { value: countryId } }) => {\n    const { countryName } = countriesDict[countryId] ?? {};\n    return countryName;\n  };\n}\n\nfunction createLocationNameComparator({ locationsDict }) {\n  return ({ field: { value: locationId } }) => {\n    const { locationName } = locationsDict[locationId] ?? {};\n    return locationName;\n  };\n}\n\nconst DEFAULT_RATING = 10;\nfunction createLocationRatingComparator({ locationsRating }) {\n  return ({ field: { value: locationId } }) =>\n    locationsRating[locationId] ?? DEFAULT_RATING;\n}\n\nfunction nullsLast(iteratee) {\n  const resolve = iterateeFn(iteratee);\n  return value => resolve(value) || '';\n}\n\nfunction dates(iteratee) {\n  const resolve = iterateeFn(iteratee);\n  return value => (resolve(value) || '').valueOf();\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\n\nexport default function ExpandableActions({\n  className,\n  onExpand,\n  onExpandAll,\n  diffCount,\n}) {\n  return (\n    <Typography className={className} variant=\"body2\">\n      <MUILink onClick={onExpand}>{`показать еще ${diffCount}`}</MUILink>\n      {Boolean(onExpandAll) && (\n        <>\n          {', '}\n          <MUILink onClick={onExpandAll}>раскрыть все</MUILink>\n        </>\n      )}\n    </Typography>\n  );\n}\n","import React, { useState } from 'react';\nimport ExpandableActions from './components/ExpandableActions';\n\nconst DEFAULT_ALWAYS_EXPANDED_ITEMS_COUNT = 10;\nconst DEFAULT_COLLAPSIBLE_THRESHOLD = 2;\n\nexport default function Expandable({\n  classes,\n  collapsible,\n  children,\n  items: originalItems,\n  onExpand,\n  onExpandAll,\n  alwaysExpandedItemsCount,\n  collapsibleThreshold,\n}) {\n  const [collapsed, setCollapsed] = useState(true);\n\n  const actualCollapsible =\n    collapsible &&\n    originalItems.length > alwaysExpandedItemsCount + collapsibleThreshold;\n\n  const actualCollapsed = actualCollapsible && collapsed;\n\n  const actualItems = actualCollapsed\n    ? originalItems.slice(0, alwaysExpandedItemsCount)\n    : originalItems;\n\n  return (\n    <>\n      {children({ items: actualItems })}\n      {actualCollapsed && (\n        <ExpandableActions\n          className={classes.actions}\n          diffCount={originalItems.length - actualItems.length}\n          onExpand={event => {\n            if (onExpand) {\n              onExpand(event);\n            }\n            setCollapsed(false);\n          }}\n          onExpandAll={onExpandAll}\n        />\n      )}\n    </>\n  );\n}\n\nExpandable.defaultProps = {\n  alwaysExpandedItemsCount: DEFAULT_ALWAYS_EXPANDED_ITEMS_COUNT,\n  collapsibleThreshold: DEFAULT_COLLAPSIBLE_THRESHOLD,\n};\n","import React, { useLayoutEffect, useEffect } from 'react';\n\nexport default function useWindowRect() {\n  const [rect, dispatch] = React.useReducer(rectReducer, {});\n  useLayoutEffect(() => {\n    dispatch({\n      rect: {\n        height: window.innerHeight,\n        width: window.innerWidth,\n      },\n    });\n  }, []);\n\n  useEffect(() => {\n    const resizeHandler = () => {\n      dispatch({\n        rect: {\n          height: window.innerHeight,\n          width: window.innerWidth,\n        },\n      });\n    };\n    resizeHandler();\n    window.addEventListener('resize', resizeHandler);\n    return () => {\n      window.removeEventListener('resize', resizeHandler);\n    };\n  }, []);\n\n  return rect;\n}\n\nfunction rectReducer(state, action) {\n  const { rect } = action;\n  if (!state || state.height !== rect.height || state.width !== rect.width) {\n    return rect;\n  }\n  return state;\n}\n","const findNearestBinarySearch = (low, high, getCurrentValue, value) => {\n  while (low <= high) {\n    let middle = ((low + high) / 2) | 0;\n    let currentValue = getCurrentValue(middle);\n\n    if (currentValue < value) {\n      low = middle + 1;\n    } else if (currentValue > value) {\n      high = middle - 1;\n    } else {\n      return middle;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nexport default function calculateRange({ measurements, outerSize, scrollOffset }, prevRange) {\n  const size = measurements.length - 1;\n  const getOffset = index => measurements[index].start;\n\n  let start = findNearestBinarySearch(0, size, getOffset, scrollOffset);\n  let end = start;\n\n  while (end < size && measurements[end].end < scrollOffset + outerSize) {\n    end++;\n  }\n\n  if (prevRange.start !== start || prevRange.end !== end) {\n    return { start, end };\n  }\n\n  return prevRange;\n}","import React, { useLayoutEffect } from 'react';\nimport useRect from './useRect';\nimport useRange from './useRange';\n\nconst defaultEstimateSize = () => 50;\n\nconst defaultKeyExtractor = index => index;\n\nexport const defaultRangeExtractor = range => {\n  const start = Math.max(range.start - range.overscan, 0);\n  const end = Math.min(range.end + range.overscan, range.size - 1);\n\n  const arr = [];\n\n  for (let i = start; i <= end; i++) {\n    arr.push(i);\n  }\n\n  return arr;\n};\n\nexport function useVirtual({\n  size = 0,\n  estimateSize = defaultEstimateSize,\n  overscan = 1,\n  paddingStart = 0,\n  paddingEnd = 0,\n  parentRef,\n  keyExtractor = defaultKeyExtractor,\n}) {\n  const { height: outerSize } = useRect();\n  const latestRef = React.useRef({\n    scrollOffset: 0,\n    measurements: [],\n    outerSize: undefined,\n    totalSize: undefined,\n  });\n\n  latestRef.current.outerSize = outerSize;\n\n  const [measuredCache, setMeasuredCache] = React.useState({});\n  const [updDep, forceUpdate] = React.useReducer(x => x + 1, 0);\n\n  const measure = forceUpdate;\n\n  const pendingMeasuredCacheIndexesRef = React.useRef([]);\n\n  const measurements = React.useMemo(\n    () => {\n      const min =\n        pendingMeasuredCacheIndexesRef.current.length > 0\n          ? Math.min(...pendingMeasuredCacheIndexesRef.current)\n          : 0;\n      pendingMeasuredCacheIndexesRef.current = [];\n\n      const measurements = latestRef.current.measurements.slice(0, min);\n\n      for (let i = min; i < size; i++) {\n        const key = keyExtractor(i);\n        const measuredSize = measuredCache[key];\n        const start = measurements[i - 1]\n          ? measurements[i - 1].end\n          : paddingStart;\n        const size =\n          typeof measuredSize === 'number' ? measuredSize : estimateSize(i);\n        const end = start + size;\n        measurements[i] = { index: i, start, size, end, key };\n      }\n      return measurements;\n    },\n    [estimateSize, measuredCache, paddingStart, size, keyExtractor],\n  );\n\n  const totalSize = (measurements[size - 1]?.end || 0) + paddingEnd;\n\n  latestRef.current.measurements = measurements;\n  latestRef.current.totalSize = totalSize;\n\n  const range = useRange({\n    measurements,\n    outerSize,\n    latestRef,\n    parentRef,\n  });\n\n  const virtualItems = React.useMemo(\n    () => {\n      const indexes = defaultRangeExtractor({\n        start: range.start,\n        end: range.end,\n        overscan,\n        size: measurements.length,\n      });\n\n      const virtualItems = [];\n\n      for (let k = 0, len = indexes.length; k < len; k++) {\n        const i = indexes[k];\n        const measurement = measurements[i];\n\n        const item = {\n          ...measurement,\n          measureRef: el => {\n            if (el) {\n              const measuredSize = el.offsetHeight;\n\n              if (measuredSize !== item.size) {\n                const { scrollOffset } = latestRef.current;\n\n                if (item.start < scrollOffset) {\n                  defaultScrollToFn(scrollOffset + (measuredSize - item.size));\n                }\n\n                pendingMeasuredCacheIndexesRef.current.push(i);\n\n                setMeasuredCache(old => ({\n                  ...old,\n                  [item.key]: measuredSize,\n                }));\n              }\n            }\n          },\n        };\n\n        virtualItems.push(item);\n      }\n\n      return virtualItems;\n    },\n    [measurements, overscan, range.end, range.start, updDep],\n  );\n\n  const mountedRef = React.useRef();\n\n  useLayoutEffect(\n    () => {\n      if (mountedRef.current) {\n        if (estimateSize) setMeasuredCache({});\n      }\n      mountedRef.current = true;\n    },\n    [estimateSize],\n  );\n\n  const scrollToOffset = React.useCallback(\n    (toOffset, { align = 'start' } = {}) => {\n      const { scrollOffset, outerSize } = latestRef.current;\n\n      if (align === 'auto') {\n        if (toOffset <= scrollOffset) {\n          align = 'start';\n        } else if (toOffset >= scrollOffset + outerSize) {\n          align = 'end';\n        } else {\n          align = 'start';\n        }\n      }\n\n      if (align === 'start') {\n        defaultScrollToFn(toOffset);\n      } else if (align === 'end') {\n        defaultScrollToFn(toOffset - outerSize);\n      } else if (align === 'center') {\n        defaultScrollToFn(toOffset - outerSize / 2);\n      }\n    },\n    [],\n  );\n\n  const tryScrollToIndex = React.useCallback(\n    (index, { align = 'auto', ...rest } = {}) => {\n      const { measurements, scrollOffset, outerSize } = latestRef.current;\n\n      const measurement = measurements[Math.max(0, Math.min(index, size - 1))];\n\n      if (!measurement) {\n        return;\n      }\n\n      if (align === 'auto') {\n        if (measurement.end >= scrollOffset + outerSize) {\n          align = 'end';\n        } else if (measurement.start <= scrollOffset) {\n          align = 'start';\n        } else {\n          return;\n        }\n      }\n\n      const toOffset =\n        align === 'center'\n          ? measurement.start + measurement.size / 2\n          : align === 'end'\n            ? measurement.end\n            : measurement.start;\n\n      scrollToOffset(toOffset, { align, ...rest });\n    },\n    [scrollToOffset, size],\n  );\n\n  const scrollToIndex = React.useCallback(\n    (...args) => {\n      // We do a double request here because of\n      // dynamic sizes which can cause offset shift\n      // and end up in the wrong spot. Unfortunately,\n      // we can't know about those dynamic sizes until\n      // we try and render them. So double down!\n      tryScrollToIndex(...args);\n      requestAnimationFrame(() => {\n        tryScrollToIndex(...args);\n      });\n    },\n    [tryScrollToIndex],\n  );\n\n  return {\n    virtualItems,\n    totalSize,\n    scrollToOffset,\n    scrollToIndex,\n    measure,\n  };\n}\n\nfunction defaultScrollToFn(offset) {\n  window.scrollY = offset;\n}\n","import React, { useLayoutEffect } from 'react';\nimport calculateRange from 'modules/utilities/virtual/calculateRange';\n\nexport default function useRange({\n  measurements,\n  outerSize,\n  latestRef,\n  parentRef,\n}) {\n  const [range, setRange] = React.useState({ start: 0, end: 0 });\n\n  const rangeTimeoutIdRef = React.useRef(null);\n\n  const cancelAsyncRange = React.useCallback(() => {\n    if (rangeTimeoutIdRef.current !== null) {\n      clearTimeout(rangeTimeoutIdRef.current);\n      rangeTimeoutIdRef.current = null;\n    }\n  }, []);\n\n  useLayoutEffect(\n    () => {\n      rangeTimeoutIdRef.current = setTimeout(() => {\n        setRange(prevRange => calculateRange(latestRef.current, prevRange));\n      });\n      return () => cancelAsyncRange();\n    },\n    [measurements, outerSize, cancelAsyncRange],\n  );\n\n  useLayoutEffect(\n    () => {\n      const onScroll = () => {\n        latestRef.current.scrollOffset = parentRef.current\n          ? scrollOffsetFn(parentRef)\n          : 0;\n        cancelAsyncRange();\n        setRange(prevRange => calculateRange(latestRef.current, prevRange));\n      };\n\n      // Determine initially visible range\n      onScroll();\n\n      window.addEventListener('scroll', onScroll, {\n        capture: false,\n        passive: true,\n      });\n\n      return () => {\n        window.removeEventListener('scroll', onScroll);\n      };\n    },\n    [cancelAsyncRange],\n  );\n\n  return range;\n}\n\nfunction scrollOffsetFn(parentRef) {\n  const bounds = parentRef.current.getBoundingClientRect();\n  return bounds.top * -1;\n}\n","import React, { useRef, forwardRef, useImperativeHandle } from 'react';\nimport { useVirtual } from 'modules/utilities/virtual';\n\nexport default forwardRef(function Virtualized(\n  { children, items: originalItems, overscan },\n  ref,\n) {\n  const parentRef = useRef();\n\n  const { virtualItems, totalSize, measure } = useVirtual({\n    parentRef,\n    size: originalItems.length,\n    estimateSize,\n    overscan,\n  });\n\n  useImperativeHandle(ref, () => ({\n    measure,\n  }));\n\n  return (\n    <div ref={parentRef} style={{ height: totalSize }}>\n      <div style={{ height: totalSize, position: 'relative' }}>\n        {virtualItems.map(virtualItem => (\n          <div\n            key={virtualItem.index}\n            ref={virtualItem.measureRef}\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              transform: `translateY(${virtualItem.start}px)`,\n            }}\n          >\n            {children({\n              item: originalItems[virtualItem.index],\n              virtualItem,\n              index: virtualItem.index,\n              measure,\n            })}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n});\n\nfunction estimateSize() {\n  return 500;\n}\n","import React, { forwardRef, useImperativeHandle } from 'react';\n\nexport default forwardRef(function BypassVirtualized({ children, items }, ref) {\n  useImperativeHandle(ref, () => ({\n    measure: noop,\n  }));\n\n  return (\n    <>\n      {items.map((item, index) =>\n        children({\n          item,\n          virtualItem: null,\n          index,\n          measure: noop,\n        }),\n      )}\n    </>\n  );\n});\n\nfunction noop() {\n  return null;\n}\n","import React, { forwardRef } from 'react';\nimport Virtualized from './components/Virtualized';\nimport BypassVirtualized from './components/BypassVirtualized';\n\nexport default forwardRef(function Virtualizer(\n  { children, items, bypass, ...forwardingProps },\n  ref,\n) {\n  const Component = bypass ? BypassVirtualized : Virtualized;\n  return (\n    <Component ref={ref} items={items} {...forwardingProps}>\n      {children}\n    </Component>\n  );\n});\n","import React, { useState, useCallback } from 'react';\nimport LazyLoad from 'react-lazy-load';\n\nexport default function LazyWithPlaceholder({\n  placeholder,\n  children,\n  ...forwardingProps\n}) {\n  const [loaded, setLoaded] = useState(false);\n  const handleVisible = useCallback(() => setLoaded(true), []);\n\n  return (\n    <>\n      {!loaded && placeholder}\n      <LazyLoad {...forwardingProps} onContentVisible={handleVisible}>\n        {children}\n      </LazyLoad>\n    </>\n  );\n}\n","import React, { useState, useCallback, useEffect, useRef } from 'react';\nimport cls from 'classnames';\nimport { ensuredForwardRef } from 'react-use';\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\nimport ZoomOutIcon from '@material-ui/icons/ZoomOut';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst CENTER = 50;\n\nconst useStyles = makeStyles({\n  container: {\n    position: 'relative',\n  },\n  zoom: {\n    backgroundPosition: `${CENTER}% ${CENTER}%`,\n    backgroundRepeat: 'no-repeat',\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    margin: 0,\n    padding: 0,\n    opacity: 0,\n    transition: 'opacity 0.5s',\n    // https://stackoverflow.com/questions/2975217/how-to-fix-flicker-when-using-webkit-transforms-transitions\n    transform: 'translateZ(0)',\n  },\n  zoomButton: {\n    position: 'absolute',\n    bottom: '0',\n    right: 'initial',\n    left: '50%',\n    transform: 'translate(-50%)',\n    zIndex: 4,\n  },\n  zoomIcon: {\n    transform: 'scale(1.2)',\n  },\n  zoomed: {\n    // should be more specific than $zoom class, so placed later\n    opacity: 1,\n  },\n});\n\nexport default ensuredForwardRef(function ZoomableImage(\n  { alt, src, onSwipeLock, ...forwardingProps },\n  ref,\n) {\n  const touchscreen = window.matchMedia('(any-pointer: coarse)').matches;\n  const [zoomable, setZoomable] = useState(true);\n  const [zoomed, setZoomed] = useState(false);\n\n  const classes = useStyles();\n  const [backgroundPosition, setBackgroundPosition] = useState(\n    `${CENTER}% ${CENTER}%`,\n  );\n\n  const containerRef = useRef();\n\n  useEffect(\n    () => {\n      if (!touchscreen) {\n        return undefined;\n      }\n      onSwipeLock(zoomed);\n      return () => onSwipeLock(false);\n    },\n    [touchscreen, zoomed],\n  );\n\n  const handleAnyZoom = useCallback(event => {\n    const { nativeEvent } = event;\n    const {\n      top: containerTop,\n      left: containerLeft,\n      width: originalWidth,\n      height: originalHeight,\n    } = ref.current.getBoundingClientRect();\n\n    const offsetX =\n      (nativeEvent.clientX ?? nativeEvent.touches[0]?.clientX) - containerLeft;\n    const offsetY =\n      (nativeEvent.clientY ?? nativeEvent.touches[0]?.clientY) - containerTop;\n\n    if (!offsetX || !offsetY) {\n      return;\n    }\n\n    const extendable =\n      originalWidth < ref.current.naturalWidth ||\n      originalHeight < ref.current.naturalHeight;\n\n    const notEnoughWidth =\n      containerRef.current.getBoundingClientRect().width <\n      ref.current.naturalWidth;\n\n    if (!extendable) {\n      setZoomable(false);\n      return;\n    }\n\n    const x =\n      extendable && notEnoughWidth\n        ? asPercent((offsetX / originalWidth) * 100)\n        : CENTER;\n    const y = extendable ? asPercent((offsetY / originalHeight) * 100) : CENTER;\n\n    setBackgroundPosition(`${x}% ${y}%`);\n  }, []);\n\n  const ZoomIcon = zoomed ? ZoomOutIcon : ZoomInIcon;\n\n  const imgNode = <img ref={ref} alt={alt} src={src} {...forwardingProps} />;\n  if (!zoomable) {\n    return imgNode;\n  }\n\n  return (\n    <div className={classes.container} ref={containerRef}>\n      {imgNode}\n      {/* click handler in only for convenience */}\n      {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-noninteractive-element-interactions */}\n      <figure\n        className={cls(classes.zoom, {\n          [classes.zoomed]: zoomed,\n        })}\n        style={{ backgroundPosition, backgroundImage: `url(${src})` }}\n        onMouseMove={zoomed && !touchscreen ? handleAnyZoom : undefined}\n        onTouchMove={zoomed && touchscreen ? handleAnyZoom : undefined}\n        onClick={() => setZoomed(false)}\n      />\n      <button\n        type=\"button\"\n        className={cls(\n          'image-gallery-icon',\n          'image-gallery-fullscreen-button',\n          classes.zoomButton,\n        )}\n        onClick={() => setZoomed(prevZoomed => !prevZoomed)}\n      >\n        <ZoomIcon className={cls('image-gallery-svg', classes.zoomIcon)} />\n      </button>\n    </div>\n  );\n});\n\nfunction asPercent(value) {\n  return Math.min(Math.max(value, 0), 100) || CENTER;\n}\n","import React from 'react';\nimport warning from 'warning';\n\nexport default class ErrorBoundary extends React.Component {\n  static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    warning(\n      false,\n      `blurhash error: ${\n        error.message\n      }. Check window.lastReactError for details`,\n    );\n    window.lastReactError = { error, errorInfo };\n  }\n\n  render() {\n    const { children } = this.props;\n    const { hasError } = this.state;\n\n    if (hasError) {\n      return null;\n    }\n\n    return children;\n  }\n}\n","import React, {\n  useCallback,\n  useEffect,\n  useState,\n  useRef,\n  useLayoutEffect,\n} from 'react';\nimport { Blurhash } from 'react-blurhash';\nimport min from 'lodash/min';\nimport BlurhashErrorBoundary from './BlurhashErrorBoundary';\n\nconst BLURHASH_RESOLUTION = 32;\nconst BLURHASH_PUNCH = 1;\nconst ERROR_IMAGE_URL =\n  'https://res.cloudinary.com/dc2eke0gj/image/upload/minetravel/common/img_placeholder.png';\nconst LOADING_STATE = {\n  IDLE: 'IDLE',\n  LOADING: 'LOADING',\n  SUCCESS: 'SUCCESS',\n  ERROR: 'ERROR',\n};\nconst LAZY_LOADING_SUPPORT = false; // 'loading' in HTMLImageElement.prototype;\nconst INITIAL_STATE = LAZY_LOADING_SUPPORT\n  ? LOADING_STATE.LOADING\n  : LOADING_STATE.IDLE;\n\nexport default function LazyImage({\n  aspectRatio,\n  className,\n  component: ImageComponent,\n  require,\n  tag,\n  src,\n  alt,\n  blurhash,\n  constraints,\n  height,\n  width,\n  onLoad,\n  children,\n  zoomable,\n  ...forwardingProps\n}) {\n  const [loadingState, setLoadingState] = useState(INITIAL_STATE);\n\n  const handleError = useCallback(() => {\n    setLoadingState(LOADING_STATE.ERROR);\n  }, []);\n\n  const imgRef = useRef();\n  const handleLoad = useCallback(() => {\n    setLoadingState(LOADING_STATE.SUCCESS);\n    if (onLoad) {\n      onLoad({\n        aspectRatio: imgRef.current.naturalWidth / imgRef.current.naturalHeight,\n      });\n    }\n  }, []);\n\n  useEffect(\n    () => {\n      if (require && loadingState === LOADING_STATE.IDLE) {\n        setLoadingState(LOADING_STATE.LOADING);\n      }\n    },\n    [require, loadingState],\n  );\n\n  const hasResult =\n    loadingState === LOADING_STATE.SUCCESS ||\n    loadingState === LOADING_STATE.ERROR;\n\n  const { imageWidth, imageHeight } = resolveImageSize(\n    {\n      height,\n      width,\n      aspectRatio,\n    },\n    constraints,\n  );\n\n  // consider all margins and paddings, reflect to { maxWidth: '100%' } img behavior\n  const [realImgWidth, setRealImgWidth] = useState(imageWidth);\n\n  useLayoutEffect(\n    () => {\n      if (imgRef.current) {\n        setRealImgWidth(imgRef.current.getBoundingClientRect().width);\n      }\n    },\n    [imageWidth],\n  );\n\n  return (\n    <>\n      {!hasResult && (\n        <BlurhashErrorBoundary>\n          <Blurhash\n            hash={blurhash}\n            width={realImgWidth}\n            height={realImgWidth / aspectRatio ?? imageHeight}\n            resolutionX={BLURHASH_RESOLUTION}\n            resolutionY={BLURHASH_RESOLUTION}\n            punch={BLURHASH_PUNCH}\n          />\n        </BlurhashErrorBoundary>\n      )}\n      {loadingState !== LOADING_STATE.ERROR ? (\n        <ImageComponent\n          key=\"ok\"\n          data-tag={tag}\n          ref={imgRef}\n          className={className}\n          alt={alt}\n          src={resolveActualSrc(src, loadingState)}\n          style={{\n            width: imageWidth,\n            height: hasResult ? imageHeight : 0,\n            maxWidth: '100%',\n          }}\n          onLoad={handleLoad}\n          onError={handleError}\n          loading={LAZY_LOADING_SUPPORT ? 'lazy' : undefined}\n          {...forwardingProps}\n        />\n      ) : (\n        <img\n          key=\"error\"\n          alt=\"error\"\n          className={className}\n          src={ERROR_IMAGE_URL}\n          style={{\n            width: imageWidth,\n            height: imageHeight,\n            maxWidth: '100%',\n          }}\n        />\n      )}\n      {children}\n    </>\n  );\n}\n\nLazyImage.defaultProps = {\n  component: 'img',\n};\n\nfunction resolveActualSrc(src, loadingState) {\n  switch (loadingState) {\n    case LOADING_STATE.IDLE:\n      return null;\n    default:\n      return src;\n  }\n}\n\nfunction resolveImageSize({ aspectRatio, height, width }, constraints) {\n  if (!constraints) {\n    return {\n      imageHeight: height || width / aspectRatio,\n      imageWidth: width || height * aspectRatio,\n    };\n  }\n\n  const heightConstraint = min([constraints.height, height]);\n  const widthConstraint = min([constraints.width, width]);\n  const constraintByHeight = heightConstraint * aspectRatio < widthConstraint;\n\n  const [imageWidth, imageHeight] = constraintByHeight\n    ? [heightConstraint * aspectRatio, heightConstraint]\n    : [widthConstraint, widthConstraint / aspectRatio];\n\n  return {\n    imageHeight,\n    imageWidth,\n  };\n}\n","import React from 'react';\nimport times from 'lodash/times';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst THUMB_HEIGHT = 40;\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n  },\n  imageSkeleton: {\n    flexGrow: '1',\n  },\n  thumbsContainer: {\n    overflow: 'hidden',\n  },\n  thumbSkeleton: {\n    margin: '0 5px 10px 5px',\n  },\n});\n\nexport default function GallerySkeleton({ height }) {\n  const classes = useStyles();\n\n  const thumbsCount = Math.ceil(height / THUMB_HEIGHT);\n\n  return (\n    <div className={classes.container}>\n      <Skeleton\n        variant=\"rect\"\n        height={height}\n        className={classes.imageSkeleton}\n      />\n      <div className={classes.thumbsContainer} style={{ height }}>\n        {times(thumbsCount).map(() => (\n          <Skeleton\n            variant=\"rect\"\n            height={60}\n            width={100}\n            className={classes.thumbSkeleton}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport ScrollLock from 'react-scrolllock';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n  top: {\n    zIndex: `${theme.zIndex.drawer + 1} !important`,\n  },\n}));\n\nexport default function FullscreenFallback({\n  children,\n  fullscreen,\n  uniqKey,\n  inlineGalleryRef,\n}) {\n  const classes = useStyles();\n  const portalGalleryRef = useRef();\n\n  useEffect(() => {\n    const element = document.createElement('div');\n    element.id = `imageGalleryPortal-${uniqKey}`;\n    document.body.append(element);\n    return () => element.remove();\n  }, []);\n\n  useEffect(\n    () => {\n      if (inlineGalleryRef.current) {\n        inlineGalleryRef.current.setState({\n          isFullscreen: false,\n          modalFullscreen: false,\n        });\n      }\n      if (fullscreen) {\n        portalGalleryRef.current.setState({\n          isFullscreen: true,\n          modalFullscreen: true,\n        });\n      }\n    },\n    [fullscreen],\n  );\n\n  if (!fullscreen) {\n    return null;\n  }\n  return ReactDOM.createPortal(\n    <ScrollLock>\n      <div>\n        {React.cloneElement(children, {\n          ref: portalGalleryRef,\n          additionalClass: classes.top,\n        })}\n      </div>\n    </ScrollLock>,\n    window.document.getElementById(`imageGalleryPortal-${uniqKey}`),\n  );\n}\n","import React, { useState, useMemo, useEffect, useRef } from 'react';\nimport { v4 as uuidV4 } from 'uuid';\nimport cls from 'classnames';\nimport ImageGallery from 'react-image-gallery';\nimport { makeStyles } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport LazyWithPlaceholder from 'modules/components/LazyWithPlaceholder';\nimport { useLayoutContext } from 'modules/components/LayoutContext';\nimport ZoomableImage from './components/ZoomableImage';\nimport LazyImage from './components/LazyImage';\nimport GallerySkeleton from './components/GallerySkeleton';\nimport FullscreenFallback from './components/FullscreenFallback';\n\nconst FALLBACK_ASPECT_RATIO = 1;\nconst PREFETCH_SLIDES = 1;\nconst START_INDEX = 0;\nconst THUMB_WIDTH_WITHOUT_BORDERS_PX = 92;\nconst FULLSCREEN_ENABLED =\n  document.fullscreenEnabled ||\n  document.mozFullScreenEnabled ||\n  document.documentElement.webkitRequestFullScreen;\n\nconst useStyles = makeStyles({\n  photoContainer: {\n    minHeight: '200px',\n    margin: '24px 0',\n    '& .image-gallery-thumbnails': {\n      overflowY: 'auto',\n      '-ms-overflow-style': 'none' /* Hide scrollbar for IE, Old Edge */,\n      scrollbarWidth: 'none' /* Firefox */,\n      '&::-webkit-scrollbar': {\n        /* Hide scrollbar for Chrome, Safari and Opera */\n        display: 'none',\n      },\n    },\n  },\n  photo: {\n    display: 'block',\n    width: '100%',\n  },\n});\n\nexport default function PhotosGallery({ className, photos }) {\n  const uniqKey = useMemo(() => uuidV4(), []);\n  const classes = useStyles();\n\n  const mobile = useMediaQuery(theme => theme.breakpoints.down('sm'));\n  const touchscreen = window.matchMedia('(any-pointer: coarse)').matches;\n  const [swipeLock, setSwipeLock] = useState(false);\n\n  const { vw, vh } = useLayoutContext();\n  const [fullscreen, setFullscreen] = useState(false);\n  const [aspectRatios, setAspectRatios] = useState({});\n  const [currentIndex, setCurrentIndex] = useState(START_INDEX);\n\n  const constraints = useMemo(\n    () => resolveImageConstraints(fullscreen, { vh, vw }),\n    [fullscreen, vh, vw],\n  );\n\n  useEffect(\n    () => {\n      const thumbnailElement = window.document\n        .querySelector(\n          `[data-tag=\"photos-gallery-thumb-${uniqKey}-${currentIndex}\"]`,\n        )\n        ?.closest('.image-gallery-thumbnail');\n\n      if (thumbnailElement) {\n        thumbnailElement.scrollIntoView({\n          block: 'nearest',\n          behavior: 'smooth',\n        });\n      }\n    },\n    [currentIndex],\n  );\n\n  const actualPhotos = photos.map(\n    (\n      {\n        fullSizePhotoUrl,\n        thumbnailUrl,\n        previewUrl,\n        blurhash,\n        aspectRatio,\n        description,\n      },\n      index,\n    ) => ({\n      original: previewUrl,\n      originalClass: classes.photo,\n      thumbnail: thumbnailUrl,\n      fullscreen: fullSizePhotoUrl,\n      description,\n      blurhash,\n      aspectRatio,\n      index,\n    }),\n  );\n\n  const showThumbnails = !swipeLock && (!mobile || fullscreen);\n  const zoomable = !touchscreen || fullscreen;\n\n  const galleryRef = useRef();\n\n  if (!actualPhotos.length) {\n    return null;\n  }\n\n  const imageGalleryNode = (\n    <ImageGallery\n      ref={galleryRef}\n      useBrowserFullscreen={FULLSCREEN_ENABLED}\n      startIndex={START_INDEX}\n      disableSwipe={swipeLock}\n      showIndex={true}\n      showThumbnails={showThumbnails}\n      items={actualPhotos}\n      thumbnailPosition={showThumbnails ? 'right' : undefined}\n      onScreenChange={nextFullscreen => setFullscreen(nextFullscreen)}\n      onBeforeSlide={nextIndex => setCurrentIndex(nextIndex)}\n      disableKeyDown={true}\n      disableThumbnailScroll={true}\n      renderItem={item => {\n        const zoomableItem = zoomable && currentIndex === item.index;\n        return (\n          <LazyImage\n            className=\"image-gallery-image\"\n            src={fullscreen ? item.fullscreen : item.original}\n            component={zoomableItem ? ZoomableImage : 'img'}\n            onSwipeLock={zoomableItem ? setSwipeLock : undefined}\n            description={item.description}\n            alt={item.originalAlt}\n            title={item.originalTitle}\n            blurhash={item.blurhash}\n            require={Math.abs(currentIndex - item.index) <= PREFETCH_SLIDES}\n            constraints={constraints}\n            aspectRatio={\n              aspectRatios[item.index] ||\n              item.aspectRatio?.ratio ||\n              FALLBACK_ASPECT_RATIO\n            }\n          >\n            {item.description && (\n              <span className=\"image-gallery-description\">\n                {item.description}\n              </span>\n            )}\n          </LazyImage>\n        );\n      }}\n      renderThumbInner={item => (\n        <span className=\"image-gallery-thumbnail-inner\">\n          <LazyImage\n            tag={`photos-gallery-thumb-${uniqKey}-${item.index}`}\n            className=\"image-gallery-thumbnail-image\"\n            aspectRatio={\n              aspectRatios[item.index] ||\n              item.aspectRatio ||\n              FALLBACK_ASPECT_RATIO\n            }\n            src={item.thumbnail}\n            width={THUMB_WIDTH_WITHOUT_BORDERS_PX}\n            alt={item.thumbnailAlt}\n            title={item.thumbnailTitle}\n            blurhash={item.blurhash}\n            require={true}\n            onLoad={({ aspectRatio }) =>\n              setAspectRatios(prevRatios => ({\n                ...prevRatios,\n                [item.index]: aspectRatio,\n              }))\n            }\n          />\n        </span>\n      )}\n    />\n  );\n\n  return (\n    <div\n      className={cls(className, classes.photoContainer)}\n      style={{ height: constraints.height }}\n    >\n      <LazyWithPlaceholder\n        offset={1000}\n        placeholder={<GallerySkeleton height={constraints.height} />}\n      >\n        {imageGalleryNode}\n      </LazyWithPlaceholder>\n      {!FULLSCREEN_ENABLED && (\n        <FullscreenFallback\n          fullscreen={fullscreen}\n          uniqKey={uniqKey}\n          inlineGalleryRef={galleryRef}\n        >\n          {imageGalleryNode}\n        </FullscreenFallback>\n      )}\n    </div>\n  );\n}\n\nconst RATIOS = {\n  FULLSCREEN: {\n    HEIGHT: { PERCENT: 100, MAX_PX: Infinity },\n    WIDTH: { PERCENT: 100, MAX_PX: Infinity },\n  },\n  DEFAULT: {\n    HEIGHT: { PERCENT: 50, MAX_PX: 1024 },\n    WIDTH: { PERCENT: 100, MAX_PX: 1024 },\n  },\n};\nfunction resolveImageConstraints(fullscreen, { vh, vw }) {\n  const { HEIGHT, WIDTH } = fullscreen ? RATIOS.FULLSCREEN : RATIOS.DEFAULT;\n  return {\n    height: calc(HEIGHT, vh),\n    width: calc(WIDTH, vw),\n  };\n\n  function calc(CONFIG, unit) {\n    return Math.min(CONFIG.PERCENT * unit, CONFIG.MAX_PX);\n  }\n}\n","import React from 'react';\nimport PhotosGallery from 'modules/components/PhotosGallery';\nimport { findClosestGroupValue } from '../../arrangement/groupping/utils/resolveGroupingUtils';\nimport { PLAIN_GROUPS } from '../../arrangement/groupping/consts';\n\nexport default function VisitsPhotosGallery({\n  className,\n  visitsGroup,\n  provision,\n}) {\n  const visitPhotos = visitsGroup.visitsList.flatMap(visit =>\n    visit.photos.map(photo => ({\n      ...photo,\n      description: renderDescription(visit, visitsGroup, provision),\n    })),\n  );\n\n  return <PhotosGallery className={className} photos={visitPhotos} />;\n}\n\nfunction renderDescription(visit, visitsGroup, { countriesDict }) {\n  const { locationName, countryId, arrivalYear } = visit;\n\n  let result = '';\n\n  const hasLocationGroup = Boolean(\n    findClosestGroupValue(visitsGroup, PLAIN_GROUPS.LOCATIONS),\n  );\n  const hasCountryGroup =\n    hasLocationGroup ||\n    Boolean(findClosestGroupValue(visitsGroup, PLAIN_GROUPS.COUNTRIES));\n  const hasYearGroup = Boolean(\n    findClosestGroupValue(visitsGroup, PLAIN_GROUPS.YEARS),\n  );\n\n  if (!hasLocationGroup) {\n    result += locationName;\n  }\n  if (!hasCountryGroup) {\n    const { countryName } = countriesDict[countryId] ?? {};\n    if (countryName) {\n      result += `, ${countryName}`;\n    }\n  }\n  if (!hasYearGroup) {\n    result += `/${arrivalYear}`;\n  }\n\n  return result;\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport uniq from 'lodash/uniq';\nimport MUILink from '@material-ui/core/Link';\nimport { makeStyles } from '@material-ui/core/styles';\nimport LocationsMap, { MARKERS_SCALES } from 'travel/components/LocationsMap';\n\nconst useStyles = makeStyles({\n  container: { fontSize: '16px', lineHeight: '1.5' },\n  visitContainer: { margin: '20px 0' },\n  mapVisibilityToggle: { marginLeft: '8px', cursor: 'pointer' },\n  googleMapContainer: {\n    margin: '12px 0',\n    width: '800px',\n    maxWidth: '100%',\n    height: '400px',\n    maxHeight: '100%',\n  },\n});\n\nexport default function VisitsLocationsMap({\n  className,\n  visitsGroup,\n  provision: { visitsDict, locationsDict, locationsRating },\n  onToggle,\n}) {\n  const classes = useStyles();\n  const [mapVisible, setMapVisible] = useState(false);\n\n  const locationsIds = uniq(\n    visitsGroup.visitsList.map(({ locationId }) => locationId),\n  );\n\n  const frRef = useRef(false);\n  useEffect(\n    () => {\n      if (!frRef.current) {\n        frRef.current = true;\n      } else if (onToggle) {\n        onToggle(mapVisible);\n      }\n    },\n    [mapVisible],\n  );\n\n  return (\n    <div className={className}>\n      <div>\n        <MUILink\n          variant=\"body2\"\n          onClick={() => {\n            setMapVisible(prevMapVisible => !prevMapVisible);\n          }}\n        >\n          {mapVisible ? 'скрыть карту' : 'на карте'}\n        </MUILink>\n      </div>\n      {mapVisible && (\n        <LocationsMap\n          className={classes.mapContainer}\n          locationsDict={locationsDict}\n          visitsDict={visitsDict}\n          locationsRating={locationsRating}\n          locationsIds={locationsIds}\n          minHeight={300}\n          scaleBy={MARKERS_SCALES.BY_LAST_VISIT}\n          ratingLevel={null}\n        />\n      )}\n    </div>\n  );\n}\n","import React, { Fragment } from 'react';\nimport StatsPanel from '../../statistics/components/StatsPanel';\nimport VisitsPhotosGallery from '../VisitsPhotosGallery';\nimport VisitsLocationsMap from '../VisitsLocationsMap';\n\nfunction VisitGroup({\n  children,\n  classes,\n  config,\n  forwardingProps,\n  isObscure,\n  showMap,\n  showPhotos,\n  provision,\n  urls,\n  visitsGroup,\n  VisitsGroupComponent,\n  onHeightChange,\n  customNode,\n}) {\n  return (\n    <Fragment key={visitsGroup.field.value}>\n      <VisitsGroupComponent\n        visitsGroup={visitsGroup}\n        classes={classes}\n        provision={provision}\n        urls={urls}\n        config={config}\n        {...forwardingProps}\n      >\n        <StatsPanel\n          visitsGroup={visitsGroup}\n          provision={provision}\n          isObscure={isObscure}\n          config={config}\n        />\n      </VisitsGroupComponent>\n      {customNode}\n      {showMap && (\n        <VisitsLocationsMap\n          className={classes.nextLevel}\n          visitsGroup={visitsGroup}\n          provision={provision}\n          onToggle={onHeightChange}\n        />\n      )}\n      {children}\n      {showPhotos && (\n        <VisitsPhotosGallery\n          className={classes.nextLevel}\n          visitsGroup={visitsGroup}\n          provision={provision}\n        />\n      )}\n    </Fragment>\n  );\n}\n\nexport default React.memo(VisitGroup);\n","export const PLAIN_FILTERING = {\n  ANY: 'ANY',\n  FOREIGN: 'FOREIGN',\n  DOMESTIC: 'DOMESTIC',\n};\n","import { PLAIN_FILTERING } from './consts';\n\nexport default function switchFilteringFn(provision, filteringOption) {\n  switch (filteringOption) {\n    case PLAIN_FILTERING.FOREIGN:\n    case PLAIN_FILTERING.DOMESTIC:\n      return createFilterBasedOnOrigin(provision, filteringOption);\n    case PLAIN_FILTERING.ANY:\n    default:\n      return isVisitExist;\n  }\n}\n\nfunction createFilterBasedOnOrigin(\n  { tripsDict, locationsDict },\n  filteringOption,\n) {\n  const isForeign = filteringOption === PLAIN_FILTERING.FOREIGN;\n  if (!isForeign && filteringOption !== PLAIN_FILTERING.DOMESTIC) {\n    return isVisitExist; // filter nothing\n  }\n  return function filterOnlyForeign(visit) {\n    if (!visit) {\n      return false;\n    }\n    const { countryId, tripId } = visit;\n    if (!countryId) {\n      return true;\n    }\n    const trip = tripsDict[tripId];\n    if (!trip) {\n      return true;\n    }\n    const { originLocationId } = trip;\n    const originLocation = locationsDict[originLocationId];\n    if (!originLocation) {\n      return true;\n    }\n    const { countryId: originCountryId } = originLocation;\n    if (!originCountryId) {\n      return true;\n    }\n    return isForeign\n      ? countryId !== originCountryId\n      : countryId === originCountryId;\n  };\n}\n\nfunction isVisitExist(visit) {\n  return Boolean(visit);\n}\n","import React, { useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport clamp from 'lodash/clamp';\nimport cls from 'classnames';\nimport { useCollapsible } from 'travel/components/VisitsArranger/arrangement/collapsing';\nimport {\n  groupVisitsBy,\n  PLAIN_GROUPS,\n  PLAIN_GROUPS_CONFIG,\n} from 'travel/components/VisitsArranger/arrangement/groupping';\nimport { calcStats } from 'travel/components/VisitsArranger/statistics';\nimport { sortVisitsBy } from 'travel/components/VisitsArranger/arrangement/sorting';\nimport Expandable from 'travel/components/VisitsArranger/components/Expandable';\nimport Virtualizer from 'travel/components/VisitsArranger/components/Virtualizer';\nimport VisitGroup from 'travel/components/VisitsArranger/components/VisitGroup';\nimport { switchFilteringFn } from './arrangement/filtering';\n\nconst useStyles = makeStyles(theme => ({\n  noMarginTop: {},\n  link: {\n    cursor: 'pointer',\n  },\n  header0: {\n    ...theme.typography.h2,\n    wordBreak: 'break-word',\n  },\n  container0: {\n    display: 'flex',\n    alignItems: 'self-start',\n    '&:not($noMarginTop)': {\n      marginTop: '64px',\n    },\n  },\n  level0: {},\n\n  header1: {\n    ...theme.typography.h4,\n    wordBreak: 'break-word',\n  },\n  container1: {\n    display: 'flex',\n    alignItems: 'self-start',\n    marginTop: '18px',\n    marginBottom: '6px',\n  },\n  level1: {\n    [theme.breakpoints.up('sm')]: {\n      paddingLeft: '32px',\n    },\n  },\n\n  header2: {\n    ...theme.typography.body1,\n    wordBreak: 'break-word',\n  },\n  container2: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  level2: {\n    [theme.breakpoints.up('sm')]: {\n      paddingLeft: '96px',\n    },\n  },\n}));\n\nexport default function VisitsArranger({\n  visitsList,\n  groupsOrder,\n  sortingOrder,\n  filteringOption,\n  provision,\n  urls,\n  isObscure,\n  config: { collapsible: allowCollapsible = false, ...config },\n  adaptTopHeaderSize,\n  mapSectionLevel,\n  photosSectionLevel,\n  children,\n  virtualize,\n  ...forwardingProps\n}) {\n  const classes = useStyles();\n\n  const actualVisitsList = visitsList.filter(\n    switchFilteringFn(provision, filteringOption),\n  );\n\n  const virtualizerRef = useRef();\n  // if virtualize is true, then need to virtualize, so not yet virtualized\n  let virtualized = !virtualize;\n\n  const { collapsible, disableCollapsible } = useCollapsible({\n    allowCollapsible,\n    onToggleCollapsible: () => virtualizerRef.current?.measure(),\n  });\n\n  return renderRecursive(\n    { visitsList: actualVisitsList, parent: null, field: null },\n    groupsOrder,\n  );\n\n  function renderRecursive(parentVisitsGroup, groupsOrderInternal) {\n    const [plainGroup, ...restGroupsOrder] = groupsOrderInternal;\n    if (!plainGroup) {\n      return null;\n    }\n    const { component: VisitsGroupComponent } = PLAIN_GROUPS_CONFIG[plainGroup];\n    const { visitsList: visitsListInternal } = parentVisitsGroup;\n\n    const nestingLevel = lookupNestingLevel(parentVisitsGroup);\n    const expectedMaxLevel = nestingLevel + groupsOrderInternal.length;\n    const sectionLevel = lookupSectionLevel(\n      nestingLevel,\n      adaptTopHeaderSize,\n      expectedMaxLevel,\n    );\n    const actualPhotosSectionLevel = photosSectionLevel ?? expectedMaxLevel - 1;\n    const actualMapSectionLevel = mapSectionLevel ?? expectedMaxLevel - 2;\n\n    const visitsGroups = groupVisitsBy(visitsListInternal, plainGroup).map(\n      visitsGroup => {\n        const enhancedVisitsGroup = {\n          ...visitsGroup,\n          plainGroup,\n          parent: parentVisitsGroup,\n        };\n        enhancedVisitsGroup.stats = calcStats(enhancedVisitsGroup, provision);\n        return enhancedVisitsGroup;\n      },\n    );\n\n    const sortedVisitsGroups = sortVisitsBy(\n      visitsGroups,\n      sortingOrder,\n      plainGroup,\n      provision,\n    );\n\n    const bypassVirtualization = virtualized;\n    if (!virtualized) {\n      virtualized = true; // only apply for the top level list\n    }\n    return (\n      <>\n        <Expandable\n          classes={{\n            actions: cls(classes.link, classes[`level${nestingLevel}`]),\n          }}\n          collapsible={collapsible && plainGroup === PLAIN_GROUPS.LOCATIONS}\n          items={sortedVisitsGroups}\n          onExpand={virtualizerRef.current?.measure}\n          onExpandAll={disableCollapsible}\n        >\n          {({ items: actualVisitsGroups }) => (\n            <Virtualizer\n              items={actualVisitsGroups}\n              bypass={bypassVirtualization}\n              ref={bypassVirtualization ? undefined : virtualizerRef}\n              overscan={3}\n            >\n              {({ item: visitsGroup, index }) => (\n                <VisitGroup\n                  key={toFieldSignature(visitsGroup.field)}\n                  classes={resolveVisitsGroupClasses(classes, {\n                    nestingLevel,\n                    sectionLevel,\n                    isFirstChild: index === 0,\n                  })}\n                  visitsGroup={visitsGroup}\n                  VisitsGroupComponent={VisitsGroupComponent}\n                  config={config}\n                  isObscure={isObscure}\n                  provision={provision}\n                  urls={urls}\n                  forwardingProps={forwardingProps}\n                  showMap={nestingLevel === actualMapSectionLevel}\n                  showPhotos={nestingLevel === actualPhotosSectionLevel}\n                  onHeightChange={virtualizerRef.current?.measure}\n                  customNode={children?.({\n                    level: nestingLevel,\n                    className: classes[`level${nestingLevel + 1}`],\n                    index,\n                    visitsGroup,\n                  })}\n                >\n                  {renderRecursive(visitsGroup, restGroupsOrder)}\n                </VisitGroup>\n              )}\n            </Virtualizer>\n          )}\n        </Expandable>\n      </>\n    );\n  }\n}\n\nVisitsArranger.defaultProps = {\n  mapSectionLevel: undefined,\n  photosSectionLevel: undefined,\n};\n\nfunction lookupNestingLevel(visitsGroup) {\n  let currentVisitsGroup = visitsGroup;\n  let level = 0;\n  while (currentVisitsGroup) {\n    level += 1;\n    currentVisitsGroup = currentVisitsGroup.parent;\n  }\n  return Math.max(0, level - 1);\n}\n\nconst MAX_LEVEL = 3;\nfunction lookupSectionLevel(\n  nestingLevel,\n  adaptTopHeaderSize,\n  expectedMaxLevel,\n) {\n  return nestingLevel > 0 || adaptTopHeaderSize\n    ? clamp(MAX_LEVEL - expectedMaxLevel + nestingLevel, 0, MAX_LEVEL - 1)\n    : nestingLevel;\n}\n\nfunction toFieldSignature(field) {\n  const { name, value } = field ?? {};\n  return `${name}:${value}`;\n}\n\nfunction resolveVisitsGroupClasses(\n  classes,\n  { nestingLevel, sectionLevel, isFirstChild },\n) {\n  return {\n    level: classes[`level${nestingLevel}`],\n    nextLevel: classes[`level${nestingLevel + 1}`],\n    container: cls(\n      classes[`level${nestingLevel}`],\n      classes[`container${sectionLevel}`],\n      { [classes.noMarginTop]: isFirstChild && nestingLevel === 0 },\n    ),\n    header: classes[`header${sectionLevel}`],\n  };\n}\n","import { useCallback, useEffect, useState } from 'react';\n\nexport default function useCollapsible({\n  allowCollapsible,\n  onToggleCollapsible,\n}) {\n  const [collapsible, setCollapsible] = useState(true);\n  const disableCollapsible = useCallback(() => setCollapsible(false), []);\n  useEffect(onToggleCollapsible, [collapsible]);\n  const actualCollapsible = collapsible && allowCollapsible;\n\n  return { collapsible: actualCollapsible, setCollapsible, disableCollapsible };\n}\n","import VisitsArranger from './VisitsArranger';\nexport * from './arrangement/groupping';\nexport * from './arrangement/sorting';\nexport * from './arrangement/filtering';\nexport * from './statistics';\n\nexport default VisitsArranger;\n","import uniq from 'lodash/uniq';\n\nexport default (array, { maxLength, separator = ', ' }) => {\n  const uniqArray = uniq(array);\n  const result = uniqArray.slice(0, maxLength).join(separator);\n  if (uniqArray.length > maxLength) {\n    return `${result}...`;\n  }\n  return result;\n};\n","import dateMin from 'date-fns/min';\nimport dateMax from 'date-fns/max';\nimport groupBy from 'lodash/groupBy';\nimport uniqTrimAndJoin from 'modules/utilities/text/uniqTrimAndJoin';\nimport { VISIT_TYPES } from 'travel/models/visits/consts';\nimport { visitDateTimePeriodToString } from 'modules/utilities/dateTime/dateTimePeriodToString';\n\nconst FALLBACK = 'Без названия';\nexport default function resolveTripCaption(\n  trip,\n  visitsDict,\n  countriesDict,\n  locationsDict,\n) {\n  const {\n    visits: visitsIds,\n    originLocationId,\n    tripName,\n    hasAutogeneratedTripName,\n  } = trip || {};\n\n  const originCountryId = locationsDict[originLocationId]?.countryId;\n\n  if (!hasAutogeneratedTripName) {\n    return tripName || FALLBACK;\n  }\n  if (!visitsIds.length) {\n    return FALLBACK;\n  }\n\n  const periodStr = visitDateTimePeriodToString({\n    arrivalDateTime: dateMin(\n      visitsIds.map(visitsId => visitsDict[visitsId]?.arrivalDateTime),\n    ),\n    departureDateTime: dateMax(\n      visitsIds.map(visitsId => visitsDict[visitsId]?.departureDateTime),\n    ),\n  });\n\n  const visitsByCountries = Object.keys(\n    groupBy(\n      visitsIds.filter(\n        visitId => visitsDict[visitId]?.visitType !== VISIT_TYPES.TRANSIT,\n      ),\n      'countryId',\n    ),\n  );\n\n  if (visitsByCountries.length === 1) {\n    const locationsNames = uniqTrimAndJoin(\n      visitsIds.map(visitId => visitsDict[visitId]?.locationName),\n      { maxLength: 4 },\n    );\n    return `${locationsNames || FALLBACK}, ${periodStr}`;\n  }\n\n  const countriesNames = uniqTrimAndJoin(\n    visitsByCountries\n      .map(\n        countryId =>\n          Number(countryId) !== originCountryId &&\n          countriesDict[countryId] &&\n          countriesDict[countryId].countryName,\n      )\n      .filter(Boolean),\n    { maxLength: 4 },\n  );\n  return `${countriesNames || FALLBACK}, ${periodStr}`;\n}\n","import React, { useState } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\nimport VisitsArranger, {\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n  PLAIN_FILTERING,\n} from 'travel/components/VisitsArranger';\nimport useCountryWithTripStats from './useCountryWithTripStats';\n\nexport default function CountryPage({\n  match: {\n    params: { userAlias, strCountryId, section },\n  },\n}) {\n  const [alsoGroupByYears, setAlsoGroupByYears] = useState(false);\n  const { userAlias: authenticatedUserAlias } = useAuthContext();\n\n  const urls = useVisitsUrls({ editable: false, userAlias, section });\n\n  // const editable = userAlias === authenticatedUserAlias;\n  const isObscure = userAlias !== authenticatedUserAlias;\n\n  const countryId = parseInt(strCountryId, 10);\n\n  const {\n    country,\n    provision,\n    provision: { isError, isPending, isReady },\n    isVisited,\n    visitsList,\n  } = useCountryWithTripStats({ userAlias, countryId });\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending || !isReady) {\n    return <div>...Loading</div>;\n  }\n\n  if (!country) {\n    return null;\n  }\n\n  if (!isVisited) {\n    return (\n      <Typography variant=\"h2\" component=\"span\">\n        {country.countryName}\n      </Typography>\n    );\n  }\n\n  return (\n    <VisitsArranger\n      visitsList={visitsList}\n      provision={provision}\n      groupsOrder={[\n        PLAIN_GROUPS.COUNTRIES,\n        alsoGroupByYears && PLAIN_GROUPS.YEARS,\n        PLAIN_GROUPS.LOCATIONS,\n      ].filter(Boolean)}\n      sortingOrder={[PLAIN_SORTING.LAST_VISIT]}\n      filteringOption={PLAIN_FILTERING.ANY}\n      isObscure={isObscure}\n      urls={urls}\n      config={{ CountryVisitsGroup: { hyperlinks: { country: false } } }}\n    >\n      {({ level, index }) =>\n        level === 0 &&\n        index === 0 && (\n          <MUILink\n            variant=\"body2\"\n            onClick={() =>\n              setAlsoGroupByYears(prevAlsoGroupByYears => !prevAlsoGroupByYears)\n            }\n          >\n            {alsoGroupByYears\n              ? 'Убрать группировку по годам'\n              : 'Сгруппировать по годам'}\n          </MUILink>\n        )\n      }\n    </VisitsArranger>\n  );\n}\n","import { useTripsStats } from 'travel/dataSource/useTrips';\n\nexport default function useCountryWithTripStats({ userAlias, countryId }) {\n  const tripsProvision = useTripsStats({\n    userAlias,\n  });\n\n  const { countriesIds, countriesDict, visitsDict, visitsIds } = tripsProvision;\n\n  const isVisited = countriesIds.includes(countryId);\n\n  return {\n    provision: tripsProvision,\n    country: countriesDict[countryId],\n    isVisited,\n    visitsList: isVisited\n      ? visitsIds\n          .map(visitId => visitsDict[visitId])\n          .filter(\n            ({ countryId: visitCountryId }) => visitCountryId === countryId,\n          )\n      : [],\n  };\n}\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport Box from '@material-ui/core/Box';\nimport Rating from '@material-ui/lab/Rating';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\n\nconst RATING_LOCALIZATION = {\n  [LOCATION_RATING.PLACE_TO_LIVE]: 'Готов тут жить',\n  [LOCATION_RATING.FEW_PER_YEAR]: 'Готов бывать по нескольку раз в год',\n  [LOCATION_RATING.ONCE_PER_YEAR]: 'Приезжал бы каждый год',\n  [LOCATION_RATING.ONCE_PER_TWO_YEARS]: 'Приезжал бы раз в пару лет',\n  [LOCATION_RATING.ONCE_PER_FIVE_YEARS]: 'Приезжал бы раз в пять лет',\n  [LOCATION_RATING.ONCE_PER_DECADE]: 'Можно заглянуть раз в десятилетие',\n  [LOCATION_RATING.TWICE_PER_LIVE]: 'Пары посещений за всю жизнь достаточно',\n  [LOCATION_RATING.ONCE_PER_LIVE]: 'Одного посещения достаточно',\n  [LOCATION_RATING.NEVER]: 'Лучше бы тут и не бывать',\n};\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  formControl: {\n    display: 'block',\n    margin: '24px 12px',\n    width: '100%',\n  },\n});\n\nexport default function LocationRating({\n  locationId,\n  locationRating,\n  isEditable,\n  onSubmitLocationRating,\n}) {\n  const classes = useStyles();\n  const [rating, setRating] = React.useState(locationRating);\n\n  const handleChangeRating = useCallback(\n    event => {\n      const nextRating = event.target.value;\n      if (nextRating && nextRating !== locationRating) {\n        setRating(nextRating);\n        onSubmitLocationRating(locationId, event.target.value);\n      }\n    },\n    [locationId, locationRating],\n  );\n\n  return (\n    <div className={classes.container}>\n      {Boolean(rating) && (\n        <Rating\n          name=\"locationRating\"\n          readOnly={true}\n          size=\"large\"\n          value={ratingToStars(rating)}\n          precision={0.5}\n        />\n      )}\n      {Boolean(!isEditable && rating) && (\n        <Box ml={2}>{RATING_LOCALIZATION[rating]}</Box>\n      )}\n      {isEditable && (\n        <FormControl className={classes.formControl}>\n          <InputLabel shrink={true} id=\"select-location-rating-label\">\n            Задать рейтинг\n          </InputLabel>\n          <Select\n            labelId=\"select-location-rating-label\"\n            id=\"select-location-rating\"\n            value={locationRating}\n            onChange={handleChangeRating}\n          >\n            {Object.values(LOCATION_RATING).map(ratingOption => (\n              <MenuItem key={ratingOption} value={ratingOption}>\n                {RATING_LOCALIZATION[ratingOption]}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      )}\n    </div>\n  );\n}\n\nfunction ratingToStars(rating) {\n  if (rating >= 7) {\n    return 9 - Math.ceil(rating);\n  }\n  return 5 - (rating - 1) / 2;\n}\n","import useLocation from 'travel/dataSource/useLocation';\nimport { useTripsStats } from 'travel/dataSource/useTrips';\nimport { useLocationRatingRequest } from 'travel/dataSource/useLocations';\n\nexport default function useLocationWithTripStats({\n  domain,\n  userAlias,\n  locationId,\n}) {\n  const tripsStatsProvision = useTripsStats({\n    userAlias,\n  });\n\n  const {\n    isError: isTripsError,\n    isPending: isTripsPending,\n    isReady: isTripsReady,\n    locationsIds,\n    visitsDict,\n    visitsIds,\n    locationsRating,\n  } = tripsStatsProvision;\n\n  const {\n    location,\n    provision: { isError, isPending, isReady, ...restProvision },\n  } = useLocation({ domain, locationId });\n\n  const { submitLocationRating } = useLocationRatingRequest({ domain });\n\n  const isVisited = locationsIds.includes(locationId);\n\n  return {\n    provision: {\n      isError: isError || isTripsError,\n      isPending: isPending || isTripsPending,\n      isReady: isReady || isTripsReady,\n      ...restProvision,\n    },\n    location,\n    isVisited,\n    visitsList: isVisited\n      ? visitsIds\n          .map(visitId => visitsDict[visitId])\n          .filter(\n            ({ locationId: visitLocationId }) => visitLocationId === locationId,\n          )\n      : [],\n    locationRating: (isVisited && locationsRating[locationId]) || null,\n    submitLocationRating,\n    tripsStatsProvision,\n  };\n}\n","import { useSelector } from 'react-redux';\nimport { useProvision, selectItem } from 'core/connection';\n\nexport default function useLocation({ domain, locationId }) {\n  const location = useSelector(\n    state => selectItem(state, 'locations', locationId) || {},\n  );\n\n  const provision = useProvision({\n    domain,\n    isProvision: true,\n    modelName: 'locations',\n    observe: locationId,\n    condition: Boolean(locationId),\n    query: {\n      id: locationId,\n    },\n  });\n\n  return {\n    location,\n    provision,\n  };\n}\n","import React, { useCallback, useState } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\nimport VisitsArranger, {\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n  PLAIN_FILTERING,\n} from 'travel/components/VisitsArranger';\nimport LocationRating from './blocks/LocationRating';\nimport useLocationWithTripStats from './useLocationWithTripStats';\n\nconst domain = 'travel.LocationPage';\nexport default function LocationPage({\n  match: {\n    params: { userAlias, strLocationId, section },\n  },\n}) {\n  const [alsoGroupByYears, setAlsoGroupByYears] = useState(false);\n\n  const {\n    isAuthenticated,\n    userAlias: authenticatedUserAlias,\n  } = useAuthContext();\n\n  const editable = userAlias === authenticatedUserAlias;\n  const isObscure = userAlias !== authenticatedUserAlias;\n\n  const urls = useVisitsUrls({ editable, userAlias, section });\n\n  const locationId = parseInt(strLocationId, 10);\n\n  const {\n    location,\n    provision: { isError, isPending, isReady },\n    isVisited,\n    visitsList,\n    tripsStatsProvision,\n    tripsStatsProvision: { userProvision },\n    locationRating,\n    submitLocationRating,\n  } = useLocationWithTripStats({ domain, userAlias, locationId });\n\n  const handleSubmitLocationRating = useCallback(\n    (locationIdToSubmit, value) => {\n      submitLocationRating({\n        query: { rating: value, id: String(locationIdToSubmit) },\n        condition: Boolean(locationIdToSubmit),\n      }).finally(userProvision.invalidate); // todo: still need to improve invalidation ux\n    },\n  );\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending || !isReady) {\n    return <div>...Loading</div>;\n  }\n\n  if (!location) {\n    return null;\n  }\n\n  const isEditable = isAuthenticated && authenticatedUserAlias === userAlias;\n\n  if (!isVisited) {\n    return (\n      <Typography variant=\"h2\" component=\"span\">\n        {location.locationName}\n      </Typography>\n    );\n  }\n  return (\n    <VisitsArranger\n      visitsList={visitsList}\n      provision={tripsStatsProvision}\n      groupsOrder={[\n        PLAIN_GROUPS.LOCATIONS,\n        alsoGroupByYears && PLAIN_GROUPS.YEARS,\n        PLAIN_GROUPS.JUST_VISITS,\n      ].filter(Boolean)}\n      photosSectionLevel={1}\n      mapSectionLevel={0}\n      sortingOrder={[PLAIN_SORTING.LAST_VISIT]}\n      filteringOption={PLAIN_FILTERING.ANY}\n      isObscure={isObscure}\n      urls={urls}\n      config={{\n        LocationVisitsGroup: {\n          hyperlinks: { location: false },\n        },\n        StatsPanel: {\n          appearance: { CountriesStats: false },\n        },\n      }}\n    >\n      {({ level, index }) =>\n        level === 0 &&\n        index === 0 && (\n          <>\n            <MUILink\n              variant=\"body2\"\n              onClick={() =>\n                setAlsoGroupByYears(\n                  prevAlsoGroupByYears => !prevAlsoGroupByYears,\n                )\n              }\n            >\n              {alsoGroupByYears\n                ? 'Убрать группировку по годам'\n                : 'Сгруппировать по годам'}\n            </MUILink>\n            <LocationRating\n              locationId={locationId}\n              locationRating={locationRating}\n              isEditable={isEditable}\n              onSubmitLocationRating={handleSubmitLocationRating}\n            />\n          </>\n        )\n      }\n    </VisitsArranger>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\n\nconst RATING_LOCALIZATION = {\n  [LOCATION_RATING.PLACE_TO_LIVE]: 'Жил бы здесь',\n  [LOCATION_RATING.FEW_PER_YEAR]: 'Несколько раз в год',\n  [LOCATION_RATING.ONCE_PER_YEAR]: 'Раз в год',\n  [LOCATION_RATING.ONCE_PER_TWO_YEARS]: 'Раз в пару лет',\n  [LOCATION_RATING.ONCE_PER_FIVE_YEARS]: 'Раз в пять лет',\n  [LOCATION_RATING.ONCE_PER_DECADE]: 'Раз в десятилетие',\n  [LOCATION_RATING.TWICE_PER_LIVE]: 'Пару раз в жизни',\n  [LOCATION_RATING.ONCE_PER_LIVE]: 'Раз в жизни',\n  [LOCATION_RATING.NEVER]: 'Никогда',\n};\n\nconst useStyles = makeStyles({\n  formControl: {\n    width: '100%',\n  },\n});\n\nexport default function LocationRating({\n  locationId,\n  locationRating,\n  isEditable,\n  onSubmitLocationRating,\n}) {\n  const classes = useStyles();\n  if (!isEditable) {\n    return <div>{RATING_LOCALIZATION[locationRating]}</div>;\n  }\n  return (\n    <FormControl className={classes.formControl}>\n      <InputLabel shrink={true} id=\"select-location-rating-label\">\n        Я бы ездил сюда\n      </InputLabel>\n      <Select\n        labelId=\"select-location-rating-label\"\n        id=\"select-location-rating\"\n        value={locationRating}\n        onChange={event => {\n          onSubmitLocationRating(event, locationId, event.target.value);\n        }}\n      >\n        <MenuItem value={LOCATION_RATING.PLACE_TO_LIVE}>\n          {RATING_LOCALIZATION[LOCATION_RATING.PLACE_TO_LIVE]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.FEW_PER_YEAR}>\n          {RATING_LOCALIZATION[LOCATION_RATING.FEW_PER_YEAR]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.ONCE_PER_YEAR}>\n          {RATING_LOCALIZATION[LOCATION_RATING.ONCE_PER_YEAR]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.ONCE_PER_TWO_YEARS}>\n          {RATING_LOCALIZATION[LOCATION_RATING.ONCE_PER_TWO_YEARS]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.ONCE_PER_FIVE_YEARS}>\n          {RATING_LOCALIZATION[LOCATION_RATING.ONCE_PER_FIVE_YEARS]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.ONCE_PER_DECADE}>\n          {RATING_LOCALIZATION[LOCATION_RATING.ONCE_PER_DECADE]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.TWICE_PER_LIVE}>\n          {RATING_LOCALIZATION[LOCATION_RATING.TWICE_PER_LIVE]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.ONCE_PER_LIVE}>\n          {RATING_LOCALIZATION[LOCATION_RATING.ONCE_PER_LIVE]}\n        </MenuItem>\n        <MenuItem value={LOCATION_RATING.NEVER}>\n          {RATING_LOCALIZATION[LOCATION_RATING.NEVER]}\n        </MenuItem>\n      </Select>\n    </FormControl>\n  );\n}\n\nLocationRating.defaultProps = { locationRating: null };\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport LocationRating from './blocks/LocationRating';\nimport useUserLocations from './useUserLocations';\n\nconst useStyles = makeStyles({\n  container: { fontSize: '16px', lineHeight: '1.5' },\n  visitContainer: { margin: '20px 0' },\n  location: { fontWeight: 'bold', fontSize: '21px' },\n  googleMapContainer: {\n    margin: '12px 0',\n    width: '800px',\n    maxWidth: '100%',\n    height: '400px',\n    maxHeight: '100%',\n  },\n});\n\nconst domain = 'travel.LocationsPage';\nexport default function LocationsPage({\n  match: {\n    params: { userAlias, strLocationId },\n  },\n}) {\n  const classes = useStyles();\n\n  const {\n    isAuthenticated,\n    userAlias: authenticatedUserAlias,\n  } = useAuthContext();\n\n  const {\n    isError,\n    isPending,\n    locationsDict,\n    locationsIds,\n    locationsRating,\n    submitLocationRating,\n  } = useUserLocations({ domain, userAlias });\n\n  const locationId = parseInt(strLocationId, 10);\n  const actualLocationsIds = locationId ? [locationId] : locationsIds;\n\n  const handleSubmitLocationRating = useCallback(\n    (event, locationIdToSubmit, value) => {\n      submitLocationRating({\n        query: { rating: value, id: String(locationIdToSubmit) },\n        condition: Boolean(locationIdToSubmit),\n      });\n    },\n  );\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending) {\n    return <div>...Loading</div>;\n  }\n  if (locationId && !locationsIds.includes(locationId)) {\n    return (\n      <div>{`Путешественик ${userAlias} еще не посетил данную локацию`}</div>\n    );\n  }\n\n  const isEditable = isAuthenticated && authenticatedUserAlias === userAlias;\n  return (\n    <div className={classes.container}>\n      {actualLocationsIds.map(locationsIdToRender => {\n        const location = locationsDict[locationsIdToRender];\n        if (!location) {\n          return null;\n        }\n        const { locationName } = location;\n        return (\n          <React.Fragment key={locationsIdToRender}>\n            <h1 className={classes.location}>{locationName}</h1>\n            <LocationRating\n              locationId={locationsIdToRender}\n              locationRating={locationsRating[locationsIdToRender]}\n              isEditable={isEditable}\n              onSubmitLocationRating={handleSubmitLocationRating}\n            />\n          </React.Fragment>\n        );\n      })}\n    </div>\n  );\n}\n","import useUser from 'travel/dataSource/useUser';\nimport { useTripsStats } from 'travel/dataSource/useTrips';\nimport { useLocationRatingRequest } from 'travel/dataSource/useLocations';\n\nexport default function useUserLocations({ domain, userAlias }) {\n  const {\n    isError,\n    isPending,\n    locationsDict,\n    locationsIds = [],\n    locationsRating,\n  } = useTripsStats({\n    userAlias,\n  });\n  const { submitLocationRating } = useLocationRatingRequest({ domain });\n\n  return {\n    isError,\n    isPending,\n    locationsDict,\n    locationsIds,\n    locationsRating,\n    submitLocationRating,\n  };\n}\n","import React, { useState } from 'react';\nimport MUILink from '@material-ui/core/Link';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport {\n  useTripsStats,\n} from 'travel/dataSource';\nimport VisitsArranger, {\n  PLAIN_FILTERING,\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n} from 'travel/components/VisitsArranger';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\n\nconst domain = 'travel.VisitPage';\nexport default function TripPage({\n  match: {\n    params: { userAlias, strTripId },\n  },\n}) {\n  const [alsoGroupByCountries, setAlsoGroupByCountries] = useState(false);\n\n  const {\n    isAuthenticated,\n    userAlias: authenticatedUserAlias,\n  } = useAuthContext();\n\n  const tripId = parseInt(strTripId, 10);\n  const provision = useTripsStats({\n    domain,\n    userAlias,\n    tripsIds: tripId ? [tripId] : [],\n  });\n  const {\n    visitsIds: tripVisitsIds,\n    isReady,\n    visitsDict,\n    isError,\n    isPending,\n  } = provision;\n\n  const editable = isAuthenticated && authenticatedUserAlias === userAlias;\n  const urls = useVisitsUrls({ editable, userAlias, section: 'trips' });\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending || !isReady) {\n    return <div>...Loading</div>;\n  }\n\n  return (\n    <VisitsArranger\n      visitsList={tripVisitsIds.map(tripVisitsId => visitsDict[tripVisitsId])}\n      provision={provision}\n      groupsOrder={[\n        PLAIN_GROUPS.TRIPS,\n        alsoGroupByCountries && PLAIN_GROUPS.COUNTRIES,\n        PLAIN_GROUPS.JUST_VISITS,\n      ].filter(Boolean)}\n      photosSectionLevel={0}\n      mapSectionLevel={0}\n      sortingOrder={[PLAIN_SORTING.LAST_VISIT]}\n      filteringOption={PLAIN_FILTERING.ANY}\n      isObscure={!editable}\n      urls={urls}\n      config={{ YearVisitsGroup: { hyperlinks: { year: false } } }}\n    >\n      {({ level, index }) =>\n        level === 0 &&\n        index === 0 && (\n          <>\n            <MUILink\n              variant=\"body2\"\n              onClick={() =>\n                setAlsoGroupByCountries(\n                  prevAlsoGroupByCountries => !prevAlsoGroupByCountries,\n                )\n              }\n            >\n              {alsoGroupByCountries\n                ? 'Убрать группировку по странам'\n                : 'Сгруппировать по странам'}\n            </MUILink>\n          </>\n        )\n      }\n    </VisitsArranger>\n  );\n}\n","function degToRad(degree) {\n  const DEGREES_IN_CIRCLE = 360;\n  return (degree / DEGREES_IN_CIRCLE) * 2 * Math.PI;\n}\n\nfunction hexToRgba(hex, alpha) {\n  const match = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  const rgba = match\n    ? {\n        r: parseInt(match[1], 16),\n        g: parseInt(match[2], 16),\n        b: parseInt(match[3], 16),\n        a: alpha,\n      }\n    : { r: 0, g: 0, b: 0, a: 0 };\n  return `rgba(${rgba.r},${rgba.g},${rgba.b},${rgba.a})`;\n}\n\nconst backgroundColor = '#FFF';\nconst STRIPLES_ANGLE_DEG = 45;\nconst STRIPLES_WIDTH_PX = 20;\nconst STRIPLES_SHIFT_PX =\n  4 * STRIPLES_WIDTH_PX * Math.cos(degToRad(STRIPLES_ANGLE_DEG));\n\nfunction makeStriplesBackground(color, opacity = 0.4) {\n  const actualColor = hexToRgba(color, opacity);\n  return {\n    background: `repeating-linear-gradient(\n      ${STRIPLES_ANGLE_DEG}deg,\n      ${backgroundColor},\n      ${backgroundColor} ${STRIPLES_WIDTH_PX}px,\n      ${actualColor} ${STRIPLES_WIDTH_PX}px,\n      ${actualColor} ${2 * STRIPLES_WIDTH_PX}px\n    )`,\n    backgroundSize: `calc(100% + ${STRIPLES_SHIFT_PX}px)`,\n  };\n}\n\nexport default function resolveDropzoneStyles(theme) {\n  return {\n    dropzoneContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-around',\n      height: '100%',\n      minHeight: '144px',\n      padding: '0 12px',\n      margin: '12px 0',\n      cursor: 'pointer',\n    },\n    dropzoneStandby: {\n      '& $dropzoneContainer': {\n        border: `2px dashed ${theme.palette.primary.dark}`,\n        borderRadius: '4px',\n        ...makeStriplesBackground(theme.palette.primary.light, 0.2),\n      },\n      '& $dropzoneUpload': {\n        borderColor: theme.palette.disabled.dark,\n        ...makeStriplesBackground(theme.palette.disabled.main, 0.2),\n        animation: '$slide 2s infinite linear forwards',\n      },\n    },\n    dropzoneActive: {\n      border: `2px dashed ${theme.palette.secondary.dark}`,\n      animation: '$slide 2s infinite linear forwards',\n      ...makeStriplesBackground(theme.palette.secondary.light),\n      '&$dropzoneAccept': {\n        borderColor: theme.palette.secondary.dark,\n        ...makeStriplesBackground(theme.palette.secondary.main),\n        animation: '$slide 2s infinite linear forwards',\n      },\n      '&$dropzoneReject': {\n        borderColor: theme.palette.error.dark,\n        ...makeStriplesBackground(theme.palette.error.main),\n        animation: '$slide 2s infinite linear forwards',\n      },\n    },\n    dropzoneAccept: {},\n    dropzoneReject: {},\n    dropzoneUpload: {},\n    '@keyframes slide': {\n      '0%': {\n        backgroundPositionX: `-${STRIPLES_SHIFT_PX}px`,\n      },\n      '100%': {\n        backgroundPositionX: 0,\n      },\n    },\n  };\n}\n","import { v4 as uuidV4 } from 'uuid';\n\nconst listeners = new Set();\nconst worker =\n  'Worker' in window\n    ? new Worker(new URL('./blurhashWorker.js', import.meta.url))\n    : null;\nworker.onmessage = message => listeners.forEach(listener => listener(message));\n\nexport default function calcBlurhashInWorker({\n  pixels,\n  height,\n  width,\n  componentX,\n  componentY,\n}) {\n  const uniqId = uuidV4();\n  if (!worker) {\n    return import('blurhash').then(blurhash =>\n      blurhash.encode(pixels, height, width, componentX, componentY),\n    );\n  }\n  return new Promise(resolve => {\n    listeners.add(listen);\n\n    worker.postMessage({\n      payload: { pixels, height, width, componentX, componentY },\n      uniqId,\n    });\n\n    function listen(message) {\n      const {\n        data: { payload: receivedPayload, uniqId: receivedUniqId },\n      } = message;\n      if (receivedUniqId !== uniqId) {\n        return;\n      }\n      listeners.delete(listen);\n      resolve(receivedPayload);\n    }\n  });\n}\n","import React, { useCallback, useState } from 'react';\nimport cls from 'classnames';\nimport { useDropzone } from 'react-dropzone';\nimport { makeStyles } from '@material-ui/core/styles';\nimport chunk from 'lodash/chunk';\nimport resolveDropzoneStyles from '../../resolveDropzoneStyles';\nimport calcBlurhashInWorker from './calcBlurhashInWorker';\n\nconst UPLOAD_MAX_IMAGES = 10;\nconst UPLOAD_IMAGES_CHUNK_SIZE = 2;\nconst UPLOAD_IMAGE_MIN_SIZE = 50 * 1024;\nconst UPLOAD_IMAGE_MAX_SIZE = 5 * 1024 * 1024;\n\nconst useStyles = makeStyles(resolveDropzoneStyles);\n\nexport default function PhotosDropzone({\n  onChunkUpload,\n  onUploadComplete,\n  visit,\n}) {\n  const classes = useStyles();\n  const [progress, setProgress] = useState(null);\n  const [rejectedFiles, setRejectedFiles] = useState([]);\n  const isUploadInProgress = progress !== null;\n\n  const { visitId } = visit;\n\n  const handleSubmitPhotos = useCallback(\n    async (acceptedFiles, currentRejectedFiles) => {\n      if (currentRejectedFiles) {\n        setRejectedFiles(currentRejectedFiles);\n      }\n      setProgress({ uploaded: 0, measured: 0, total: acceptedFiles.length });\n      const chunks = chunk(acceptedFiles, UPLOAD_IMAGES_CHUNK_SIZE);\n\n      Promise.all(\n        chunks.map(async chunkAcceptedFiles =>\n          onChunkUpload({\n            id: visitId,\n            data: chunkAcceptedFiles,\n            meta: await Promise.all(\n              chunkAcceptedFiles.map(file =>\n                measureImage(file).finally(() =>\n                  setProgress(prevProgress => ({\n                    ...prevProgress,\n                    measured: (prevProgress?.measured ?? 0) + 1,\n                  })),\n                ),\n              ),\n            ),\n            isAsset: true,\n          })\n            .finally(() =>\n              setProgress(prevProgress => ({\n                ...prevProgress,\n                uploaded:\n                  (prevProgress?.uploaded ?? 0) + UPLOAD_IMAGES_CHUNK_SIZE,\n              })),\n            )\n            .catch(() => {}),\n        ),\n      ).finally(() => {\n        setProgress(null);\n        onUploadComplete();\n      });\n    },\n    [onChunkUpload],\n  );\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    isDragAccept,\n    isDragReject,\n  } = useDropzone({\n    accept: 'image/jpeg, image/png',\n    disabled: isUploadInProgress,\n    onDrop: handleSubmitPhotos,\n    maxSize: UPLOAD_IMAGE_MAX_SIZE,\n    minSize: UPLOAD_IMAGE_MIN_SIZE,\n    maxFiles: UPLOAD_MAX_IMAGES,\n  });\n\n  return (\n    <div\n      {...getRootProps()}\n      className={cls({\n        [classes.dropzoneStandby]: !isDragActive,\n        [classes.dropzoneActive]: isDragActive,\n        [classes.dropzoneAccept]: isDragAccept,\n        [classes.dropzoneReject]: isDragReject,\n      })}\n    >\n      <div\n        className={cls(classes.dropzoneContainer, {\n          [classes.dropzoneUpload]: isUploadInProgress,\n        })}\n      >\n        <input {...getInputProps()} />\n        {renderDropzoneCaption({ isDragActive, progress })}\n        {rejectedFiles.length > 0 && (\n          <div>\n            Не удалось загрузить следующие файлы:\n            {rejectedFiles.map(rejectedFile => (\n              <div key={rejectedFile.path}>{renderFile(rejectedFile)}</div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction renderDropzoneCaption({ isDragActive, progress }) {\n  switch (true) {\n    case progress !== null: {\n      const { total, measured, uploaded } = progress;\n      return `Идет загрузка, пожалуйста не закрывайте браузер. Загружено/Подготовлено/Всего: ${uploaded}/${measured}/${total}`;\n    }\n    case isDragActive:\n      return 'Загрузить фотографии';\n    default:\n      return 'Перенесите сюда фотографии для загрузки или кликните, что-бы выбрать файлы';\n  }\n}\n\nfunction renderFile({ file, errors }) {\n  const errorsMessage = errors.map(({ message }) => message).join(', ');\n  return `${file.path} - ${file.size} bytes, reason: ${errorsMessage}`;\n}\n\nfunction getImageData(image) {\n  const canvas = document.createElement('canvas');\n  canvas.width = image.width;\n  canvas.height = image.height;\n  const context = canvas.getContext('2d');\n  context.drawImage(image, 0, 0);\n  return context.getImageData(0, 0, image.width, image.height);\n}\n\nfunction gcd(a, b) {\n  let v1 = Math.abs(a);\n  let v2 = Math.abs(b);\n  let temp = v1;\n\n  if (v2 > v1) {\n    temp = v1;\n    v1 = v2;\n    v2 = temp;\n  }\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    if (v2 === 0) {\n      return a;\n    }\n    v1 %= v2;\n    if (v1 === 0) {\n      return b;\n    }\n    v2 %= v1;\n  }\n}\n\nasync function measureImage(fileImage) {\n  return new Promise(resolve => {\n    const imageURL = URL.createObjectURL(fileImage);\n\n    const image = new Image();\n\n    image.onload = () => {\n      const nod = gcd(image.width, image.height);\n      const [w, h] = nod\n        ? [image.width / nod, image.height / nod]\n        : [image.width, image.height];\n      try {\n        const imageData = getImageData(image);\n        calcBlurhashInWorker({\n          pixels: imageData.data,\n          width: imageData.width,\n          height: imageData.height,\n          componentX: 4,\n          componentY: 4,\n        }).then(blurhash => {\n          resolve({\n            aspect_ratio: `${w}:${h}`,\n            blurhash,\n          });\n        });\n      } catch (e) {\n        resolve({\n          aspect_ratio: `${w}:${h}`,\n          blurhash: null,\n        });\n      }\n    };\n\n    image.src = imageURL;\n  });\n}\n","import React from 'react';\nimport ConnectedLink from 'modules/components/muiExtended/ConnectedLink';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport {\n  useAddVisitPhotoRequest,\n  useTripsStats,\n  useVisit,\n} from 'travel/dataSource';\nimport VisitsArranger, {\n  PLAIN_FILTERING,\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n} from 'travel/components/VisitsArranger';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\nimport PhotosDropzone from './components/PhotosDropzone';\n\nconst domain = 'travel.VisitPage';\nexport default function VisitPage({\n  match: {\n    params: { userAlias, strVisitId, section },\n  },\n}) {\n  const {\n    isAuthenticated,\n    userAlias: authenticatedUserAlias,\n  } = useAuthContext();\n\n  const visitId = parseInt(strVisitId, 10);\n  const { isError, isPending, visit, invalidate } = useVisit({\n    domain,\n    userAlias,\n    visitId,\n  });\n  const tripsStatsProvision = useTripsStats({\n    domain,\n    userAlias,\n    tripsIds: visit?.tripId ? [visit.tripId] : [],\n  });\n\n  const { submitVisitPhoto } = useAddVisitPhotoRequest({\n    domain,\n    userAlias,\n    visitId,\n  });\n\n  const editable = isAuthenticated && authenticatedUserAlias === userAlias;\n  const urls = useVisitsUrls({ editable, userAlias, section });\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending) {\n    return <div>...Loading</div>;\n  }\n\n  if (!visit) {\n    return <div>...Не найдено посещение</div>;\n  }\n\n  return (\n    <>\n      <VisitsArranger\n        visitsList={[visit]}\n        provision={tripsStatsProvision}\n        groupsOrder={[PLAIN_GROUPS.JUST_VISITS]}\n        photosSectionLevel={0}\n        mapSectionLevel={0}\n        sortingOrder={[PLAIN_SORTING.LAST_VISIT]}\n        filteringOption={PLAIN_FILTERING.ANY}\n        isObscure={!editable}\n        urls={urls}\n        config={{ YearVisitsGroup: { hyperlinks: { year: false } } }}\n      >\n        {({ level, index, className }) =>\n          level === 0 &&\n          index === 0 && (\n            <>\n              <ConnectedLink\n                className={className}\n                variant=\"body2\"\n                to={urls.resolveTripUrl({ tripId: visit.tripId })}\n              >\n                вся поездка\n              </ConnectedLink>\n            </>\n          )\n        }\n      </VisitsArranger>\n      {editable && (\n        <PhotosDropzone\n          visit={visit}\n          userAlias={userAlias}\n          onChunkUpload={values =>\n            submitVisitPhoto(values, {\n              refetchPolicy: submitVisitPhoto.REFETCH_POLICY.SEQUENTIAL,\n            })\n          }\n          onUploadComplete={invalidate}\n        />\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#fff',\n  },\n}));\n\nexport default function BackdropLoader() {\n  const classes = useStyles();\n\n  return (\n    <Backdrop className={classes.backdrop} open={true}>\n      <CircularProgress color=\"inherit\" />\n    </Backdrop>\n  );\n}\n","import {\n  PLAIN_FILTERING,\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n} from 'travel/components/VisitsArranger';\n\n// GROUPPING\n\nexport const KEY_GROUP_VISITS_BY = 'group';\nexport const GROUP_VISITS_BY = {\n  LOCATIONS: 'loc',\n  COUNTRIES: 'c',\n  YEARS: 'yr',\n  YEARS_COUNTRIES: 'yr_c',\n  COUNTRIES_YEARS: 'c_yr',\n  TRIPS: 't',\n  TRIPS_COUNTRIES: 't_c',\n};\n\nexport const PLAIN_GROUPS_MAPPING = {\n  [GROUP_VISITS_BY.LOCATIONS]: PLAIN_GROUPS.LOCATIONS,\n  [GROUP_VISITS_BY.COUNTRIES]: PLAIN_GROUPS.COUNTRIES,\n  [GROUP_VISITS_BY.YEARS]: PLAIN_GROUPS.YEARS,\n  [GROUP_VISITS_BY.TRIPS]: PLAIN_GROUPS.TRIPS,\n};\n\n// SORTING\nexport const KEY_SORT_VISITS_BY = 'sort';\nexport const SORT_VISITS_BY = {\n  RATING_ALPHABET: 'r_a',\n  VISITS_ALPHABET: 'v_a',\n  FIRST_VISIT_ALPHABET: 'fv_a',\n  LAST_VISIT_ALPHABET: 'lv_a',\n  ALPHABET: 'a',\n};\nexport const SORT_VISITS_BY_DEFAULT = SORT_VISITS_BY.ALPHABET;\n\nexport const PLAIN_SORTING_MAPPING = {\n  a: PLAIN_SORTING.ALPHABET,\n  r: PLAIN_SORTING.RATING,\n  fv: PLAIN_SORTING.FIRST_VISIT,\n  lv: PLAIN_SORTING.LAST_VISIT,\n  v: PLAIN_SORTING.VISITS_COUNT,\n};\n\n// FILTERING\nexport const KEY_FILTER_VISITS_BY = 'filter';\nexport const FILTER_VISITS_BY = {\n  ANY: 'a',\n  FOREIGN: 'f',\n  DOMESTIC: 'd',\n};\nexport const FILTER_VISITS_BY_DEFAULT = FILTER_VISITS_BY.ANY;\n\nexport const PLAIN_FILTERING_MAPPING = {\n  [FILTER_VISITS_BY.ANY]: PLAIN_FILTERING.ANY,\n  [FILTER_VISITS_BY.FOREIGN]: PLAIN_FILTERING.FOREIGN,\n  [FILTER_VISITS_BY.DOMESTIC]: PLAIN_FILTERING.DOMESTIC,\n};\n","import { GROUP_VISITS_BY } from './sidebarConsts';\n\nexport const VISITS_SECTIONS = {\n  TRIPS: 'trips',\n  PLACES: 'places',\n};\nexport const VISITS_SECTION_DEFAULT = VISITS_SECTIONS.TRIPS;\nexport const VISITS_SECTIONS_GROUPS = {\n  [VISITS_SECTIONS.PLACES]: [\n    { key: GROUP_VISITS_BY.LOCATIONS, l10n: 'По городам' },\n    { key: GROUP_VISITS_BY.COUNTRIES, l10n: 'По странам' },\n    { key: GROUP_VISITS_BY.YEARS, l10n: 'По годам' },\n    { key: GROUP_VISITS_BY.YEARS_COUNTRIES, l10n: 'По годам и странам' },\n    { key: GROUP_VISITS_BY.COUNTRIES_YEARS, l10n: 'По странам и годам' },\n  ],\n  [VISITS_SECTIONS.TRIPS]: [\n    { key: GROUP_VISITS_BY.TRIPS, l10n: 'По поездкам' },\n    { key: GROUP_VISITS_BY.TRIPS_COUNTRIES, l10n: 'По поездкам и странам' },\n  ],\n};\n\nexport const GROUP_VISITS_BY_DEFAULTS = {\n  [VISITS_SECTIONS.PLACES]: GROUP_VISITS_BY.COUNTRIES,\n  [VISITS_SECTIONS.TRIPS]: GROUP_VISITS_BY.TRIPS,\n};\n\nexport const COMPARATORS = {\n  VISIT: { ARRIVAL_YEAR: 'ARRIVAL_YEAR' },\n  TRIP: {\n    DEPARTURE_TIME: 'TRIP_DEPARTURE_DATE',\n    ID: 'TRIP_ID',\n    PRESERVE_ORDER: 'PRESERVE_ORDER',\n  },\n  COUNTRY: {\n    VISITS: 'COUNTRY_VISITS',\n    RATING: 'COUNTRY_RATING',\n    NAME_ID: 'COUNTRY_NAME_ID',\n    FIRST_VISIT: 'COUNTRY_FIRST_VISIT',\n    LAST_VISIT: 'COUNTRY_LAST_VISIT',\n  },\n  LOCATION: {\n    VISITS: 'LOCATION_VISITS',\n    RATING: 'LOCATION_RATING',\n    NAME_ID: 'LOCATION_NAME_ID',\n    FIRST_VISIT: 'LOCATION_FIRST_VISIT',\n    LAST_VISIT: 'LOCATION_LAST_VISIT',\n  },\n};\n\nexport const NODE_TYPE = {\n  ARRIVAL_LOCATION: 'ARRIVAL_LOCATION',\n  COUNTRY: 'COUNTRY',\n  DEPARTURE_LOCATION: 'DEPARTURE_LOCATION',\n  LOCATION: 'LOCATION',\n  TRIP: 'TRIP',\n  YEAR: 'YEAR',\n};\n","import React from 'react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useSidebar } from 'core/context/SidebarContext';\nimport {\n  VISITS_SECTION_DEFAULT,\n  VISITS_SECTIONS,\n  VISITS_SECTIONS_GROUPS,\n  GROUP_VISITS_BY_DEFAULTS,\n} from './consts';\nimport {\n  GROUP_VISITS_BY,\n  KEY_GROUP_VISITS_BY,\n  SORT_VISITS_BY,\n  KEY_SORT_VISITS_BY,\n  SORT_VISITS_BY_DEFAULT,\n  FILTER_VISITS_BY,\n  FILTER_VISITS_BY_DEFAULT,\n  KEY_FILTER_VISITS_BY,\n} from './sidebarConsts';\n\nconst useStyles = makeStyles({\n  formControl: {\n    width: '100%',\n  },\n});\n\nexport default function(setQueryFilter, queryFilter, section) {\n  const classes = useStyles();\n\n  const {\n    [KEY_GROUP_VISITS_BY]: groupByQuery,\n    [KEY_SORT_VISITS_BY]: sortByQuery,\n    [KEY_FILTER_VISITS_BY]: filterByQuery,\n  } = queryFilter || {};\n\n  const sortBy = resolveActualSortBy(sortByQuery);\n  const filterBy = resolveActualFilterBy(filterByQuery);\n  const [groupBy, visitsSectionGroups] = resolveActualGroupBy(\n    groupByQuery,\n    section,\n  );\n\n  useSidebar(\n    ({ closeSidebar }) => (\n      <List>\n        <ListItem>\n          <FormControl className={classes.formControl}>\n            <InputLabel shrink={true} id=\"select-groupBy-filter-label\">\n              Сгруппировать\n            </InputLabel>\n            <Select\n              labelId=\"select-groupBy-filter-label\"\n              autoWidth={true}\n              id=\"select-groupBy-filter\"\n              value={groupBy}\n              onChange={event => {\n                closeSidebar();\n                setQueryFilter({\n                  [KEY_GROUP_VISITS_BY]: event.target.value,\n                });\n              }}\n            >\n              {visitsSectionGroups.map(visitsSectionGroup => (\n                <MenuItem\n                  key={visitsSectionGroup.key}\n                  value={visitsSectionGroup.key}\n                >\n                  {visitsSectionGroup.l10n}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </ListItem>\n        {groupBy !== GROUP_VISITS_BY.TRIPS && (\n          <ListItem>\n            <FormControl className={classes.formControl}>\n              <InputLabel shrink={true} id=\"select-sortBy-filter-label\">\n                Сортировать\n              </InputLabel>\n              <Select\n                labelId=\"select-sortBy-filter-label\"\n                autoWidth={true}\n                id=\"select-sortBy-filter\"\n                value={sortBy}\n                onChange={event => {\n                  closeSidebar();\n                  setQueryFilter({\n                    [KEY_SORT_VISITS_BY]: event.target.value,\n                  });\n                }}\n              >\n                <MenuItem value={SORT_VISITS_BY.ALPHABET}>По алфавиту</MenuItem>\n                <MenuItem value={SORT_VISITS_BY.VISITS_ALPHABET}>\n                  По числу посещений\n                </MenuItem>\n                <MenuItem value={SORT_VISITS_BY.FIRST_VISIT_ALPHABET}>\n                  По первому посещению\n                </MenuItem>\n                <MenuItem value={SORT_VISITS_BY.LAST_VISIT_ALPHABET}>\n                  По последнему посещению\n                </MenuItem>\n                <MenuItem value={SORT_VISITS_BY.RATING_ALPHABET}>\n                  По рейтингу\n                </MenuItem>\n              </Select>\n            </FormControl>\n          </ListItem>\n        )}\n        <ListItem>\n          <FormControl className={classes.formControl}>\n            <InputLabel shrink={true} id=\"select-filterBy-filter-label\">\n              Фильтровать\n            </InputLabel>\n            <Select\n              labelId=\"select-filterBy-filter-label\"\n              autoWidth={true}\n              id=\"select-filterBy-filter\"\n              value={filterBy}\n              onChange={event => {\n                closeSidebar();\n                setQueryFilter({\n                  [KEY_FILTER_VISITS_BY]: event.target.value,\n                });\n              }}\n            >\n              <MenuItem value={FILTER_VISITS_BY.ANY}>Показать все</MenuItem>\n              <MenuItem value={FILTER_VISITS_BY.FOREIGN}>\n                Только зарубежные\n              </MenuItem>\n              <MenuItem value={FILTER_VISITS_BY.DOMESTIC}>\n                Только местные\n              </MenuItem>\n            </Select>\n          </FormControl>\n        </ListItem>\n      </List>\n    ),\n    [groupBy, sortBy, filterBy],\n  );\n\n  return { groupBy, sortBy, filterBy };\n}\n\nfunction resolveActualSortBy(sortByQuery) {\n  return Object.values(SORT_VISITS_BY).includes(sortByQuery)\n    ? sortByQuery\n    : SORT_VISITS_BY_DEFAULT;\n}\n\nfunction resolveActualFilterBy(filterByQuery) {\n  return Object.values(FILTER_VISITS_BY).includes(filterByQuery)\n    ? filterByQuery\n    : FILTER_VISITS_BY_DEFAULT;\n}\n\nfunction resolveActualGroupBy(groupByQuery, section) {\n  const actualSection = Object.values(VISITS_SECTIONS).includes(section)\n    ? section\n    : VISITS_SECTION_DEFAULT;\n  const visitsSectionGroups = VISITS_SECTIONS_GROUPS[actualSection] || [];\n  const groupBy = visitsSectionGroups.find(({ key }) => key === groupByQuery)\n    ? groupByQuery\n    : GROUP_VISITS_BY_DEFAULTS[actualSection];\n  return [groupBy, visitsSectionGroups];\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\nimport IconButton from '@material-ui/core/IconButton';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport * as locators from '../../locators';\n\nexport default function renderTitle({\n  tripCreateUrl,\n  locationsUrl,\n  stats: {\n    locationsStats: { total: locationsCount },\n    countriesStats: { total: countriesCount },\n    // daysTravellingStats: { totalStay },\n  },\n}) {\n  return (\n    <Typography variant=\"h6\" paragraph={true}>\n      <span>Всего </span>\n      <MUILink to={locationsUrl} component={Link}>\n        {`${locationsCount} городов `}\n      </MUILink>\n      <span>из </span>\n      <span>{`${countriesCount} стран`}</span>\n      {/* <span>{`В путешествии ${totalStay} дней`}</span> */}\n      {tripCreateUrl ? (\n        <IconButton\n          component={Link}\n          to={tripCreateUrl}\n          data-locator={locators.ADD_TRIP_BUTTON}\n        >\n          <AddCircleIcon />\n        </IconButton>\n      ) : null}\n    </Typography>\n  );\n}\n","export const ADD_TRIP_BUTTON = 'ADD_TRIP_BUTTON';\n","import { PLAIN_GROUPS } from 'travel/components/VisitsArranger';\nimport { PLAIN_GROUPS_MAPPING } from './sidebarConsts';\n\nexport default function resolveGroupsOrder(groupBy) {\n  const groupingOrder = groupBy\n    .split('_')\n    .map(currentGroupBy => PLAIN_GROUPS_MAPPING[currentGroupBy]);\n\n  const shouldShowVisits = groupingOrder.includes(PLAIN_GROUPS.TRIPS);\n  const lastGroup = groupingOrder[groupingOrder.length - 1];\n\n  if (!shouldShowVisits && lastGroup !== PLAIN_GROUPS.LOCATIONS) {\n    groupingOrder.push(PLAIN_GROUPS.LOCATIONS);\n  }\n  if (shouldShowVisits) {\n    groupingOrder.push(PLAIN_GROUPS.JUST_VISITS);\n  }\n  return groupingOrder;\n}\n","import { PLAIN_SORTING_MAPPING } from './sidebarConsts';\n\nexport default function resolveSortingOrder(sortBy) {\n  return sortBy\n    .split('_')\n    .map(currentSortBy => PLAIN_SORTING_MAPPING[currentSortBy]);\n}\n","import { PLAIN_FILTERING_MAPPING } from './sidebarConsts';\n\nexport default function resolveFiltering(filterBy) {\n  return PLAIN_FILTERING_MAPPING[filterBy];\n}\n","import React from 'react';\nimport { useTripsStats } from 'travel/dataSource';\nimport BackdropLoader from 'modules/components/loaders/BackdropLoader';\nimport { useQueryFilter } from 'core/context/QueryFilterContext';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport useVisitsGroupingSidebar from './useVisitsGroupingSidebar';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\nimport { GROUP_VISITS_BY } from 'travel/pages/VisitsPage/sidebarConsts';\nimport VisitsArranger, {\n  calcStats,\n  PLAIN_SORTING,\n} from 'travel/components/VisitsArranger';\nimport VisitsTitle from './components/VisitsTitle';\nimport resolveGroupsOrder from './resolveGroupsOrder';\nimport resolveSortingOrder from './resolveSortingOrder';\nimport resolveFiltering from './resolveFiltering';\n\nexport default function VisitsPage({\n  match: {\n    params: { userAlias, section },\n  },\n}) {\n  const { userAlias: authenticatedUserAlias } = useAuthContext();\n  const editable = userAlias === authenticatedUserAlias;\n  const isObscure = userAlias !== authenticatedUserAlias;\n\n  const { queryFilter, setQueryFilter } = useQueryFilter();\n  const { groupBy, sortBy, filterBy } = useVisitsGroupingSidebar(\n    setQueryFilter,\n    queryFilter,\n    section,\n  );\n\n  const provision = useTripsStats({ userAlias });\n  const { isPending, isError } = provision;\n\n  const urls = useVisitsUrls({ editable, userAlias, section });\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending) {\n    return <BackdropLoader />;\n  }\n\n  const { visitsIds, visitsDict } = provision;\n  const visitsList = visitsIds.map(visitId => visitsDict[visitId]);\n\n  const commonVisitsGroup = { visitsList, parent: null, field: null };\n  const totalStats = calcStats(commonVisitsGroup, provision);\n\n  return (\n    <>\n      <VisitsTitle\n        locationsUrl={urls.locationsUrl}\n        tripCreateUrl={urls.tripCreateUrl}\n        stats={totalStats}\n      />\n      <VisitsArranger\n        visitsList={visitsList}\n        provision={provision}\n        groupsOrder={resolveGroupsOrder(groupBy)}\n        sortingOrder={\n          section === 'trips'\n            ? [PLAIN_SORTING.LAST_VISIT]\n            : resolveSortingOrder(sortBy)\n        }\n        filteringOption={resolveFiltering(filterBy)}\n        adaptTopHeaderSize={true}\n        isObscure={isObscure}\n        urls={urls}\n        virtualize={true}\n        mapSectionLevel={groupBy === GROUP_VISITS_BY.LOCATIONS ? -1 : 1}\n        photosSectionLevel={0}\n        config={{\n          collapsible: groupBy !== GROUP_VISITS_BY.LOCATIONS,\n        }}\n      />\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport MUILink from '@material-ui/core/Link';\nimport { useAuthContext } from 'core/context/AuthContext';\nimport useVisitsUrls from 'travel/utils/useVisitsUrls';\nimport VisitsArranger, {\n  PLAIN_GROUPS,\n  PLAIN_SORTING,\n  PLAIN_FILTERING,\n} from 'travel/components/VisitsArranger';\nimport useYearWithTripStats from './useYearWithTripStats';\n\nconst domain = 'travel.LocationPage';\nexport default function YearPage({\n  match: {\n    params: { userAlias, strYear, section },\n  },\n}) {\n  const [alsoGroupByCountries, setAlsoGroupByCountries] = useState(false);\n\n  const { userAlias: authenticatedUserAlias } = useAuthContext();\n\n  const editable = userAlias === authenticatedUserAlias;\n  const isObscure = userAlias !== authenticatedUserAlias;\n\n  const urls = useVisitsUrls({ editable, userAlias, section });\n\n  const year = parseInt(strYear, 10);\n\n  const {\n    provision,\n    provision: { isError, isPending, isReady },\n    visitsList,\n  } = useYearWithTripStats({ domain, userAlias, year });\n\n  if (isError) {\n    return <div>...Error</div>;\n  }\n  if (isPending || !isReady) {\n    return <div>...Loading</div>;\n  }\n\n  if (!visitsList.length) {\n    return (\n      <Typography variant=\"h2\" component=\"span\">\n        {year}\n      </Typography>\n    );\n  }\n  return (\n    <VisitsArranger\n      visitsList={visitsList}\n      provision={provision}\n      groupsOrder={[\n        PLAIN_GROUPS.YEARS,\n        alsoGroupByCountries && PLAIN_GROUPS.COUNTRIES,\n        PLAIN_GROUPS.JUST_VISITS,\n      ].filter(Boolean)}\n      photosSectionLevel={1}\n      mapSectionLevel={0}\n      sortingOrder={[PLAIN_SORTING.LAST_VISIT]}\n      filteringOption={PLAIN_FILTERING.ANY}\n      isObscure={isObscure}\n      urls={urls}\n      config={{ YearVisitsGroup: { hyperlinks: { year: false } } }}\n    >\n      {({ level, index }) =>\n        level === 0 &&\n        index === 0 && (\n          <>\n            <MUILink\n              variant=\"body2\"\n              onClick={() =>\n                setAlsoGroupByCountries(\n                  prevAlsoGroupByCountries => !prevAlsoGroupByCountries,\n                )\n              }\n            >\n              {alsoGroupByCountries\n                ? 'Убрать группировку по странам'\n                : 'Сгруппировать по странам'}\n            </MUILink>\n          </>\n        )\n      }\n    </VisitsArranger>\n  );\n}\n","import { useTripsStats } from 'travel/dataSource/useTrips';\n\nexport default function useYearWithTripStats({ userAlias, year }) {\n  const provision = useTripsStats({\n    userAlias,\n  });\n\n  const { visitsDict, visitsIds } = provision;\n\n  const visitsList = visitsIds\n    .map(visitId => visitsDict[visitId])\n    .filter(({ arrivalYear }) => year === arrivalYear);\n\n  return {\n    provision,\n    visitsList,\n  };\n}\n","import { useMemo } from 'react';\nimport { usePaths } from 'modules/packages';\n\nexport default function useVisitsUrls({ editable, userAlias, section }) {\n  const { travel: travelPaths } = usePaths();\n\n  return useMemo(\n    () => ({\n      hyperlinks: () => {},\n      locationsUrl: travelPaths.locations.toUrl({ userAlias, section }),\n      tripCreateUrl: editable\n        ? travelPaths.tripCreate.toUrl({ userAlias })\n        : null,\n      resolveLocationUrl: ({ locationId }) =>\n        travelPaths.location.toUrl({\n          userAlias,\n          section,\n          strLocationId: String(locationId),\n        }),\n      resolveCountryUrl: ({ countryId }) =>\n        travelPaths.country.toUrl({\n          userAlias,\n          section,\n          strCountryId: String(countryId),\n        }),\n      resolveYearUrl: ({ year }) =>\n        year\n          ? travelPaths.year.toUrl({\n              userAlias,\n              section,\n              strYear: String(year),\n            })\n          : null,\n      resolveTripEditUrl: ({ tripId }) =>\n        editable\n          ? travelPaths.tripEdit.toUrl({\n              strTripId: String(tripId),\n              userAlias,\n            })\n          : null,\n      resolveTripUrl: ({ tripId }) =>\n        travelPaths.trip.toUrl({\n          strTripId: String(tripId),\n          userAlias,\n        }),\n      resolveVisitUrl: ({ visitId }) =>\n        travelPaths.visit.toUrl({\n          userAlias,\n          section,\n          strVisitId: String(visitId),\n        }),\n    }),\n    [editable, travelPaths],\n  );\n}\n"],"names":["ConnectedLink","optional","children","forwardingProps","Boolean","href","to","onClick","component","RouterLink","defaultProps","DATE_FORMATS","dateTimePeriodToString","periodStart","periodEnd","isObscure","fullFormat","periodEndString","dateFormat","locale","ru","isSameDay","periodStartString","isSameMonth","isSameYear","shortFormat","rideDateTimePeriodToString","departureDateTime","arrivalDateTime","visitDateTimePeriodToString","dateTimeOpenPeriodToString","placeholder","format","startDateStr","RideIcon","vehicleType","ride","className","IconComponent","VEHICLE_TYPES","CarIcon","TrainIcon","FlightIcon","BusIcon","VanIcon","BoatIcon","BikeIcon","WalkIcon","MotorcycleIcon","TruckIcon","TerrainIcon","TramIcon","LocalTaxiIcon","SubwayIcon","SeatIcon","CustomTransportIcon","UnknownRideIcon","resolveRideIconComponent","useStyles","makeStyles","icon","color","fontSize","height","absoluteIcon","position","detail","RideInfo","rideType","isLong","classes","RIDE_TYPES","CountryVisitsGroup","countryId","visitsGroup","field","value","countriesDict","provision","urls","config","hyperlinks","country","countryHyperlink","CountryInfo","container","countryUrl","resolveCountryUrl","variant","countryName","display","header","findClosestGroupValue","plainGroup","currentVisitsGroup","parent","findClosestGroup","LocationVisitsGroup","locationIdStr","locationsDict","appearance","location","locationHyperlink","groupCountryId","PLAIN_GROUPS","COUNTRIES","locationId","locationUrl","resolveLocationUrl","LocationInfo","showCountry","locationName","countryAppearance","countryNode","locationNode","YearInfo","year","yearUrl","undefined","useVisibleOnHoverStyles","containerClassName","contentClassName","visibility","makeVisibleOnHoverStyles","TripInfo","trip","visitsDict","hoverTrigger","visibleOnHover","tripEditUrl","resolveTripEditUrl","tripId","Typography","cls","paragraph","resolveTripCaption","IconButton","Edit","autoMargin","marginLeft","AutoMargin","childrenArray","React","length","lastChildren","slice","restChildren","Grid","justify","alignItems","item","halfDown","top","LocationWithRideInfo","rideId","ridesDict","locationInfoChildren","ownClasses","locationContainer","editButton","left","VisitInfo","visit","visitId","departureRideId","visitUrl","resolveVisitUrl","Link","Event","placeDetails","marginRight","LOCATIONS","YEARS","TRIPS","JUST_VISITS","PLAIN_GROUPS_CONFIG","groupFieldName","tripsDict","key","adapter","Number","getFullYear","YearVisitsGroup","yearHyperlink","resolveYearUrl","visitsList","VisitsItselfGroup","locationAppearance","groupTripId","groupLocationId","actualVisitsList","useMemo","uniqBy","map","level","originLocationId","originLocation","groupVisitsBy","name","Object","entries","groupByFn","groupFieldValue","groupVisitsList","isFunction","groupVisitsByValue","createCalcByYearUtils","lookupKey","memoizedCalcOldies","memoizeOne","memoize","values","reduce","acc","entityId","arrivalYear","add","Set","calcOldies","calcTotal","total","size","calcByYear","oldies","freshies","newbies","difference","totalAtYear","newAtYear","calcDaysTravellingStats","considerRides","visitToPeriodMapper","startDate","endDate","arrivalRideId","arrivalRide","prevVisitId","departureVisitId","rideStartDate","departureRide","nextVisitId","arrivalVisitId","rideEndDate","stack","createMapperWithRides","simpleMapper","visitsPeriods","detailedStats","createPeriods","toArray","visitsIds","stay","differenceInCalendarDays","push","totalStay","calcStats","visitsStats","calcVisitsStats","countriesStats","calcCountriesStats","locationsStats","calcLocationsStats","daysTravellingStats","includes","calcCountriesTotal","calcCountriesByYear","calcLocationsTotal","calcLocationsByYear","visitsCount","firstVisit","minBy","lastVisit","maxBy","statsIndicator","marginRLeft","StatsIndicator","hint","contentNode","Tooltip","title","CountriesStats","showByYear","hintNode","renderHint","detailsNode","renderDetails","Flag","String","LocationStats","Place","DaysTravellingStats","Timelapse","totalStr","periodStr","locationsStr","renderLocations","index","join","StatsPanel","stats","countriesStatsAppearance","LocationsStats","locationStatsAppearance","daysTravellingStatsAppearance","isLocationGroup","hasCountryGroup","hasLocationGroup","hasYearGroup","daysTravellingStatsNode","visibleOnlyOnHover","has","isNewbieCountry","yearVisitsGroup","countriesVisitsGroup","countryLocationStats","isNewbieLocation","isNewbie","FiberNew","PLAIN_SORTING","ALPHABET","RATING","FIRST_VISIT","LAST_VISIT","VISITS_COUNT","sortVisitsBy","visitsGroups","sortingOrder","comparators","flatMap","plainSorting","dates","iteratee","nullsLast","order","locationsRating","createRatingComparator","createAlphabetComparator","some","property","orderBy","current","withOrder","sortBy","resolve","iterateeFn","valueOf","ExpandableActions","onExpand","onExpandAll","diffCount","Expandable","collapsible","originalItems","items","alwaysExpandedItemsCount","collapsibleThreshold","useState","collapsed","setCollapsed","actualCollapsed","actualItems","actions","event","rectReducer","state","action","rect","width","calculateRange","prevRange","measurements","outerSize","scrollOffset","start","low","high","getCurrentValue","middle","currentValue","findNearestBinarySearch","end","defaultEstimateSize","defaultKeyExtractor","useVirtual","estimateSize","overscan","paddingStart","paddingEnd","parentRef","keyExtractor","dispatch","useLayoutEffect","window","innerHeight","innerWidth","useEffect","resizeHandler","addEventListener","removeEventListener","useRect","latestRef","totalSize","measuredCache","setMeasuredCache","x","updDep","measure","pendingMeasuredCacheIndexesRef","min","Math","i","measuredSize","range","setRange","rangeTimeoutIdRef","cancelAsyncRange","clearTimeout","setTimeout","onScroll","getBoundingClientRect","scrollOffsetFn","capture","passive","useRange","virtualItems","indexes","max","arr","defaultRangeExtractor","k","len","measureRef","el","offsetHeight","defaultScrollToFn","old","mountedRef","scrollToOffset","toOffset","align","tryScrollToIndex","rest","measurement","scrollToIndex","args","requestAnimationFrame","offset","scrollY","forwardRef","ref","useRef","useImperativeHandle","style","virtualItem","transform","noop","bypass","Component","BypassVirtualized","Virtualized","LazyWithPlaceholder","loaded","setLoaded","handleVisible","useCallback","LazyLoad","onContentVisible","CENTER","zoom","backgroundPosition","backgroundRepeat","bottom","right","margin","padding","opacity","transition","zoomButton","zIndex","zoomIcon","zoomed","ensuredForwardRef","alt","src","onSwipeLock","touchscreen","matchMedia","matches","zoomable","setZoomable","setZoomed","setBackgroundPosition","containerRef","handleAnyZoom","nativeEvent","containerTop","containerLeft","originalWidth","originalHeight","offsetX","clientX","touches","offsetY","clientY","extendable","naturalWidth","naturalHeight","notEnoughWidth","asPercent","y","ZoomIcon","ZoomOutIcon","ZoomInIcon","imgNode","backgroundImage","onMouseMove","onTouchMove","type","prevZoomed","ErrorBoundary","props","hasError","error","errorInfo","warning","message","lastReactError","this","LOADING_STATE","LazyImage","aspectRatio","ImageComponent","require","tag","blurhash","constraints","onLoad","loadingState","setLoadingState","handleError","imgRef","handleLoad","hasResult","imageHeight","imageWidth","heightConstraint","widthConstraint","resolveImageSize","realImgWidth","setRealImgWidth","hash","resolutionX","resolutionY","punch","resolveActualSrc","maxWidth","onError","loading","imageSkeleton","flexGrow","thumbsContainer","overflow","thumbSkeleton","GallerySkeleton","thumbsCount","ceil","Skeleton","times","theme","drawer","FullscreenFallback","fullscreen","uniqKey","inlineGalleryRef","portalGalleryRef","element","document","createElement","id","body","append","remove","setState","isFullscreen","modalFullscreen","ReactDOM","additionalClass","getElementById","FULLSCREEN_ENABLED","fullscreenEnabled","mozFullScreenEnabled","documentElement","webkitRequestFullScreen","photoContainer","minHeight","overflowY","scrollbarWidth","photo","PhotosGallery","photos","uuidV4","mobile","useMediaQuery","breakpoints","down","swipeLock","setSwipeLock","useLayoutContext","vw","vh","setFullscreen","aspectRatios","setAspectRatios","currentIndex","setCurrentIndex","RATIOS","FULLSCREEN","DEFAULT","HEIGHT","WIDTH","calc","CONFIG","unit","PERCENT","MAX_PX","resolveImageConstraints","thumbnailElement","querySelector","closest","scrollIntoView","block","behavior","actualPhotos","fullSizePhotoUrl","thumbnailUrl","previewUrl","description","original","originalClass","thumbnail","showThumbnails","galleryRef","imageGalleryNode","useBrowserFullscreen","startIndex","disableSwipe","showIndex","thumbnailPosition","onScreenChange","nextFullscreen","onBeforeSlide","nextIndex","disableKeyDown","disableThumbnailScroll","renderItem","zoomableItem","ZoomableImage","originalAlt","originalTitle","abs","ratio","renderThumbInner","thumbnailAlt","thumbnailTitle","prevRatios","Infinity","VisitsPhotosGallery","visitPhotos","renderDescription","result","lineHeight","visitContainer","mapVisibilityToggle","cursor","googleMapContainer","maxHeight","VisitsLocationsMap","onToggle","mapVisible","setMapVisible","locationsIds","uniq","frRef","prevMapVisible","LocationsMap","mapContainer","scaleBy","MARKERS_SCALES","ratingLevel","VisitGroup","showMap","showPhotos","VisitsGroupComponent","onHeightChange","customNode","Fragment","nextLevel","PLAIN_FILTERING","ANY","FOREIGN","DOMESTIC","isVisitExist","noMarginTop","link","header0","typography","h2","wordBreak","container0","marginTop","level0","header1","h4","container1","marginBottom","level1","up","paddingLeft","header2","body1","container2","level2","VisitsArranger","groupsOrder","filteringOption","allowCollapsible","adaptTopHeaderSize","mapSectionLevel","photosSectionLevel","virtualize","filter","isForeign","originCountryId","createFilterBasedOnOrigin","switchFilteringFn","virtualizerRef","virtualized","onToggleCollapsible","setCollapsible","disableCollapsible","useCollapsible","renderRecursive","parentVisitsGroup","groupsOrderInternal","restGroupsOrder","visitsListInternal","nestingLevel","lookupNestingLevel","expectedMaxLevel","sectionLevel","clamp","MAX_LEVEL","lookupSectionLevel","actualPhotosSectionLevel","actualMapSectionLevel","sortedVisitsGroups","enhancedVisitsGroup","bypassVirtualization","actualVisitsGroups","Virtualizer","resolveVisitsGroupClasses","isFirstChild","array","maxLength","separator","uniqArray","FALLBACK","visits","tripName","hasAutogeneratedTripName","dateMin","visitsId","dateMax","visitsByCountries","keys","groupBy","visitType","VISIT_TYPES","locationsNames","uniqTrimAndJoin","countriesNames","CountryPage","match","params","userAlias","strCountryId","section","alsoGroupByYears","setAlsoGroupByYears","authenticatedUserAlias","useAuthContext","useVisitsUrls","editable","tripsProvision","useTripsStats","countriesIds","isVisited","useCountryWithTripStats","parseInt","isError","isPending","isReady","prevAlsoGroupByYears","RATING_LOCALIZATION","LOCATION_RATING","formControl","LocationRating","locationRating","isEditable","onSubmitLocationRating","rating","setRating","handleChangeRating","nextRating","target","Rating","readOnly","ratingToStars","precision","Box","ml","FormControl","InputLabel","shrink","Select","labelId","onChange","ratingOption","MenuItem","useLocationWithTripStats","domain","tripsStatsProvision","isTripsError","isTripsPending","isTripsReady","useSelector","selectItem","useProvision","isProvision","modelName","observe","condition","query","useLocation","restProvision","submitLocationRating","useLocationRatingRequest","LocationPage","strLocationId","isAuthenticated","userProvision","handleSubmitLocationRating","locationIdToSubmit","invalidate","fontWeight","LocationsPage","useUserLocations","actualLocationsIds","locationsIdToRender","TripPage","strTripId","alsoGroupByCountries","setAlsoGroupByCountries","tripsIds","tripVisitsIds","tripVisitsId","prevAlsoGroupByCountries","hexToRgba","hex","alpha","exec","rgba","r","g","b","a","backgroundColor","STRIPLES_SHIFT_PX","cos","degree","PI","makeStriplesBackground","actualColor","background","backgroundSize","listeners","worker","Worker","URL","calcBlurhashInWorker","pixels","componentX","componentY","uniqId","Promise","listen","data","receivedPayload","payload","postMessage","then","encode","onmessage","forEach","listener","dropzoneContainer","flexDirection","justifyContent","dropzoneStandby","border","palette","primary","dark","borderRadius","light","borderColor","disabled","main","animation","dropzoneActive","secondary","dropzoneAccept","dropzoneReject","dropzoneUpload","backgroundPositionX","PhotosDropzone","onChunkUpload","onUploadComplete","progress","setProgress","rejectedFiles","setRejectedFiles","isUploadInProgress","handleSubmitPhotos","acceptedFiles","currentRejectedFiles","uploaded","measured","chunks","chunk","all","chunkAcceptedFiles","file","measureImage","prevProgress","meta","isAsset","useDropzone","accept","onDrop","maxSize","minSize","maxFiles","getRootProps","getInputProps","isDragActive","isDragAccept","isDragReject","renderDropzoneCaption","rejectedFile","path","errorsMessage","errors","getImageData","image","canvas","context","getContext","drawImage","gcd","v1","v2","temp","fileImage","imageURL","createObjectURL","Image","onload","nod","w","h","imageData","aspect_ratio","e","VisitPage","strVisitId","useVisit","submitVisitPhoto","useAddVisitPhotoRequest","resolveTripUrl","refetchPolicy","REFETCH_POLICY","SEQUENTIAL","backdrop","BackdropLoader","Backdrop","open","CircularProgress","GROUP_VISITS_BY","PLAIN_GROUPS_MAPPING","SORT_VISITS_BY","RATING_ALPHABET","VISITS_ALPHABET","FIRST_VISIT_ALPHABET","LAST_VISIT_ALPHABET","SORT_VISITS_BY_DEFAULT","PLAIN_SORTING_MAPPING","fv","lv","v","FILTER_VISITS_BY","FILTER_VISITS_BY_DEFAULT","PLAIN_FILTERING_MAPPING","VISITS_SECTIONS","PLACES","VISITS_SECTION_DEFAULT","VISITS_SECTIONS_GROUPS","l10n","GROUP_VISITS_BY_DEFAULTS","setQueryFilter","queryFilter","groupByQuery","sortByQuery","filterByQuery","resolveActualSortBy","filterBy","resolveActualFilterBy","actualSection","visitsSectionGroups","find","resolveActualGroupBy","useSidebar","closeSidebar","List","ListItem","autoWidth","visitsSectionGroup","renderTitle","tripCreateUrl","locationsUrl","locationsCount","countriesCount","AddCircle","resolveGroupsOrder","groupingOrder","split","currentGroupBy","shouldShowVisits","lastGroup","resolveSortingOrder","currentSortBy","resolveFiltering","VisitsPage","useQueryFilter","useVisitsGroupingSidebar","commonVisitsGroup","totalStats","YearPage","strYear","useYearWithTripStats","travelPaths","usePaths","travel","locations","toUrl","tripCreate","tripEdit"],"sourceRoot":""}