(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1080:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(2),o=r.n(a),l=r(827),c=r(130),s=r(808),u=r(313),p=r(783),d=r(1e3),m=r(1069),f=r(1070),v=r(1083),b=r(1086),O=r(9),E=r(1087),g=r(1066),y=r(1068),h=r(1082),I=function(e){var t=e.caption,r=e.classes,n=e.hasNullOption,a=e.inputId,o=e.name,l=e.onChange,c=e.optionRender,s=e.options,u=e.value;return i.a.createElement("div",{className:r.container},i.a.createElement(E.a,{component:"label",shrink:!0,htmlFor:a},t),i.a.createElement(h.a,{name:o,value:u,displayEmpty:!0,onChange:l,input:i.a.createElement(g.a,{id:a}),className:r.selectRoot},n&&i.a.createElement(y.a,{key:null,value:null},c({option:null,index:-1,options:s})),s.map((function(e,t){return i.a.createElement(y.a,{key:e,value:e},c({option:e,index:t,options:s}))}))))},j=o.a.oneOfType([o.a.number,o.a.string]);I.propTypes={name:o.a.string,caption:o.a.string.isRequired,classes:o.a.objectOf(o.a.string).isRequired,hasNullOption:o.a.bool,inputId:o.a.string.isRequired,onChange:o.a.func.isRequired,optionRender:o.a.func,options:o.a.arrayOf(j),value:j},I.defaultProps={name:void 0,hasNullOption:!0,optionRender:function(e){return e.option||""},options:[],value:void 0};var P=Object(O.a)({container:{display:"block"},selectRoot:{display:"block"}})(I),T=r(1051),S=r(790),C=r(789);function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function w(e){var t=e.isHighlighted,r=e.isSelected,n=e.option,a=D(e,["isHighlighted","isSelected","option"]);return i.a.createElement(y.a,R({component:"div",selected:t,style:{fontWeight:r?500:400}},a),i.a.createElement(C.a,{primary:n.label,secondary:n.details}))}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function A(e){var t=e.isOpen,r=e.options,n=e.classes,a=e.getMenuProps,o=e.getItemProps,l=e.selectedItem,c=e.highlightedIndex;return i.a.createElement("div",a(),t&&i.a.createElement(S.a,{className:n.paper,square:!0},r.map((function(e,t){return i.a.createElement(w,N({key:e.label},o({item:e}),{isHighlighted:c===t,isSelected:Boolean(l)&&l.label===e.label,option:e}))}))))}function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t=e.classes,r=e.triggerProps,n=e.triggerInputProps;return i.a.createElement(b.a,V({InputProps:x({classes:{root:t.inputRoot,input:t.inputInput}},n),fullWidth:!0,classes:t},r))}function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var M=Object(p.a)((function(e){return{root:{},container:{},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},inputRoot:{},inputInput:{}}})),q=function(e){return(e||{}).label};function U(e){var t=e.classes,r=e.options,n=e.inputProps,a=e.triggerProps,o=B(e,["classes","options","inputProps","triggerProps"]),l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},M(),{},t);return i.a.createElement("div",{className:l.root},i.a.createElement(T.a,Y({itemToString:q},o),(function(e){var t=e.getInputProps,o=e.getItemProps,c=e.getMenuProps,s=e.highlightedIndex,u=e.inputValue,p=e.isOpen,d=e.selectedItem;return i.a.createElement("div",{className:l.container},i.a.createElement(k,{classes:l,inputValue:u,triggerProps:a,triggerInputProps:t(n)}),i.a.createElement(A,{isOpen:p,options:r,classes:l,getMenuProps:c,getItemProps:o,selectedItem:d,highlightedIndex:s}))})))}var G=r(62),z=r(10),W=r(146);var K="FILTER",$="SEARCH";function J(e){var t,r,n,i=e.queryFormat,a=e.filterField,o=e.inputValue,l={pageSize:e.numberOfItemsToRequest};switch(i){case $:return{navigation:l,search:o};case K:default:return{navigation:l,filter:(t={},r=a,n={comparator:"~",value:"%".concat(o,"%")},r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t)}}}function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function re(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ne(e){var t=e.classes,r=e.inputProps,a=e.triggerProps,o=e.sourceProps,l=e.transformSuggestionToOption,c=void 0===l?function(e){return e}:l,s=re(e,["classes","inputProps","triggerProps","sourceProps","transformSuggestionToOption"]),u=te(Object(n.useState)(""),2),p=u[0],d=u[1],m=function(e){var t=e.domain,r=e.modelName,n=e.inputValue,i=e.queryFormat,a=e.filterField,o=e.numberOfItemsToRequest,l=e.debounceRequestDelayMs,c=void 0===l?400:l,s=Object(W.g)({debounceRequest:c,domain:t,isProvision:!0,modelName:r,observe:n,query:J({queryFormat:i,filterField:a,inputValue:n,numberOfItemsToRequest:o})}),u=(Object(z.o)(s)||{}).data,p=void 0===u?[]:u,d=Object(G.d)((function(e){return Object(W.d)(e,r)||{}}));return{provision:s,suggestions:p.map((function(e){return d[e]})).filter(Boolean)}}(Z({},o,{inputValue:p})).suggestions,f=Object(n.useCallback)((function(e){var t;d(null===(t=e.target)||void 0===t?void 0:t.value)})),v=Object(n.useMemo)((function(){return Z({},r,{onChange:f})}),[r,f]),b=Object(n.useMemo)((function(){return m.map(c)}),[m]);return i.a.createElement(U,X({classes:t,inputProps:v,triggerProps:a,options:b},s))}var ie,ae=r(161);function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le=(oe(ie={},ae.TRIP_TYPES.LEISURE,"Отдых"),oe(ie,ae.TRIP_TYPES.BUSINESS,"Работа"),oe(ie,ae.TRIP_TYPES.MIXED,"Смешанный"),oe(ie,ae.TRIP_TYPES.RELOCATION,"Переезд"),oe(ie,ae.TRIP_TYPES.OTHER,"Другой"),ie);var ce=function(e){var t=e.option;return t?le[t]:"Не указан"},se=Object(p.a)({optionGroup:{display:"flex",minWidth:"400px"},suggest:{flexGrow:1}});function ue(e){var t,r,n,a,o=e.provision,l=(o=void 0===o?{}:o).locationsDict,c=void 0===l?{}:l,s=e.formikProps,u=se(),p=s.handleChange,d=s.setFieldValue,O=s.handleBlur,E=s.errors,g=s.touched,y=s.values.trip,h=void 0===y?{}:y,I=(c[h.originLocationId]||{}).locationName;return i.a.createElement(m.a,{container:!0,spacing:3,alignItems:"center"},i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(f.a,{control:i.a.createElement(v.a,{fullWidth:!0,helperText:(null===(t=g.trip)||void 0===t?void 0:t.hasAutogeneratedTripName)&&(null===(r=E.trip)||void 0===r?void 0:r.hasAutogeneratedTripName),name:"trip.hasAutogeneratedTripName",onBlur:O,onChange:p,value:h.hasAutogeneratedTripName}),label:"Автогенерируемое название"})),i.a.createElement(m.a,{item:!0,xs:6},!h.hasAutogeneratedTripName&&i.a.createElement(b.a,{className:u.textField,fullWidth:!0,helperText:(null===(n=g.trip)||void 0===n?void 0:n.tripName)&&(null===(a=E.trip)||void 0===a?void 0:a.tripName),label:"Название поездки",margin:"normal",name:"trip.tripName",onBlur:O,onChange:p,value:h.tripName})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(ne,{classes:{root:u.suggest},inputProps:{placeholder:"Пункт отправления..."},initialInputValue:I,onChange:function(e){var t=e.suggestion.geonameId;return d("trip.originGeonameId",t)},onBlur:O,sourceProps:{domain:"tripEditCard.geoname",modelName:"geonames",filterField:"locationName",queryFormat:$,resolveDetails:function(e){return[e.countryName,e.regionName].filter(Boolean).join(", ")}},transformSuggestionToOption:pe,triggerProps:{label:"Старт из"}})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{caption:"Тип поездки",name:"trip.tripType",inputId:"TripEditCard-TripTypeOptions",onChange:p,onBlur:O,optionRender:ce,options:Object.values(ae.TRIP_TYPES),hasNullOption:!0,value:h.tripType})))}function pe(e){return{label:e.locationName,detail:e.countryName,suggestion:e}}ue.propTypes={},ue.defaultProps={};var de=r(167),me=r.n(de),fe=function(e,t){return!e||!t||e.departureRideId===t.arrivalRideId},ve=r(1032),be=function(e){for(var t=e.target;t;){var r=t.dataset;if(r){var n=r.sortHandler;if("enabled"===n)return!1;if("disabled"===n)return!0}t=t.parentNode}return!0};function Oe(){return(Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ee(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var ge=Object(ve.SortableContainer)((function(e){var t=e.children,r=e.className;return i.a.createElement("div",{className:r},t)})),ye=Object(ve.SortableElement)((function(e){return e.node}));function he(e){var t=e.children,r=Ee(e,["children"]);return i.a.createElement(ge,Oe({shouldCancelStart:be,lockAxis:"y",lockToContainerEdges:!0},r),i.a.Children.map(t,(function(e,t){return i.a.createElement(ye,{node:e,index:t})})))}var Ie=r(1033),je=r.n(Ie),Pe=Object(p.a)({dragHandler:{cursor:"grab"}});function Te(e){var t=e.className,r=Pe();return i.a.createElement(je.a,{className:me()(t,r.dragHandler),"data-sort-handler":"enabled"})}function Se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Te.propTypes={className:o.a.string},Te.defaultProps={className:void 0};var Ce="RIDE_CREATE_DIALOG",Re="RIDE_EDIT_DIALOG",De="VISIT_CREATE_DIALOG",we="VISIT_EDIT_DIALOG",Ne="VISIT_DELETE_DIALOG";var Ae=Object(p.a)({container:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}});function Ve(e){var t=e.showDialog,r=Ae();return i.a.createElement("div",{className:r.container,"data-sort-handler":"enabled"},i.a.createElement(d.a,{"data-sort-handler":"disabled",size:"small",variant:"outlined",color:"primary",onClick:function(){return t(De)}},i.a.createElement("span",null,"Добавить посещение")),i.a.createElement(Te,{className:r.visibleOnlyOnHover}))}Ve.propTypes={showDialog:o.a.func.isRequired},Ve.defaultProps={};var _e=r(792),xe=r(1034),Le=r.n(xe);function ke(){return(ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ye(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function He(e){var t=e.onClick,r=Ye(e,["onClick"]);return i.a.createElement(_e.a,ke({size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),i.a.createElement(Le.a,null))}He.propTypes={},He.defaultProps={};var Fe=r(908),Be=r.n(Fe);function Me(){return(Me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function qe(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ue(e){var t=e.onClick,r=qe(e,["onClick"]);return i.a.createElement(_e.a,Me({size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),i.a.createElement(Be.a,null))}Ue.propTypes={},Ue.defaultProps={};var Ge=r(1035),ze=r.n(Ge);function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ke(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $e(e){var t=e.onClick,r=Ke(e,["onClick"]);return i.a.createElement(_e.a,We({size:"small",variant:"outlined",color:"primary",component:"button",onClick:t},r),i.a.createElement(ze.a,null))}$e.propTypes={},$e.defaultProps={};var Je=Object(p.a)({actions:{display:"inline-block"}});function Xe(e){var t=e.className,r=e.isEntityExist,n=e.onEditClick,a=e.onDeleteClick,o=e.onCreateClick,l=Je(),c=!r&&Boolean(o),s=r&&Boolean(n),u=r&&Boolean(a);return i.a.createElement("div",{"data-sort-handler":"disabled",className:me()(l.actions,t)},c&&i.a.createElement(He,{onClick:o}),s&&i.a.createElement(Ue,{onClick:n}),u&&i.a.createElement($e,{onClick:a}))}var Qe=r(1038),Ze=r.n(Qe),et=r(1036),tt=r.n(et),rt=r(861),nt=r.n(rt),it=r(1037),at=r.n(it),ot=r(231);function lt(e){var t=e.visit.visitType,r=e.className,n=function(e){switch(e){case ot.VISIT_TYPES.TRANSIT:return tt.a;case ot.VISIT_TYPES.BASE_CAMP:return at.a;case ot.VISIT_TYPES.RELOCATION:return nt.a;case ot.VISIT_TYPES.REGULAR:default:return Ze.a}}(t);return i.a.createElement(n,{className:r})}var ct=r(277),st=Object(p.a)({container:{display:"inline-block",marginRight:"4px","&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},visibleOnHover:{visibility:"hidden"}}),ut=function(e){var t=e.visit,r=e.showDialog,n=st();if(!t)return"Не указано";var a=t.locationName;return i.a.createElement("div",{className:n.container},i.a.createElement(lt,{visit:t,className:n.icon}),a,i.a.createElement(Xe,{className:n.visibleOnHover,isEntityExist:!0,onEditClick:function(){return r(we,t)},onDeleteClick:function(){return r(Ne,t)}}))};ut.propTypes={visit:o.a.shape(ct.default)},ut.defaultProps={visit:{}};var pt=ut,dt=r(811),mt=r(291),ft=r(825);var vt=Object(p.a)({container:{"&:hover $visibleOnHover":{visibility:"visible"}},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},details:{marginRight:"4px"},visibleOnHover:{visibility:"hidden"}}),bt=function(e){var t,r,n,a=e.className,o=e.ride,l=e.showDialog,c=vt(),s=o||{},u=s.rideId,p=s.arrivalDateTime,d=s.departureDateTime,m=Boolean(u);return i.a.createElement("div",{className:me()(a,c.container)},m&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ft.a,{ride:o,className:c.icon}),i.a.createElement("span",{className:c.details},Object(dt.a)({departureDateTime:d,arrivalDateTime:p}))),i.a.createElement(Xe,{className:me()((t={},r=c.visibleOnHover,n=m,r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t)),isEntityExist:m,onCreateClick:function(){return l(Ce)},onEditClick:function(){return l(Re,o)}}))};bt.propTypes={className:o.a.string,ride:o.a.shape(mt.default)},bt.defaultProps={className:void 0,ride:{}};var Ot=bt;function Et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(r),!0).forEach((function(t){yt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ht=Object(p.a)({alwaysVisible:{},container:{margin:"12px 0",cursor:"grab",background:"#fff",padding:"12px",border:"1px solid #ccc",boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 0.1), 0 0 1px 0 rgba(0, 0, 0, 0.2)",position:"relative","&:hover $editDialogTrigger":{visibility:"visible"},"&:hover $visibleOnlyOnHover":{visibility:"visible"}},editDialogTrigger:{marginLeft:"4px",position:"absolute",top:"50%",transform:"translateY(-50%)",display:"inline-block",visibility:"hidden"},visibleOnlyOnHover:{visibility:"hidden"},ride:{},warning:{color:"red"}});function It(e){var t=e.style,r=e.className,n=e.prevVisit,a=e.visit,o=e.nextVisit,l=e.showDialog,c=e.isArrivalRideMatch,s=e.isDepartureRideMatch,u=(e.tripId,e.provision),p=ht(),d=u.ridesDict,m=a||{},f=m.visitId,v=m.arrivalRideId,b=m.departureRideId,O=(n||{}).visitId,E=(o||{}).visitId;return i.a.createElement("div",{className:me()(p.container,r),style:t,"data-sort-handler":"enabled"},i.a.createElement(Ot,{showDialog:function(e,t){return l(e,gt({},t,{departureVisitId:c?O:void 0,arrivalVisitId:f}))},className:me()(p.ride,yt({},p.warning,!c)),ride:d[v],provision:u}),i.a.createElement(pt,{showDialog:l,classes:{editIcon:p.visibleOnlyOnHover},visit:a,provision:u}),i.a.createElement(Ot,{showDialog:function(e,t){return l(e,gt({},t,{departureVisitId:f,arrivalVisitId:s?E:void 0}))},visitId:f,className:me()(p.ride,yt({},p.warning,!s)),ride:d[b],provision:u}))}function jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}It.propTypes={},It.defaultProps={};var St=Object(p.a)({creatorsContainer:{display:"flex",justifyContent:"space-between"},isCompact:{marginTop:"-52px"},resetFlow:{transform:"translate(0, 0)"}});function Ct(e){var t=e.showDialog,r=e.provision,a=e.formikProps,o=a.values.trip.visits,c=r.visitsDict,s=St(),u=Tt(Object(n.useState)(o.length),2),p=u[0],d=u[1],m=Tt(Object(n.useState)(!1),2),f=m[0],v=m[1],b=function(e,r){var n=Tt(Dt(o,p).map((function(e){return e&&c[e]||null})),2),i=n[0],a=n[1];t(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(r),!0).forEach((function(t){Pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{orderInTrip:Rt(i,a)}))};return o.length?i.a.createElement(l.a,{name:"trip.visits",render:function(e){return i.a.createElement(he,{className:s.resetFlow,updateBeforeSortStart:function(){return v(!0)},onSortEnd:function(t){v(!1);var r=t.oldIndex,n=t.newIndex;r===p?d(n):e.move(r,n)}},o.flatMap((function(e,n){var l=Tt(Dt(o,n).map((function(e){return e&&c[e]||null})),3),u=l[0],d=l[1],m=l[2],v=function(e,t,r){var n=fe(e,t);return{isDepartureRideMatch:fe(t,r),isArrivalRideMatch:n}}(u,d,m),O=v.isArrivalRideMatch,E=v.isDepartureRideMatch,g=n>=1&&!f&&O&&p!==n,y=i.a.createElement(It,{key:"v".concat(e),index:n,style:{zIndex:o.length-n},className:me()(Pt({},s.isCompact,g)),showDialog:t,isArrivalRideMatch:O,isDepartureRideMatch:E,prevVisit:u,visit:d,nextVisit:m,formikProps:a,provision:r}),h=p===n,I=p===o.length&&p===n+1;if(!h&&!I)return y;var j=i.a.createElement("div",{style:{zIndex:o.length+1}},i.a.createElement(Ve,{key:"visitCreator",showDialog:b}));return h?[j,y]:[y,j]})))}}):i.a.createElement(Ve,{key:"visitCreator",showDialog:b})}function Rt(e,t){var r=(e||{}).orderInTrip,n=(t||{}).orderInTrip;return e?t?(r+n)/2+(Math.random()-.5)*(n-r)/2:r+1:n-1}function Dt(e,t){return[e[t-1]||null,e[t]||null,e[t+1]||null]}Ct.propTypes={},Ct.defaultProps={};var wt=r(228),Nt=r(1039),At=r.n(Nt),Vt=r(1045),_t=r.n(Vt),xt=function(e,t){var r=t.maxLength,n=t.separator,i=void 0===n?", ":n,a=_t()(e),o=a.slice(0,r).join(i);return a.length>r?"".concat(o,"..."):o};function Lt(e){var t=e.isCreation,r=e.className,n=e.provision,a=e.formikProps.values,o=a.trip,l=a.visitsDict,c=n.countriesDict,s=n.locationsDict,u=t?"Создание поездки":"Редактирование поездки",p=o.hasAutogeneratedTripName?function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Без названия";if(!e.length)return i;var a=Object.keys(At()(e.filter((function(e){var r;return(null===(r=t[e])||void 0===r?void 0:r.visitType)!==ot.VISIT_TYPES.TRANSIT})),"countryId"));return 1===a.length?xt(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.locationName})),{maxLength:4})||i:xt(a.map((function(e){return Number(e)!==n&&r[e]&&r[e].countryName})).filter(Boolean),{maxLength:4})||i}(o.visits,l,c,s[o.originLocationId]&&s[o.originLocationId].countryId,o.tripName):o.tripName,d="".concat(u,': "').concat(p,'"');return i.a.createElement(wt.a,{variant:"h6",className:r},d)}var kt=Object(p.a)({container:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"}}),Yt=function(e){var t=e.isCreation,r=e.showDialog,n=e.provision,a=e.formikProps,o=kt();return i.a.createElement(i.a.Fragment,null,i.a.createElement(Lt,{className:o.container,formikProps:a,isCreation:t,provision:n}),i.a.createElement(l.b,null,i.a.createElement(ue,{formikProps:a,provision:n}),i.a.createElement(Ct,{classes:o,showDialog:r,formikProps:a,provision:n}),i.a.createElement(d.a,{type:"submit",color:"primary"},"Сохранить")))};Yt.propTypes={isCreation:o.a.bool.isRequired},Yt.defaultProps={};var Ht=Yt,Ft=r(316),Bt=r(315),Mt=r(1071),qt=r(1075),Ut=r(1073),Gt=r(1074),zt=r(1072),Wt=function(e){var t=e.isOpen,r=e.title,n=e.description,a=e.children,o=e.primaryButtonCaption,l=e.primaryButtonHandler,c=e.secondaryButtonCaption,s=e.secondaryButtonHandler,u=e.onClose;return i.a.createElement(Mt.a,{transitionDuration:500,open:t,onClose:u,"aria-labelledby":"form-dialog"},i.a.createElement(zt.a,{id:"form-dialog-title"},r),i.a.createElement(Ut.a,null,i.a.createElement(Gt.a,null,n),a),i.a.createElement(qt.a,null,s&&i.a.createElement(d.a,{onClick:s,color:"secondary"},c),l&&i.a.createElement(d.a,{onClick:l,color:"primary"},o)))},Kt=function(e){var t=e.initialValues,r=e.isOpen,n=e.onSubmit,a=e.onReset,o=e.title,c=e.description,s=e.children;return i.a.createElement(l.c,{initialValues:t,enableReinitialize:!0,onSubmit:n},(function(e){return i.a.createElement(Wt,{description:c,onClose:a,isOpen:r,primaryButtonCaption:"Сохранить",primaryButtonHandler:e.handleSubmit,secondaryButtonCaption:"Отмена",secondaryButtonHandler:a,title:o},i.a.cloneElement(s,{formikProps:e}))}))},$t=r(1076),Jt=r(1091),Xt=Object(p.a)({container:{display:"inline-block",marginRight:"4px"},icon:{marginRight:"4px",display:"inline-block",verticalAlign:"text-bottom"},editIcon:{}}),Qt=function(e){var t=e.visit,r=Xt();if(!t)return"Не указано";var n=t.locationName;return i.a.createElement("div",{className:r.container},i.a.createElement(lt,{visit:t,className:r.icon}),n)};Qt.propTypes={visit:o.a.shape(ct.default)},Qt.defaultProps={visit:{}};var Zt,er,tr,rr,nr=Qt,ir=r(88);function ar(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var or=(ar(Zt={},ir.RIDE_CLASSES.ECONOMY,"Эконом"),ar(Zt,ir.RIDE_CLASSES.COMFORT,"Комфорт"),ar(Zt,ir.RIDE_CLASSES.BUSINESS,"Бизнес"),ar(Zt,ir.RIDE_CLASSES.FIRST,"Первый"),ar(Zt,ir.RIDE_CLASSES.PRIVATE,"Частный"),Zt),lr=(ar(er={},ir.RIDE_OCCUPATION.PASSENGER,"Пассажир"),ar(er,ir.RIDE_OCCUPATION.STUFF,"Персонал"),ar(er,ir.RIDE_OCCUPATION.DRIVER,"Водитель"),er),cr=(ar(tr={},ir.RIDE_TYPES.SELF_DRIVE,"Самостоятельная поездка"),ar(tr,ir.RIDE_TYPES.SCHEDULED,"Регулярный рейс"),ar(tr,ir.RIDE_TYPES.CHARTER,"Чартерный рейс"),ar(tr,ir.RIDE_TYPES.TOUR,"Тур"),ar(tr,ir.RIDE_TYPES.CARPOOL,"Попутный автомобиль"),ar(tr,ir.RIDE_TYPES.HITCH_HIKING,"Автостоп"),ar(tr,ir.RIDE_TYPES.DROP_OFF,"Подбросили до места"),tr),sr=(ar(rr={},ir.VEHICLE_TYPES.CAR,"Автомобиль"),ar(rr,ir.VEHICLE_TYPES.TRAIN,"Поезд"),ar(rr,ir.VEHICLE_TYPES.AIRCRAFT,"Самолет"),ar(rr,ir.VEHICLE_TYPES.BUS,"Автобус"),ar(rr,ir.VEHICLE_TYPES.MOTORHOME,"Дом на колесах"),ar(rr,ir.VEHICLE_TYPES.LOCAL_TRAIN,"Электричка"),ar(rr,ir.VEHICLE_TYPES.FERRY,"Паром"),ar(rr,ir.VEHICLE_TYPES.BIKE,"Велосипед"),ar(rr,ir.VEHICLE_TYPES.BY_FEET,"Пешком"),ar(rr,ir.VEHICLE_TYPES.ROPEWAY,"Канатная дорога"),ar(rr,ir.VEHICLE_TYPES.FUNICULAR,"Фуникулер"),ar(rr,ir.VEHICLE_TYPES.MOTORBIKE,"Мотоцикл"),ar(rr,ir.VEHICLE_TYPES.TRUCK,"Грузовик"),ar(rr,ir.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE,"Вездеход"),ar(rr,ir.VEHICLE_TYPES.TRAM,"Трамвай"),ar(rr,ir.VEHICLE_TYPES.TROLLEY,"Троллейбус"),ar(rr,ir.VEHICLE_TYPES.TAXI,"Такси"),ar(rr,ir.VEHICLE_TYPES.CITY_BUS,"Муниципальный автобус"),ar(rr,ir.VEHICLE_TYPES.JITNEY,"Маршрутное такси"),ar(rr,ir.VEHICLE_TYPES.SUBWAY,"Метро"),ar(rr,ir.VEHICLE_TYPES.PUBLIC_TRANSPORT,"Общественный транспорт"),rr),ur=r(307),pr=r(348),dr=r(288),mr=r(205),fr=function(e){var t=e.dateFrom,r=e.timeFrom;return new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),r.getSeconds())},vr=function(e){var t=e.values,r=t.rideDeparture,n=t.rideArrival,i=e.setFieldValue,a=Object(ur.a)(r,n),o=function(e,t){var a,o,l=(a=e,o=t,Object(mr.a)(a,o)),c=l?t:e,s=l?e:t;Object(pr.a)(r,c)||function(e){i("departureDateTime",e)}(c),Object(pr.a)(n,s)||function(e){i("arrivalDateTime",e)}(s)};return{isSameDateField:{value:a,onChange:function(e){Boolean(a)!==Boolean(e)&&o(r,fr({dateFrom:e?r:Object(dr.a)(r,1),timeFrom:n}))}},rideDepartureField:{value:r,onChange:function(e){var t=a?fr({timeFrom:n,dateFrom:e}):n;o(e,t)}},rideArrivalField:{value:n,onChange:function(e){var t=a?fr({timeFrom:r,dateFrom:e}):r;o(t,e)}}}};function br(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Or=null,Er=function(e){return function(t){var r=t.option;return r===Or?"Пункт отправления":i.a.createElement(nr,{visit:e[r]})}},gr=function(e){var t=e.option;return t?sr[t]:"Не указан"},yr=function(e){var t=e.option;return t?cr[t]:"Не указан"},hr=function(e){var t=e.option;return t?or[t]:"Не указан"},Ir=function(e){var t=e.option;return t?lr[t]:"Не указан"},jr=Object(p.a)({option:{width:"100%"}}),Pr=function(e){var t=e.tripVisitsIds,r=e.visitsDict,n=e.formikProps,a=n.values,o=a.vehicleType,l=a.rideType,c=a.rideComment,s=a.rideClass,u=a.rideOccupation,p=a.departureVisitId,d=a.departureDateTime,O=a.arrivalVisitId,E=a.arrivalDateTime,g=n.handleChange,y=n.setFieldValue,h=jr(),I=t&&t.length>0,j=vr({values:{rideDeparture:d,rideArrival:E},setFieldValue:y}),T=j.rideArrivalField,S=j.rideDepartureField,C=j.isSameDateField;return i.a.createElement(m.a,{container:!0,spacing:3,alignItems:"center"},I&&i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"departureVisitId",caption:"Отправление из",inputId:"RideEditCard-departureVisitId",optionRender:Er(r),hasNullOption:!1,options:[Or].concat(br(t)),value:p,onChange:g})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"arrivalVisitId",caption:"Прибытие в",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:Er(r),options:[].concat(br(t),[Or]),onChange:g,value:O}))),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"vehicleType",caption:"Транспорт",inputId:"RideEditCard-VehicleTypeOptions",optionRender:gr,options:Object.values(ir.VEHICLE_TYPES),onChange:g,value:o})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"rideType",caption:"Тип поездки",inputId:"RideEditCard-RideTypeOptions",optionRender:yr,options:Object.values(ir.RIDE_TYPES),onChange:g,value:l})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"rideClass",caption:"Класс поездки",inputId:"RideEditCard-RideClassOptions",optionRender:hr,options:Object.values(ir.RIDE_CLASSES),onChange:g,value:s})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"rideOccupation",caption:"Роль",inputId:"RideEditCard-RideOccupationOptions",optionRender:Ir,options:Object.values(ir.RIDE_OCCUPATION),onChange:g,value:u})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement($t.a,{name:"departureDateTime",autoOk:!0,className:h.option,label:"Дата отправления",value:S.value,onChange:S.onChange,format:"dd/MM/yyyy"})),i.a.createElement(m.a,{item:!0,xs:6},C.value?i.a.createElement(f.a,{control:i.a.createElement(v.a,{checked:C.value,onChange:function(e){return C.onChange(e.target.checked)}}),label:"Прибытие в тот же день"}):i.a.createElement($t.a,{name:"arrivalDateTime",autoOk:!0,className:h.option,label:"Дата прибытия",value:T.value,onChange:T.onChange,format:"dd/MM/yyyy"})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(Jt.a,{name:"departureDateTime",ampm:!1,autoOk:!0,className:h.option,label:"Время отправления",value:S.value,onChange:S.onChange})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(Jt.a,{name:"arrivalDateTime",ampm:!1,autoOk:!0,className:h.option,label:"Время прибытия",value:T.value,onChange:T.onChange})),i.a.createElement(m.a,{item:!0,xs:12},i.a.createElement(b.a,{name:"rideComment",className:h.option,label:"Комментарий",multiline:!0,onChange:g,rows:1,rowsMax:12,value:c})))};Pr.propTypes={},Pr.defaultProps={};var Tr=Pr;function Sr(){return(Sr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Cr(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Rr(e){var t=e.isCreation,r=e.tripVisitsIds,n=e.visitsDict,a=Cr(e,["isCreation","tripVisitsIds","visitsDict"]);return i.a.createElement(Kt,Sr({title:t?"Создание маршрута":"Редактирование маршрута"},a),i.a.createElement(Tr,{tripVisitsIds:r,visitsDict:n,formikProps:null}))}var Dr,wr=r(824);function Nr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ar=(Nr(Dr={},ot.VISIT_TYPES.TRANSIT,"Транзит"),Nr(Dr,ot.VISIT_TYPES.REGULAR,"Посещение"),Nr(Dr,ot.VISIT_TYPES.BASE_CAMP,"Базовый лагерь"),Nr(Dr,ot.VISIT_TYPES.RELOCATION,"Переезд"),Dr),Vr=function(e){return function(t){var r=t.option;return i.a.createElement(wr.a,{ride:e[r],isLong:!0})}},_r=function(e){var t=e.option;return t?Ar[t]:"Не указан"},xr=Object(p.a)({option:{width:"100%"}});function Lr(e){var t=e.tripRidesIds,r=e.ridesDict,n=e.formikProps,a=n.values,o=a.locationName,l=a.visitType,c=a.visitComment,s=a.arrivalRideId,u=a.departureRideId,p=n.handleChange,d=n.handleBlur,f=n.setFieldValue,v=xr(),O=t&&t.length>0;return i.a.createElement(m.a,{container:!0,spacing:3,alignItems:"center"},i.a.createElement(m.a,{item:!0,xs:12},i.a.createElement(ne,{inputProps:{placeholder:"Место посещения..."},initialInputValue:o,onChange:function(e){var t=e.suggestion.geonameId;return f("geonameId",t)},onBlur:d,sourceProps:{domain:"visitEditFormSection.geoname",modelName:"geonames",filterField:"locationName",queryFormat:$},transformSuggestionToOption:kr,triggerProps:{label:"Место посещения"}})),O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"arrivalRideId",caption:"Прибытие",inputId:"RideEditCard-arrivalVisitId",hasNullOption:!1,optionRender:Vr(r),options:t,onChange:p,value:s})),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"departureRideId",caption:"Отправление",inputId:"RideEditCard-departureVisitId",optionRender:Vr(r),hasNullOption:!1,options:t,value:u,onChange:p}))),i.a.createElement(m.a,{item:!0,xs:6},i.a.createElement(P,{name:"visitType",value:l,onChange:p,caption:"Тип посещения",inputId:"VisitEditCard-VisitTypeOptions",optionRender:_r,options:Object.values(ot.VISIT_TYPES),hasNullOption:!0})),i.a.createElement(m.a,{item:!0,xs:12},i.a.createElement(b.a,{className:v.option,name:"visitComment",value:c,onChange:p,label:"Комментарий",fullWidth:!0,multiline:!0,rows:1,rowsMax:12})))}function kr(e){return{label:e.locationName,details:[e.countryName,e.regionName].filter(Boolean).join(", "),suggestion:e}}function Yr(){return(Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Hr(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Fr(e){var t=e.isCreation,r=e.tripRidesIds,n=e.ridesDict,a=Hr(e,["isCreation","tripRidesIds","ridesDict"]);return i.a.createElement(Kt,Yr({title:t?"Создание посешения":"Редактирование посещения"},a),i.a.createElement(Lr,{tripRidesIds:r,ridesDict:n,formikProps:null}))}function Br(){return(Br=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Mr(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function qr(e){var t=e.visit,r=e.onSubmit,n=e.onReset,a=Mr(e,["visit","onSubmit","onReset"]);return i.a.createElement(Wt,Br({title:"Удалить посещение",description:"Вы действительно хотите удалить посещение",primaryButtonCaption:"Да",primaryButtonHandler:function(e){return r(e,t)},secondaryButtonCaption:"Нет",secondaryButtonHandler:n},a),i.a.createElement(nr,{visit:t}))}function Ur(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(r),!0).forEach((function(t){zr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ur(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wr(e){var t=e.provision,r=e.dialogsState,a=e.hideDialog,o=e.handleSubmitRide,l=e.handleSubmitVisit,c=e.handleDeleteVisit,s=e.trip,u=t.ridesDict,p=t.visitsDict,d=s.tripId,m=s.visits,f=s.rides,v=r.dialogName,b=r.dialogParams,O=void 0===b?{}:b,E=Object(n.useMemo)((function(){var e=O.rideId;return Gr({},e?u[e]:Object(Ft.b)(),{},O,{tripId:d})}),[u,d,O]),g=Object(n.useMemo)((function(){var e=O.visitId;return Gr({},e?p[e]:Object(Bt.b)(),{},O,{tripId:d})}),[p,d,O]),y=function(e){return e===Re||e===Ce}(v),h=function(e){return e===we||e===De}(v),I=v===Ne;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Rr,{initialValues:E,tripVisitsIds:m,isOpen:y,onSubmit:function(e){o(e),a()},onReset:a,isCreation:v===Ce,visitsDict:p}),i.a.createElement(Fr,{initialValues:g,tripRidesIds:f,isOpen:h,onSubmit:function(e){l(e),a()},onReset:a,isCreation:v===De,ridesDict:u}),i.a.createElement(qr,{visit:p[O.visitId],isOpen:I,onSubmit:function(e,t){var r=t.visitId;c(r),a()},onReset:a}))}Lr.propTypes={},Lr.defaultProps={};function Kr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){var t=e.orderResolver}({orderResolver:function(e){return e.orderInTrip}});function $r(e){var t=e.match.params,r=t.userAlias,a=t.strTripId,o="create"===t.action,p=Object(c.c)(),d=p.isAuthenticated,m=p.userAlias,f=a&&parseInt(a,10),v=Object(s.a)({userAlias:r,tripsIds:f?[f]:[]}),b=v.tripsDict,O=v.tripsProvision,E=o?Object(u.b)():b[f],g=function(e){var t=Kr(Object(W.h)({domain:"".concat("travel.TripEditPage",".rides"),modelName:"rides"}),1)[0],r=Object(n.useCallback)((function(r){return t({query:{id:r.rideId,body:r}}).then(e)}),[]),i=Kr(Object(W.h)({domain:"".concat("travel.TripEditPage",".trips"),modelName:"trips"}),1)[0],a=Object(n.useCallback)((function(t){return i({query:{id:t.tripId,body:t}}).then(e)}),[]),o=Kr(Object(W.h)({domain:"".concat("travel.TripEditPage",".visits"),modelName:"visits"}),1)[0],l=Object(n.useCallback)((function(t){return o({query:{id:t.visitId,body:t}}).then(e)}),[]),c=Kr(Object(W.h)({domain:"".concat("travel.TripEditPage",".visits"),modelName:"visits"}),1)[0];return{handleSubmitRide:r,handleSubmitTrip:a,handleSubmitVisit:l,handleDeleteVisit:Object(n.useCallback)((function(t){return c({method:"DELETE",query:{id:t}}).then(e)}),[])}}(O.invalidate),y=g.handleSubmitRide,h=g.handleSubmitTrip,I=g.handleSubmitVisit,j=g.handleDeleteVisit,P=function(){var e=Se(Object(n.useState)({name:null}),2),t=e[0],r=e[1];return{showDialog:function(e,t){r({dialogName:e,dialogParams:t})},hideDialog:function(){r({name:null})},dialogsState:t}}(),T=P.showDialog,S=P.hideDialog,C=P.dialogsState,R=v.isError,D=v.isReady,w=v.isPending;return f&&(!D||E)||o?d&&m===r?R?i.a.createElement("div",null,"...Error"):w?i.a.createElement("div",null,"...Loading"):E?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{initialValues:{trip:E},onSubmit:function(e){return h(e.trip)}},(function(e){return i.a.createElement(Ht,{isCreation:o,showDialog:T,formikProps:e,provision:v})})),i.a.createElement(Wr,{provision:v,dialogsState:C,hideDialog:S,handleSubmitRide:y,handleSubmitVisit:I,handleDeleteVisit:j,trip:E})):i.a.createElement("div",null,"...Error, no trip is provided"):i.a.createElement("div",null,"У вас не достаочно прав для просмотра данной страницы"):i.a.createElement("div",null,"Запрашиваемая вами страница не найдена")}$r.propTypes={match:o.a.shape({params:o.a.shape({userAlias:o.a.string.isRequired}).isRequired}).isRequired};t.default=$r},795:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(62),i=r(821),a=r.n(i),o=r(822),l=r.n(o),c=r(810),s=r.n(c),u=r(154),p=r.n(u),d=r(146),m=r(10),f=r(802),v=r(797),b=r(803);function O(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function E(e){var t=e.userAlias,r=function(e){var t=e.userAlias,r=e.tripsIds,i=Object(n.d)((function(e){return{tripsDict:Object(d.d)(e,"trips")||{}}})).tripsDict,a=!r,o=!a&&r.filter((function(e){return!i[e]}));return Object(d.g)({domain:"travel.trips-".concat(t),isProvision:!0,modelName:"trips",observe:t,query:{userAlias:t,navigation:{isDisabled:!0},filter:a?{}:{id:{comparator:"in",value:o}}}})}({userAlias:t,tripsIds:e.tripsIds}),i=Object(f.a)({domain:"travel.trips-".concat(t,".user"),userAlias:t}),o=i.user,l=(o=void 0===o?{}:o).locationsRating,c=void 0===l?{}:l,u=O(i,["user"]),E=(Object(m.o)(r)||{}).data,y=void 0===E?[]:E,h=Object(n.d)((function(e){return{tripsDict:Object(d.d)(e,"trips")||{},visitsDict:Object(d.d)(e,"visits")||{},ridesDict:Object(d.d)(e,"rides")||{},countriesDict:Object(d.d)(e,"countries")||{},locationsDict:Object(d.d)(e,"locations")||{}}})),I=h.tripsDict,j=h.visitsDict,P=h.ridesDict,T=h.countriesDict,S=h.locationsDict,C=Array.from(new Set(y.flatMap((function(e){var t;return(null===(t=I[e])||void 0===t?void 0:t.visits)||[]})))),R=Array.from(new Set(y.flatMap((function(e){var t;return(null===(t=I[e])||void 0===t?void 0:t.rides)||[]})))),D=Array.from(new Set(C.flatMap((function(e){var t;return(null===(t=j[e])||void 0===t?void 0:t.countryId)||[]})))),w=Array.from(new Set(C.flatMap((function(e){var t;return(null===(t=j[e])||void 0===t?void 0:t.locationId)||[]})))),N=Object(v.a)(),A=Object(b.a)({domain:"travel.locations-".concat(t),locationsIds:w}),V=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{updatesCounter:s()(t.map(m.p)),isReady:t.every(m.i),isPending:t.some(m.h),isValid:t.every(m.k),error:t.find(m.g),errors:t.map(m.f).filter(Boolean),invalidate:function(){return t.forEach((function(e){return(0,e.invalidate)()}))}}}(r,u,N,A),_=V.isError,x=V.isValid,L=V.isReady,k=V.isPending,Y=function(e,t,r){var n=e.reduce((function(e,n){var i=t[n];if(!i)return e;var a=r[n],o=i.countryId;return e[o]||(e[o]=[]),e[o].push(a),e}),{});return p()(n,(function(e){return function(e){if(!e.length)return 1/0;var t=e.length/e.map((function(e){return 1/e})).reduce((function(e,t){return e+t})),r=a()(e),n=Math.log(e.length);return 1/(1/t+n/r)}(e)}))}(w,S,c);return{tripsProvision:r,countriesProvision:N,locationsProvision:A,isError:_,isValid:x,isReady:L,isPending:k,tripsIds:y,tripsDict:I,visitsIds:C,visitsDict:j,ridesIds:R,ridesDict:P,ridesStats:g(R,P),locationsIds:w,locationsDict:S,locationsRating:c,countriesIds:D,countriesDict:T,countriesRating:Y}}function g(e,t){return{earliestDeparture:new Date(l()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime.getTime()})))),latestArrival:new Date(a()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime.getTime()}))))}}},797:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(146),i=r(10);function a(){var e=Object(n.g)({domain:"travel.countries",isProvision:!0,modelName:"countries",query:{navigation:{isDisabled:!0}}}),t=(Object(i.o)(e)||{}).data;return{countriesIds:void 0===t?[]:t,isReady:Object(i.i)(e),isLoading:Object(i.h)(e),isError:Object(i.g)(e),counters:e.counters}}},802:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(62),i=r(146);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){var t=e.domain,r=e.userAlias,l=Object(n.d)((function(e){return Object(i.e)(e,"users",r)}));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(i.g)({domain:t,applicableSchemaName:"item",isProvision:!0,modelName:"users",observe:r,condition:Boolean(r),query:{id:r}}),{user:l})}},803:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r(62),i=r(146),a=r(10);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){var t=e.domain,r=e.locationsIds,o=Object(n.d)((function(e){return Object(i.d)(e,"locations")||{}})),l=r.filter((function(e){return!o[e]})),c=Object(i.g)({domain:t,isProvision:!0,modelName:"locations",observe:r,condition:Boolean(l.length),query:{filter:{id:{comparator:"in",value:l}},navigation:{isDisabled:!0}}});return{locationsDict:o,isReady:Object(a.i)(c),isLoading:Object(a.h)(c),isError:Object(a.g)(c),counters:c.counters}}function u(e){var t=e.domain,r=c(Object(i.h)({domain:t,modelName:"locations",method:"POST"}),2),n=r[0];return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r[1],{submitLocationRating:n})}},808:function(e,t,r){"use strict";var n=r(795);r.d(t,"a",(function(){return n.a}));r(797)},811:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r(307),i=r(889),a=r(890),o=r(54),l=r(820),c=r.n(l),s="d MMMM yyyy",u="d MMMM",p="d";function d(e,t){var r=Object(o.a)(t,s,{locale:c.a});if(Object(n.a)(e,t))return r;var l="";return l=Object(i.a)(e,t)?Object(o.a)(e,p,{locale:c.a}):Object(a.a)(e,t)?Object(o.a)(e,u,{locale:c.a}):Object(o.a)(e,s,{locale:c.a}),"".concat(l,"—").concat(r)}function m(e){return d(e.departureDateTime,e.arrivalDateTime)}function f(e){var t=e.departureDateTime;return d(e.arrivalDateTime,t)}},824:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),i=r.n(n),a=r(783),o=r(907),l=r.n(o),c=r(811),s=r(88),u=r(825),p=Object(a.a)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function d(e){var t=e.ride,r=e.ride,n=(r=void 0===r?{}:r).rideType,a=e.className,o=e.isLong,d=p();return t?i.a.createElement("div",{className:a},i.a.createElement(u.a,{ride:t,className:d.icon}),n===s.RIDE_TYPES.HITCH_HIKING&&i.a.createElement(l.a,{className:d.absoluteIcon}),o&&Object(c.a)(t)):null}},825:function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r(0),i=r.n(n),a=r(897),o=r.n(a),l=r(896),c=r.n(l),s=r(894),u=r.n(s),p=r(891),d=r.n(p),m=r(905),f=r.n(m),v=r(893),b=r.n(v),O=r(899),E=r.n(O),g=r(900),y=r.n(g),h=r(892),I=r.n(h),j=r(861),P=r.n(j),T=r(895),S=r.n(T),C=r(898),R=r.n(C),D=r(901),w=r.n(D),N=r(902),A=r.n(N),V=r(903),_=r.n(V),x=r(904),L=r.n(x),k=r(906),Y=r.n(k),H=r(88);function F(e){var t=e.ride.vehicleType,r=e.className,n=function(e){switch(e){case H.VEHICLE_TYPES.CAR:return d.a;case H.VEHICLE_TYPES.TRAIN:return I.a;case H.VEHICLE_TYPES.AIRCRAFT:return b.a;case H.VEHICLE_TYPES.BUS:case H.VEHICLE_TYPES.TROLLEY:case H.VEHICLE_TYPES.CITY_BUS:return u.a;case H.VEHICLE_TYPES.MOTORHOME:case H.VEHICLE_TYPES.JITNEY:return S.a;case H.VEHICLE_TYPES.LOCAL_TRAIN:return I.a;case H.VEHICLE_TYPES.FERRY:return c.a;case H.VEHICLE_TYPES.BIKE:return o.a;case H.VEHICLE_TYPES.BY_FEET:return R.a;case H.VEHICLE_TYPES.MOTORBIKE:return E.a;case H.VEHICLE_TYPES.TRUCK:return P.a;case H.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return y.a;case H.VEHICLE_TYPES.TRAM:return w.a;case H.VEHICLE_TYPES.TAXI:return A.a;case H.VEHICLE_TYPES.SUBWAY:return _.a;case H.VEHICLE_TYPES.PUBLIC_TRANSPORT:return L.a;case H.VEHICLE_TYPES.ROPEWAY:case H.VEHICLE_TYPES.FUNICULAR:return f.a;default:return Y.a}}(t);return i.a.createElement(n,{className:r})}}}]);
//# sourceMappingURL=travel-Trips-c2915dc4ae1b9153b7f2.js.map