{"version":3,"sources":["webpack:///./src/packages/travel/pages/Dashboard/blocks/Description.jsx","webpack:///./src/modules/utilities/l10n/index.js","webpack:///./src/packages/travel/pages/Dashboard/blocks/ExternalLinks.jsx","webpack:///./src/packages/travel/pages/Dashboard/TravelDashboard.jsx","webpack:///./src/packages/travel/dataSource/useTrips.js","webpack:///./src/core/connection/request/utils/mergeProvisionsState.js","webpack:///./src/packages/travel/dataSource/useCountries.js","webpack:///./src/modules/utilities/dateTime/safeDateFormat.js","webpack:///./src/modules/utilities/dateTime/isValidDate.js","webpack:///./src/packages/travel/dataSource/useLocations.js","webpack:///./src/packages/travel/dataSource/useUser.js","webpack:///./src/packages/travel/dataSource/useVisit.js","webpack:///./src/modules/components/Markdown/Markdown.jsx","webpack:///./src/packages/travel/components/LocationsMap/utils/adaptMarkerData.js","webpack:///./src/packages/travel/components/LocationsMap/utils/resolveLocationFirstAndLastVisitDateTime.js","webpack:///./src/packages/travel/components/LocationsMap/consts.js","webpack:///./src/packages/travel/components/LocationsMap/utils/makeScaleUtils.js","webpack:///./src/modules/utilities/dateTime/formatDate.js","webpack:///./src/packages/travel/components/LocationsMap/utils/renderTitle.js","webpack:///./src/packages/travel/components/LocationsMap/utils/resolveMarkerUrl.js","webpack:///./src/packages/travel/components/LocationsMap/useMarkers.js","webpack:///./src/packages/travel/components/LocationsMap/blocks/MarkersScaleSelect/MarkersScaleSelect.jsx","webpack:///./src/packages/travel/components/LocationsMap/blocks/MarkersRatingLevelSelect/MarkersRatingLevelSelect.jsx","webpack:///./src/packages/travel/components/LocationsMap/useMarkersScaleSidebar.js","webpack:///./src/packages/travel/components/LocationsMap/LocationsMap.jsx","webpack:///./src/packages/travel/components/LocationsMap/utils/filterMarkerData.js"],"names":["Description","countriesIds","locationsDict","locationsIds","visitsPaths","usePaths","travel","visits","countriesCounter","resolvePlural","length","one","many","locationsCounter","filter","locationsId","locationClass","LOCATION_CLASSES_ID","CITY","calcCitiesCount","Markdown","toUrl","counter","pluralOptions","amount","few","value","Math","abs","propTypes","PropTypes","arrayOf","number","isRequired","objectOf","shape","locationPropTypes","ExternalLinks","Button","component","target","rel","href","src","alt","useStyles","makeStyles","content","display","flexDirection","height","mapContainer","flexGrow","TravelDashboard","classes","useQueryFilter","queryFilter","setQueryFilter","useMarkersScaleSidebar","scaleBy","ratingLevel","useTripsStats","userAlias","isReady","locationsRating","visitsDict","className","LocationsMap","minHeight","MARKERS_SCALES","BY_RATING","undefined","tripsProvision","requiredTripsIds","tripsIds","tripsDict","useSelector","state","selectDict","shouldRequireAllTrips","missingTripsIds","tripId","useProvision","domain","isProvision","modelName","observe","query","navigation","isDisabled","id","comparator","useTrips","useUser","user","userProvision","selectResult","data","ridesDict","countriesDict","visitsIds","useUniqField","ridesIds","countriesProvision","useCountries","locationsProvision","useLocations","commonProvisionState","provisions","updatesCounter","sum","map","selectUpdatesCounter","every","selectIsReady","isPending","some","selectIsPending","isValid","selectIsValid","error","find","selectIsError","errors","selectError","Boolean","invalidate","forEach","mergeProvisionsState","isError","ridesStats","calcRidesStats","earliestDeparture","Date","min","rideId","departureDateTime","getTime","latestArrival","max","arrivalDateTime","entitiesIds","entitiesDict","fieldName","useMemo","Array","from","Set","flatMap","entityId","safeDateFormat","date","isValidDate","args","dateFormat","Number","isNaN","requiredLocationIds","missingLocationsIds","locationId","condition","useLocationRatingRequest","useRequest","method","submitLocationRating","selectItem","applicableSchemaName","useVisit","requiredVisitId","visitId","visit","visit_id","useAddVisitPhotoRequest","contentType","submitVisitPhoto","components","a","children","startsWith","to","forwardedProps","adaptMarkerData","location","lon","lat","locationName","reduce","accumulator","firstVisitDateTime","lastVisitDateTime","resolveLocationFirstAndLastVisitDateTime","locationRating","visitsCount","BY_FIRST_VISIT","BY_LAST_VISIT","BY_VISITS_COUNT","MARKERS_SCALE_DEFAULT","MARKERS_SCALE_BY_TIME_FILENAMES","MARKERS_SCALE_BY_SOURCES","MARKERS_RATING_LEVELS","ALL","WANT_COME_BACK","LOVE_THIS_PLACE","MARKERS_RATING_LEVEL_DEFAULT","stepByVisitsCount","stepByRating","LOCATION_RATING","PLACE_TO_LIVE","FEW_PER_YEAR","ONCE_PER_YEAR","ONCE_PER_TWO_YEARS","ONCE_PER_FIVE_YEARS","ONCE_PER_DECADE","TWICE_PER_LIVE","ONCE_PER_LIVE","NEVER","makeScaleByDateTimeUtils","field","resolveStep","step","minTime","diff","floor","resolveOptions","markersDataList","times","markerData","formatDate","format","locale","ru","renderRating","resolveMarkerUrl","markerSources","subPath","MarkersScaleSelect","onClose","onChange","List","ListItem","FormControl","formControl","InputLabel","shrink","Select","labelId","autoWidth","event","nextScaleBy","updates","MenuItem","key","MarkersRatingLevelSelect","string","oneOf","Object","values","func","width","scaleByQuery","ratingLevelQuery","includes","resolveActualScaleBy","resolveActualRatingLevel","useSidebar","closeSidebar","googleMapContainer","margin","maxWidth","position","googleMapPosition","top","left","right","bottom","handleGoogleApiLoaded","markersData","useState","googleMapsApi","setGoogleMapsApi","isFirsRenderRef","useRef","useEffect","maps","bounds","LatLngBounds","markers","iconUrl","title","zIndex","marker","Marker","lng","icon","url","scaledSize","Size","scale","extend","current","setOptions","maxZoom","minZoom","fitBounds","setMap","setVisible","api","useMarkers","actualMarkersData","adaptedMarkersData","validMarkersData","filterMarkerData","makeScaleUtils","options","join","cls","bootstrapURLKeys","__GOOGLE_MAP_API_KEY__","center","zoom","onGoogleApiLoaded","visitsPropTypes","defaultProps"],"mappings":"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","file":"travel-Dashboard-fcd4b221afcd757c448c.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Markdown from 'modules/components/Markdown';\nimport { usePaths } from 'modules/packages';\nimport { plural } from 'modules/utilities/l10n';\nimport { LOCATION_CLASSES_ID } from 'travel/models/locations/consts';\nimport locationPropTypes from 'travel/models/locations/propTypes';\n\nexport default function Description({\n  countriesIds,\n  locationsDict,\n  locationsIds,\n}) {\n  const {\n    travel: { visits: visitsPaths },\n  } = usePaths();\n\n  const countriesCounter = resolvePlural(countriesIds.length, {\n    one: 'стране',\n    many: 'странах',\n  });\n  const locationsCounter = resolvePlural(\n    calcCitiesCount(locationsIds, locationsDict),\n    {\n      one: 'городе',\n      many: 'городах',\n    },\n  );\n\n  return (\n    <Markdown>\n      {`\nСтатистика по моим путешествиям.\n\nЗдесь будет красивая инфографика, рассказы и фотки про 250 стран и\nтерриторий. Пока я побывал только в\n[${countriesCounter}](${visitsPaths.toUrl()}) и \n[${locationsCounter}](${visitsPaths.toUrl()}),\nа раз так, то и на инфографику пока забил.\n  `}\n    </Markdown>\n  );\n}\n\nDescription.propTypes = {\n  countriesIds: PropTypes.arrayOf(PropTypes.number).isRequired,\n  locationsDict: PropTypes.objectOf(PropTypes.shape(locationPropTypes))\n    .isRequired,\n  locationsIds: PropTypes.arrayOf(PropTypes.number).isRequired,\n};\n\nfunction calcCitiesCount(locationsIds, locationsDict = {}) {\n  return locationsIds.filter(\n    locationsId =>\n      locationsDict[locationsId]?.locationClass === LOCATION_CLASSES_ID.CITY,\n  ).length;\n}\n\nfunction resolvePlural(counter, pluralOptions) {\n  if (counter == null) {\n    return `... ${pluralOptions.many}`;\n  }\n  return `${counter} ${plural(counter, pluralOptions)}`;\n}\n","/* eslint-disable import/prefer-default-export */\nexport function plural(amount, { many, few = many, one }) {\n  let value = Math.abs(amount);\n  value %= 100;\n  if (value >= 5 && value <= 20) {\n    return many;\n  }\n  value %= 10;\n  if (value === 1) {\n    return one;\n  }\n  if (value >= 2 && value <= 4) {\n    return few;\n  }\n  return many;\n}\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\n\nexport default function ExternalLinks() {\n  return (\n    <>\n      <div>\n        <Button\n          component=\"a\"\n          target=\"_blank\"\n          rel=\"nofollow noreferrer noopener\"\n          href=\"https://lobastov.livejournal.com/tag/%D0%9F%D1%83%D1%82%D0%B5%D1%88%D0%B5%D1%81%D1%82%D0%B2%D0%B8%D0%B5\"\n        >\n          Про путешествия в ЖЖ\n        </Button>\n      </div>\n      <a\n        href=\"https://my.flightradar24.com/lobastov\"\n        target=\"_blank\"\n        rel=\"nofollow noreferrer noopener\"\n      >\n        <img\n          src=\"https://banners-my.flightradar24.com/lobastov.png\"\n          alt=\"My Flightdiary.net profile\"\n        />\n      </a>\n    </>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useQueryFilter } from 'core/context/QueryFilterContext';\nimport { useTripsStats } from 'travel/dataSource';\nimport LocationsMap, {\n  useMarkersScaleSidebar,\n  MARKERS_SCALES,\n} from 'travel/components/LocationsMap';\nimport Description from './blocks/Description';\nimport ExternalLinks from './blocks/ExternalLinks';\n\nconst useStyles = makeStyles({\n  content: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: ' 100%',\n  },\n  mapContainer: {\n    flexGrow: 1,\n  },\n});\n\nexport default function TravelDashboard() {\n  const classes = useStyles();\n\n  const { queryFilter, setQueryFilter } = useQueryFilter();\n  const { scaleBy, ratingLevel } = useMarkersScaleSidebar(\n    setQueryFilter,\n    queryFilter,\n  );\n\n  const {\n    countriesIds,\n    isReady,\n    locationsDict,\n    locationsIds,\n    locationsRating,\n    visitsDict,\n  } = useTripsStats({\n    userAlias: 'my',\n  });\n\n  if (!isReady) {\n    return '...Loading';\n  }\n\n  return (\n    <div className={classes.content}>\n      <Description\n        countriesIds={countriesIds}\n        isReady={isReady}\n        locationsDict={locationsDict}\n        locationsIds={locationsIds}\n      />\n      <LocationsMap\n        className={classes.mapContainer}\n        locationsDict={locationsDict}\n        visitsDict={visitsDict}\n        locationsRating={locationsRating}\n        locationsIds={locationsIds}\n        minHeight={300}\n        scaleBy={scaleBy}\n        ratingLevel={\n          scaleBy === MARKERS_SCALES.BY_RATING ? ratingLevel : undefined\n        }\n      />\n      <ExternalLinks />\n    </div>\n  );\n}\n","import { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport max from 'lodash/max';\nimport min from 'lodash/min';\nimport { useProvision, selectDict } from 'core/connection';\nimport { selectResult } from 'core/connection/request/controllerRedux';\nimport mergeProvisionsState from 'core/connection/request/utils/mergeProvisionsState';\nimport useUser from './useUser';\nimport useCountries from './useCountries';\nimport useLocations from './useLocations';\n\nexport default function useTrips({ userAlias, tripsIds: requiredTripsIds }) {\n  const { tripsDict } = useSelector(state => ({\n    tripsDict: selectDict(state, 'trips') || {},\n  }));\n\n  const shouldRequireAllTrips = !requiredTripsIds;\n  const missingTripsIds =\n    !shouldRequireAllTrips &&\n    requiredTripsIds.filter(tripId => !tripsDict[tripId]);\n\n  return useProvision({\n    domain: `travel.trips-${userAlias}`,\n    isProvision: true,\n    modelName: 'trips',\n    observe: userAlias,\n    query: {\n      userAlias,\n      navigation: { isDisabled: true },\n      filter: shouldRequireAllTrips\n        ? {}\n        : { id: { comparator: 'in', value: missingTripsIds } },\n    },\n  });\n}\n\nexport function useTripsStats({ userAlias, tripsIds: requiredTripsIds }) {\n  const tripsProvision = useTrips({ userAlias, tripsIds: requiredTripsIds });\n  const { user: { locationsRating = {} } = {}, ...userProvision } = useUser({\n    domain: `travel.trips-${userAlias}.user`,\n    userAlias,\n  });\n\n  const { data: tripsIds = [] } = selectResult(tripsProvision) || {};\n\n  const {\n    tripsDict,\n    visitsDict,\n    ridesDict,\n    countriesDict,\n    locationsDict,\n  } = useSelector(state => ({\n    tripsDict: selectDict(state, 'trips') || {},\n    visitsDict: selectDict(state, 'visits') || {},\n    ridesDict: selectDict(state, 'rides') || {},\n    countriesDict: selectDict(state, 'countries') || {},\n    locationsDict: selectDict(state, 'locations') || {},\n  }));\n\n  const visitsIds = useUniqField(tripsIds, tripsDict, 'visits');\n  const ridesIds = useUniqField(tripsIds, tripsDict, 'rides');\n  const countriesIds = useUniqField(visitsIds, visitsDict, 'countryId');\n  const locationsIds = useUniqField(visitsIds, visitsDict, 'locationId');\n\n  const countriesProvision = useCountries();\n  const locationsProvision = useLocations({\n    domain: `travel.locations-${userAlias}`,\n    locationsIds,\n  });\n\n  const commonProvisionState = mergeProvisionsState(\n    tripsProvision,\n    userProvision,\n    countriesProvision,\n    locationsProvision,\n  );\n\n  const { isError, isValid, isReady, isPending } = commonProvisionState;\n\n  return {\n    userProvision,\n    tripsProvision,\n    countriesProvision,\n    locationsProvision,\n\n    isError,\n    isValid,\n    isReady,\n    isPending,\n\n    tripsIds,\n    tripsDict,\n    visitsIds,\n    visitsDict,\n    ridesIds,\n    ridesDict,\n    ridesStats: calcRidesStats(ridesIds, ridesDict),\n    locationsIds,\n    locationsDict,\n    locationsRating,\n    countriesIds,\n    countriesDict,\n  };\n}\n\nfunction calcRidesStats(ridesIds, ridesDict) {\n  return {\n    earliestDeparture: new Date(\n      min(\n        ridesIds.map(rideId => ridesDict[rideId]?.departureDateTime.getTime()),\n      ),\n    ),\n    latestArrival: new Date(\n      max(ridesIds.map(rideId => ridesDict[rideId]?.arrivalDateTime.getTime())),\n    ),\n  };\n}\n\nfunction useUniqField(entitiesIds, entitiesDict, fieldName) {\n  return useMemo(\n    () =>\n      Array.from(\n        new Set(\n          entitiesIds.flatMap(\n            entityId => entitiesDict[entityId]?.[fieldName] || [],\n          ),\n        ),\n      ),\n    [entitiesIds, entitiesDict, fieldName],\n  );\n}\n","import sum from 'lodash/sum';\nimport {\n  selectError,\n  selectIsError,\n  selectIsPending,\n  selectIsReady,\n  selectIsValid,\n  selectUpdatesCounter,\n} from '../controllerRedux';\n\nexport default function mergeProvisionsState(...provisions) {\n  return {\n    updatesCounter: sum(provisions.map(selectUpdatesCounter)),\n    isReady: provisions.every(selectIsReady),\n    isPending: provisions.some(selectIsPending),\n    isValid: provisions.every(selectIsValid),\n    error: provisions.find(selectIsError),\n    errors: provisions.map(selectError).filter(Boolean),\n    invalidate: () => provisions.forEach(({ invalidate }) => invalidate()),\n  };\n}\n","import { useProvision } from 'core/connection';\n\nexport default function useCountries() {\n  return useProvision({\n    domain: `travel.countries`,\n    isProvision: true,\n    modelName: 'countries',\n    query: { navigation: { isDisabled: true } },\n  });\n}\n","import dateFormat from 'date-fns/format';\nimport isValidDate from './isValidDate';\n\nexport default function safeDateFormat(date, ...args) {\n  if (!isValidDate(date)) {\n    return '?';\n  }\n  return dateFormat(date, ...args);\n}\n","export default function isValidDate(date) {\n  return date instanceof Date && !Number.isNaN(date.getTime());\n}\n","import { useSelector } from 'react-redux';\nimport { useProvision, useRequest, selectDict } from 'core/connection';\n\nexport default function useLocations({\n  domain,\n  locationsIds: requiredLocationIds,\n}) {\n  const locationsDict = useSelector(\n    state => selectDict(state, 'locations') || {},\n  );\n\n  const missingLocationsIds = requiredLocationIds.filter(\n    locationId => !locationsDict[locationId],\n  );\n\n  return useProvision({\n    domain,\n    isProvision: true,\n    modelName: 'locations',\n    observe: requiredLocationIds,\n    condition: Boolean(missingLocationsIds.length),\n    query: {\n      filter: { id: { comparator: 'in', value: missingLocationsIds } },\n      navigation: { isDisabled: true },\n    },\n  });\n}\n\nexport function useLocationRatingRequest({ domain }) {\n  const [submitLocationRating, provision] = useRequest({\n    domain,\n    modelName: 'locations',\n    method: 'POST',\n  });\n\n  return {\n    ...provision,\n    submitLocationRating,\n  };\n}\n","import { useSelector } from 'react-redux';\nimport { useProvision, selectItem } from 'core/connection';\n\nexport default function useUser({ domain, userAlias }) {\n  const user = useSelector(state => selectItem(state, 'users', userAlias));\n  const provision = useProvision({\n    domain,\n    applicableSchemaName: 'item',\n    isProvision: true,\n    modelName: 'users',\n    observe: userAlias,\n    condition: Boolean(userAlias),\n    query: {\n      id: userAlias,\n    },\n  });\n  return { ...provision, user };\n}\n","import { useSelector } from 'react-redux';\nimport { useProvision, useRequest, selectDict } from 'core/connection';\n\nexport default function useVisit({ userAlias, visitId: requiredVisitId }) {\n  const { visitsDict } = useSelector(state => ({\n    visitsDict: selectDict(state, 'visits') || {},\n  }));\n  const visit = visitsDict[requiredVisitId];\n\n  return {\n    visit,\n    ...useProvision({\n      domain: `travel.visit${requiredVisitId}-${userAlias}`,\n      isProvision: true,\n      modelName: 'visits',\n      observe: requiredVisitId,\n      condition: !visit,\n      query: {\n        userAlias,\n        filter: { visit_id: { comparator: '=', value: requiredVisitId } },\n        navigation: { isDisabled: true },\n      },\n    }),\n  };\n}\n\nexport function useAddVisitPhotoRequest({ domain }) {\n  const [submitVisitPhoto, provision] = useRequest({\n    domain,\n    modelName: 'visits', // todo: actually this is assets model, not visits. Moreover this is photos model\n    method: 'POST',\n    contentType: 'multipart/form-data',\n  });\n\n  return {\n    ...provision,\n    submitVisitPhoto,\n  };\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\n\nconst components = {\n  a: ({ href, children }) =>\n    href.startsWith && href.startsWith('/') ? (\n      <Link to={href}>{children}</Link>\n    ) : (\n      <a href={href}>{children}</a>\n    ),\n};\n\nexport default ({ children, forwardedProps }) => (\n  <ReactMarkdown {...forwardedProps} components={components}>\n    {children}\n  </ReactMarkdown>\n);\n","import resolveLocationFirstAndLastVisitDateTime from './resolveLocationFirstAndLastVisitDateTime';\n\nexport default function adaptMarkerData({\n  locationsIds,\n  locationsDict,\n  visitsDict,\n  locationsRating,\n}) {\n  return locationsIds.map(locationId => {\n    const location = locationsDict[locationId];\n    if (!location) {\n      return null;\n    }\n    const { lon, lat, locationName, visitsIds } = location;\n    const {\n      firstVisitDateTime,\n      lastVisitDateTime,\n    } = resolveLocationFirstAndLastVisitDateTime(visitsIds ?? [], visitsDict);\n\n    return {\n      locationName,\n      lat,\n      lon,\n      firstVisitDateTime,\n      lastVisitDateTime,\n      locationRating: locationsRating[locationId],\n      visitsCount: location.visitsIds?.length,\n    };\n  });\n}\n","import min from 'lodash/min';\nimport max from 'lodash/max';\n\nexport default function resolveLocationFirstAndLastVisitDateTime(\n  visitsIds,\n  visitsDict,\n) {\n  return visitsIds.reduce(\n    (accumulator, visitId) => {\n      const visit = visitsDict[visitId];\n      if (visit) {\n        const { arrivalDateTime, departureDateTime } = visit;\n        accumulator.firstVisitDateTime = min([\n          accumulator.firstVisitDateTime,\n          arrivalDateTime,\n        ]);\n        accumulator.lastVisitDateTime = max([\n          accumulator.lastVisitDateTime,\n          departureDateTime,\n        ]);\n      }\n      return accumulator;\n    },\n    { firstVisitDateTime: null, lastVisitDateTime: null },\n  );\n}\n","export const KEY_MARKERS_SCALE_BY = 'scale';\n\nexport const MARKERS_SCALES = {\n  BY_FIRST_VISIT: 'fv',\n  BY_LAST_VISIT: 'lv',\n  BY_VISITS_COUNT: 'vc',\n  BY_RATING: 'r',\n};\n\nexport const MARKERS_SCALE_DEFAULT = MARKERS_SCALES.BY_LAST_VISIT;\n\nexport const MARKERS_SCALE_IMAGES_BASE_PATH =\n  'https://res.cloudinary.com/dc2eke0gj/image/upload/markers/';\n\nexport const MARKERS_SCALE_BY_TIME_FILENAMES = [\n  'step_by_time_1_zjtrlw.png',\n  'step_by_time_2_tvotvg.png',\n  'step_by_time_3_ylj1vi.png',\n  'step_by_time_4_uovfrs.png',\n  'step_by_time_5_s4jq0u.png',\n  'step_by_time_6_lmihnf.png',\n];\n\nexport const MARKERS_SCALE_BY_RATING_FILENAMES = [\n  'step_by_rating_1_id2qgb.png',\n  'step_by_rating_2_iiqvik.png',\n  'step_by_rating_3_x2gzsd.png',\n  'step_by_rating_4_cbqdcn.png',\n  'step_by_rating_5_viyhls.png',\n  'step_by_rating_6_zzfgki.png',\n  'step_by_rating_7_pjjhhq.png',\n  'step_by_rating_8_vgetsd.png',\n  'step_by_rating_9_t6tenz.png',\n  'step_by_rating_10_yjywr0.png',\n];\n\nexport const MARKERS_SCALE_BY_VISITS_FILENAMES = [\n  'step_by_visits_1_zv3tba.png',\n  'step_by_visits_2_qthjqa.png',\n  'step_by_visits_3_xcjyla.png',\n  'step_by_visits_4_kwdwka.png',\n  'step_by_visits_5_xnnipa.png',\n];\n\nexport const MARKERS_SCALE_BY_SOURCES = {\n  [MARKERS_SCALES.BY_FIRST_VISIT]: MARKERS_SCALE_BY_TIME_FILENAMES,\n  [MARKERS_SCALES.BY_LAST_VISIT]: MARKERS_SCALE_BY_TIME_FILENAMES,\n  [MARKERS_SCALES.BY_VISITS_COUNT]: MARKERS_SCALE_BY_VISITS_FILENAMES,\n  [MARKERS_SCALES.BY_RATING]: MARKERS_SCALE_BY_RATING_FILENAMES,\n};\n\nexport const MARKERS_RATING_LEVELS = {\n  ALL: 'all',\n  WANT_COME_BACK: 'good',\n  LOVE_THIS_PLACE: 'best',\n};\n\nexport const KEY_MARKERS_RATING_LEVEL = 'rating';\n\nexport const MARKERS_RATING_LEVEL_DEFAULT = MARKERS_RATING_LEVELS.ALL;\n","import min from 'lodash/min';\nimport max from 'lodash/max';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\nimport { MARKERS_SCALES } from '../consts';\n\nexport default function makeScaleUtils(scaleBy) {\n  switch (scaleBy) {\n    case MARKERS_SCALES.BY_VISITS_COUNT:\n      return {\n        resolveStep: stepByVisitsCount,\n      };\n    case MARKERS_SCALES.BY_RATING:\n      return {\n        resolveStep: stepByRating,\n      };\n    case MARKERS_SCALES.BY_LAST_VISIT:\n      return makeScaleByDateTimeUtils('lastVisitDateTime');\n    case MARKERS_SCALES.BY_FIRST_VISIT:\n      return makeScaleByDateTimeUtils('firstVisitDateTime');\n    default:\n      return {\n        resolveStep: () => 1,\n      };\n  }\n}\n\nfunction stepByVisitsCount({ visitsCount }) {\n  switch (true) {\n    case visitsCount > 10:\n      return 5;\n    case visitsCount > 5:\n      return 4;\n    case visitsCount > 2:\n      return 3;\n    case visitsCount > 1:\n      return 2;\n    default:\n      return 1;\n  }\n}\n\nfunction stepByRating({ locationRating }) {\n  switch (locationRating) {\n    case LOCATION_RATING.PLACE_TO_LIVE:\n      return 1;\n    case LOCATION_RATING.FEW_PER_YEAR:\n    case LOCATION_RATING.ONCE_PER_YEAR:\n      return 3;\n    case LOCATION_RATING.ONCE_PER_TWO_YEARS:\n    case LOCATION_RATING.ONCE_PER_FIVE_YEARS:\n      return 4;\n    case LOCATION_RATING.ONCE_PER_DECADE:\n    case LOCATION_RATING.TWICE_PER_LIVE:\n      return 7;\n    case LOCATION_RATING.ONCE_PER_LIVE:\n      return 9;\n    case LOCATION_RATING.NEVER:\n      return 10;\n    default:\n      return 6;\n  }\n}\n\nconst stepsByDateTimeCount = 6;\nfunction makeScaleByDateTimeUtils(field) {\n  return {\n    resolveStep: function stepByDateTime(\n      { [field]: dateTime },\n      { minTime, diff },\n    ) {\n      const step = ((dateTime - minTime) / diff) * stepsByDateTimeCount;\n      return Math.min(Math.max(Math.floor(step), 0), stepsByDateTimeCount);\n    },\n    resolveOptions: function resolveOptionsForStepByDateTime(markersDataList) {\n      const times = markersDataList\n        .map(markerData => markerData[field] && markerData[field].getTime())\n        .filter(Boolean);\n\n      const minTime = min(times);\n      const maxTime = max(times) + 1;\n      const diff = maxTime - minTime;\n      return { minTime, diff };\n    },\n  };\n}\n","import ru from 'date-fns/locale/ru';\nimport dateFormat from './safeDateFormat';\n\nexport default function formatDate(date, format = 'eeeeee, d MMMM yyyy') {\n  return dateFormat(date, format, { locale: ru });\n}\n","import formatDate from 'modules/utilities/dateTime/formatDate';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\n\nexport default function renderTitle({\n  locationName,\n  locationRating,\n  visitsCount,\n  firstVisitDateTime,\n  lastVisitDateTime,\n}) {\n  return [\n    locationName,\n    `Посещено ${visitsCount} раз`,\n    `Впервые ${formatDate(firstVisitDateTime)}`,\n    visitsCount > 1 && `Прошлое посешение ${formatDate(lastVisitDateTime)}`,\n    `Рейтинг: ${renderRating(locationRating)}`,\n  ]\n    .filter(Boolean)\n    .join('\\n');\n}\n\nfunction renderRating(locationRating) {\n  switch (locationRating) {\n    case LOCATION_RATING.PLACE_TO_LIVE:\n      return 'Жил бы здесь';\n    case LOCATION_RATING.FEW_PER_YEAR:\n    case LOCATION_RATING.ONCE_PER_YEAR:\n      return 'Готов ездить сюда постоянно';\n    case LOCATION_RATING.ONCE_PER_TWO_YEARS:\n    case LOCATION_RATING.ONCE_PER_FIVE_YEARS:\n      return 'Приезжал бы иногда';\n    case LOCATION_RATING.ONCE_PER_DECADE:\n    case LOCATION_RATING.TWICE_PER_LIVE:\n      return 'Заглянул бы еще разок';\n    case LOCATION_RATING.ONCE_PER_LIVE:\n      return 'Одного посещения достаточно';\n    case LOCATION_RATING.NEVER:\n      return 'Тут нечего делать';\n    default:\n      return '?';\n  }\n}\n","import {\n  MARKERS_SCALE_BY_SOURCES,\n  MARKERS_SCALE_BY_TIME_FILENAMES,\n  MARKERS_SCALE_IMAGES_BASE_PATH,\n} from '../consts';\n\nexport default function resolveMarkerUrl(step, scaleBy) {\n  if (!scaleBy) {\n    return `${MARKERS_SCALE_IMAGES_BASE_PATH}${\n      MARKERS_SCALE_BY_TIME_FILENAMES[0]\n    }`;\n  }\n  const markerSources = MARKERS_SCALE_BY_SOURCES[scaleBy];\n  const subPath = markerSources[step - 1] || markerSources[0];\n  return `${MARKERS_SCALE_IMAGES_BASE_PATH}${subPath}`;\n}\n","import { useState, useEffect, useRef } from 'react';\n\nexport default markersData => {\n  const [googleMapsApi, setGoogleMapsApi] = useState(null);\n\n  const isFirsRenderRef = useRef(true);\n\n  useEffect(\n    () => {\n      if (!googleMapsApi) {\n        return undefined;\n      }\n      const { map, maps } = googleMapsApi;\n      const bounds = new maps.LatLngBounds();\n      const markers = markersData.map(\n        ({ lat, lon, iconUrl, title, zIndex }) => {\n          const marker = new maps.Marker({\n            map,\n            position: { lat, lng: lon },\n            icon: {\n              url: iconUrl,\n              scaledSize: new maps.Size(24, 24),\n            },\n            scale: 0.5,\n            title,\n            zIndex,\n          });\n          bounds.extend(marker.position);\n          return marker;\n        },\n      );\n      if (isFirsRenderRef.current) {\n        map.setOptions({ maxZoom: 11, minZoom: 2 });\n        map.fitBounds(bounds);\n        map.setOptions({ maxZoom: null, minZoom: null });\n        isFirsRenderRef.current = false;\n      }\n      return () => {\n        markers.forEach(marker => {\n          marker.setMap(null);\n          marker.setVisible(false);\n        });\n        markers.length = 0;\n      };\n    },\n    [googleMapsApi, markersData],\n  );\n  return { handleGoogleApiLoaded: api => setGoogleMapsApi(api) };\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport {\n  MARKERS_SCALES,\n  KEY_MARKERS_SCALE_BY,\n  KEY_MARKERS_RATING_LEVEL,\n} from '../../consts';\n\nexport default function MarkersScaleSelect({\n  classes,\n  scaleBy,\n  onClose,\n  onChange,\n}) {\n  return (\n    <List>\n      <ListItem>\n        <FormControl className={classes.formControl}>\n          <InputLabel shrink={true} id=\"select-scaleBy-filter-label\">\n            Раскрасить маркеры\n          </InputLabel>\n          <Select\n            labelId=\"select-scaleBy-filter-label\"\n            autoWidth={true}\n            id=\"select-scaleBy-filter\"\n            value={scaleBy}\n            onChange={event => {\n              onClose();\n              const nextScaleBy = event.target.value;\n              const updates = { [KEY_MARKERS_SCALE_BY]: nextScaleBy };\n              if (nextScaleBy !== MARKERS_SCALES.BY_RATING) {\n                updates[KEY_MARKERS_RATING_LEVEL] = undefined;\n              }\n              onChange(updates);\n            }}\n          >\n            <MenuItem\n              key={MARKERS_SCALES.BY_FIRST_VISIT}\n              value={MARKERS_SCALES.BY_FIRST_VISIT}\n            >\n              По первому посещению\n            </MenuItem>\n            <MenuItem\n              key={MARKERS_SCALES.BY_LAST_VISIT}\n              value={MARKERS_SCALES.BY_LAST_VISIT}\n            >\n              По последнему посещению\n            </MenuItem>\n            <MenuItem\n              key={MARKERS_SCALES.BY_VISITS_COUNT}\n              value={MARKERS_SCALES.BY_VISITS_COUNT}\n            >\n              По числу посещений\n            </MenuItem>\n            <MenuItem\n              key={MARKERS_SCALES.BY_RATING}\n              value={MARKERS_SCALES.BY_RATING}\n            >\n              По рейтингу\n            </MenuItem>\n          </Select>\n        </FormControl>\n      </ListItem>\n    </List>\n  );\n}\n\nMarkersScaleSelect.propTypes = {\n  classes: PropTypes.shape({ formControl: PropTypes.string.isRequired })\n    .isRequired,\n  scaleBy: PropTypes.oneOf(Object.values(MARKERS_SCALES)).isRequired,\n  onClose: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { MARKERS_RATING_LEVELS, KEY_MARKERS_RATING_LEVEL } from '../../consts';\n\nexport default function MarkersRatingLevelSelect({\n  classes,\n  ratingLevel,\n  onClose,\n  onChange,\n}) {\n  return (\n    <List>\n      <ListItem>\n        <FormControl className={classes.formControl}>\n          <InputLabel shrink={true} id=\"select-ratingLevel-filter-label\">\n            Фильтр по рейтингу\n          </InputLabel>\n          <Select\n            labelId=\"select-ratingLevel-filter-label\"\n            autoWidth={true}\n            id=\"select-ratingLevel-filter\"\n            value={ratingLevel}\n            onChange={event => {\n              onClose();\n              onChange({\n                [KEY_MARKERS_RATING_LEVEL]: event.target.value,\n              });\n            }}\n          >\n            <MenuItem\n              key={MARKERS_RATING_LEVELS.ALL}\n              value={MARKERS_RATING_LEVELS.ALL}\n            >\n              Все\n            </MenuItem>\n            <MenuItem\n              key={MARKERS_RATING_LEVELS.WANT_COME_BACK}\n              value={MARKERS_RATING_LEVELS.WANT_COME_BACK}\n            >\n              Куда бы вернулся\n            </MenuItem>\n            <MenuItem\n              key={MARKERS_RATING_LEVELS.LOVE_THIS_PLACE}\n              value={MARKERS_RATING_LEVELS.LOVE_THIS_PLACE}\n            >\n              Лучшие места\n            </MenuItem>\n          </Select>\n        </FormControl>\n      </ListItem>\n    </List>\n  );\n}\n\nMarkersRatingLevelSelect.propTypes = {\n  classes: PropTypes.shape({ formControl: PropTypes.string.isRequired })\n    .isRequired,\n  ratingLevel: PropTypes.oneOf(Object.values(MARKERS_RATING_LEVELS)).isRequired,\n  onClose: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useSidebar } from 'core/context/SidebarContext';\nimport MarkersScaleSelect from './blocks/MarkersScaleSelect';\nimport MarkersRatingLevelSelect from './blocks/MarkersRatingLevelSelect';\nimport {\n  MARKERS_SCALES,\n  KEY_MARKERS_SCALE_BY,\n  MARKERS_SCALE_DEFAULT,\n  MARKERS_RATING_LEVELS,\n  KEY_MARKERS_RATING_LEVEL,\n  MARKERS_RATING_LEVEL_DEFAULT,\n} from './consts';\n\nconst useStyles = makeStyles({\n  formControl: {\n    width: '100%',\n  },\n});\n\nexport default function(setQueryFilter, queryFilter) {\n  const classes = useStyles();\n  const {\n    [KEY_MARKERS_SCALE_BY]: scaleByQuery,\n    [KEY_MARKERS_RATING_LEVEL]: ratingLevelQuery,\n  } = queryFilter || {};\n  const scaleBy = resolveActualScaleBy(scaleByQuery);\n  const ratingLevel = resolveActualRatingLevel(ratingLevelQuery);\n  useSidebar(\n    ({ closeSidebar }) => (\n      <>\n        <MarkersScaleSelect\n          classes={classes}\n          onClose={closeSidebar}\n          scaleBy={scaleBy}\n          onChange={setQueryFilter}\n        />\n        {scaleBy === MARKERS_SCALES.BY_RATING && (\n          <MarkersRatingLevelSelect\n            classes={classes}\n            onClose={closeSidebar}\n            ratingLevel={ratingLevel}\n            onChange={setQueryFilter}\n          />\n        )}\n      </>\n    ),\n    [scaleBy, ratingLevel],\n  );\n\n  return { scaleBy, ratingLevel };\n}\n\nfunction resolveActualScaleBy(scaleByQuery) {\n  return Object.values(MARKERS_SCALES).includes(scaleByQuery)\n    ? scaleByQuery\n    : MARKERS_SCALE_DEFAULT;\n}\nfunction resolveActualRatingLevel(ratingLevelQuery) {\n  return Object.values(MARKERS_RATING_LEVELS).includes(ratingLevelQuery)\n    ? ratingLevelQuery\n    : MARKERS_RATING_LEVEL_DEFAULT;\n}\n","/* globals __GOOGLE_MAP_API_KEY__ */\nimport React, { useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport cls from 'classnames';\nimport GoogleMapReact from 'google-map-react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport locationPropTypes from 'travel/models/locations/propTypes';\nimport visitsPropTypes from 'travel/models/visits/propTypes';\nimport adaptMarkerData from './utils/adaptMarkerData';\nimport filterMarkerData from './utils/filterMarkerData';\nimport makeScaleUtils from './utils/makeScaleUtils';\nimport renderTitle from './utils/renderTitle';\nimport resolveMarkerUrl from './utils/resolveMarkerUrl';\nimport { MARKERS_SCALES, MARKERS_RATING_LEVELS } from './consts';\nimport useMarkers from './useMarkers';\n\nexport { MARKERS_SCALES, MARKERS_RATING_LEVELS };\nexport useMarkersScaleSidebar from './useMarkersScaleSidebar';\n\nconst useStyles = makeStyles({\n  googleMapContainer: {\n    margin: '12px 0',\n    maxWidth: '100%',\n    flexGrow: 1,\n    minHeight: ({ minHeight }) => minHeight,\n    position: 'relative',\n  },\n  googleMapPosition: {\n    position: 'absolute',\n    top: '0',\n    left: '0',\n    right: '0',\n    bottom: '0',\n  },\n});\n\nexport default function LocationsMap({\n  className,\n  locationsDict,\n  visitsDict,\n  locationsRating,\n  locationsIds,\n  minHeight,\n  scaleBy,\n  ratingLevel,\n}) {\n  const classes = useStyles({ minHeight });\n  const markersData = useMemo(\n    () => {\n      const adaptedMarkersData = adaptMarkerData({\n        locationsDict,\n        visitsDict,\n        locationsRating,\n        locationsIds,\n      });\n      const actualMarkersData = filterMarkerData(adaptedMarkersData, {\n        ratingLevel,\n      });\n      const { resolveStep, resolveOptions } = makeScaleUtils(scaleBy);\n      const options = resolveOptions && resolveOptions(actualMarkersData);\n      return actualMarkersData.map(markerData => {\n        const step = resolveStep(markerData, options);\n        return {\n          ...markerData,\n          zIndex: [\n            MARKERS_SCALES.BY_RATING,\n            MARKERS_SCALES.BY_FIRST_VISIT,\n          ].includes(scaleBy)\n            ? 10 - step\n            : step,\n          iconUrl: resolveMarkerUrl(step, scaleBy),\n          title: renderTitle(markerData),\n        };\n      });\n    },\n    [\n      locationsDict,\n      visitsDict,\n      locationsRating,\n      locationsIds,\n      scaleBy,\n      ratingLevel,\n    ],\n  );\n  const { handleGoogleApiLoaded } = useMarkers(markersData);\n\n  return (\n    <div className={cls(className, classes.googleMapContainer)}>\n      <div className={classes.googleMapPosition}>\n        <GoogleMapReact\n          bootstrapURLKeys={{ key: __GOOGLE_MAP_API_KEY__ }}\n          center={{ lat: 0, lng: 0 }}\n          zoom={11}\n          onGoogleApiLoaded={handleGoogleApiLoaded}\n        />\n      </div>\n    </div>\n  );\n}\n\nLocationsMap.propTypes = {\n  className: PropTypes.string,\n  visitsDict: PropTypes.objectOf(PropTypes.shape(visitsPropTypes)).isRequired,\n  locationsDict: PropTypes.objectOf(PropTypes.shape(locationPropTypes))\n    .isRequired,\n  locationsIds: PropTypes.arrayOf(PropTypes.number).isRequired,\n  locationsRating: PropTypes.objectOf(PropTypes.number).isRequired,\n  minHeight: PropTypes.number,\n  scaleBy: PropTypes.oneOf(Object.values(MARKERS_SCALES)).isRequired,\n  ratingLevel: PropTypes.oneOf(Object.values(MARKERS_RATING_LEVELS)).isRequired,\n};\n\nLocationsMap.defaultProps = {\n  className: undefined,\n  minHeight: '400px',\n};\n","import { MARKERS_RATING_LEVELS } from '../consts';\nimport { LOCATION_RATING } from 'travel/models/users/consts';\n\nexport default function filterMarkerData(adaptedMarkersData, { ratingLevel }) {\n  const validMarkersData = adaptedMarkersData.filter(Boolean);\n  if (\n    !Object.values(MARKERS_RATING_LEVELS).includes(ratingLevel) ||\n    ratingLevel === MARKERS_RATING_LEVELS.ALL\n  ) {\n    return validMarkersData;\n  }\n  return validMarkersData.filter(({ locationRating, visitsCount }) => {\n    switch (ratingLevel) {\n      case MARKERS_RATING_LEVELS.WANT_COME_BACK:\n        if (visitsCount < 2) {\n          return locationRating <= LOCATION_RATING.TWICE_PER_LIVE;\n        }\n        return locationRating <= LOCATION_RATING.ONCE_PER_DECADE;\n      case MARKERS_RATING_LEVELS.LOVE_THIS_PLACE:\n        return locationRating <= LOCATION_RATING.ONCE_PER_YEAR;\n      default:\n        return true;\n    }\n  });\n}\n"],"sourceRoot":""}