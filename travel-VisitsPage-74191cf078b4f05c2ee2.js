(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1034:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(147)).default)(a.default.createElement("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorder");t.default=i},1035:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(147)).default)(a.default.createElement("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm0 12l-4.34 4.34L12 14H3v-2l3-7h9v10zm4-12h4v12h-4z"}),"ThumbDownOutlined");t.default=i},1036:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(147)).default)(a.default.createElement("path",{d:"M12 6c0-.55-.45-1-1-1H5.82l.66-3.18.02-.23c0-.31-.13-.59-.33-.8L5.38 0 .44 4.94C.17 5.21 0 5.59 0 6v6.5c0 .83.67 1.5 1.5 1.5h6.75c.62 0 1.15-.38 1.38-.91l2.26-5.29c.07-.17.11-.36.11-.55V6zm-2 1.13L7.92 12H2V6.21l1.93-1.93L3.36 7H10v.13zM22.5 10h-6.75c-.62 0-1.15.38-1.38.91l-2.26 5.29c-.07.17-.11.36-.11.55V18c0 .55.45 1 1 1h5.18l-.66 3.18-.02.24c0 .31.13.59.33.8l.79.78 4.94-4.94c.27-.27.44-.65.44-1.06v-6.5c0-.83-.67-1.5-1.5-1.5zm-.5 7.79l-1.93 1.93.57-2.72H14v-.13L16.08 12H22v5.79z"}),"ThumbsUpDownOutlined");t.default=i},1101:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return tt}));var n,a,i=r(0),o=r.n(i),c=r(35),u=r(818),l=r(198),s=r(132);function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v="loc",d="c",p="yr",O="yr_c",m="c_yr",y="t",E="t_с",b={TRIPS:"trips",LOCATIONS:"locations"},I=b.TRIPS,g=(f(n={},b.LOCATIONS,[{key:v,l10n:"По городам"},{key:d,l10n:"По странам"},{key:p,l10n:"По годам"},{key:O,l10n:"По годам и странам"},{key:m,l10n:"По странам и годам"}]),f(n,b.TRIPS,[{key:y,l10n:"По поездкам"},{key:E,l10n:"По поездкам и странам"}]),n),T=(f(a={},b.LOCATIONS,d),f(a,b.TRIPS,y),a),h={RATING_ALPHABET:"r_a",VISITS_ALPHABET:"v_a",ALPHABET:"a"},A=h.ALPHABET,j={VISIT:{ARRIVAL_YEAR:"ARRIVAL_YEAR"},TRIP:{DEPARTURE_TIME:"TRIP_DEPARTURE_DATE",ID:"TRIP_ID",PRESERVE_ORDER:"PRESERVE_ORDER"},COUNTRY:{VISITS:"COUNTRY_VISITS",RATING:"COUNTRY_RATING",NAME_ID:"COUNTRY_NAME_ID"},LOCATION:{VISITS:"LOCATION_VISITS",RATING:"LOCATION_RATING",NAME_ID:"LOCATION_NAME_ID"}},N=r(791),R=Object(N.a)((function(e){return{visibilityTrigger:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"},group:{backgroundColor:"white",top:0,"&:not(:first-of-type)":{marginTop:e.spacing(5)},"& ~ $subgroup":{marginTop:e.spacing(2)},"& + $subgroup ":{marginTop:0}},subgroup:{backgroundColor:"white",top:38},detail:{color:"gray",fontSize:12},formControl:{width:"100%"},ratingBlock:{display:"inline-flex",alignItems:"center"},ratingIcon:{color:"gray",fontSize:12},halfDown:{position:"relative",top:12}}})),P=r(795),C=r(796),D=r(1085),_=r(1110),S=r(1102),L=r(1088),w=r(199);function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var B=function(e,t,r){var n=R(),a=t||{},i=a.group,c=function(e){return Object.values(h).includes(e)?e:A}(a.sort),u=Y(function(e,t){var r=Object.values(b).includes(t)?t:I,n=g[r]||[];return[n.find((function(t){return t.key===e}))?e:T[r],n]}(i,r),2),l=u[0],s=u[1];return Object(w.b)((function(t){var r=t.closeSidebar;return o.a.createElement(P.a,null,o.a.createElement(C.a,null,o.a.createElement(D.a,{className:n.formControl},o.a.createElement(_.a,{shrink:!0,id:"select-groupBy-filter-label"},"Сгруппировать"),o.a.createElement(S.a,{labelId:"select-groupBy-filter-label",autoWidth:!0,id:"select-groupBy-filter",value:l,onChange:function(t){r(),e(V({},"group",t.target.value))}},s.map((function(e){return o.a.createElement(L.a,{key:e.key,value:e.key},e.l10n)}))))),l!==y&&o.a.createElement(C.a,null,o.a.createElement(D.a,{className:n.formControl},o.a.createElement(_.a,{shrink:!0,id:"select-sortBy-filter-label"},"Сортировать"),o.a.createElement(S.a,{labelId:"select-sortBy-filter-label",autoWidth:!0,id:"select-sortBy-filter",value:c,onChange:function(t){r(),e(V({},"sort",t.target.value))}},o.a.createElement(L.a,{value:h.ALPHABET},"По алфавиту"),o.a.createElement(L.a,{value:h.VISITS_ALPHABET},"По числу посещений"),o.a.createElement(L.a,{value:h.RATING_ALPHABET},"По рейтингу")))))}),[l,c]),{groupBy:l,sortBy:c}};var M=r(93),H=r.n(M),k=r(421),U=r.n(k),x=r(834),G=r.n(x);function F(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var z=function(e,t){var r;void 0===t&&(t=F);var n,a=[],i=!1;return function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];return i&&r===this&&t(o,a)?n:(n=e.apply(this,o),i=!0,r=this,a=o,n)}};function q(e,t){return"t".concat(e,"_c").concat(t)}function W(e,t){return"y".concat(e,"_c").concat(t)}function J(e){var t=e.arrivalDateTime;return t?t.getFullYear(t):null}function K(e){return e===y||e===E}var $,Q=null,X=null;function Z(e,t,r,n){var a=e[t];a||(a=e[t]={});var i=a[r];i||(i=a[r]={});var o=i[n]||0;i[n]=o+1}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.locations,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).visits,i=void 0===a?{}:a;return Object.keys(i).length}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.countries,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).visits,i=void 0===a?{}:a;return Object.keys(i).length}function re(e,t,r){var n=e.years,a=(n=void 0===n?{}:n)[r],i=(a=void 0===a?{}:a).locations;return(i=void 0===i?{}:i)[t]}function ne(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ie=(ae($={},j.VISIT.ARRIVAL_YEAR,(function(){return function(e,t){var r=e.arrivalDateTime,n=t.arrivalDateTime;return r||n?r&&n?n.getFullYear()-r.getFullYear():r?-1:1:0}})),ae($,j.COUNTRY.NAME_ID,(function(e){var t=e.countriesDict;return function(e,r){var n=e.countryId,a=r.countryId,i=(t[n]||{}).countryName,o=(t[a]||{}).countryName;return i>o?1:o>i?-1:n-a}})),ae($,j.COUNTRY.RATING,(function(e){var t=e.countriesRating;return function(e,r){var n=e.countryId,a=r.countryId;return(t[n]||10)-(t[a]||10)}})),ae($,j.COUNTRY.VISITS,(function(e,t){return function(e,r){var n=e.countryId,a=r.countryId;return te(t,a)-te(t,n)}})),ae($,j.LOCATION.NAME_ID,(function(){return function(e,t){var r=e.locationId,n=e.locationName,a=t.locationId,i=t.locationName;return n>i?1:i>n?-1:r-a}})),ae($,j.LOCATION.RATING,(function(e){var t=e.locationsRating;return function(e,r){var n=e.locationId,a=r.locationId;return(t[n]||10)-(t[a]||10)}})),ae($,j.LOCATION.VISITS,(function(e,t){return function(e,r){var n=e.locationId,a=r.locationId;return ee(t,a)-ee(t,n)}})),ae($,j.TRIP.PRESERVE_ORDER,(function(e){var t=e.tripsIds;return function(e,r){if(!t)return 0;var n=e.tripId,a=r.tripId,i=t.indexOf(n),o=t.indexOf(a);return i<0||o<0?i<0&&o<0?0:o<0?-1:1:i-o}})),ae($,j.TRIP.DEPARTURE_TIME,(function(e){var t=e.tripsDict;return function(e,r){var n=e.tripId,a=r.tripId,i=(t[n]||{}).departureDateTime,o=(t[a]||{}).departureDateTime;return i||o?i&&o?o.getFullYear()-i.getFullYear():i?-1:1:0}})),ae($,j.TRIP.ID,(function(){return function(e,t){return e.tripId-t.tripId}})),$);function oe(e,t){switch(e){case h.VISITS_ALPHABET:return[null==t?void 0:t.VISITS];case h.RATING_ALPHABET:return[null==t?void 0:t.RATING,null==t?void 0:t.VISITS];default:return[]}}function ce(e,t,r){var n=r.map((function(r){var n=ie[r];return H()(n,"missing comparatorKey: %s",r),n?n(e,t):null})).filter(Boolean);return function(e,t){for(var r=0;r<n.length;r+=1){var a=n[r](e,t);if(a)return a}return 0}}z((function(e){return U()((function(t){var r=Object.values(e).filter((function(e){var r=e.countryId;return t===r})).map((function(e){return e.rating}));return r.length?G()(r)/r.length:0}))}));var ue=r(169);function le(e){var t=e.country,r=(t=void 0===t?{}:t).countryName,n=e.isSubgroup,a=e.isDetail,i=e.className,c=e.children;return a?o.a.createElement("span",{className:i},r):o.a.createElement(ue.a,{variant:n?"h5":"h4",className:i},r," ",c)}function se(e){var t,r,n,a,i,c,u=e.visit,l=u.tripId,s=u.visitId,f=u.countryId,v=e.changes,p=v.isTripChanged,y=v.isCountryChanged,b=e.provision.countriesDict,I=e.groupBy,g=e.year,T=e.counters,h=e.classes,A=I===E,j=I===O;if(!(y||A&&p))return null;var N=0;switch(I){case d:N=Object.keys((null==T?void 0:null===(t=T.countries)||void 0===t?void 0:null===(r=t[f])||void 0===r?void 0:r.locations)||{}).length;break;case m:case O:N=Object.keys((null==T?void 0:null===(n=T.yearsCountries)||void 0===n?void 0:null===(a=n[W(g,f)])||void 0===a?void 0:a.locations)||{}).length;break;case E:N=Object.keys((null==T?void 0:null===(i=T.tripsCountries)||void 0===i?void 0:null===(c=i[q(l,f)])||void 0===c?void 0:c.locations)||{}).length}var R=A||j;return o.a.createElement(le,{key:"c".concat(f,"_v").concat(s),country:b[f],isSubgroup:R,className:R?h.subgroup:h.group},N>2&&o.a.createElement("span",{className:h.detail},"".concat(N," мест")))}var fe=r(1089),ve=r(1034),de=r.n(ve),pe=r(1035),Oe=r.n(pe),me=r(1036),ye=r.n(me),Ee=r(808),be=r(836),Ie=r(84),ge=r(798);function Te(){return(Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function he(e){return o.a.createElement(ge.a,Te({},e,{component:Ie.b}))}var Ae=Object(N.a)({autoMargin:{marginLeft:"auto"}});function je(e){var t=e.children,r=e.shouldJustifyContent,n=e.href,a=e.location,i=(a=void 0===a?{}:a).locationName,c=Ae(),u=o.a.Children.toArray(t);if(!r||u.length<=1)return o.a.createElement(ue.a,null,i," ",t);var l=u.slice(-1),s=u.slice(0,-1);return o.a.createElement(fe.a,{container:!0,justify:"space-between",alignItems:"center"},o.a.createElement(fe.a,{item:!0},o.a.createElement(ue.a,null,n?o.a.createElement(he,{to:n},i):i," ",s)),o.a.createElement(fe.a,{item:!0,classes:{item:c.autoMargin}},l))}Object(N.a)({photosContainer:{display:"flex",justifyContent:"space-between"},photoContainer:{margin:"4px 12px 12px",minWidth:"150px",maxHeight:"100px",textAlign:"center"},photo:{maxWidth:"150px",borderRadius:"4px"}});var Ne=r(232),Re=[v,p,y],Pe=[v,d];function Ce(e){var t=e.visit,r=e.visit,n=(r.tripId,r.visitId),a=r.locationId,i=r.countryId,c=r.departureRideId,u=e.classes,l=e.changes,s=l.isYearChanged,f=l.isCountryChanged,E=l.isTripChanged,b=l.isLocationChanged,I=e.year,g=e.provision,T=g.locationsDict,A=g.locationsRating,j=g.countriesDict,N=g.visitsDict,R=g.ridesDict,P=e.groupBy,C=e.sortBy,D=e.counters,_=e.visitEditUrl,S=P===y;if(!(S||E||s||f||b))return null;var L=Re.includes(P)?o.a.createElement(le,{country:j[i],className:u.detail,isDetail:!0}):null,w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=e.locationId;switch(n){case v:case d:return ee(t,a);case p:case m:case O:return re(t,a,r)}}(t,D,I,P),V=C!==h.RATING_ALPHABET&&w>1?o.a.createElement("span",{className:u.detail},"".concat(w," визитов")):null,Y=C!==h.RATING_ALPHABET&&Pe.includes(P)?o.a.createElement("span",{className:u.detail},"в ".concat(function(e,t){var r=e.locations,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).years,i=void 0===a?{}:a;return Object.keys(i)}(D,a).join(", "))):null,B=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).reduce((function(e,t,r){return r>0&&e.push(o.a.createElement("span",null," ")),e.push(t),e}),[])}(L,C===h.RATING_ALPHABET?function(e){var t=e.locationRating,r=e.classes;return o.a.createElement("div",{className:r.ratingBlock},function(e){var t=e.locationRating,r=e.classes;switch(t){case Ne.LOCATION_RATING.PLACE_TO_LIVE:return o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}));case Ne.LOCATION_RATING.FEW_PER_YEAR:case Ne.LOCATION_RATING.ONCE_PER_YEAR:return o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}));case Ne.LOCATION_RATING.ONCE_PER_TWO_YEARS:case Ne.LOCATION_RATING.ONCE_PER_FIVE_YEARS:return o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}));case Ne.LOCATION_RATING.ONCE_PER_DECADE:case Ne.LOCATION_RATING.TWICE_PER_LIVE:return o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{className:r.ratingIcon}),o.a.createElement(de.a,{className:r.ratingIcon}));case Ne.LOCATION_RATING.ONCE_PER_LIVE:return o.a.createElement(de.a,{className:r.ratingIcon});case Ne.LOCATION_RATING.NEVER:return o.a.createElement(Oe.a,{className:r.ratingIcon});default:return o.a.createElement(ye.a,{className:r.ratingIcon})}}({locationRating:t,classes:r}))}({classes:u,locationRating:null==A?void 0:A[a]}):null,V,Y);return o.a.createElement(o.a.Fragment,{key:"l".concat(a,"_v").concat(n)},o.a.createElement(je,{location:T[a],country:j[i],shouldJustifyContent:S,href:_},B,S&&o.a.createElement(fe.a,{container:!0},o.a.createElement(fe.a,{item:!0},o.a.createElement(ue.a,{className:u.detail},Object(Ee.b)(N[n]))),o.a.createElement(fe.a,{item:!0},o.a.createElement(be.a,{ride:R[c],className:u.halfDown})))))}var De=[v,p,y];function _e(e){var t=e.keyBase,r=e.children,n=e.classes,a=e.visit.tripId,i=e.provision,c=i.tripsDict,u=i.locationsDict,l=i.countriesDict,s=e.groupBy,f=c[a];if(!f)return null;var v=f.originLocationId,d=u[v];if(!d)return null;var p=d.countryId,O=De.includes(s)?o.a.createElement(le,{country:l[p],className:n.detail,isDetail:!0}):null;return o.a.createElement(je,{key:"".concat(t,"_t").concat(a,"_ol").concat(v),location:u[v],country:l[p],shouldJustifyContent:null!=r},O,r)}function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function we(e){var t=e.visit.arrivalRideId,r=e.classes,n=e.changes.isTripChanged,a=e.provision.ridesDict;return n?_e(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){Le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{keyBase:"dl",children:o.a.createElement(be.a,{ride:a[t],className:r.halfDown})})):null}function Ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(e){return e.changes.willTripChange?_e(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){Ye(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{keyBase:"al"})):null}var Me=r(150),He=r.n(Me),ke=r(801),Ue=r(918),xe=r.n(Ue),Ge=r(873);function Fe(e){var t=e.trip,r=e.visitsDict,n=e.countriesDict,a=e.locationsDict,i=e.children,c=e.className;return o.a.createElement(ue.a,{variant:"h4",className:c,paragraph:!0},o.a.createElement("span",null,Object(Ge.a)(t,r,n,a)),i)}function ze(e){var t=e.visit,r=t.visitId,n=t.tripId,a=e.changes.isTripChanged,i=e.provision,c=i.tripsDict,u=i.visitsDict,l=i.countriesDict,s=i.locationsDict,f=e.travelPaths.tripEdit,v=e.hasEditRights,d=e.userAlias,p=e.classes;if(!a)return null;var O=v?o.a.createElement(ke.a,{className:p.visibleOnlyOnHover,href:f.toUrl({userAlias:d,strTripId:String(n)}),size:"small"},o.a.createElement(xe.a,null)):null;return o.a.createElement(Fe,{key:"t".concat(n,"_v").concat(r),className:He()(p.visibilityTrigger,p.group),trip:c[n],visitsDict:u,countriesDict:l,locationsDict:s},O)}function qe(e){var t=e.year,r=e.isSubgroup,n=R();return o.a.createElement(ue.a,{variant:r?"h5":"h4",className:r?n.subgroup:n.group},t)}function We(e){var t=e.visit.visitId,r=e.changes,n=r.isYearChanged,a=r.isCountryChanged,i=e.groupBy,c=e.year,u=i===m;return n||u&&a?o.a.createElement(qe,{key:"y".concat(c,"_v").concat(t),year:c,isSubgroup:u}):null}function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Qe(e){var t=e.prevVisit,r=e.visit,n=e.nextVisit,a=e.groupBy,i=$e(e,["prevVisit","visit","nextVisit","groupBy"]),o=t.countryId,c=t.locationId,u=t.tripId,l=n.tripId,s=r.countryId,f=r.locationId,b=r.tripId,I=J(t),g=J(r),T=K(a),h=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){Ke(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({visit:r,groupBy:a,year:g,changes:{isTripChanged:T&&u!==b,willTripChange:T&&l!==b,isYearChanged:function(e){return e===p||e===m||e===O}(a)&&I!==g,isCountryChanged:function(e){return e===E||e===d||e===m||e===O}(a)&&o!==s,isLocationChanged:c!==f}},i);switch(a){case y:return[ze(h),we(h),Ce(h),Be(h)];case E:return[ze(h),se(h),Ce(h)];case d:return[se(h),Ce(h)];case p:return[We(h),Ce(h)];case O:return[We(h),se(h),Ce(h)];case m:return[se(h),We(h),Ce(h)];case v:default:return[Ce(h)]}}var Xe=r(2),Ze=r.n(Xe);function et(e){var t=e.createTripUrl,r=e.locationsUrl,n=e.locationsCount,a=e.countriesCount,i=K(e.groupBy)?o.a.createElement("div",null,o.a.createElement(ge.a,{to:t,component:Ie.b,"data-locator":"ADD_TRIP_BUTTON"},"Добавить поездку")):null;return o.a.createElement(ue.a,{variant:"h6",paragraph:!0},o.a.createElement("span",null,"Всего "),o.a.createElement(ge.a,{to:r,component:Ie.b},"".concat(n," городов ")),o.a.createElement("span",null,"из "),o.a.createElement("span",null,"".concat(a," стран ")),i)}function tt(e){var t=e.match.params,r=t.userAlias,n=t.section,a=Object(s.c)().userAlias,i=r===a,f=R(),b=Object(l.b)(),I=b.queryFilter,g=b.setQueryFilter,T=B(g,I,n),h=T.groupBy,A=T.sortBy,N=Object(u.b)({userAlias:r}),P=N.isPending,C=N.isError,D=Object(c.d)().travel,_=D.locations,S=D.tripCreate,L=D.visitEdit;if(C)return o.a.createElement("div",null,"...Error");if(P)return o.a.createElement("div",null,"...Loading");var w=N.visitsIds,V=N.visitsDict,Y=w.map((function(e){return V[e]})).filter(Boolean),M=function(e,t){if(t&&t===Q)return X;var r={totalVisits:{},countries:{},years:{},trips:{},tripsCountries:{},yearsCountries:{},locations:{}};return e.forEach((function(e){var t=e.locationId,n=e.countryId,a=e.tripId,i=e.visitId,o=J(e);Z(r.countries,n,"visits",i),Z(r.countries,n,"locations",t),Z(r.countries,n,"years",o),Z(r.countries,n,"trips",a),Z(r.years,o,"locations",t),Z(r.years,o,"countries",n),Z(r.years,o,"trips",a),Z(r.trips,a,"visits",i),Z(r.trips,a,"locations",t),Z(r.trips,a,"countries",n),Z(r.locations,t,"visits",i),Z(r.locations,t,"years",o),Z(r.locations,t,"trips",a),Z(r.tripsCountries,q(a,n),"locations",t),Z(r.yearsCountries,W(o,n),"locations",t)}),{}),Q=t,X=r,r}(Y,N.updatesCounter),H=et({locationsUrl:_.toUrl({userAlias:r}),createTripUrl:S.toUrl({userAlias:r}),locationsCount:Object.keys((null==M?void 0:M.locations)||{}).length,countriesCount:Object.keys((null==M?void 0:M.countries)||{}).length,groupBy:h}),k=Y.sort(function(e,t,r){var n=e.groupBy,a=e.sortBy;switch(n){case y:return ce(t,r,[j.TRIP.PRESERVE_ORDER,j.TRIP.DEPARTURE_TIME,j.TRIP.ID,j.LOCATION.NAME]);case E:return ce(t,r,[j.TRIP.PRESERVE_ORDER,j.TRIP.DEPARTURE_TIME,j.TRIP.ID].concat(ne(oe(a,j.COUNTRY)),[j.COUNTRY.NAME_ID],ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]));case d:return ce(t,r,[].concat(ne(oe(a,j.COUNTRY)),[j.COUNTRY.NAME_ID],ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]));case p:return ce(t,r,[j.VISIT.ARRIVAL_YEAR].concat(ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]));case O:return ce(t,r,[j.VISIT.ARRIVAL_YEAR].concat(ne(oe(a,j.COUNTRY)),[j.COUNTRY.NAME_ID],ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]));case m:return ce(t,r,[].concat(ne(oe(a,j.COUNTRY)),[j.COUNTRY.NAME_ID,j.VISIT.ARRIVAL_YEAR],ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]));case v:default:return ce(t,r,[].concat(ne(oe(a,j.LOCATION)),[j.LOCATION.NAME_ID]))}}({groupBy:h,sortBy:A},N,M)),U=k.reduce((function(e,t,n){return Qe({prevVisit:n>0?k[n-1]:{},visit:t,nextVisit:n<k.length-1?k[n+1]:{},provision:N,classes:f,counters:M,groupBy:h,sortBy:A,hasEditRights:i,travelPaths:D,userAlias:r,visitEditUrl:i&&h===y?L.toUrl({strVisitId:String(t.visitId)}):void 0}).filter(Boolean).forEach((function(t){return e.push(t)})),e}),[H]);return o.a.createElement("div",{key:"".concat(h,"_").concat(A)},U)}et.propTypes={locationsUrl:Ze.a.string.isRequired,locationsCount:Ze.a.number.isRequired,countriesCount:Ze.a.number.isRequired}},804:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(0),a=r(71),i=r(820),o=r.n(i),c=r(821),u=r.n(c),l=r(834),s=r.n(l),f=r(158),v=r.n(f),d=r(149),p=r(17),O=r(812),m=r(806),y=r(813);function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b(e){var t=e.userAlias,r=function(e){var t=e.userAlias,r=e.tripsIds,n=Object(a.c)((function(e){return{tripsDict:Object(d.c)(e,"trips")||{}}})).tripsDict,i=!r,o=!i&&r.filter((function(e){return!n[e]}));return Object(d.f)({domain:"travel.trips-".concat(t),isProvision:!0,modelName:"trips",observe:t,query:{userAlias:t,navigation:{isDisabled:!0},filter:i?{}:{id:{comparator:"in",value:o}}}})}({userAlias:t,tripsIds:e.tripsIds}),i=Object(O.a)({domain:"travel.trips-".concat(t,".user"),userAlias:t}),c=i.user,u=(c=void 0===c?{}:c).locationsRating,l=void 0===u?{}:u,f=E(i,["user"]),b=(Object(p.o)(r)||{}).data,g=void 0===b?[]:b,T=Object(a.c)((function(e){return{tripsDict:Object(d.c)(e,"trips")||{},visitsDict:Object(d.c)(e,"visits")||{},ridesDict:Object(d.c)(e,"rides")||{},countriesDict:Object(d.c)(e,"countries")||{},locationsDict:Object(d.c)(e,"locations")||{}}})),h=T.tripsDict,A=T.visitsDict,j=T.ridesDict,N=T.countriesDict,R=T.locationsDict,P=Object(n.useMemo)((function(){return Array.from(new Set(g.flatMap((function(e){var t;return(null===(t=h[e])||void 0===t?void 0:t.visits)||[]}))))}),[g,h]),C=Object(n.useMemo)((function(){return Array.from(new Set(g.flatMap((function(e){var t;return(null===(t=h[e])||void 0===t?void 0:t.rides)||[]}))))}),[g,h]),D=Object(n.useMemo)((function(){return Array.from(new Set(P.flatMap((function(e){var t;return(null===(t=A[e])||void 0===t?void 0:t.countryId)||[]}))))}),[P,A]),_=Object(n.useMemo)((function(){return Array.from(new Set(P.flatMap((function(e){var t;return(null===(t=A[e])||void 0===t?void 0:t.locationId)||[]}))))}),[P,A]),S=Object(m.a)(),L=Object(y.a)({domain:"travel.locations-".concat(t),locationsIds:_}),w=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{updatesCounter:s()(t.map(p.p)),isReady:t.every(p.i),isPending:t.some(p.h),isValid:t.every(p.k),error:t.find(p.g),errors:t.map(p.f).filter(Boolean),invalidate:function(){return t.forEach((function(e){return(0,e.invalidate)()}))}}}(r,f,S,L),V=w.isError,Y=w.isValid,B=w.isReady,M=w.isPending,H=function(e,t,r){var n=e.reduce((function(e,n){var a=t[n];if(!a)return e;var i=r[n],o=a.countryId;return e[o]||(e[o]=[]),e[o].push(i),e}),{});return v()(n,(function(e){return function(e){if(!e.length)return 1/0;var t=e.length/e.map((function(e){return 1/e})).reduce((function(e,t){return e+t})),r=o()(e),n=Math.log(e.length);return 1/(1/t+n/r)}(e)}))}(_,R,l);return{tripsProvision:r,countriesProvision:S,locationsProvision:L,isError:V,isValid:Y,isReady:B,isPending:M,tripsIds:g,tripsDict:h,visitsIds:P,visitsDict:A,ridesIds:C,ridesDict:j,ridesStats:I(C,j),locationsIds:_,locationsDict:R,locationsRating:l,countriesIds:D,countriesDict:N,countriesRating:H}}function I(e,t){return{earliestDeparture:new Date(u()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime.getTime()})))),latestArrival:new Date(o()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime.getTime()}))))}}},806:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(149);r(17);function a(){return Object(n.f)({domain:"travel.countries",isProvision:!0,modelName:"countries",query:{navigation:{isDisabled:!0}}})}},808:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r(306),a=r(895),i=r(896),o=r(55),c=r(819),u=r.n(c),l="d MMMM yyyy",s="d MMMM",f="d";function v(e,t){var r=Object(o.a)(t,l,{locale:u.a});if(Object(n.a)(e,t))return r;var c="";return c=Object(a.a)(e,t)?Object(o.a)(e,f,{locale:u.a}):Object(i.a)(e,t)?Object(o.a)(e,s,{locale:u.a}):Object(o.a)(e,l,{locale:u.a}),"".concat(c,"—").concat(r)}function d(e){return v(e.departureDateTime,e.arrivalDateTime)}function p(e){var t=e.departureDateTime;return v(e.arrivalDateTime,t)}},812:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(71),a=r(149);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){var t=e.domain,r=e.userAlias,c=Object(n.c)((function(e){return Object(a.e)(e,"users",r)}));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(a.f)({domain:t,applicableSchemaName:"item",isProvision:!0,modelName:"users",observe:r,condition:Boolean(r),query:{id:r}}),{user:c})}},813:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r(71),a=r(149);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){var t=e.domain,r=e.locationsIds,i=Object(n.c)((function(e){return Object(a.c)(e,"locations")||{}})),o=r.filter((function(e){return!i[e]}));return Object(a.f)({domain:t,isProvision:!0,modelName:"locations",observe:r,condition:Boolean(o.length),query:{filter:{id:{comparator:"in",value:o}},navigation:{isDisabled:!0}}})}function l(e){var t=e.domain,r=c(Object(a.g)({domain:t,modelName:"locations",method:"POST"}),2),n=r[0];return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r[1],{submitLocationRating:n})}},818:function(e,t,r){"use strict";r.d(t,"b",(function(){return n.a})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return f}));var n=r(804),a=(r(806),r(71)),i=r(149);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var t=e.userAlias,r=e.visitId,n=Object(a.c)((function(e){return{visitsDict:Object(i.c)(e,"visits")||{}}})).visitsDict[r];return u({visit:n},Object(i.f)({domain:"travel.visit".concat(r,"-").concat(t),isProvision:!0,modelName:"visits",observe:r,condition:!n,query:{userAlias:t,filter:{visit_id:{comparator:"=",value:r}},navigation:{isDisabled:!0}}}))}function f(e){var t=e.domain,r=o(Object(i.g)({domain:t,modelName:"visits",method:"POST",contentType:"multipart/form-data"}),2),n=r[0];return u({},r[1],{submitVisitPhoto:n})}},836:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(0),a=r.n(n),i=r(791),o=r(913),c=r.n(o),u=r(808),l=r(89),s=r(837),f=Object(i.a)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function v(e){var t=e.ride,r=e.ride,n=(r=void 0===r?{}:r).rideType,i=e.className,o=e.isLong,v=f();return t?a.a.createElement("div",{className:i},a.a.createElement(s.a,{ride:t,className:v.icon}),n===l.RIDE_TYPES.HITCH_HIKING&&a.a.createElement(c.a,{className:v.absoluteIcon}),o&&Object(u.a)(t)):null}},837:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(0),a=r.n(n),i=r(903),o=r.n(i),c=r(902),u=r.n(c),l=r(900),s=r.n(l),f=r(897),v=r.n(f),d=r(911),p=r.n(d),O=r(899),m=r.n(O),y=r(905),E=r.n(y),b=r(906),I=r.n(b),g=r(898),T=r.n(g),h=r(866),A=r.n(h),j=r(901),N=r.n(j),R=r(904),P=r.n(R),C=r(907),D=r.n(C),_=r(908),S=r.n(_),L=r(909),w=r.n(L),V=r(910),Y=r.n(V),B=r(912),M=r.n(B),H=r(89);function k(e){var t=e.ride.vehicleType,r=e.className,n=function(e){switch(e){case H.VEHICLE_TYPES.CAR:return v.a;case H.VEHICLE_TYPES.TRAIN:return T.a;case H.VEHICLE_TYPES.AIRCRAFT:return m.a;case H.VEHICLE_TYPES.BUS:case H.VEHICLE_TYPES.TROLLEY:case H.VEHICLE_TYPES.CITY_BUS:return s.a;case H.VEHICLE_TYPES.MOTORHOME:case H.VEHICLE_TYPES.JITNEY:return N.a;case H.VEHICLE_TYPES.LOCAL_TRAIN:return T.a;case H.VEHICLE_TYPES.FERRY:return u.a;case H.VEHICLE_TYPES.BIKE:return o.a;case H.VEHICLE_TYPES.BY_FEET:return P.a;case H.VEHICLE_TYPES.MOTORBIKE:return E.a;case H.VEHICLE_TYPES.TRUCK:return A.a;case H.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return I.a;case H.VEHICLE_TYPES.TRAM:return D.a;case H.VEHICLE_TYPES.TAXI:return S.a;case H.VEHICLE_TYPES.SUBWAY:return w.a;case H.VEHICLE_TYPES.PUBLIC_TRANSPORT:return Y.a;case H.VEHICLE_TYPES.ROPEWAY:case H.VEHICLE_TYPES.FUNICULAR:return p.a;default:return M.a}}(t);return a.a.createElement(n,{className:r})}},873:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(916),a=r(917),i=r(914),o=r.n(i),c=r(915),u=r.n(c),l=function(e,t){var r=t.maxLength,n=t.separator,a=void 0===n?", ":n,i=u()(e),o=i.slice(0,r).join(a);return i.length>r?"".concat(o,"..."):o},s=r(233),f=r(808);function v(e,t,r,i){var c,u=e||{},v=u.visits,d=u.originLocationId,p=u.tripName,O=u.hasAutogeneratedTripName,m=null===(c=i[d])||void 0===c?void 0:c.countryId;if(!O)return p||"Без названия";if(!v.length)return"Без названия";var y=Object(f.b)({arrivalDateTime:Object(n.a)(v.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime}))),departureDateTime:Object(a.a)(v.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime})))}),E=Object.keys(o()(v.filter((function(e){var r;return(null===(r=t[e])||void 0===r?void 0:r.visitType)!==s.VISIT_TYPES.TRANSIT})),"countryId"));if(1===E.length){var b=l(v.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.locationName})),{maxLength:4});return"".concat(b||"Без названия",", ").concat(y)}var I=l(E.map((function(e){return Number(e)!==m&&r[e]&&r[e].countryName})).filter(Boolean),{maxLength:4});return"".concat(I||"Без названия",", ").concat(y)}}}]);
//# sourceMappingURL=travel-VisitsPage-74191cf078b4f05c2ee2.js.map