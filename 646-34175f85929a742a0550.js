"use strict";(self.webpackChunkmine=self.webpackChunkmine||[]).push([[646],{45646:(e,t,n)=>{n.d(t,{OJ:()=>T,ZP:()=>H,eS:()=>M}),n(21249),n(57640),n(9924),n(26699),n(32023),n(69070),n(47941),n(82526),n(57327),n(41539),n(88449),n(2490),n(59849),n(38880),n(89554),n(15581),n(34514),n(54747),n(49337),n(33321);var r,i=n(67294),a=n(94184),l=n.n(a),o=n(86453),s=n(41120),c=(n(85827),n(25387),n(72608),n(53632)),u=n.n(c),_=n(6162),f=n.n(_);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(26833);var T={BY_FIRST_VISIT:"fv",BY_LAST_VISIT:"lv",BY_VISITS_COUNT:"vc",BY_RATING:"r"},m=T.BY_LAST_VISIT,p="https://res.cloudinary.com/dc2eke0gj/image/upload/markers/",v=["step_by_time_1_zjtrlw.png","step_by_time_2_tvotvg.png","step_by_time_3_ylj1vi.png","step_by_time_4_uovfrs.png","step_by_time_5_s4jq0u.png","step_by_time_6_lmihnf.png"],g=(I(r={},T.BY_FIRST_VISIT,v),I(r,T.BY_LAST_VISIT,v),I(r,T.BY_VISITS_COUNT,["step_by_visits_1_zv3tba.png","step_by_visits_2_qthjqa.png","step_by_visits_3_xcjyla.png","step_by_visits_4_kwdwka.png","step_by_visits_5_xnnipa.png"]),I(r,T.BY_RATING,["step_by_rating_1_id2qgb.png","step_by_rating_2_iiqvik.png","step_by_rating_3_x2gzsd.png","step_by_rating_4_cbqdcn.png","step_by_rating_5_viyhls.png","step_by_rating_6_zzfgki.png","step_by_rating_7_pjjhhq.png","step_by_rating_8_vgetsd.png","step_by_rating_9_t6tenz.png","step_by_rating_10_yjywr0.png"]),r),E={ALL:"all",WANT_COME_BACK:"good",LOVE_THIS_PLACE:"best"},O=E.ALL,A=n(39222);function y(e){var t=e.visitsCount;switch(!0){case t>10:return 5;case t>5:return 4;case t>2:return 3;case t>1:return 2;default:return 1}}function N(e){switch(e.locationRating){case A.LOCATION_RATING.PLACE_TO_LIVE:return 1;case A.LOCATION_RATING.FEW_PER_YEAR:case A.LOCATION_RATING.ONCE_PER_YEAR:return 3;case A.LOCATION_RATING.ONCE_PER_TWO_YEARS:case A.LOCATION_RATING.ONCE_PER_FIVE_YEARS:return 4;case A.LOCATION_RATING.ONCE_PER_DECADE:case A.LOCATION_RATING.TWICE_PER_LIVE:return 7;case A.LOCATION_RATING.ONCE_PER_LIVE:return 9;case A.LOCATION_RATING.NEVER:return 10;default:return 6}}function b(e){return{resolveStep:function(t,n){var r=(t[e]-n.minTime)/n.diff*6;return Math.min(Math.max(Math.floor(r),0),6)},resolveOptions:function(t){var n=t.map((function(t){return t[e]&&t[e].getTime()})).filter(Boolean),r=u()(n);return{minTime:r,diff:f()(n)+1-r}}}}n(69600);var C=n(28523),d=n(41297);function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eeeeee, d MMMM yyyy";return(0,d.Z)(e,t,{locale:C.Z})}function L(e){switch(e){case A.LOCATION_RATING.PLACE_TO_LIVE:return"Жил бы здесь";case A.LOCATION_RATING.FEW_PER_YEAR:case A.LOCATION_RATING.ONCE_PER_YEAR:return"Готов ездить сюда постоянно";case A.LOCATION_RATING.ONCE_PER_TWO_YEARS:case A.LOCATION_RATING.ONCE_PER_FIVE_YEARS:return"Приезжал бы иногда";case A.LOCATION_RATING.ONCE_PER_DECADE:case A.LOCATION_RATING.TWICE_PER_LIVE:return"Заглянул бы еще разок";case A.LOCATION_RATING.ONCE_PER_LIVE:return"Одного посещения достаточно";case A.LOCATION_RATING.NEVER:return"Тут нечего делать";default:return"?"}}function S(e,t){if(!t)return"".concat(p).concat(v[0]);var n=g[t],r=n[e-1]||n[0];return"".concat(p).concat(r)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(92222),n(79753),n(41817),n(32165),n(66992),n(78783),n(33948),n(47042),n(68309),n(91038),n(74916),n(77601);var V=n(66142),B=n(62822),P=n(50998),G=n(64436),Y=n(43700),D=n(23200),j=n(85639);function w(e){var t=e.classes,n=e.scaleBy,r=e.onClose,a=e.onChange;return i.createElement(B.Z,null,i.createElement(P.Z,null,i.createElement(G.Z,{className:t.formControl},i.createElement(Y.Z,{shrink:!0,id:"select-scaleBy-filter-label"},"Раскрасить маркеры"),i.createElement(D.Z,{labelId:"select-scaleBy-filter-label",autoWidth:!0,id:"select-scaleBy-filter",value:n,onChange:function(e){r();var t,n,i,l=e.target.value,o=(i=l,(n="scale")in(t={})?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t);l!==T.BY_RATING&&(o.rating=void 0),a(o)}},i.createElement(j.Z,{key:T.BY_FIRST_VISIT,value:T.BY_FIRST_VISIT},"По первому посещению"),i.createElement(j.Z,{key:T.BY_LAST_VISIT,value:T.BY_LAST_VISIT},"По последнему посещению"),i.createElement(j.Z,{key:T.BY_VISITS_COUNT,value:T.BY_VISITS_COUNT},"По числу посещений"),i.createElement(j.Z,{key:T.BY_RATING,value:T.BY_RATING},"По рейтингу")))))}function Z(e){var t=e.classes,n=e.ratingLevel,r=e.onClose,a=e.onChange;return i.createElement(B.Z,null,i.createElement(P.Z,null,i.createElement(G.Z,{className:t.formControl},i.createElement(Y.Z,{shrink:!0,id:"select-ratingLevel-filter-label"},"Фильтр по рейтингу"),i.createElement(D.Z,{labelId:"select-ratingLevel-filter-label",autoWidth:!0,id:"select-ratingLevel-filter",value:n,onChange:function(e){var t,n,i;r(),a((t={},n="rating",i=e.target.value,n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t))}},i.createElement(j.Z,{key:E.ALL,value:E.ALL},"Все"),i.createElement(j.Z,{key:E.WANT_COME_BACK,value:E.WANT_COME_BACK},"Куда бы вернулся"),i.createElement(j.Z,{key:E.LOVE_THIS_PLACE,value:E.LOVE_THIS_PLACE},"Лучшие места")))))}var k=(0,s.Z)({formControl:{width:"100%"}});function M(e,t){var n=k(),r=t||{},a=r.scale,l=r.rating,o=function(e){return Object.values(T).includes(e)?e:m}(a),s=function(e){return Object.values(E).includes(e)?e:O}(l);return(0,V.Ap)((function(t){var r=t.closeSidebar;return i.createElement(i.Fragment,null,i.createElement(w,{classes:n,onClose:r,scaleBy:o,onChange:e}),o===T.BY_RATING&&i.createElement(Z,{classes:n,onClose:r,ratingLevel:s,onChange:e}))}),[o,s]),{scaleBy:o,ratingLevel:s}}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=(0,s.Z)({googleMapContainer:{margin:"12px 0",maxWidth:"100%",flexGrow:1,minHeight:function(e){return e.minHeight},position:"relative"},googleMapPosition:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0"}});function H(e){var t=e.className,n=e.locationsDict,r=e.visitsDict,a=e.locationsRating,s=e.locationsIds,c=e.minHeight,_=e.scaleBy,I=e.ratingLevel,m=F({minHeight:c}),p=(0,i.useMemo)((function(){var e=function(e,t){var n=t.ratingLevel,r=e.filter(Boolean);return Object.values(E).includes(n)&&n!==E.ALL?r.filter((function(e){var t=e.locationRating,r=e.visitsCount;switch(n){case E.WANT_COME_BACK:return r<2?t<=A.LOCATION_RATING.TWICE_PER_LIVE:t<=A.LOCATION_RATING.ONCE_PER_DECADE;case E.LOVE_THIS_PLACE:return t<=A.LOCATION_RATING.ONCE_PER_YEAR;default:return!0}})):r}(function(e){var t=e.locationsIds,n=e.locationsDict,r=e.visitsDict,i=e.locationsRating;return t.map((function(e){var t,a=n[e];if(!a)return null;var l=a.lon,o=a.lat,s=a.locationName,c=a.visitsIds,_=function(e,t){return e.reduce((function(e,n){var r=t[n];if(r){var i=r.arrivalDateTime,a=r.departureDateTime;e.firstVisitDateTime=u()([e.firstVisitDateTime,i]),e.lastVisitDateTime=f()([e.lastVisitDateTime,a])}return e}),{firstVisitDateTime:null,lastVisitDateTime:null})}(null!=c?c:[],r);return{locationName:s,lat:o,lon:l,firstVisitDateTime:_.firstVisitDateTime,lastVisitDateTime:_.lastVisitDateTime,locationRating:i[e],visitsCount:null===(t=a.visitsIds)||void 0===t?void 0:t.length}}))}({locationsDict:n,visitsDict:r,locationsRating:a,locationsIds:s}),{ratingLevel:I}),t=function(e){switch(e){case T.BY_VISITS_COUNT:return{resolveStep:y};case T.BY_RATING:return{resolveStep:N};case T.BY_LAST_VISIT:return b("lastVisitDateTime");case T.BY_FIRST_VISIT:return b("firstVisitDateTime");default:return{resolveStep:function(){return 1}}}}(_),i=t.resolveStep,l=t.resolveOptions,o=l&&l(e);return e.map((function(e){var t,n,r,a,l,s,c=i(e,o);return W(W({},e),{},{zIndex:[T.BY_RATING,T.BY_FIRST_VISIT].includes(_)?10-c:c,iconUrl:S(c,_),title:(t=e,n=t.locationName,r=t.locationRating,a=t.visitsCount,l=t.firstVisitDateTime,s=t.lastVisitDateTime,[n,"Посещено ".concat(a," раз"),"Впервые ".concat(R(l)),a>1&&"Прошлое посешение ".concat(R(s)),"Рейтинг: ".concat(L(r))].filter(Boolean).join("\n"))})}))}),[n,r,a,s,_,I]),v=function(e){var t,n,r=(t=(0,i.useState)(null),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(e){o=!0,i=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw i}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],l=r[1],o=(0,i.useRef)(!0);return(0,i.useEffect)((function(){if(a){var t=a.map,n=a.maps,r=new n.LatLngBounds,i=e.map((function(e){var i=e.lat,a=e.lon,l=e.iconUrl,o=e.title,s=e.zIndex,c=new n.Marker({map:t,position:{lat:i,lng:a},icon:{url:l,scaledSize:new n.Size(24,24)},scale:.5,title:o,zIndex:s});return r.extend(c.position),c}));return o.current&&(t.setOptions({maxZoom:11,minZoom:2}),t.fitBounds(r),t.setOptions({maxZoom:null,minZoom:null}),o.current=!1),function(){i.forEach((function(e){e.setMap(null),e.setVisible(!1)})),i.length=0}}}),[a,e]),{handleGoogleApiLoaded:function(e){return l(e)}}}(p),g=v.handleGoogleApiLoaded;return i.createElement("div",{className:l()(t,m.googleMapContainer)},i.createElement("div",{className:m.googleMapPosition},i.createElement(o.Z,{bootstrapURLKeys:{key:"AIzaSyCvP0e64ui7WpXKBdzOyEmkb4l5RuGy3Zs"},center:{lat:0,lng:0},zoom:11,onGoogleApiLoaded:g})))}H.defaultProps={className:void 0,minHeight:"400px"}}}]);
//# sourceMappingURL=646-34175f85929a742a0550.js.map