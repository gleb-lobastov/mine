(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1020:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(145)).default)(a.default.createElement("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorder");t.default=i},1021:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(145)).default)(a.default.createElement("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm0 12l-4.34 4.34L12 14H3v-2l3-7h9v10zm4-12h4v12h-4z"}),"ThumbDownOutlined");t.default=i},1022:function(e,t,r){"use strict";var n=r(119);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(145)).default)(a.default.createElement("path",{d:"M12 6c0-.55-.45-1-1-1H5.82l.66-3.18.02-.23c0-.31-.13-.59-.33-.8L5.38 0 .44 4.94C.17 5.21 0 5.59 0 6v6.5c0 .83.67 1.5 1.5 1.5h6.75c.62 0 1.15-.38 1.38-.91l2.26-5.29c.07-.17.11-.36.11-.55V6zm-2 1.13L7.92 12H2V6.21l1.93-1.93L3.36 7H10v.13zM22.5 10h-6.75c-.62 0-1.15.38-1.38.91l-2.26 5.29c-.07.17-.11.36-.11.55V18c0 .55.45 1 1 1h5.18l-.66 3.18-.02.24c0 .31.13.59.33.8l.79.78 4.94-4.94c.27-.27.44-.65.44-1.06v-6.5c0-.83-.67-1.5-1.5-1.5zm-.5 7.79l-1.93 1.93.57-2.72H14v-.13L16.08 12H22v5.79z"}),"ThumbsUpDownOutlined");t.default=i},1079:function(e,t,r){"use strict";r.r(t);var n,a,i=r(0),o=r.n(i),c=r(35),u=r(808),l=r(201),s=r(130),d=r(867),f=r(782),v=Object(f.a)((function(e){return{visibilityTrigger:{"&:hover $visibleOnlyOnHover":{visibility:"visible"}},visibleOnlyOnHover:{visibility:"hidden"},group:{backgroundColor:"white",top:0,"&:not(:first-of-type)":{marginTop:e.spacing(5)},"& ~ $subgroup":{marginTop:e.spacing(2)},"& + $subgroup ":{marginTop:0}},subgroup:{backgroundColor:"white",top:38},detail:{color:"gray",fontSize:12},formControl:{width:"100%"},ratingBlock:{display:"inline-flex",alignItems:"center"},ratingIcon:{color:"gray",fontSize:12},halfDown:{position:"relative",top:12}}})),p=r(786),O=r(787),m=r(1063),E=r(1085),b=r(1080),y=r(1066),g=r(202);function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T="loc",h="c",A="yr",R="yr_c",N="c_yr",j="t",P="t_с",C={TRIPS:"trips",LOCATIONS:"locations"},_=C.TRIPS,D=(I(n={},C.LOCATIONS,[{key:T,l10n:"По городам"},{key:h,l10n:"По странам"},{key:A,l10n:"По годам"},{key:R,l10n:"По годам и странам"},{key:N,l10n:"По странам и годам"}]),I(n,C.TRIPS,[{key:j,l10n:"По поездкам"},{key:P,l10n:"По поездкам и странам"}]),n),S=(I(a={},C.LOCATIONS,h),I(a,C.TRIPS,j),a),L={RATING_ALPHABET:"r_a",VISITS_ALPHABET:"v_a",ALPHABET:"a"},w=L.ALPHABET,V={VISIT:{ARRIVAL_YEAR:"ARRIVAL_YEAR"},TRIP:{DEPARTURE_TIME:"TRIP_DEPARTURE_DATE",ID:"TRIP_ID",PRESERVE_ORDER:"PRESERVE_ORDER"},COUNTRY:{VISITS:"COUNTRY_VISITS",RATING:"COUNTRY_RATING",NAME_ID:"COUNTRY_NAME_ID"},LOCATION:{VISITS:"LOCATION_VISITS",RATING:"LOCATION_RATING",NAME_ID:"LOCATION_NAME_ID"}};function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var M=function(e,t,r){var n=v(),a=t||{},i=a.group,c=function(e){return Object.values(L).includes(e)?e:w}(a.sort),u=Y(function(e,t){var r=Object.values(C).includes(t)?t:_,n=D[r]||[];return[n.find((function(t){return t.key===e}))?e:S[r],n]}(i,r),2),l=u[0],s=u[1];return Object(g.b)((function(t){var r=t.closeSidebar;return o.a.createElement(p.a,null,o.a.createElement(O.a,null,o.a.createElement(m.a,{className:n.formControl},o.a.createElement(E.a,{shrink:!0,id:"select-groupBy-filter-label"},"Сгруппировать"),o.a.createElement(b.a,{labelId:"select-groupBy-filter-label",autoWidth:!0,id:"select-groupBy-filter",value:l,onChange:function(t){r(),e(B({},"group",t.target.value))}},s.map((function(e){return o.a.createElement(y.a,{key:e.key,value:e.key},e.l10n)}))))),l!==j&&o.a.createElement(O.a,null,o.a.createElement(m.a,{className:n.formControl},o.a.createElement(E.a,{shrink:!0,id:"select-sortBy-filter-label"},"Сортировать"),o.a.createElement(b.a,{labelId:"select-sortBy-filter-label",autoWidth:!0,id:"select-sortBy-filter",value:c,onChange:function(t){r(),e(B({},"sort",t.target.value))}},o.a.createElement(y.a,{value:L.ALPHABET},"По алфавиту"),o.a.createElement(y.a,{value:L.VISITS_ALPHABET},"По числу посещений"),o.a.createElement(y.a,{value:L.RATING_ALPHABET},"По рейтингу")))))}),[l,c]),{groupBy:l,sortBy:c}};var k=r(93),H=r.n(k),U=r(421),G=r.n(U),x=r(803),F=r.n(x);function z(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var q=function(e,t){var r;void 0===t&&(t=z);var n,a=[],i=!1;return function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];return i&&r===this&&t(o,a)?n:(n=e.apply(this,o),i=!0,r=this,a=o,n)}};function W(e,t){return"t".concat(e,"_c").concat(t)}function K(e,t){return"y".concat(e,"_c").concat(t)}function J(e){var t=e.arrivalDateTime;return t?t.getFullYear(t):null}function $(e){return e===j||e===P}var Z,X=null,Q=null;function ee(e,t,r,n){var a=e[t];a||(a=e[t]={});var i=a[r];i||(i=a[r]={});var o=i[n]||0;i[n]=o+1}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.locations,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).visits,i=void 0===a?{}:a;return Object.keys(i).length}function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.countries,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).visits,i=void 0===a?{}:a;return Object.keys(i).length}function ne(e,t,r){var n=e.years,a=(n=void 0===n?{}:n)[r],i=(a=void 0===a?{}:a).locations;return(i=void 0===i?{}:i)[t]}function ae(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var oe=(ie(Z={},V.VISIT.ARRIVAL_YEAR,(function(){return function(e,t){var r=e.arrivalDateTime,n=t.arrivalDateTime;return r||n?r&&n?n.getFullYear()-r.getFullYear():r?-1:1:0}})),ie(Z,V.COUNTRY.NAME_ID,(function(e){var t=e.countriesDict;return function(e,r){var n=e.countryId,a=r.countryId,i=(t[n]||{}).countryName,o=(t[a]||{}).countryName;return i>o?1:o>i?-1:n-a}})),ie(Z,V.COUNTRY.RATING,(function(e){var t=e.countriesRating;return function(e,r){var n=e.countryId,a=r.countryId;return(t[n]||10)-(t[a]||10)}})),ie(Z,V.COUNTRY.VISITS,(function(e,t){return function(e,r){var n=e.countryId,a=r.countryId;return re(t,a)-re(t,n)}})),ie(Z,V.LOCATION.NAME_ID,(function(){return function(e,t){var r=e.locationId,n=e.locationName,a=t.locationId,i=t.locationName;return n>i?1:i>n?-1:r-a}})),ie(Z,V.LOCATION.RATING,(function(e){var t=e.locationsRating;return function(e,r){var n=e.locationId,a=r.locationId;return(t[n]||10)-(t[a]||10)}})),ie(Z,V.LOCATION.VISITS,(function(e,t){return function(e,r){var n=e.locationId,a=r.locationId;return te(t,a)-te(t,n)}})),ie(Z,V.TRIP.PRESERVE_ORDER,(function(e){var t=e.tripsIds;return function(e,r){if(!t)return 0;var n=e.tripId,a=r.tripId,i=t.indexOf(n),o=t.indexOf(a);return i<0||o<0?i<0&&o<0?0:o<0?-1:1:i-o}})),ie(Z,V.TRIP.DEPARTURE_TIME,(function(e){var t=e.tripsDict;return function(e,r){var n=e.tripId,a=r.tripId,i=(t[n]||{}).departureDateTime,o=(t[a]||{}).departureDateTime;return i||o?i&&o?o.getFullYear()-i.getFullYear():i?-1:1:0}})),ie(Z,V.TRIP.ID,(function(){return function(e,t){return e.tripId-t.tripId}})),Z);function ce(e,t){switch(e){case L.VISITS_ALPHABET:return[null==t?void 0:t.VISITS];case L.RATING_ALPHABET:return[null==t?void 0:t.RATING,null==t?void 0:t.VISITS];default:return[]}}function ue(e,t,r){var n=r.map((function(r){var n=oe[r];return H()(n,"missing comparatorKey: %s",r),n?n(e,t):null})).filter(Boolean);return function(e,t){for(var r=0;r<n.length;r+=1){var a=n[r](e,t);if(a)return a}return 0}}q((function(e){return G()((function(t){var r=Object.values(e).filter((function(e){var r=e.countryId;return t===r})).map((function(e){return e.rating}));return r.length?F()(r)/r.length:0}))}));var le=r(228);function se(e){var t=e.country,r=(t=void 0===t?{}:t).countryName,n=e.isSubgroup,a=e.isDetail,i=e.className,c=e.children;v();return a?o.a.createElement("span",{className:i},r):o.a.createElement(le.a,{variant:n?"h5":"h4",className:i},r," ",c)}function de(e){var t,r,n,a,i,c,u=e.visit,l=u.tripId,s=u.visitId,d=u.countryId,f=e.changes,v=f.isTripChanged,p=f.isCountryChanged,O=e.provision.countriesDict,m=e.groupBy,E=e.year,b=e.counters,y=e.classes,g=m===P,I=m===R;if(!(p||g&&v))return null;var T=0;switch(m){case h:T=Object.keys((null==b?void 0:null===(t=b.countries)||void 0===t?void 0:null===(r=t[d])||void 0===r?void 0:r.locations)||{}).length;break;case N:case R:T=Object.keys((null==b?void 0:null===(n=b.yearsCountries)||void 0===n?void 0:null===(a=n[K(E,d)])||void 0===a?void 0:a.locations)||{}).length;break;case P:T=Object.keys((null==b?void 0:null===(i=b.tripsCountries)||void 0===i?void 0:null===(c=i[W(l,d)])||void 0===c?void 0:c.locations)||{}).length}var A=g||I;return o.a.createElement(se,{key:"c".concat(d,"_v").concat(s),country:O[d],isSubgroup:A,className:A?y.subgroup:y.group},T>2&&o.a.createElement("span",{className:y.detail},"".concat(T," мест")))}var fe=r(1067),ve=r(1020),pe=r.n(ve),Oe=r(1021),me=r.n(Oe),Ee=r(1022),be=r.n(Ee),ye=r(812),ge=r(823),Ie=Object(f.a)({autoMargin:{marginLeft:"auto"}});function Te(e){var t=e.children,r=e.shouldJustifyContent,n=e.location,a=(n=void 0===n?{}:n).locationName,i=Ie(),c=o.a.Children.toArray(t);if(!r||c.length<=1)return o.a.createElement(le.a,null,a," ",t);var u=c.slice(-1),l=c.slice(0,-1);return o.a.createElement(fe.a,{container:!0,justify:"space-between",alignItems:"center"},o.a.createElement(fe.a,{item:!0},o.a.createElement(le.a,null,a," ",l)),o.a.createElement(fe.a,{item:!0,classes:{item:i.autoMargin}},u))}var he=r(277),Ae=[T,A,j],Re=[T,h];function Ne(e){var t=e.visit,r=e.visit,n=r.visitId,a=r.locationId,i=r.countryId,c=r.departureRideId,u=e.classes,l=e.changes,s=l.isYearChanged,d=l.isCountryChanged,f=l.isTripChanged,v=l.isLocationChanged,p=e.year,O=e.provision,m=O.locationsDict,E=O.locationsRating,b=O.countriesDict,y=O.visitsDict,g=O.ridesDict,I=e.groupBy,P=e.sortBy,C=e.counters,_=I===j;if(!(_||f||s||d||v))return null;var D=Ae.includes(I)?o.a.createElement(se,{country:b[i],className:u.detail,isDetail:!0}):null,S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=e.locationId;switch(n){case T:case h:return te(t,a);case A:case N:case R:return ne(t,a,r)}}(t,C,p,I),w=P!==L.RATING_ALPHABET&&S>1?o.a.createElement("span",{className:u.detail},"".concat(S," визитов")):null,V=P!==L.RATING_ALPHABET&&Re.includes(I)?o.a.createElement("span",{className:u.detail},"в ".concat(function(e,t){var r=e.locations,n=(r=void 0===r?{}:r)[t],a=(n=void 0===n?{}:n).years,i=void 0===a?{}:a;return Object.keys(i)}(C,a).join(", "))):null,B=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).reduce((function(e,t,r){return r>0&&e.push(o.a.createElement("span",null," ")),e.push(t),e}),[])}(D,P===L.RATING_ALPHABET?function(e){var t=e.locationRating,r=e.classes;return o.a.createElement("div",{className:r.ratingBlock},function(e){var t=e.locationRating,r=e.classes;switch(t){case he.LOCATION_RATING.PLACE_TO_LIVE:return o.a.createElement(o.a.Fragment,null,o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}));case he.LOCATION_RATING.FEW_PER_YEAR:case he.LOCATION_RATING.ONCE_PER_YEAR:return o.a.createElement(o.a.Fragment,null,o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}));case he.LOCATION_RATING.ONCE_PER_TWO_YEARS:case he.LOCATION_RATING.ONCE_PER_FIVE_YEARS:return o.a.createElement(o.a.Fragment,null,o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}));case he.LOCATION_RATING.ONCE_PER_DECADE:case he.LOCATION_RATING.TWICE_PER_LIVE:return o.a.createElement(o.a.Fragment,null,o.a.createElement(pe.a,{className:r.ratingIcon}),o.a.createElement(pe.a,{className:r.ratingIcon}));case he.LOCATION_RATING.ONCE_PER_LIVE:return o.a.createElement(pe.a,{className:r.ratingIcon});case he.LOCATION_RATING.NEVER:return o.a.createElement(me.a,{className:r.ratingIcon});default:return o.a.createElement(be.a,{className:r.ratingIcon})}}({locationRating:t,classes:r}))}({classes:u,locationRating:null==E?void 0:E[a]}):null,w,V);return o.a.createElement(Te,{key:"l".concat(a,"_v").concat(n),location:m[a],country:b[i],shouldJustifyContent:_},B,_&&o.a.createElement(fe.a,{container:!0},o.a.createElement(fe.a,{item:!0},o.a.createElement(le.a,{className:u.detail},Object(ye.b)(y[n]))),o.a.createElement(fe.a,{item:!0},o.a.createElement(ge.a,{ride:g[c],className:u.halfDown}))))}var je=[T,A,j];function Pe(e){var t=e.keyBase,r=e.children,n=e.classes,a=e.visit.tripId,i=e.provision,c=i.tripsDict,u=i.locationsDict,l=i.countriesDict,s=e.groupBy,d=c[a];if(!d)return null;var f=d.originLocationId,v=u[f];if(!v)return null;var p=v.countryId,O=je.includes(s)?o.a.createElement(se,{country:l[p],className:n.detail,isDetail:!0}):null;return o.a.createElement(Te,{key:"".concat(t,"_t").concat(a,"_ol").concat(f),location:u[f],country:l[p],shouldJustifyContent:null!=r},O,r)}function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e){var t=e.visit.arrivalRideId,r=e.classes,n=e.changes.isTripChanged,a=e.provision.ridesDict;return n?Pe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(r),!0).forEach((function(t){_e(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{keyBase:"dl",children:o.a.createElement(ge.a,{ride:a[t],className:r.halfDown})})):null}function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function we(e){return e.changes.willTripChange?Pe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){Le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{keyBase:"al"})):null}var Ve=r(167),Be=r.n(Ve),Ye=r(791),Me=r(909),ke=r.n(Me);function He(e){var t=e.trip,r=(t=void 0===t?{}:t).tripName,n=e.children,a=e.className;return o.a.createElement(le.a,{variant:"h4",className:a,paragraph:!0},o.a.createElement("span",null,r),n)}function Ue(e){var t=e.visit,r=t.visitId,n=t.tripId,a=e.changes.isTripChanged,i=e.provision.tripsDict,c=e.travelPaths.tripEdit,u=e.hasEditRights,l=e.userAlias,s=e.classes;if(!a)return null;var d=u?o.a.createElement(Ye.a,{className:s.visibleOnlyOnHover,href:c.toUrl({userAlias:l,strTripId:String(n)}),size:"small"},o.a.createElement(ke.a,null)):null;return o.a.createElement(He,{key:"t".concat(n,"_v").concat(r),className:Be()(s.visibilityTrigger,s.group),trip:i[n]},d)}function Ge(e){var t=e.year,r=e.isSubgroup,n=v();return o.a.createElement(le.a,{variant:r?"h5":"h4",className:r?n.subgroup:n.group},t)}function xe(e){var t=e.visit.visitId,r=e.changes,n=r.isYearChanged,a=r.isCountryChanged,i=e.groupBy,c=e.year,u=i===N;return n||u&&a?o.a.createElement(Ge,{key:"y".concat(c,"_v").concat(t),year:c,isSubgroup:u}):null}function Fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qe(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function We(e){var t=e.prevVisit,r=e.visit,n=e.nextVisit,a=e.groupBy,i=qe(e,["prevVisit","visit","nextVisit","groupBy"]),o=t.countryId,c=t.locationId,u=t.tripId,l=n.tripId,s=r.countryId,d=r.locationId,f=r.tripId,v=J(t),p=J(r),O=$(a),m=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(r),!0).forEach((function(t){ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({visit:r,groupBy:a,year:p,changes:{isTripChanged:O&&u!==f,willTripChange:O&&l!==f,isYearChanged:function(e){return e===A||e===N||e===R}(a)&&v!==p,isCountryChanged:function(e){return e===P||e===h||e===N||e===R}(a)&&o!==s,isLocationChanged:c!==d}},i);switch(a){case j:return[Ue(m),De(m),Ne(m),we(m)];case P:return[Ue(m),de(m),Ne(m)];case h:return[de(m),Ne(m)];case A:return[xe(m),Ne(m)];case R:return[xe(m),de(m),Ne(m)];case N:return[de(m),xe(m),Ne(m)];case T:default:return[Ne(m)]}}var Ke=r(2),Je=r.n(Ke),$e=r(83),Ze=r(873);function Xe(e){var t=e.createTripUrl,r=e.locationsUrl,n=e.locationsCount,a=e.countriesCount,i=$(e.groupBy)?o.a.createElement("div",null,o.a.createElement(Ze.a,{to:t,component:$e.b},"Добавить поездку")):null;return o.a.createElement(le.a,{variant:"h6",paragraph:!0},o.a.createElement("span",null,"Всего "),o.a.createElement(Ze.a,{to:r,component:$e.b},"".concat(n," городов ")),o.a.createElement("span",null,"из "),o.a.createElement("span",null,"".concat(a," стран ")),i)}function Qe(e){var t=e.match.params,r=t.userAlias,n=t.section,a=Object(s.c)().userAlias,i=r===a,f=v(),p=Object(l.b)(),O=p.queryFilter,m=p.setQueryFilter,E=M(m,O,n),b=E.groupBy,y=E.sortBy,g=Object(u.a)({userAlias:r}),I=g.isPending,C=g.isError,_=Object(c.d)().travel,D=_.locations,S=_.tripCreate;if(C)return o.a.createElement("div",null,"...Error");if(I)return o.a.createElement("div",null,"...Loading");var L=g.visitsIds,w=g.visitsDict,B=L.map((function(e){return w[e]})).filter(Boolean),Y=function(e,t){if(t&&t===X)return Q;var r={totalVisits:{},countries:{},years:{},trips:{},tripsCountries:{},yearsCountries:{},locations:{}};return e.forEach((function(e){var t=e.locationId,n=e.countryId,a=e.tripId,i=e.visitId,o=J(e);ee(r.countries,n,"visits",i),ee(r.countries,n,"locations",t),ee(r.countries,n,"years",o),ee(r.countries,n,"trips",a),ee(r.years,o,"locations",t),ee(r.years,o,"countries",n),ee(r.years,o,"trips",a),ee(r.trips,a,"visits",i),ee(r.trips,a,"locations",t),ee(r.trips,a,"countries",n),ee(r.locations,t,"visits",i),ee(r.locations,t,"years",o),ee(r.locations,t,"trips",a),ee(r.tripsCountries,W(a,n),"locations",t),ee(r.yearsCountries,K(o,n),"locations",t)}),{}),X=t,Q=r,r}(B,g.updatesCounter),k=Xe({locationsUrl:D.toUrl({userAlias:r}),createTripUrl:S.toUrl({userAlias:r}),locationsCount:Object.keys((null==Y?void 0:Y.locations)||{}).length,countriesCount:Object.keys((null==Y?void 0:Y.countries)||{}).length,groupBy:b}),H=g.locationsDict,U=g.locationsIds,G=o.a.createElement(d.a,{locationsDict:H,locationsIds:U,height:300}),x=B.sort(function(e,t,r){var n=e.groupBy,a=e.sortBy;switch(n){case j:return ue(t,r,[V.TRIP.PRESERVE_ORDER,V.TRIP.DEPARTURE_TIME,V.TRIP.ID,V.LOCATION.NAME]);case P:return ue(t,r,[V.TRIP.PRESERVE_ORDER,V.TRIP.DEPARTURE_TIME,V.TRIP.ID].concat(ae(ce(a,V.COUNTRY)),[V.COUNTRY.NAME_ID],ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]));case h:return ue(t,r,[].concat(ae(ce(a,V.COUNTRY)),[V.COUNTRY.NAME_ID],ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]));case A:return ue(t,r,[V.VISIT.ARRIVAL_YEAR].concat(ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]));case R:return ue(t,r,[V.VISIT.ARRIVAL_YEAR].concat(ae(ce(a,V.COUNTRY)),[V.COUNTRY.NAME_ID],ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]));case N:return ue(t,r,[].concat(ae(ce(a,V.COUNTRY)),[V.COUNTRY.NAME_ID,V.VISIT.ARRIVAL_YEAR],ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]));case T:default:return ue(t,r,[].concat(ae(ce(a,V.LOCATION)),[V.LOCATION.NAME_ID]))}}({groupBy:b,sortBy:y},g,Y)),F=x.reduce((function(e,t,n){return We({prevVisit:n>0?x[n-1]:{},visit:t,nextVisit:n<x.length-1?x[n+1]:{},provision:g,classes:f,counters:Y,groupBy:b,sortBy:y,hasEditRights:i,travelPaths:_,userAlias:r}).filter(Boolean).forEach((function(t){return e.push(t)})),e}),[k,G]);return o.a.createElement("div",{key:"".concat(b,"_").concat(y)},F)}Xe.propTypes={locationsUrl:Je.a.string.isRequired,locationsCount:Je.a.number.isRequired,countriesCount:Je.a.number.isRequired},r.d(t,"default",(function(){return Qe}))},794:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(62),a=r(809),i=r.n(a),o=r(811),c=r.n(o),u=r(803),l=r.n(u),s=r(149),d=r.n(s),f=r(146),v=r(10),p=r(798),O=r(795),m=r(799);function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b(e){var t=e.userAlias,r=function(e){var t=e.userAlias,r=e.tripsIds,a=Object(n.d)((function(e){return{tripsDict:Object(f.d)(e,"trips")||{}}})).tripsDict,i=!r,o=!i&&r.filter((function(e){return!a[e]}));return Object(f.g)({domain:"travel.trips-".concat(t),isProvision:!0,modelName:"trips",observe:t,query:{userAlias:t,navigation:{isDisabled:!0},filter:i?{}:{id:{comparator:"in",value:o}}}})}({userAlias:t,tripsIds:e.tripsIds}),a=Object(p.a)({domain:"travel.trips-".concat(t,".user"),userAlias:t}),o=a.user,c=(o=void 0===o?{}:o).locationsRating,u=void 0===c?{}:c,s=E(a,["user"]),b=(Object(v.o)(r)||{}).data,g=void 0===b?[]:b,I=Object(n.d)((function(e){return{tripsDict:Object(f.d)(e,"trips")||{},visitsDict:Object(f.d)(e,"visits")||{},ridesDict:Object(f.d)(e,"rides")||{},countriesDict:Object(f.d)(e,"countries")||{},locationsDict:Object(f.d)(e,"locations")||{}}})),T=I.tripsDict,h=I.visitsDict,A=I.ridesDict,R=I.countriesDict,N=I.locationsDict,j=Array.from(new Set(g.flatMap((function(e){var t;return(null===(t=T[e])||void 0===t?void 0:t.visits)||[]})))),P=Array.from(new Set(g.flatMap((function(e){var t;return(null===(t=T[e])||void 0===t?void 0:t.rides)||[]})))),C=Array.from(new Set(j.flatMap((function(e){var t;return(null===(t=h[e])||void 0===t?void 0:t.countryId)||[]})))),_=Array.from(new Set(j.flatMap((function(e){var t;return(null===(t=h[e])||void 0===t?void 0:t.locationId)||[]})))),D=Object(O.a)(),S=Object(m.a)({domain:"travel.locations-".concat(t),locationsIds:_}),L=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{updatesCounter:l()(t.map(v.p)),isReady:t.every(v.i),isPending:t.some(v.h),isValid:t.every(v.k),error:t.find(v.g),errors:t.map(v.f).filter(Boolean),invalidate:function(){return t.forEach((function(e){return(0,e.invalidate)()}))}}}(r,s,D,S),w=L.isError,V=L.isValid,B=L.isReady,Y=L.isPending,M=function(e,t,r){var n=e.reduce((function(e,n){var a=t[n];if(!a)return e;var i=r[n],o=a.countryId;return e[o]||(e[o]=[]),e[o].push(i),e}),{});return d()(n,(function(e){return function(e){if(!e.length)return 1/0;var t=e.length/e.map((function(e){return 1/e})).reduce((function(e,t){return e+t})),r=i()(e),n=Math.log(e.length);return 1/(1/t+n/r)}(e)}))}(_,N,u);return{tripsProvision:r,countriesProvision:D,locationsProvision:S,isError:w,isValid:V,isReady:B,isPending:Y,tripsIds:g,tripsDict:T,visitsIds:j,visitsDict:h,ridesIds:P,ridesDict:A,ridesStats:y(P,A),locationsIds:_,locationsDict:N,locationsRating:u,countriesIds:C,countriesDict:R,countriesRating:M}}function y(e,t){return{earliestDeparture:new Date(c()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.departureDateTime.getTime()})))),latestArrival:new Date(i()(e.map((function(e){var r;return null===(r=t[e])||void 0===r?void 0:r.arrivalDateTime.getTime()}))))}}},795:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(146),a=r(10);function i(){var e=Object(n.g)({domain:"travel.countries",isProvision:!0,modelName:"countries",query:{navigation:{isDisabled:!0}}}),t=(Object(a.o)(e)||{}).data;return{countriesIds:void 0===t?[]:t,isReady:Object(a.i)(e),isLoading:Object(a.h)(e),isError:Object(a.g)(e),counters:e.counters}}},798:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(62),a=r(146);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){var t=e.domain,r=e.userAlias,c=Object(n.d)((function(e){return Object(a.e)(e,"users",r)}));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Object(a.g)({domain:t,applicableSchemaName:"item",isProvision:!0,modelName:"users",observe:r,condition:Boolean(r),query:{id:r}}),{user:c})}},799:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return s}));var n=r(62),a=r(146),i=r(10);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(e){var t=e.domain,r=e.locationsIds,o=Object(n.d)((function(e){return Object(a.d)(e,"locations")||{}})),c=r.filter((function(e){return!o[e]})),u=Object(a.g)({domain:t,isProvision:!0,modelName:"locations",observe:r,condition:Boolean(c.length),query:{filter:{id:{comparator:"in",value:c}},navigation:{isDisabled:!0}}});return{locationsDict:o,isReady:Object(i.i)(u),isLoading:Object(i.h)(u),isError:Object(i.g)(u),counters:u.counters}}function s(e){var t=e.domain,r=u(Object(a.h)({domain:t,modelName:"locations",method:"POST"}),2),n=r[0];return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r[1],{submitLocationRating:n})}},808:function(e,t,r){"use strict";var n=r(794);r.d(t,"a",(function(){return n.a}));r(795)},812:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return p}));var n=r(306),a=r(890),i=r(891),o=r(54),c=r(821),u=r.n(c),l="d MMMM yyyy",s="d MMMM",d="d";function f(e,t){var r=Object(o.a)(t,l,{locale:u.a});if(Object(n.a)(e,t))return r;var c="";return c=Object(a.a)(e,t)?Object(o.a)(e,d,{locale:u.a}):Object(i.a)(e,t)?Object(o.a)(e,s,{locale:u.a}):Object(o.a)(e,l,{locale:u.a}),"".concat(c,"—").concat(r)}function v(e){return f(e.departureDateTime,e.arrivalDateTime)}function p(e){var t=e.departureDateTime;return f(e.arrivalDateTime,t)}},823:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(0),a=r.n(n),i=r(782),o=r(908),c=r.n(o),u=r(812),l=r(88),s=r(824),d=Object(i.a)({icon:{color:"gray",fontSize:16,height:16},absoluteIcon:{color:"gray",fontSize:16,height:16,position:"absolute"},detail:{color:"gray",fontSize:12}});function f(e){var t=e.ride,r=e.ride,n=(r=void 0===r?{}:r).rideType,i=e.className,o=e.isLong,f=d();return t?a.a.createElement("div",{className:i},a.a.createElement(s.a,{ride:t,className:f.icon}),n===l.RIDE_TYPES.HITCH_HIKING&&a.a.createElement(c.a,{className:f.absoluteIcon}),o&&Object(u.a)(t)):null}},824:function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));var n=r(0),a=r.n(n),i=r(898),o=r.n(i),c=r(897),u=r.n(c),l=r(895),s=r.n(l),d=r(892),f=r.n(d),v=r(906),p=r.n(v),O=r(894),m=r.n(O),E=r(900),b=r.n(E),y=r(901),g=r.n(y),I=r(893),T=r.n(I),h=r(860),A=r.n(h),R=r(896),N=r.n(R),j=r(899),P=r.n(j),C=r(902),_=r.n(C),D=r(903),S=r.n(D),L=r(904),w=r.n(L),V=r(905),B=r.n(V),Y=r(907),M=r.n(Y),k=r(88);function H(e){var t=e.ride.vehicleType,r=e.className,n=function(e){switch(e){case k.VEHICLE_TYPES.CAR:return f.a;case k.VEHICLE_TYPES.TRAIN:return T.a;case k.VEHICLE_TYPES.AIRCRAFT:return m.a;case k.VEHICLE_TYPES.BUS:case k.VEHICLE_TYPES.TROLLEY:case k.VEHICLE_TYPES.CITY_BUS:return s.a;case k.VEHICLE_TYPES.MOTORHOME:case k.VEHICLE_TYPES.JITNEY:return N.a;case k.VEHICLE_TYPES.LOCAL_TRAIN:return T.a;case k.VEHICLE_TYPES.FERRY:return u.a;case k.VEHICLE_TYPES.BIKE:return o.a;case k.VEHICLE_TYPES.BY_FEET:return P.a;case k.VEHICLE_TYPES.MOTORBIKE:return b.a;case k.VEHICLE_TYPES.TRUCK:return A.a;case k.VEHICLE_TYPES.ALL_TERRAIN_VEHICLE:return g.a;case k.VEHICLE_TYPES.TRAM:return _.a;case k.VEHICLE_TYPES.TAXI:return S.a;case k.VEHICLE_TYPES.SUBWAY:return w.a;case k.VEHICLE_TYPES.PUBLIC_TRANSPORT:return B.a;case k.VEHICLE_TYPES.ROPEWAY:case k.VEHICLE_TYPES.FUNICULAR:return p.a;default:return M.a}}(t);return a.a.createElement(n,{className:r})}},867:function(e,t,r){"use strict";var n=r(0),a=r.n(n),i=r(2),o=r.n(i),c=r(881),u=r.n(c),l=r(782),s=r(276),d=r(312),f=r.n(d),v=function(){var e=null,t=null;return{promise:new Promise((function(r,n){e=r,t=n})),resolver:e,rejector:t}};r.d(t,"a",(function(){return O}));var p=Object(l.a)({googleMapContainer:{margin:"12px 0",maxWidth:"100%",height:function(e){return e.height},maxHeight:"100%"}});function O(e){var t=e.locationsDict,r=e.locationsIds,i=e.height,o=p({height:i}),c=function(e){var t=Object(n.useMemo)(v,[]),r=t.promise,a=t.resolver,i=Object(n.useRef)(null),o=Object(n.useRef)(0);return Object(n.useEffect)((function(){f()(i,e)||(o.current+=1)})),Object(n.useEffect)((function(){var t=[];return r.then((function(r){var n=r.map,a=r.maps,i=new a.LatLngBounds;t=e.map((function(e){var t=e.lat,r=e.lon,o=new a.Marker({position:{lat:t,lng:r},map:n});return i.extend(o.position),o})),n.fitBounds(i),n.getZoom()>11&&n.setZoom(11)})),function(){return t.forEach((function(e){return e.setMap(null)}))}}),[o.current]),{handleGoogleApiLoaded:a}}(r.map((function(e){return t[e]}))).handleGoogleApiLoaded;return a.a.createElement("div",{className:o.googleMapContainer},a.a.createElement(u.a,{bootstrapURLKeys:{key:"AIzaSyCvP0e64ui7WpXKBdzOyEmkb4l5RuGy3Zs"},center:{lat:0,lng:0},zoom:11,onGoogleApiLoaded:c}))}O.propTypes={locationsDict:o.a.objectOf(o.a.shape(s.default)).isRequired,locationsIds:o.a.arrayOf(o.a.number).isRequired,height:o.a.string},O.defaultProps={height:"400px"}},873:function(e,t,r){"use strict";var n=r(1),a=r(5),i=r(0),o=r.n(i),c=(r(7),r(8)),u=r(15),l=r(9),s=r(307),d=r(33),f=r(228),v=o.a.forwardRef((function(e,t){var r=e.classes,i=e.className,l=e.color,v=void 0===l?"primary":l,p=e.component,O=void 0===p?"a":p,m=e.onBlur,E=e.onFocus,b=e.TypographyClasses,y=e.underline,g=void 0===y?"hover":y,I=e.variant,T=void 0===I?"inherit":I,h=Object(a.a)(e,["classes","className","color","component","onBlur","onFocus","TypographyClasses","underline","variant"]),A=Object(s.a)(),R=A.isFocusVisible,N=A.onBlurVisible,j=A.ref,P=o.a.useState(!1),C=P[0],_=P[1],D=Object(d.a)(t,j);return o.a.createElement(f.a,Object(n.a)({className:Object(c.a)(r.root,r["underline".concat(Object(u.a)(g))],i,C&&r.focusVisible,"button"===O&&r.button),classes:b,color:v,component:O,onBlur:function(e){C&&(N(),_(!1)),m&&m(e)},onFocus:function(e){R(e)&&_(!0),E&&E(e)},ref:D,variant:T},h))}));t.a=Object(l.a)({root:{},underlineNone:{textDecoration:"none"},underlineHover:{textDecoration:"none","&:hover":{textDecoration:"underline"}},underlineAlways:{textDecoration:"underline"},button:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none","&::-moz-focus-inner":{borderStyle:"none"},"&$focusVisible":{outline:"auto"}},focusVisible:{}},{name:"MuiLink"})(v)}}]);
//# sourceMappingURL=travel-VisitsPage-d5ef44b6dd499f97f22f.js.map